"use strict";(self.webpackChunkngx_three_demo=self.webpackChunkngx_three_demo||[]).push([[179],{2677:(d0,V1,ou)=>{var Td={};function un(n){return"function"==typeof n}function f0(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}ou.r(Td),ou.d(Td,{ACESFilmicToneMapping:()=>DF,AddEquation:()=>pc,AddOperation:()=>SF,AdditiveAnimationBlendMode:()=>zM,AdditiveBlending:()=>ih,AlphaFormat:()=>kF,AlwaysDepth:()=>_F,AlwaysStencilFunc:()=>ZF,AmbientLight:()=>iT,AmbientLightProbe:()=>Ite,AnimationClip:()=>Wh,AnimationLoader:()=>xte,AnimationMixer:()=>iN,AnimationObjectGroup:()=>Zte,AnimationUtils:()=>Kn,ArcCurve:()=>uO,ArrayCamera:()=>Uk,ArrowHelper:()=>hne,Audio:()=>eN,AudioAnalyser:()=>Bte,AudioContext:()=>rT,AudioListener:()=>kte,AudioLoader:()=>Rte,AxesHelper:()=>dne,BackSide:()=>ns,BasicDepthPacking:()=>XF,BasicShadowMap:()=>IY,Bone:()=>ov,BooleanKeyframeTrack:()=>Lc,Box2:()=>ene,Box3:()=>zo,Box3Helper:()=>pN,BoxBufferGeometry:()=>Xn,BoxGeometry:()=>Xn,BoxHelper:()=>cne,BufferAttribute:()=>En,BufferGeometry:()=>wt,BufferGeometryLoader:()=>XO,ByteType:()=>RF,Cache:()=>kc,Camera:()=>Qf,CameraHelper:()=>lne,CanvasTexture:()=>OS,CapsuleBufferGeometry:()=>Ph,CapsuleGeometry:()=>Ph,CatmullRomCurve3:()=>hO,CineonToneMapping:()=>EF,CircleBufferGeometry:()=>Ih,CircleGeometry:()=>Ih,ClampToEdgeWrapping:()=>dr,Clock:()=>Sv,Color:()=>Ce,ColorKeyframeTrack:()=>QS,ColorManagement:()=>Ss,CompressedTexture:()=>cO,CompressedTextureLoader:()=>wte,ConeBufferGeometry:()=>Lh,ConeGeometry:()=>Lh,CubeCamera:()=>uk,CubeReflectionMapping:()=>Ja,CubeRefractionMapping:()=>el,CubeTexture:()=>$f,CubeTextureLoader:()=>Mte,CubeUVReflectionMapping:()=>rh,CubicBezierCurve:()=>VS,CubicBezierCurve3:()=>fO,CubicInterpolant:()=>LO,CullFaceBack:()=>cM,CullFaceFront:()=>tF,CullFaceFrontBack:()=>PY,CullFaceNone:()=>eF,Curve:()=>uo,CurvePath:()=>mO,CustomBlending:()=>rF,CustomToneMapping:()=>AF,CylinderBufferGeometry:()=>gi,CylinderGeometry:()=>gi,Cylindrical:()=>Jte,Data3DTexture:()=>R_,DataArrayTexture:()=>Xf,DataTexture:()=>Ac,DataTexture2DArray:()=>bne,DataTexture3D:()=>xne,DataTextureLoader:()=>Ste,DataUtils:()=>gp,DecrementStencilOp:()=>HY,DecrementWrapStencilOp:()=>WY,DefaultLoadingManager:()=>OO,DepthFormat:()=>sl,DepthStencilFormat:()=>gc,DepthTexture:()=>Vk,DirectionalLight:()=>xv,DirectionalLightHelper:()=>ane,DiscreteInterpolant:()=>FO,DodecahedronBufferGeometry:()=>Fh,DodecahedronGeometry:()=>Fh,DoubleSide:()=>io,DstAlphaFactor:()=>hF,DstColorFactor:()=>fF,DynamicCopyUsage:()=>sK,DynamicDrawUsage:()=>S_,DynamicReadUsage:()=>nK,EdgesGeometry:()=>gO,EllipseCurve:()=>_l,EqualDepth:()=>yF,EqualStencilFunc:()=>YY,EquirectangularReflectionMapping:()=>Bf,EquirectangularRefractionMapping:()=>jf,Euler:()=>fh,EventDispatcher:()=>rs,ExtrudeBufferGeometry:()=>Oh,ExtrudeGeometry:()=>Oh,FileLoader:()=>Es,FlatShading:()=>iF,Float16BufferAttribute:()=>VK,Float32BufferAttribute:()=>$e,Float64BufferAttribute:()=>zK,FloatType:()=>so,Fog:()=>ep,FogExp2:()=>tv,Font:()=>_ne,FontLoader:()=>gne,FramebufferTexture:()=>Gee,FrontSide:()=>$a,Frustum:()=>K_,GLBufferAttribute:()=>$te,GLSL1:()=>aK,GLSL3:()=>WM,GreaterDepth:()=>xF,GreaterEqualDepth:()=>bF,GreaterEqualStencilFunc:()=>JY,GreaterStencilFunc:()=>QY,GridHelper:()=>uT,Group:()=>Wo,HalfFloatType:()=>rl,HemisphereLight:()=>JS,HemisphereLightHelper:()=>sne,HemisphereLightProbe:()=>Pte,IcosahedronBufferGeometry:()=>Ic,IcosahedronGeometry:()=>Ic,ImageBitmapLoader:()=>YO,ImageLoader:()=>fp,ImageUtils:()=>KM,ImmediateRenderObject:()=>vne,IncrementStencilOp:()=>zY,IncrementWrapStencilOp:()=>GY,InstancedBufferAttribute:()=>Rh,InstancedBufferGeometry:()=>WO,InstancedInterleavedBuffer:()=>Qte,InstancedMesh:()=>PS,Int16BufferAttribute:()=>jK,Int32BufferAttribute:()=>UK,Int8BufferAttribute:()=>OK,IntType:()=>IF,InterleavedBuffer:()=>tp,InterleavedBufferAttribute:()=>gl,Interpolant:()=>zh,InterpolateDiscrete:()=>oh,InterpolateLinear:()=>_c,InterpolateSmooth:()=>b_,InvertStencilOp:()=>XY,KeepStencilOp:()=>w_,KeyframeTrack:()=>go,LOD:()=>Zk,LatheBufferGeometry:()=>Rc,LatheGeometry:()=>Rc,Layers:()=>N_,LessDepth:()=>vF,LessEqualDepth:()=>f_,LessEqualStencilFunc:()=>KY,LessStencilFunc:()=>ZY,Light:()=>Aa,LightProbe:()=>wv,Line:()=>Mi,Line3:()=>aN,LineBasicMaterial:()=>Pi,LineCurve:()=>fv,LineCurve3:()=>pO,LineDashedMaterial:()=>IO,LineLoop:()=>LS,LineSegments:()=>Cs,LinearEncoding:()=>ol,LinearFilter:()=>si,LinearInterpolant:()=>KS,LinearMipMapLinearFilter:()=>NY,LinearMipMapNearestFilter:()=>OY,LinearMipmapLinearFilter:()=>va,LinearMipmapNearestFilter:()=>m_,LinearSRGBColorSpace:()=>ll,LinearToneMapping:()=>TF,Loader:()=>Pr,LoaderUtils:()=>_o,LoadingManager:()=>$S,LoopOnce:()=>VM,LoopPingPong:()=>GF,LoopRepeat:()=>HF,LuminanceAlphaFormat:()=>NF,LuminanceFormat:()=>vM,MOUSE:()=>ws,Material:()=>mi,MaterialLoader:()=>GO,MathUtils:()=>Ot,Matrix3:()=>Ms,Matrix4:()=>ot,MaxEquation:()=>pM,Mesh:()=>qe,MeshBasicMaterial:()=>nr,MeshDepthMaterial:()=>ev,MeshDistanceMaterial:()=>SS,MeshLambertMaterial:()=>RO,MeshMatcapMaterial:()=>PO,MeshNormalMaterial:()=>AO,MeshPhongMaterial:()=>YS,MeshPhysicalMaterial:()=>Ea,MeshStandardMaterial:()=>mo,MeshToonMaterial:()=>DO,MinEquation:()=>fM,MirroredRepeatWrapping:()=>sh,MixOperation:()=>MF,MultiplyBlending:()=>dM,MultiplyOperation:()=>Nf,NearestFilter:()=>xi,NearestMipMapLinearFilter:()=>kY,NearestMipMapNearestFilter:()=>FY,NearestMipmapLinearFilter:()=>Vf,NearestMipmapNearestFilter:()=>Uf,NeverDepth:()=>gF,NeverStencilFunc:()=>qY,NoBlending:()=>ro,NoColorSpace:()=>jY,NoToneMapping:()=>Uo,NormalAnimationBlendMode:()=>x_,NormalBlending:()=>fc,NotEqualDepth:()=>wF,NotEqualStencilFunc:()=>$Y,NumberKeyframeTrack:()=>Hh,Object3D:()=>nn,ObjectLoader:()=>Dte,ObjectSpaceNormalMap:()=>qF,OctahedronBufferGeometry:()=>fo,OctahedronGeometry:()=>fo,OneFactor:()=>lF,OneMinusDstAlphaFactor:()=>dF,OneMinusDstColorFactor:()=>pF,OneMinusSrcAlphaFactor:()=>gM,OneMinusSrcColorFactor:()=>uF,OrthographicCamera:()=>Cc,PCFShadowMap:()=>uM,PCFSoftShadowMap:()=>nF,PMREMGenerator:()=>yS,ParametricGeometry:()=>pne,Path:()=>cp,PerspectiveCamera:()=>zi,Plane:()=>Go,PlaneBufferGeometry:()=>Ta,PlaneGeometry:()=>Ta,PlaneHelper:()=>une,PointLight:()=>bv,PointLightHelper:()=>ine,Points:()=>kS,PointsMaterial:()=>cv,PolarGridHelper:()=>one,PolyhedronBufferGeometry:()=>ho,PolyhedronGeometry:()=>ho,PositionalAudio:()=>Nte,PropertyBinding:()=>Bn,PropertyMixer:()=>nN,QuadraticBezierCurve:()=>zS,QuadraticBezierCurve3:()=>HS,Quaternion:()=>bn,QuaternionKeyframeTrack:()=>yl,QuaternionLinearInterpolant:()=>kO,REVISION:()=>d_,RGBADepthPacking:()=>GM,RGBAFormat:()=>is,RGBAIntegerFormat:()=>VF,RGBA_ASTC_10x10_Format:()=>NM,RGBA_ASTC_10x5_Format:()=>FM,RGBA_ASTC_10x6_Format:()=>kM,RGBA_ASTC_10x8_Format:()=>OM,RGBA_ASTC_12x10_Format:()=>BM,RGBA_ASTC_12x12_Format:()=>jM,RGBA_ASTC_4x4_Format:()=>CM,RGBA_ASTC_5x4_Format:()=>EM,RGBA_ASTC_5x5_Format:()=>DM,RGBA_ASTC_6x5_Format:()=>AM,RGBA_ASTC_6x6_Format:()=>RM,RGBA_ASTC_8x5_Format:()=>PM,RGBA_ASTC_8x6_Format:()=>IM,RGBA_ASTC_8x8_Format:()=>LM,RGBA_BPTC_Format:()=>UM,RGBA_ETC2_EAC_Format:()=>TM,RGBA_PVRTC_2BPPV1_Format:()=>MM,RGBA_PVRTC_4BPPV1_Format:()=>wM,RGBA_S3TC_DXT1_Format:()=>__,RGBA_S3TC_DXT3_Format:()=>v_,RGBA_S3TC_DXT5_Format:()=>y_,RGBFormat:()=>OF,RGB_ETC1_Format:()=>zF,RGB_ETC2_Format:()=>SM,RGB_PVRTC_2BPPV1_Format:()=>xM,RGB_PVRTC_4BPPV1_Format:()=>bM,RGB_S3TC_DXT1_Format:()=>g_,RGFormat:()=>jF,RGIntegerFormat:()=>UF,RawShaderMaterial:()=>EO,Ray:()=>Zf,Raycaster:()=>mp,RectAreaLight:()=>zO,RedFormat:()=>yM,RedIntegerFormat:()=>BF,ReinhardToneMapping:()=>CF,RepeatWrapping:()=>tl,ReplaceStencilOp:()=>VY,ReverseSubtractEquation:()=>oF,RingBufferGeometry:()=>Nh,RingGeometry:()=>Nh,SRGBColorSpace:()=>Vo,Scene:()=>ES,ShaderChunk:()=>$t,ShaderLib:()=>co,ShaderMaterial:()=>Yn,ShadowMaterial:()=>CO,Shape:()=>Pc,ShapeBufferGeometry:()=>Bh,ShapeGeometry:()=>Bh,ShapePath:()=>fne,ShapeUtils:()=>Xo,ShortType:()=>PF,Skeleton:()=>sp,SkeletonHelper:()=>nne,SkinnedMesh:()=>RS,SmoothShading:()=>LY,Source:()=>wc,Sphere:()=>ba,SphereBufferGeometry:()=>Ca,SphereGeometry:()=>Ca,Spherical:()=>Tv,SphericalHarmonics3:()=>HO,SplineCurve:()=>GS,SpotLight:()=>tT,SpotLightHelper:()=>tne,Sprite:()=>Xk,SpriteMaterial:()=>DS,SrcAlphaFactor:()=>mM,SrcAlphaSaturateFactor:()=>mF,SrcColorFactor:()=>cF,StaticCopyUsage:()=>rK,StaticDrawUsage:()=>M_,StaticReadUsage:()=>tK,StereoCamera:()=>Lte,StreamCopyUsage:()=>oK,StreamDrawUsage:()=>eK,StreamReadUsage:()=>iK,StringKeyframeTrack:()=>Fc,SubtractEquation:()=>sF,SubtractiveBlending:()=>hM,TOUCH:()=>_a,TangentSpaceNormalMap:()=>al,TetrahedronBufferGeometry:()=>jh,TetrahedronGeometry:()=>jh,TextGeometry:()=>mne,Texture:()=>fr,TextureLoader:()=>NO,TorusBufferGeometry:()=>po,TorusGeometry:()=>po,TorusKnotBufferGeometry:()=>Uh,TorusKnotGeometry:()=>Uh,Triangle:()=>as,TriangleFanDrawMode:()=>HM,TriangleStripDrawMode:()=>WF,TrianglesDrawMode:()=>BY,TubeBufferGeometry:()=>Vh,TubeGeometry:()=>Vh,UVMapping:()=>p_,Uint16BufferAttribute:()=>cS,Uint32BufferAttribute:()=>U_,Uint8BufferAttribute:()=>NK,Uint8ClampedBufferAttribute:()=>BK,Uniform:()=>aT,UniformsLib:()=>Qe,UniformsUtils:()=>Ho,UnsignedByteType:()=>nl,UnsignedInt248Type:()=>mc,UnsignedIntType:()=>il,UnsignedShort4444Type:()=>LF,UnsignedShort5551Type:()=>FF,UnsignedShortType:()=>_M,VSMShadowMap:()=>nh,Vector2:()=>te,Vector3:()=>C,Vector4:()=>gn,VectorKeyframeTrack:()=>Gh,VideoTexture:()=>Hee,WebGL1Renderer:()=>zk,WebGL3DRenderTarget:()=>CK,WebGLArrayRenderTarget:()=>TK,WebGLCubeRenderTarget:()=>hk,WebGLMultipleRenderTargets:()=>EK,WebGLMultisampleRenderTarget:()=>yne,WebGLRenderTarget:()=>Nn,WebGLRenderer:()=>CS,WebGLUtils:()=>jk,WireframeGeometry:()=>MO,WrapAroundEnding:()=>zf,ZeroCurvatureEnding:()=>vc,ZeroFactor:()=>aF,ZeroSlopeEnding:()=>yc,ZeroStencilOp:()=>UY,_SRGBAFormat:()=>T_,sRGBEncoding:()=>mn});const p0=f0(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function pm(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class $n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(un(i))try{i()}catch(s){e=s instanceof p0?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{G1(s)}catch(o){e=e??[],o instanceof p0?e=[...e,...o.errors]:e.push(o)}}if(e)throw new p0(e)}}add(e){var t;if(e&&e!==this)if(this.closed)G1(e);else{if(e instanceof $n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&pm(t,e)}remove(e){const{_finalizers:t}=this;t&&pm(t,e),e instanceof $n&&e._removeParent(this)}}$n.EMPTY=(()=>{const n=new $n;return n.closed=!0,n})();const z1=$n.EMPTY;function H1(n){return n instanceof $n||n&&"closed"in n&&un(n.remove)&&un(n.add)&&un(n.unsubscribe)}function G1(n){un(n)?n():n.unsubscribe()}const jl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},mm={setTimeout(n,e,...t){const{delegate:i}=mm;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=mm;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function W1(n){mm.setTimeout(()=>{const{onUnhandledError:e}=jl;if(!e)throw n;e(n)})}function m0(){}const rz=g0("C",void 0,void 0);function g0(n,e,t){return{kind:n,value:e,error:t}}let Ul=null;function gm(n){if(jl.useDeprecatedSynchronousErrorHandling){const e=!Ul;if(e&&(Ul={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Ul;if(Ul=null,t)throw i}}else n()}class _0 extends $n{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,H1(e)&&e.add(this)):this.destination=hz}static create(e,t,i){return new _m(e,t,i)}next(e){this.isStopped?y0(function oz(n){return g0("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?y0(function sz(n){return g0("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?y0(rz,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const lz=Function.prototype.bind;function v0(n,e){return lz.call(n,e)}class cz{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){vm(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){vm(i)}else vm(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){vm(t)}}}class _m extends _0{constructor(e,t,i){let r;if(super(),un(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&jl.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&v0(e.next,s),error:e.error&&v0(e.error,s),complete:e.complete&&v0(e.complete,s)}):r=e}this.destination=new cz(r)}}function vm(n){jl.useDeprecatedSynchronousErrorHandling?function az(n){jl.useDeprecatedSynchronousErrorHandling&&Ul&&(Ul.errorThrown=!0,Ul.error=n)}(n):W1(n)}function y0(n,e){const{onStoppedNotification:t}=jl;t&&mm.setTimeout(()=>t(n,e))}const hz={closed:!0,next:m0,error:function uz(n){throw n},complete:m0},b0="function"==typeof Symbol&&Symbol.observable||"@@observable";function ja(n){return n}let wn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function fz(n){return n&&n instanceof _0||function dz(n){return n&&un(n.next)&&un(n.error)&&un(n.complete)}(n)&&H1(n)}(t)?t:new _m(t,i,r);return gm(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=q1(i))((r,s)=>{const o=new _m({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[b0](){return this}pipe(...t){return function X1(n){return 0===n.length?ja:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=q1(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function q1(n){var e;return null!==(e=n??jl.Promise)&&void 0!==e?e:Promise}const pz=f0(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ft=(()=>{class n extends wn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Z1(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new pz}next(t){gm(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){gm(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){gm(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?z1:(this.currentObservers=null,s.push(t),new $n(()=>{this.currentObservers=null,pm(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new wn;return t.source=this,t}}return n.create=(e,t)=>new Z1(e,t),n})();class Z1 extends Ft{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:z1}}function Y1(n){return un(n?.lift)}function ui(n){return e=>{if(Y1(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Jn(n,e,t,i,r){return new mz(n,e,t,i,r)}class mz extends _0{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function xt(n,e){return ui((t,i)=>{let r=0;t.subscribe(Jn(i,s=>{i.next(n.call(e,s,r++))}))})}function Vl(n){return this instanceof Vl?(this.v=n,this):new Vl(n)}function vz(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(f){return new Promise(function(p,m){s.push([d,f,p,m])>1||a(d,f)})})}function a(d,f){try{!function l(d){d.value instanceof Vl?Promise.resolve(d.value.v).then(c,u):h(s[0][2],d)}(i[d](f))}catch(p){h(s[0][3],p)}}function c(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function yz(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function $1(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const w0=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function J1(n){return un(n?.then)}function eE(n){return un(n[b0])}function tE(n){return Symbol.asyncIterator&&un(n?.[Symbol.asyncIterator])}function nE(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const iE=function xz(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function rE(n){return un(n?.[iE])}function sE(n){return vz(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Vl(t.read());if(r)return yield Vl(void 0);yield yield Vl(i)}}finally{t.releaseLock()}})}function oE(n){return un(n?.getReader)}function kr(n){if(n instanceof wn)return n;if(null!=n){if(eE(n))return function wz(n){return new wn(e=>{const t=n[b0]();if(un(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(w0(n))return function Mz(n){return new wn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(J1(n))return function Sz(n){return new wn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W1)})}(n);if(tE(n))return aE(n);if(rE(n))return function Tz(n){return new wn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(oE(n))return function Cz(n){return aE(sE(n))}(n)}throw nE(n)}function aE(n){return new wn(e=>{(function Ez(n,e){var t,i,r,s;return function gz(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=yz(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function ea(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Gi(n,e,t=1/0){return un(e)?Gi((i,r)=>xt((s,o)=>e(i,s,r,o))(kr(n(i,r))),t):("number"==typeof e&&(t=e),ui((i,r)=>function Dz(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,h=!1;const d=()=>{h&&!l.length&&!c&&e.complete()},f=m=>c<i?p(m):l.push(m),p=m=>{s&&e.next(m),c++;let g=!1;kr(t(m,u++)).subscribe(Jn(e,_=>{r?.(_),s?f(_):e.next(_)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const _=l.shift();o?ea(e,o,()=>p(_)):p(_)}d()}catch(_){e.error(_)}}))};return n.subscribe(Jn(e,f,()=>{h=!0,d()})),()=>{a?.()}}(i,r,n,t)))}function au(n=1/0){return Gi(ja,n)}const yr=new wn(n=>n.complete());function lE(n){return n&&un(n.schedule)}function M0(n){return n[n.length-1]}function S0(n){return un(M0(n))?n.pop():void 0}function Cd(n){return lE(M0(n))?n.pop():void 0}function cE(n,e=0){return ui((t,i)=>{t.subscribe(Jn(i,r=>ea(i,n,()=>i.next(r),e),()=>ea(i,n,()=>i.complete(),e),r=>ea(i,n,()=>i.error(r),e)))})}function uE(n,e=0){return ui((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function hE(n,e){if(!n)throw new Error("Iterable cannot be null");return new wn(t=>{ea(t,e,()=>{const i=n[Symbol.asyncIterator]();ea(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function vi(n,e){return e?function Oz(n,e){if(null!=n){if(eE(n))return function Pz(n,e){return kr(n).pipe(uE(e),cE(e))}(n,e);if(w0(n))return function Lz(n,e){return new wn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(J1(n))return function Iz(n,e){return kr(n).pipe(uE(e),cE(e))}(n,e);if(tE(n))return hE(n,e);if(rE(n))return function Fz(n,e){return new wn(t=>{let i;return ea(t,e,()=>{i=n[iE](),ea(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>un(i?.return)&&i.return()})}(n,e);if(oE(n))return function kz(n,e){return hE(sE(n),e)}(n,e)}throw nE(n)}(n,e):kr(n)}function lu(...n){const e=Cd(n),t=function Rz(n,e){return"number"==typeof M0(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?kr(i[0]):au(t)(vi(i,e)):yr}function Or(n){return n<=0?()=>yr:ui((e,t)=>{let i=0;e.subscribe(Jn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function T0(n={}){const{connector:e=(()=>new Ft),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o=null,a=null,l=null,c=0,u=!1,h=!1;const d=()=>{a?.unsubscribe(),a=null},f=()=>{d(),o=l=null,u=h=!1},p=()=>{const m=o;f(),m?.unsubscribe()};return ui((m,g)=>{c++,!h&&!u&&d();const _=l=l??e();g.add(()=>{c--,0===c&&!h&&!u&&(a=C0(p,r))}),_.subscribe(g),o||(o=new _m({next:v=>_.next(v),error:v=>{h=!0,d(),a=C0(f,t,v),_.error(v)},complete:()=>{u=!0,d(),a=C0(f,i),_.complete()}}),vi(m).subscribe(o))})(s)}}function C0(n,e,...t){return!0===e?(n(),null):!1===e?null:e(...t).pipe(Or(1)).subscribe(()=>n())}function Fn(n){for(let e in n)if(n[e]===Fn)return e;throw Error("Could not find renamed property on target object.")}function E0(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function kn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(kn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function D0(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Nz=Fn({__forward_ref__:Fn});function Ze(n){return n.__forward_ref__=Ze,n.toString=function(){return kn(this())},n}function Rt(n){return A0(n)?n():n}function A0(n){return"function"==typeof n&&n.hasOwnProperty(Nz)&&n.__forward_ref__===Ze}class et extends Error{constructor(e,t){super(function ym(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function Nt(n){return"string"==typeof n?n:null==n?"":String(n)}function bm(n,e){throw new et(-201,!1)}function Wr(n,e){null==n&&function Mn(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function jt(n){return{providers:n.providers||[],imports:n.imports||[]}}function R0(n){return dE(n,xm)||dE(n,pE)}function dE(n,e){return n.hasOwnProperty(e)?n[e]:null}function fE(n){return n&&(n.hasOwnProperty(P0)||n.hasOwnProperty(Wz))?n[P0]:null}const xm=Fn({\u0275prov:Fn}),P0=Fn({\u0275inj:Fn}),pE=Fn({ngInjectableDef:Fn}),Wz=Fn({ngInjectorDef:Fn});var Ct=(()=>((Ct=Ct||{})[Ct.Default=0]="Default",Ct[Ct.Host=1]="Host",Ct[Ct.Self=2]="Self",Ct[Ct.SkipSelf=4]="SkipSelf",Ct[Ct.Optional=8]="Optional",Ct))();let I0;function To(n){const e=I0;return I0=n,e}function mE(n,e,t){const i=R0(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ct.Optional?null:void 0!==e?e:void bm(kn(n))}function Ua(n){return{toString:n}.toString()}var Us=(()=>((Us=Us||{})[Us.OnPush=0]="OnPush",Us[Us.Default=1]="Default",Us))(),Vs=(()=>{return(n=Vs||(Vs={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Vs;var n})();const Rn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),cu={},vn=[],wm=Fn({\u0275cmp:Fn}),L0=Fn({\u0275dir:Fn}),F0=Fn({\u0275pipe:Fn}),gE=Fn({\u0275mod:Fn}),na=Fn({\u0275fac:Fn}),Ed=Fn({__NG_ELEMENT_ID__:Fn});let qz=0;function Re(n){return Ua(()=>{const t=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Us.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||vn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Vs.Emulated,id:"c"+qz++,styles:n.styles||vn,_:null,setInput:null,schemas:n.schemas||null,tView:null},s=n.dependencies,o=n.features;return r.inputs=yE(n.inputs,i),r.outputs=yE(n.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(_E).filter(vE):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(xr).filter(vE):null,r})}function _E(n){return On(n)||br(n)}function vE(n){return null!==n}const Yz={};function Vt(n){return Ua(()=>{const e={type:n.type,bootstrap:n.bootstrap||vn,declarations:n.declarations||vn,imports:n.imports||vn,exports:n.exports||vn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Yz[n.id]=n.type),e})}function yE(n,e){if(null==n)return cu;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const tt=Re;function Qi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function On(n){return n[wm]||null}function br(n){return n[L0]||null}function xr(n){return n[F0]||null}function Xr(n,e){const t=n[gE]||null;if(!t&&!0===e)throw new Error(`Type ${kn(n)} does not have '\u0275mod' property.`);return t}function Nr(n){return Array.isArray(n)&&"object"==typeof n[1]}function Hs(n){return Array.isArray(n)&&!0===n[1]}function N0(n){return 0!=(8&n.flags)}function Cm(n){return 2==(2&n.flags)}function Em(n){return 1==(1&n.flags)}function Gs(n){return null!==n.template}function e4(n){return 0!=(256&n[2])}function Xl(n,e){return n.hasOwnProperty(na)?n[na]:null}class r4{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function $i(){return wE}function wE(n){return n.type.prototype.ngOnChanges&&(n.setInput=o4),s4}function s4(){const n=SE(this),e=n?.current;if(e){const t=n.previous;if(t===cu)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function o4(n,e,t,i){const r=SE(n)||function a4(n,e){return n[ME]=e}(n,{previous:cu,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new r4(l&&l.currentValue,e,o===cu),n[i]=e}$i.ngInherit=!0;const ME="__ngSimpleChanges__";function SE(n){return n[ME]||null}let z0;function hi(n){return!!n.listen}const TE={createRenderer:(n,e)=>function H0(){return void 0!==z0?z0:typeof document<"u"?document:void 0}()};function Ci(n){for(;Array.isArray(n);)n=n[0];return n}function Dm(n,e){return Ci(e[n])}function ps(n,e){return Ci(e[n.index])}function G0(n,e){return n.data[e]}function pu(n,e){return n[e]}function Zr(n,e){const t=e[n];return Nr(t)?t:t[0]}function CE(n){return 4==(4&n[2])}function W0(n){return 64==(64&n[2])}function Va(n,e){return null==e?null:n[e]}function EE(n){n[18]=0}function X0(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const kt={lFrame:OE(null),bindingsEnabled:!0};function AE(){return kt.bindingsEnabled}function be(){return kt.lFrame.lView}function hn(){return kt.lFrame.tView}function Br(n){return kt.lFrame.contextLView=n,n[8]}function jr(n){return kt.lFrame.contextLView=null,n}function Oi(){let n=RE();for(;null!==n&&64===n.type;)n=n.parent;return n}function RE(){return kt.lFrame.currentTNode}function Co(n,e){const t=kt.lFrame;t.currentTNode=n,t.isParent=e}function q0(){return kt.lFrame.isParent}function Z0(){kt.lFrame.isParent=!1}function wr(){const n=kt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function mu(){return kt.lFrame.bindingIndex++}function S4(n,e){const t=kt.lFrame;t.bindingIndex=t.bindingRootIndex=n,Y0(e)}function Y0(n){kt.lFrame.currentDirectiveIndex=n}function K0(n){const e=kt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function LE(){return kt.lFrame.currentQueryIndex}function Q0(n){kt.lFrame.currentQueryIndex=n}function C4(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function FE(n,e,t){if(t&Ct.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Ct.Host||(r=C4(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=kt.lFrame=kE();return i.currentTNode=e,i.lView=n,!0}function Rm(n){const e=kE(),t=n[1];kt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function kE(){const n=kt.lFrame,e=null===n?null:n.child;return null===e?OE(n):e}function OE(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function NE(){const n=kt.lFrame;return kt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const BE=NE;function Pm(){const n=NE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Mr(){return kt.lFrame.selectedIndex}function za(n){kt.lFrame.selectedIndex=n}function di(){const n=kt.lFrame;return G0(n.tView,n.selectedIndex)}function Im(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function Lm(n,e,t){jE(n,e,3,t)}function Fm(n,e,t,i){(3&n[2])===t&&jE(n,e,t,i)}function $0(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function jE(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(k4(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function k4(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Id{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function km(n,e,t){const i=hi(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];eb(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function UE(n){return 3===n||4===n||6===n}function eb(n){return 64===n.charCodeAt(0)}function Om(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||VE(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function VE(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function zE(n){return-1!==n}function gu(n){return 32767&n}function _u(n,e){let t=function U4(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let tb=!0;function Nm(n){const e=tb;return tb=n,e}let V4=0;const Eo={};function Fd(n,e){const t=ib(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,nb(i.data,n),nb(e,null),nb(i.blueprint,null));const r=Bm(n,e),s=n.injectorIndex;if(zE(r)){const o=gu(r),a=_u(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function nb(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ib(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Bm(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=QE(r),null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function jm(n,e,t){!function z4(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ed)&&(i=t[Ed]),null==i&&(i=t[Ed]=V4++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function WE(n,e,t){if(t&Ct.Optional)return n;bm()}function XE(n,e,t,i){if(t&Ct.Optional&&void 0===i&&(i=null),0==(t&(Ct.Self|Ct.Host))){const r=n[9],s=To(void 0);try{return r?r.get(e,i,t&Ct.Optional):mE(e,i,t&Ct.Optional)}finally{To(s)}}return WE(i,0,t)}function qE(n,e,t,i=Ct.Default,r){if(null!==n){if(1024&e[2]){const o=function q4(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=ZE(s,o,t,i|Ct.Self,Eo);if(a!==Eo)return a;let l=s.parent;if(!l){const c=o[21];if(c){const u=c.get(t,Eo,i);if(u!==Eo)return u}l=QE(o),o=o[15]}s=l}return r}(n,e,t,i,Eo);if(o!==Eo)return o}const s=ZE(n,e,t,i,Eo);if(s!==Eo)return s}return XE(e,t,i,r)}function ZE(n,e,t,i,r){const s=function W4(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ed)?n[Ed]:void 0;return"number"==typeof e?e>=0?255&e:X4:e}(t);if("function"==typeof s){if(!FE(e,n,i))return i&Ct.Host?WE(r,0,i):XE(e,t,i,r);try{const o=s(i);if(null!=o||i&Ct.Optional)return o;bm()}finally{BE()}}else if("number"==typeof s){let o=null,a=ib(n,e),l=-1,c=i&Ct.Host?e[16][6]:null;for((-1===a||i&Ct.SkipSelf)&&(l=-1===a?Bm(n,e):e[a+8],-1!==l&&KE(i,!1)?(o=e[1],a=gu(l),e=_u(l,e)):a=-1);-1!==a;){const u=e[1];if(YE(s,a,u.data)){const h=G4(a,e,t,o,i,c);if(h!==Eo)return h}l=e[a+8],-1!==l&&KE(i,e[1].data[a+8]===c)&&YE(s,a,e)?(o=u,a=gu(l),e=_u(l,e)):a=-1}}return r}function G4(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Um(a,o,t,null==i?Cm(a)&&tb:i!=o&&0!=(3&a.type),r&Ct.Host&&s===a);return null!==u?kd(e,o,u,a):Eo}function Um(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,d=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<d;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&Gs(f)&&f.type===t)return l}return null}function kd(n,e,t,i){let r=n[t];const s=e.data;if(function O4(n){return n instanceof Id}(r)){const o=r;o.resolving&&function Bz(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new et(-200,`Circular dependency in DI detected for ${n}${t}`)}(function _n(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Nt(n)}(s[t]));const a=Nm(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?To(o.injectImpl):null;FE(n,i,Ct.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function F4(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=wE(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&To(l),Nm(a),o.resolving=!1,BE()}}return r}function YE(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function KE(n,e){return!(n&Ct.Self||n&Ct.Host&&e)}class vu{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return qE(this._tNode,this._lView,e,i,t)}}function X4(){return new vu(Oi(),be())}function pt(n){return Ua(()=>{const e=n.prototype.constructor,t=e[na]||rb(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[na]||rb(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function rb(n){return A0(n)?()=>{const e=rb(Rt(n));return e&&e()}:Xl(n)}function QE(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[6]:null}function ql(n){return function H4(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(UE(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Oi(),n)}const bu="__parameters__";function wu(n,e,t){return Ua(()=>{const i=function sb(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(bu)?l[bu]:Object.defineProperty(l,bu,{value:[]})[bu];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class He{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Y4=new He("AnalyzeForEntryComponents");function Yr(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Yr(i,e)):e!==n&&e.push(i)}return e}function sa(n,e){n.forEach(t=>Array.isArray(t)?sa(t,e):e(t))}function JE(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Vm(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Bd(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Kr(n,e,t){let i=Mu(n,e);return i>=0?n[1|i]=t:(i=~i,function $4(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function ab(n,e){const t=Mu(n,e);if(t>=0)return n[1|t]}function Mu(n,e){return function nD(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const jd={},cb="__NG_DI_FLAG__",Hm="ngTempTokenPath",oH=/\n/gm,iD="__source";let Ud;function Gm(n){const e=Ud;return Ud=n,e}function lH(n,e=Ct.Default){if(void 0===Ud)throw new et(-203,"");return null===Ud?mE(n,void 0,e):Ud.get(n,e&Ct.Optional?null:void 0,e)}function re(n,e=Ct.Default){return(function Xz(){return I0}()||lH)(Rt(n),e)}function Zl(n,e=Ct.Default){return re(n,e)}function ub(n){const e=[];for(let t=0;t<n.length;t++){const i=Rt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new et(900,"");let r,s=Ct.Default;for(let o=0;o<i.length;o++){const a=i[o],l=cH(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(re(r,s))}else e.push(re(i))}return e}function Vd(n,e){return n[cb]=e,n.prototype[cb]=e,n}function cH(n){return n[cb]}const Wm=Vd(wu("Inject",n=>({token:n})),-1),ms=Vd(wu("Optional"),8),Su=Vd(wu("SkipSelf"),4);let Zm;function Cu(n){return function hb(){if(void 0===Zm&&(Zm=null,Rn.trustedTypes))try{Zm=Rn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Zm}()?.createHTML(n)||n}class Yl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class MH extends Yl{getTypeName(){return"HTML"}}class SH extends Yl{getTypeName(){return"Style"}}class TH extends Yl{getTypeName(){return"Script"}}class CH extends Yl{getTypeName(){return"URL"}}class EH extends Yl{getTypeName(){return"ResourceURL"}}function Qr(n){return n instanceof Yl?n.changingThisBreaksApplicationSecurity:n}function Do(n,e){const t=mD(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function mD(n){return n instanceof Yl&&n.getTypeName()||null}class LH{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Cu(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class FH{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const i=this.inertDocument.createElement("body");t.appendChild(i)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Cu(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=Cu(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const OH=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,NH=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Gd(n){return(n=String(n)).match(OH)||n.match(NH)?n:"unsafe:"+n}function _D(n){return(n=String(n)).split(",").map(e=>Gd(e.trim())).join(", ")}function Ao(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function Wd(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const vD=Ao("area,br,col,hr,img,wbr"),yD=Ao("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),bD=Ao("rp,rt"),fb=Wd(vD,Wd(yD,Ao("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Wd(bD,Ao("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Wd(bD,yD)),pb=Ao("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),mb=Ao("srcset"),xD=Wd(pb,mb,Ao("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ao("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),BH=Ao("script,style,template");class jH{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!fb.hasOwnProperty(t))return this.sanitizedSomething=!0,!BH.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!xD.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;pb[a]&&(l=Gd(l)),mb[a]&&(l=_D(l)),this.buf.push(" ",o,'="',wD(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();fb.hasOwnProperty(t)&&!vD.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(wD(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const UH=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,VH=/([^\#-~ |!])/g;function wD(n){return n.replace(/&/g,"&amp;").replace(UH,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(VH,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Km;function MD(n,e){let t=null;try{Km=Km||function gD(n){const e=new FH(n);return function kH(){try{return!!(new window.DOMParser).parseFromString(Cu(""),"text/html")}catch{return!1}}()?new LH(e):e}(n);let i=e?String(e):"";t=Km.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=Km.getInertBodyElement(i)}while(i!==s);return Cu((new jH).sanitizeChildren(gb(t)||t))}finally{if(t){const i=gb(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function gb(n){return"content"in n&&function zH(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var fn=(()=>((fn=fn||{})[fn.NONE=0]="NONE",fn[fn.HTML=1]="HTML",fn[fn.STYLE=2]="STYLE",fn[fn.SCRIPT=3]="SCRIPT",fn[fn.URL=4]="URL",fn[fn.RESOURCE_URL=5]="RESOURCE_URL",fn))();function _b(n){const e=function Xd(){const n=be();return n&&n[12]}();return e?e.sanitize(fn.URL,n)||"":Do(n,"URL")?Qr(n):Gd(Nt(n))}function yb(n){return n.ngOriginalError}class oa{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&yb(e);for(;t&&yb(t);)t=yb(t);return t||null}}const bb=new Map;let s5=0;const wb="__ngContext__";function ur(n,e){Nr(e)?(n[wb]=e[20],function a5(n){bb.set(n[20],n)}(e)):n[wb]=e}function qd(n){const e=n[wb];return"number"==typeof e?function CD(n){return bb.get(n)||null}(e):e||null}function Mb(n){const e=qd(n);return e?Nr(e)?e:e.lView:null}const g5=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(Rn))();function Sb(n){return n.ownerDocument.defaultView}function Qm(n){return n.ownerDocument}function aa(n){return n instanceof Function?n():n}var $r=(()=>(($r=$r||{})[$r.Important=1]="Important",$r[$r.DashCase=2]="DashCase",$r))();function Cb(n,e){return undefined(n,e)}function Zd(n){const e=n[3];return Hs(e)?e[3]:e}function Eb(n){return kD(n[13])}function Db(n){return kD(n[4])}function kD(n){for(;null!==n&&!Hs(n);)n=n[4];return n}function Du(n,e,t,i,r){if(null!=i){let s,o=!1;Hs(i)?s=i:Nr(i)&&(o=!0,i=i[0]);const a=Ci(i);0===n&&null!==t?null==r?VD(e,t,a):Kl(e,t,a,r||null,!0):1===n&&null!==t?Kl(e,t,a,r||null,!0):2===n?function YD(n,e,t){const i=$m(n,e);i&&function A5(n,e,t,i){hi(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function I5(n,e,t,i,r){const s=t[7];s!==Ci(t)&&Du(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Yd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function Rb(n,e,t){if(hi(n))return n.createElement(e,t);{const i=null!==t?function h4(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===i?n.createElement(e):n.createElementNS(i,e)}}function ND(n,e){const t=n[9],i=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,X0(r,-1)),t.splice(i,1)}function Pb(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&ND(r,i),e>0&&(n[t-1][4]=i[4]);const s=Vm(n,10+e);!function x5(n,e){Yd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-65}return i}function BD(n,e){if(!(128&e[2])){const t=e[11];hi(t)&&t.destroyNode&&Yd(n,e,t,3,null,null),function S5(n){let e=n[13];if(!e)return Ib(n[1],n);for(;e;){let t=null;if(Nr(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Nr(e)&&Ib(e[1],e),e=e[3];null===e&&(e=n),Nr(e)&&Ib(e[1],e),t=e&&e[4]}e=t}}(e)}}function Ib(n,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function D5(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Id)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function E5(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):Ci(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&hi(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Hs(e[3])){t!==e[3]&&ND(t,e);const i=e[19];null!==i&&i.detachView(n)}!function l5(n){bb.delete(n[20])}(e)}}function jD(n,e,t){return function UD(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Vs.None||r===Vs.Emulated)return null}return ps(i,t)}(n,e.parent,t)}function Kl(n,e,t,i,r){hi(n)?n.insertBefore(e,t,i,r):(HD(e)?e.content:e).insertBefore(t,i,r)}function VD(n,e,t){hi(n)?n.appendChild(e,t):(HD(e)?e.content:e).appendChild(t)}function zD(n,e,t,i,r){null!==i?Kl(n,e,t,i,r):VD(n,e,t)}function HD(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}function $m(n,e){return hi(n)?n.parentNode(e):e.parentNode}function GD(n,e,t){return XD(n,e,t)}let XD=function WD(n,e,t){return 40&n.type?ps(n,t):null};function Jm(n,e,t,i){const r=jD(n,i,e),s=e[11],a=GD(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)zD(s,r,t[l],a,!1);else zD(s,r,t,a,!1)}function eg(n,e){if(null!==e){const t=e.type;if(3&t)return ps(e,n);if(4&t)return Fb(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return eg(n,i);{const r=n[e.index];return Hs(r)?Fb(-1,r):Ci(r)}}if(32&t)return Cb(e,n)()||Ci(n[e.index]);{const i=ZD(n,e);return null!==i?Array.isArray(i)?i[0]:eg(Zd(n[16]),i):eg(n,e.next)}}return null}function ZD(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Fb(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return eg(i,r)}return e[7]}function kb(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&ur(Ci(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)kb(n,e,t.child,i,r,s,!1),Du(e,n,r,a,s);else if(32&l){const c=Cb(t,i);let u;for(;u=c();)Du(e,n,r,u,s);Du(e,n,r,a,s)}else 16&l?KD(n,e,i,t,r,s):Du(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Yd(n,e,t,i,r,s){kb(t,i,n.firstChild,e,r,s,!1)}function KD(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Du(e,n,r,l[c],s);else kb(n,e,l,o[3],r,s,!0)}function QD(n,e,t){hi(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function Ob(n,e,t){hi(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function $D(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const JD="ng-template";function F5(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==$D(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function eA(n){return 4===n.type&&n.value!==JD}function k5(n,e,t){return e===(4!==n.type||t?n.value:JD)}function O5(n,e,t){let i=4;const r=n.attrs||[],s=function j5(n){for(let e=0;e<n.length;e++)if(UE(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!k5(n,l,t)||""===l&&1===e.length){if(Ws(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!F5(n.attrs,c,t)){if(Ws(i))return!1;o=!0}continue}const h=N5(8&i?"class":l,r,eA(n),t);if(-1===h){if(Ws(i))return!1;o=!0;continue}if(""!==c){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&i?d:null;if(f&&-1!==$D(f,c,0)||2&i&&c!==d){if(Ws(i))return!1;o=!0}}}}else{if(!o&&!Ws(i)&&!Ws(l))return!1;if(o&&Ws(l))continue;o=!1,i=l|1&i}}return Ws(i)||o}function Ws(n){return 0==(1&n)}function N5(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function U5(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function tA(n,e,t=!1){for(let i=0;i<e.length;i++)if(O5(n,e[i],t))return!0;return!1}function V5(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function nA(n,e){return n?":not("+e.trim()+")":e}function z5(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ws(o)&&(e+=nA(s,r),r=""),i=o,s=s||!Ws(i);t++}return""!==r&&(e+=nA(s,r)),e}const Bt={};function se(n){iA(hn(),be(),Mr()+n,!1)}function iA(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&Lm(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Fm(e,s,0,t)}za(t)}const aA=new He("ENVIRONMENT_INITIALIZER"),lA=new He("INJECTOR_DEF_TYPES");function K5(...n){return{\u0275providers:cA(0,n)}}function cA(n,...e){const t=[],i=new Set;let r;return sa(e,s=>{const o=s;Nb(o,t,[],i)&&(r||(r=[]),r.push(o))}),void 0!==r&&uA(r,t),t}function uA(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];sa(r,s=>{e.push(s)})}}function Nb(n,e,t,i){if(!(n=Rt(n)))return!1;let r=null,s=fE(n);const o=!s&&On(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=fE(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Nb(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{sa(s.imports,u=>{Nb(u,e,t,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&uA(c,e)}if(!a){const c=Xl(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:vn},{provide:lA,useValue:r,multi:!0},{provide:aA,useValue:()=>re(r),multi:!0})}const l=s.providers;null==l||a||sa(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}const Q5=Fn({provide:String,useValue:Fn});function Bb(n){return null!==n&&"object"==typeof n&&Q5 in n}function Ql(n){return"function"==typeof n}const jb=new He("INJECTOR",-1);class fA{get(e,t=jd){if(t===jd){const i=new Error(`NullInjectorError: No provider for ${kn(e)}!`);throw i.name="NullInjectorError",i}return t}}const Ub=new He("Set Injector scope."),tg={},J5={};let Vb;function zb(){return void 0===Vb&&(Vb=new fA),Vb}class $l{}class pA extends $l{constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Gb(e,o=>this.processProvider(o)),this.records.set(jb,Au(void 0,this)),r.has("environment")&&this.records.set($l,Au(void 0,this));const s=this.records.get(Ub);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(lA.multi,vn,Ct.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}get(e,t=jd,i=Ct.Default){this.assertNotDestroyed();const r=Gm(this),s=To(void 0);try{if(!(i&Ct.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function rG(n){return"function"==typeof n||"object"==typeof n&&n instanceof He}(e)&&R0(e);a=l&&this.injectableDefInScope(l)?Au(Hb(e),tg):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&Ct.Self?zb():this.parent).get(e,t=i&Ct.Optional&&t===jd?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Hm]=o[Hm]||[]).unshift(kn(e)),r)throw o;return function uH(n,e,t,i){const r=n[Hm];throw e[iD]&&r.unshift(e[iD]),n.message=function hH(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=kn(e);if(Array.isArray(e))r=e.map(kn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):kn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(oH,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Hm]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{To(s),Gm(r)}}resolveInjectorInitializers(){const e=Gm(this),t=To(void 0);try{const i=this.get(aA.multi,vn,Ct.Self);for(const r of i)r()}finally{Gm(e),To(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(kn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new et(205,!1)}processProvider(e){let t=Ql(e=Rt(e))?e:Rt(e&&e.provide);const i=function tG(n){return Bb(n)?Au(void 0,n.useValue):Au(mA(n),tg)}(e);if(Ql(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Au(void 0,tg,!0),r.factory=()=>ub(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===tg&&(t.value=J5,t.value=t.factory()),"object"==typeof t.value&&t.value&&function iG(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Rt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Hb(n){const e=R0(n),t=null!==e?e.factory:Xl(n);if(null!==t)return t;if(n instanceof He)throw new et(204,!1);if(n instanceof Function)return function eG(n){const e=n.length;if(e>0)throw Bd(e,"?"),new et(204,!1);const t=function Hz(n){const e=n&&(n[xm]||n[pE]);if(e){const t=function Gz(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new et(204,!1)}function mA(n,e,t){let i;if(Ql(n)){const r=Rt(n);return Xl(r)||Hb(r)}if(Bb(n))i=()=>Rt(n.useValue);else if(function dA(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...ub(n.deps||[]));else if(function hA(n){return!(!n||!n.useExisting)}(n))i=()=>re(Rt(n.useExisting));else{const r=Rt(n&&(n.useClass||n.provide));if(!function nG(n){return!!n.deps}(n))return Xl(r)||Hb(r);i=()=>new r(...ub(n.deps))}return i}function Au(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function sG(n){return!!n.\u0275providers}function Gb(n,e){for(const t of n)Array.isArray(t)?Gb(t,e):sG(t)?Gb(t.\u0275providers,e):e(t)}function gA(n,e=null,t=null,i){const r=_A(n,e,t,i);return r.resolveInjectorInitializers(),r}function _A(n,e=null,t=null,i,r=new Set){const s=[t||vn,K5(n)];return i=i||("object"==typeof n?void 0:kn(n)),new pA(s,e||zb(),i||null,r)}let Xi=(()=>{class n{static create(t,i){if(Array.isArray(t))return gA({name:""},i,t,"");{const r=t.name??"";return gA({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=jd,n.NULL=new fA,n.\u0275prov=We({token:n,providedIn:"any",factory:()=>re(jb)}),n.__NG_ELEMENT_ID__=-1,n})();function N(n,e=Ct.Default){const t=be();return null===t?re(n,e):qE(Oi(),t,Rt(n),e)}function ig(){throw new Error("invalid")}function rg(n,e){return n<<17|e<<2}function Xs(n){return n>>17&32767}function $b(n){return 2|n}function la(n){return(131068&n)>>2}function Jb(n,e){return-131069&n|e<<2}function ex(n){return 1|n}function NA(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];Q0(r),o.contentQueries(2,e[s],s)}}}function Kd(n,e,t,i,r,s,o,a,l,c,u){const h=e.blueprint.slice();return h[0]=r,h[2]=76|i,(null!==u||n&&1024&n[2])&&(h[2]|=1024),EE(h),h[3]=h[15]=n,h[8]=t,h[10]=o||n&&n[10],h[11]=a||n&&n[11],h[12]=l||n&&n[12]||null,h[9]=c||n&&n[9]||null,h[6]=s,h[20]=function o5(){return s5++}(),h[21]=u,h[16]=2==e.type?n[16]:h,h}function Pu(n,e,t,i,r){let s=n.data[e];if(null===s)s=function cx(n,e,t,i,r){const s=RE(),o=q0(),l=n.data[e]=function NG(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),function M4(){return kt.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Pd(){const n=kt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Co(s,!0),s}function Iu(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Qd(n,e,t){Rm(e);try{const i=n.viewQuery;null!==i&&vx(1,i,t);const r=n.template;null!==r&&BA(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&NA(n,e),n.staticViewQueries&&vx(2,n.viewQuery,t);const s=n.components;null!==s&&function FG(n,e){for(let t=0;t<e.length;t++)t8(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,Pm()}}function Lu(n,e,t,i){const r=e[2];if(128!=(128&r)){Rm(e);try{EE(e),function PE(n){return kt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&BA(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&Lm(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Fm(e,c,0,null),$0(e,0)}if(function JG(n){for(let e=Eb(n);null!==e;e=Db(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(512&r[2])&&X0(s,1),r[2]|=512}}}(e),function $G(n){for(let e=Eb(n);null!==e;e=Db(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];W0(i)&&Lu(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&NA(n,e),o){const c=n.contentCheckHooks;null!==c&&Lm(e,c)}else{const c=n.contentHooks;null!==c&&Fm(e,c,1),$0(e,1)}!function IG(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)za(~r);else{const s=r,o=t[++i],a=t[++i];S4(o,s),a(2,e[s])}}}finally{za(-1)}}(n,e);const a=n.components;null!==a&&function LG(n,e){for(let t=0;t<e.length;t++)e8(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&vx(2,l,i),o){const c=n.viewCheckHooks;null!==c&&Lm(e,c)}else{const c=n.viewHooks;null!==c&&Fm(e,c,2),$0(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,X0(e[3],-1))}finally{Pm()}}}function kG(n,e,t,i){const r=e[10],o=CE(e);try{!o&&r.begin&&r.begin(),o&&Qd(n,e,i),Lu(n,e,t,i)}finally{!o&&r.end&&r.end()}}function BA(n,e,t,i,r){const s=Mr(),o=2&i;try{za(-1),o&&e.length>22&&iA(n,e,22,!1),t(i,r)}finally{za(s)}}function jA(n,e,t){if(N0(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function ux(n,e,t){!AE()||(function GG(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||Fd(t,e),ur(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Gs(l);c&&YG(e,t,l);const u=kd(e,n,a,t);ur(u,e),null!==o&&KG(0,a-r,u,l,0,o),c&&(Zr(t.index,e)[8]=u)}}(n,e,t,ps(t,e)),128==(128&t.flags)&&function WG(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function T4(){return kt.lFrame.currentDirectiveIndex}();try{za(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Y0(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&XA(l,c)}}finally{za(-1),Y0(o)}}(n,e,t))}function hx(n,e,t=ps){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function UA(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=ag(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function ag(n,e,t,i,r,s,o,a,l,c){const u=22+i,h=u+r,d=function OG(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Bt);return t}(u,h),f="function"==typeof c?c():c;return d[1]={type:n,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function HA(n,e,t,i){const r=$A(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&JA(n).push(i,r.length-1))}function GA(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Jr(n,e,t,i,r,s,o,a){const l=ps(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(nR(n,t,u,i,r),Cm(e)&&function UG(n,e){const t=Zr(e,n);16&t[2]||(t[2]|=32)}(t,e.index)):3&e.type&&(i=function jG(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,hi(s)?s.setProperty(l,i,r):eb(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function dx(n,e,t,i){let r=!1;if(AE()){const s=function XG(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];tA(t,o.selectors,!1)&&(r||(r=[]),jm(Fd(t,e),n,o.type),Gs(o)?(qA(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,ZA(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Iu(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Om(t.mergedAttrs,h.hostAttrs),YA(n,t,e,c,h),ZG(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const d=h.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function BG(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,d=null===s||eA(e)?null:QG(h,s);o.push(d),a=GA(h,c,a),l=GA(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function qG(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new et(-301,!1);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Om(t.mergedAttrs,t.attrs),r}function WA(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function HG(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function XA(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function qA(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function ZG(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Gs(e)&&(t[""]=n)}}function ZA(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function YA(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Xl(r.type)),o=new Id(s,Gs(r),N);n.blueprint[i]=o,t[i]=o,WA(n,e,0,i,Iu(n,t,r.hostVars,Bt),r)}function YG(n,e,t){const i=ps(e,n),r=UA(t),s=n[10],o=lg(n,Kd(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=o}function Ro(n,e,t,i,r,s){const o=ps(n,e);!function fx(n,e,t,i,r,s,o){if(null==s)hi(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Nt(s):o(s,i||"",r);hi(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function KG(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function QG(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function KA(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function e8(n,e){const t=Zr(e,n);if(W0(t)){const i=t[1];48&t[2]?Lu(i,t,i.template,t[8]):t[5]>0&&px(t)}}function px(n){for(let i=Eb(n);null!==i;i=Db(i))for(let r=10;r<i.length;r++){const s=i[r];if(512&s[2]){const o=s[1];Lu(o,s,o.template,s[8])}else s[5]>0&&px(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Zr(t[i],n);W0(r)&&r[5]>0&&px(r)}}function t8(n,e){const t=Zr(e,n),i=t[1];(function n8(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),Qd(i,t,t[8])}function lg(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function mx(n){for(;n;){n[2]|=32;const e=Zd(n);if(e4(n)&&!e)return n;n=e}return null}function QA(n){!function gx(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=Mb(t);if(null!==i){const r=i[1];kG(r,i,r.template,t)}}}(n[8])}function vx(n,e,t){Q0(0),e(n,t)}const s8=(()=>Promise.resolve(null))();function $A(n){return n[7]||(n[7]=[])}function JA(n){return n.cleanup||(n.cleanup=[])}function eR(n,e,t){return(null===n||Gs(n))&&(t=function p4(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(t[e.index])),t[11]}function tR(n,e){const t=n[9],i=t?t.get(oa,null):null;i&&i.handleError(e)}function nR(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function ca(n,e,t){const i=Dm(e,n);!function OD(n,e,t){hi(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function cg(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=D0(r,a):2==s&&(i=D0(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function g8(){const n=Oi();Im(be()[1],n)}function Se(n){let e=function pR(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Gs(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new et(903,"");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=bx(n.inputs),o.declaredInputs=bx(n.declaredInputs),o.outputs=bx(n.outputs);const a=r.hostBindings;a&&b8(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&v8(n,l),c&&y8(n,c),E0(n.inputs,r.inputs),E0(n.declaredInputs,r.declaredInputs),E0(n.outputs,r.outputs),Gs(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Se&&(t=!1)}}e=Object.getPrototypeOf(e)}!function _8(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Om(r.hostAttrs,t=Om(t,r.hostAttrs))}}(i)}function bx(n){return n===cu?{}:n===vn?[]:n}function v8(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function y8(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function b8(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let ug=null;function Jl(){if(!ug){const n=Rn.Symbol;if(n&&n.iterator)ug=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(ug=i)}}}return ug}function $d(n){return!!xx(n)&&(Array.isArray(n)||!(n instanceof Map)&&Jl()in n)}function xx(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Po(n,e,t){return n[e]=t}function hr(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function ec(n,e,t,i){const r=hr(n,e,t);return hr(n,e+1,i)||r}function yi(n,e,t,i){const r=be();return hr(r,mu(),e)&&(hn(),Ro(di(),r,n,e,t,i)),yi}function Sn(n,e,t,i,r,s,o,a){const l=be(),c=hn(),u=n+22,h=c.firstCreatePass?function E8(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Pu(e,n,4,o||null,Va(c,a));dx(e,t,u,Va(c,l)),Im(e,u);const h=u.tViews=ag(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Co(h,!1);const d=l[11].createComment("");Jm(c,l,d,h),ur(d,l),lg(l,l[u]=KA(d,l,d,h)),Em(h)&&ux(c,l,h),null!=o&&hx(l,h,a)}function yn(n){return pu(function w4(){return kt.lFrame.contextLView}(),22+n)}function Q(n,e,t){const i=be();return hr(i,mu(),e)&&Jr(hn(),di(),i,n,e,i[11],t,!1),Q}function wx(n,e,t,i,r){const o=r?"class":"style";nR(n,t,e.inputs[o],o,i)}function pe(n,e,t,i){const r=be(),s=hn(),o=22+n,a=r[11],l=r[o]=Rb(a,e,function L4(){return kt.lFrame.currentNamespace}()),c=s.firstCreatePass?function A8(n,e,t,i,r,s,o){const a=e.consts,c=Pu(e,n,2,r,Va(a,s));return dx(e,t,c,Va(a,o)),null!==c.attrs&&cg(c,c.attrs,!1),null!==c.mergedAttrs&&cg(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Co(c,!0);const u=c.mergedAttrs;null!==u&&km(a,l,u);const h=c.classes;null!==h&&Ob(a,l,h);const d=c.styles;return null!==d&&QD(a,l,d),64!=(64&c.flags)&&Jm(s,r,l,c),0===function _4(){return kt.lFrame.elementDepthCount}()&&ur(l,r),function v4(){kt.lFrame.elementDepthCount++}(),Em(c)&&(ux(s,r,c),jA(s,c,r)),null!==i&&hx(r,c),pe}function Te(){let n=Oi();q0()?Z0():(n=n.parent,Co(n,!1));const e=n;!function y4(){kt.lFrame.elementDepthCount--}();const t=hn();return t.firstCreatePass&&(Im(t,n),N0(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function B4(n){return 0!=(16&n.flags)}(e)&&wx(t,e,be(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function j4(n){return 0!=(32&n.flags)}(e)&&wx(t,e,be(),e.stylesWithoutHost,!1),Te}function Ye(n,e,t,i){return pe(n,e,t,i),Te(),Ye}function Mx(n,e,t){const i=be(),r=hn(),s=n+22,o=r.firstCreatePass?function R8(n,e,t,i,r){const s=e.consts,o=Va(s,i),a=Pu(e,n,8,"ng-container",o);return null!==o&&cg(a,o,!0),dx(e,t,a,Va(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Co(o,!0);const a=i[s]=i[11].createComment("");return Jm(r,i,a,o),ur(a,i),Em(o)&&(ux(r,i,o),jA(r,o,i)),null!=t&&hx(i,o),Mx}function Sx(){let n=Oi();const e=hn();return q0()?Z0():(n=n.parent,Co(n,!1)),e.firstCreatePass&&(Im(e,n),N0(n)&&e.queries.elementEnd(n)),Sx}function Tx(n,e,t){return Mx(n,e,t),Sx(),Tx}function Io(){return be()}function ef(n){return!!n&&"function"==typeof n.then}function SR(n){return!!n&&"function"==typeof n.subscribe}const Cx=SR;function gt(n,e,t,i){const r=be(),s=hn(),o=Oi();return TR(s,r,r[11],o,n,e,!!t,i),gt}function Ex(n,e){const t=Oi(),i=be(),r=hn();return TR(r,i,eR(K0(r.data),t,i),t,n,e,!1),Ex}function TR(n,e,t,i,r,s,o,a){const l=Em(i),u=n.firstCreatePass&&JA(n),h=e[8],d=$A(e);let f=!0;if(3&i.type||a){const g=ps(i,e),_=a?a(g):g,v=d.length,y=a?b=>a(Ci(b[i.index])):i.index;if(hi(t)){let b=null;if(!a&&l&&(b=function P8(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,f=!1;else{s=Dx(i,e,h,s,!1);const w=t.listen(_,r,s);d.push(s,w),u&&u.push(r,y,v,v+1)}}else s=Dx(i,e,h,s,!0),_.addEventListener(r,s,o),d.push(s),u&&u.push(r,y,v,o)}else s=Dx(i,e,h,s,!1);const p=i.outputs;let m;if(f&&null!==p&&(m=p[r])){const g=m.length;if(g)for(let _=0;_<g;_+=2){const M=e[m[_]][m[_+1]].subscribe(s),T=d.length;d.push(s,M),u&&u.push(r,i.index,T,-(T+1))}}}function CR(n,e,t,i){try{return!1!==t(i)}catch(r){return tR(n,r),!1}}function Dx(n,e,t,i,r){return function s(o){if(o===Function)return i;mx(2&n.flags?Zr(n.index,e):e);let l=CR(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=CR(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function ii(n=1){return function E4(n){return(kt.lFrame.contextLView=function D4(n,e){for(;n>0;)e=e[15],n--;return e}(n,kt.lFrame.contextLView))[8]}(n)}function I8(n,e){let t=null;const i=function B5(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?tA(n,s,!0):V5(i,s))return r}else t=r}return t}function Ji(n){const e=be()[16][6];if(!e.projection){const i=e.projection=Bd(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?I8(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function Hn(n,e=0,t){const i=be(),r=hn(),s=Pu(r,22+n,16,null,t||null);null===s.projection&&(s.projection=e),Z0(),64!=(64&s.flags)&&function P5(n,e,t){KD(e[11],0,e,t,jD(n,t,e),GD(t.parent||e[6],t,e))}(r,i,s)}function OR(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Xs(s):la(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];k8(n[a],e)&&(l=!0,n[a+1]=i?ex(u):$b(u)),a=i?Xs(u):la(u)}l&&(n[t+1]=i?$b(s):ex(s))}function k8(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Mu(n,e)>=0}function tf(n,e,t){return Zs(n,e,t,!1),tf}function pn(n,e){return Zs(n,e,null,!0),pn}function Zs(n,e,t,i){const r=be(),s=hn(),o=function ra(n){const e=kt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function GR(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Mr()],o=function HR(n,e){return e>=n.expandoStartIndex}(n,t);(function ZR(n,e){return 0!=(n.flags&(e?16:32))})(s,i)&&null===e&&!o&&(e=!1),e=function G8(n,e,t,i){const r=K0(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=nf(t=Rx(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=Rx(r,n,e,t,i),null===s){let l=function W8(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==la(i))return n[Xs(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=Rx(null,n,e,l[1],i),l=nf(l,e.attrs,i),function X8(n,e,t,i){n[Xs(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function q8(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=nf(i,n[s].hostAttrs,t);return nf(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function L8(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Xs(o),l=la(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Mu(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const d=Xs(n[a+1]);n[i+1]=rg(d,a),0!==d&&(n[d+1]=Jb(n[d+1],i)),n[a+1]=function wG(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=rg(a,0),0!==a&&(n[a+1]=Jb(n[a+1],i)),a=i;else n[i+1]=rg(l,0),0===a?a=i:n[l+1]=Jb(n[l+1],i),l=i;c&&(n[i+1]=$b(n[i+1])),OR(n,u,i,!0),OR(n,u,i,!1),function F8(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Mu(s,e)>=0&&(t[i+1]=ex(t[i+1]))}(e,u,n,i,s),o=rg(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==Bt&&hr(r,o,e)&&function XR(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];dg(function AA(n){return 1==(1&n)}(c)?qR(l,e,t,r,la(c),o):void 0)||(dg(s)||function DA(n){return 2==(2&n)}(c)&&(s=qR(l,null,t,r,a,o)),function L5(n,e,t,i,r){const s=hi(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:$r.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=$r.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Dm(Mr(),t),r,s))}(s,s.data[Mr()],r,r[11],n,r[o+1]=function K8(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=kn(Qr(n)))),n}(e,t),i,o)}function Rx(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=nf(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function nf(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Kr(n,o,!!t||e[++s]))}return void 0===n?null:n}function qR(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let d=t[r+1];d===Bt&&(d=h?vn:void 0);let f=h?ab(d,i):u===i?d:void 0;if(c&&!dg(f)&&(f=ab(l,i)),dg(f)&&(a=f,o))return a;const p=n[r+1];r=o?Xs(p):la(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=ab(l,i))}return a}function dg(n){return void 0!==n}function Cn(n,e=""){const t=be(),i=hn(),r=n+22,s=i.firstCreatePass?Pu(i,r,1,e,null):i.data[r],o=t[r]=function Ab(n,e){return hi(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Jm(i,t,o,s),Co(s,!1)}function rf(n){return fg("",n,""),rf}function fg(n,e,t){const i=be(),r=function ku(n,e,t,i){return hr(n,mu(),t)?e+Nt(t)+i:Bt}(i,n,e,t);return r!==Bt&&ca(i,Mr(),r),fg}function Ix(n,e,t){const i=be();if(hr(i,mu(),e)){const s=hn(),o=di();Jr(s,o,i,n,e,eR(K0(s.data),o,i),t,!0)}return Ix}const Wu="en-US";let pP=Wu;function kx(n,e,t,i,r){if(n=Rt(n),Array.isArray(n))for(let s=0;s<n.length;s++)kx(n[s],e,t,i,r);else{const s=hn(),o=be();let a=Ql(n)?n:Rt(n.provide),l=mA(n);const c=Oi(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(Ql(n)||!n.multi){const f=new Id(l,r,N),p=Nx(a,e,r?u:u+d,h);-1===p?(jm(Fd(c,o),s,a),Ox(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=Nx(a,e,u+d,h),p=Nx(a,e,u,u+d),m=f>=0&&t[f],g=p>=0&&t[p];if(r&&!g||!r&&!m){jm(Fd(c,o),s,a);const _=function pW(n,e,t,i,r){const s=new Id(n,t,N);return s.multi=[],s.index=e,s.componentProviders=0,jP(s,r,i&&!t),s}(r?fW:dW,t.length,r,i,l);!r&&g&&(t[p].providerFactory=_),Ox(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(_),o.push(_)}else Ox(s,n,f>-1?f:p,jP(t[r?p:f],l,!r&&i));!r&&i&&g&&t[p].componentProviders++}}}function Ox(n,e,t,i){const r=Ql(e),s=function $5(n){return!!n.useClass}(e);if(r||s){const l=(s?Rt(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function jP(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Nx(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function dW(n,e,t,i){return Bx(this.multi,[])}function fW(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=kd(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),Bx(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Bx(r,s);return s}function Bx(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Xe(n,e=[]){return t=>{t.providersResolver=(i,r)=>function hW(n,e,t){const i=hn();if(i.firstCreatePass){const r=Gs(n);kx(t,i.data,i.blueprint,r,!0),kx(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class gW{resolveComponentFactory(e){throw function mW(n){const e=Error(`No component factory found for ${kn(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let Xa=(()=>{class n{}return n.NULL=new gW,n})();class qa{}class VP{}class zP{}function vW(){return qu(Oi(),be())}function qu(n,e){return new qt(ps(n,e))}let qt=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=vW,n})();function yW(n){return n instanceof qt?n.nativeElement:n}class uf{}let ua=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function xW(){const n=be(),t=Zr(Oi().index,n);return function bW(n){return n[11]}(Nr(t)?t:n)}(),n})(),wW=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class nc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const MW=new nc("14.0.2"),jx={};function vg(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Ci(s)),Hs(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&vg(l[1],l,c,i)}const o=t.type;if(8&o)vg(n,e,t.child,i);else if(32&o){const a=Cb(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=ZD(e,t);if(Array.isArray(a))i.push(...a);else{const l=Zd(e[16]);vg(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class hf{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return vg(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Hs(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Pb(e,i),Vm(t,i))}this._attachedToViewContainer=!1}BD(this._lView[1],this._lView)}onDestroy(e){HA(this._lView[1],this._lView,null,e)}markForCheck(){mx(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function _x(n,e,t){const i=e[10];i.begin&&i.begin();try{Lu(n,e,n.template,t)}catch(r){throw tR(e,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new et(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function M5(n,e){Yd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new et(902,"");this._appRef=e}}class SW extends hf{constructor(e){super(e),this._view=e}detectChanges(){QA(this._view)}checkNoChanges(){}get context(){return null}}class Ux extends Xa{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=On(e);return new Vx(t,this.ngModule)}}function HP(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class CW{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){const r=this.injector.get(e,jx,i);return r!==jx||t===jx?r:this.parentInjector.get(e,t,i)}}class Vx extends zP{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function H5(n){return n.map(z5).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return HP(this.componentDef.inputs)}get outputs(){return HP(this.componentDef.outputs)}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof $l?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new CW(e,s):e,a=o.get(uf,TE),l=o.get(wW,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=i?function zA(n,e,t){if(hi(n))return n.selectRootElement(e,t===Vs.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(c,i,this.componentDef.encapsulation):Rb(a.createRenderer(null,this.componentDef),u,function TW(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),d=this.componentDef.onPush?288:272,f=function fR(n,e){return{components:[],scheduler:n||g5,clean:s8,playerHandler:e||null,flags:0}}(),p=ag(0,null,null,1,0,null,null,null,null,null),m=Kd(null,p,f,d,null,null,a,c,l,o,null);let g,_;Rm(m);try{const v=function hR(n,e,t,i,r,s){const o=t[1];t[22]=n;const l=Pu(o,22,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(cg(l,c,!0),null!==n&&(km(r,n,c),null!==l.classes&&Ob(r,n,l.classes),null!==l.styles&&QD(r,n,l.styles)));const u=i.createRenderer(n,e),h=Kd(t,UA(e),null,e.onPush?32:16,t[22],l,i,u,s||null,null,null);return o.firstCreatePass&&(jm(Fd(l,t),o,e.type),qA(o,l),ZA(l,t.length,1)),lg(t,h),t[22]=h}(h,this.componentDef,m,a,c);if(h)if(i)km(c,h,["ng-version",MW.full]);else{const{attrs:y,classes:b}=function G5(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ws(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);y&&km(c,h,y),b&&b.length>0&&Ob(c,h,b.join(" "))}if(_=G0(p,22),void 0!==t){const y=_.projection=[];for(let b=0;b<this.ngContentSelectors.length;b++){const w=t[b];y.push(null!=w?Array.from(w):null)}}g=function dR(n,e,t,i,r){const s=t[1],o=function zG(n,e,t){const i=Oi();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),YA(n,i,e,Iu(n,e,1,null),t));const r=kd(e,n,i.directiveStart,i);ur(r,e);const s=ps(i,e);return s&&ur(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,null!==r)for(const l of r)l(o,e);if(e.contentQueries){const l=Oi();e.contentQueries(1,o,l.directiveStart)}const a=Oi();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(za(a.index),WA(t[1],a,0,a.directiveStart,a.directiveEnd,e),XA(e,o)),o}(v,this.componentDef,m,f,[g8]),Qd(p,m,null)}finally{Pm()}return new DW(this.componentType,g,qu(_,m),m,_)}}class DW extends class _W{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new SW(r),this.componentType=e}get injector(){return new vu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class GP extends qa{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Ux(this);const i=Xr(e);this._bootstrapComponents=aa(i.bootstrap),this._r3Injector=_A(e,t,[{provide:qa,useValue:this},{provide:Xa,useValue:this.componentFactoryResolver}],kn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this.get(e)}get(e,t=Xi.THROW_IF_NOT_FOUND,i=Ct.Default){return e===Xi||e===qa||e===jb?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class zx extends VP{constructor(e){super(),this.moduleType=e}create(e){return new GP(this.moduleType,e)}}class RW extends qa{constructor(e,t,i){super(),this.componentFactoryResolver=new Ux(this),this.instance=null;const r=new pA([...e,{provide:qa,useValue:this},{provide:Xa,useValue:this.componentFactoryResolver}],t||zb(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function yg(n,e=null,t=null){return new RW(n,e,t).injector}function Ee(n,e,t){const i=wr()+n,r=be();return r[i]===Bt?Po(r,i,t?e.call(t):e()):function Jd(n,e){return n[e]}(r,i)}function Tn(n,e,t,i){return WP(be(),wr(),n,e,t,i)}function ic(n,e,t,i,r){return function XP(n,e,t,i,r,s,o){const a=e+t;return ec(n,a,r,s)?Po(n,a+2,o?i.call(o,r,s):i(r,s)):ff(n,a+2)}(be(),wr(),n,e,t,i,r)}function bg(n,e,t,i,r,s){return function qP(n,e,t,i,r,s,o,a){const l=e+t;return function hg(n,e,t,i,r){const s=ec(n,e,t,i);return hr(n,e+2,r)||s}(n,l,r,s,o)?Po(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):ff(n,l+3)}(be(),wr(),n,e,t,i,r,s)}function df(n,e,t,i,r,s,o){return function ZP(n,e,t,i,r,s,o,a,l){const c=e+t;return function gs(n,e,t,i,r,s){const o=ec(n,e,t,i);return ec(n,e+2,r,s)||o}(n,c,r,s,o,a)?Po(n,c+4,l?i.call(l,r,s,o,a):i(r,s,o,a)):ff(n,c+4)}(be(),wr(),n,e,t,i,r,s,o)}function ff(n,e){const t=n[e];return t===Bt?void 0:t}function WP(n,e,t,i,r,s){const o=e+t;return hr(n,o,r)?Po(n,o+1,s?i.call(s,r):i(r)):ff(n,o+1)}function _s(n,e){const t=hn();let i;const r=n+22;t.firstCreatePass?(i=function jW(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Xl(i.type)),o=To(N);try{const a=Nm(!1),l=s();return Nm(a),function D8(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,be(),r,l),l}finally{To(o)}}function vs(n,e,t){const i=n+22,r=be(),s=pu(r,i);return function pf(n,e){return n[1].data[e].pure}(r,i)?WP(r,wr(),e,s.transform,t,s):s.transform(t)}function Hx(n){return e=>{setTimeout(n,void 0,e)}}const yt=class GW extends Ft{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Hx(s),r&&(r=Hx(r)),o&&(o=Hx(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof $n&&e.add(a),a}};function WW(){return this._results[Jl()]()}class rc{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Jl(),i=rc.prototype;i[t]||(i[t]=WW)}get changes(){return this._changes||(this._changes=new yt)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Yr(e);(this._changesDetected=!function K4(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ks=(()=>{class n{}return n.__NG_ELEMENT_ID__=ZW,n})();const XW=Ks,qW=class extends XW{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tViews,r=Kd(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(i)),Qd(i,r,e),new hf(r)}};function ZW(){return xg(Oi(),be())}function xg(n,e){return 4&n.type?new qW(e,n,qu(n,e)):null}let Ur=(()=>{class n{}return n.__NG_ELEMENT_ID__=YW,n})();function YW(){return $P(Oi(),be())}const KW=Ur,KP=class extends KW{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return qu(this._hostTNode,this._hostLView)}get injector(){return new vu(this._hostTNode,this._hostLView)}get parentInjector(){const e=Bm(this._hostTNode,this._hostLView);if(zE(e)){const t=_u(e,this._hostLView),i=gu(e);return new vu(t[1].data[i+8],t)}return new vu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=QP(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,i,r,s){const o=e&&!function Nd(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const h=t||{};a=h.index,i=h.injector,r=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}const l=o?e:new Vx(On(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const d=(o?c:this.parentInjector).get($l,null);d&&(s=d)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[1];if(function g4(n){return Hs(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],d=new KP(h,h[6],h[3]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function T5(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],JE(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function C5(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=64}(r,i,o,s);const a=Fb(s,o),l=i[11],c=$m(l,o[7]);return null!==c&&function w5(n,e,t,i,r,s){i[0]=r,i[6]=e,Yd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),JE(Gx(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=QP(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Pb(this._lContainer,t);i&&(Vm(Gx(this._lContainer),t),BD(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Pb(this._lContainer,t);return i&&null!=Vm(Gx(this._lContainer),t)?new hf(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function QP(n){return n[8]}function Gx(n){return n[8]||(n[8]=[])}function $P(n,e){let t;const i=e[n.index];if(Hs(i))t=i;else{let r;if(8&n.type)r=Ci(i);else{const s=e[11];r=s.createComment("");const o=ps(n,e);Kl(s,$m(s,o),r,function R5(n,e){return hi(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=KA(i,e,r,n),lg(e,t)}return new KP(t,n,e)}class Wx{constructor(e){this.queryList=e,this.matches=null}clone(){return new Wx(this.queryList)}setDirty(){this.queryList.setDirty()}}class Xx{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Xx(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==iI(e,t).matches&&this.queries[t].setDirty()}}class JP{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class qx{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new qx(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Zx{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Zx(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,JW(t,s)),this.matchTNodeWithReadOption(e,t,Um(t,e,s,!1,!1))}else i===Ks?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Um(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===qt||r===Ur||r===Ks&&4&t.type)this.addMatch(t.index,-2);else{const s=Um(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function JW(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function t7(n,e,t,i){return-1===t?function e7(n,e){return 11&n.type?qu(n,e):4&n.type?xg(n,e):null}(e,n):-2===t?function n7(n,e,t){return t===qt?qu(e,n):t===Ks?xg(e,n):t===Ur?$P(e,n):void 0}(n,e,i):kd(n,n[1],t,e)}function eI(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:t7(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Yx(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=eI(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const d=u[h];d[17]===d[3]&&Yx(d[1],d,c,i)}if(null!==u[9]){const h=u[9];for(let d=0;d<h.length;d++){const f=h[d];Yx(f[1],f,c,i)}}}}}return i}function Et(n){const e=be(),t=hn(),i=LE();Q0(i+1);const r=iI(t,i);if(n.dirty&&CE(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Yx(t,e,i,[]):eI(t,e,r,i);n.reset(s,yW),n.notifyOnChanges()}return!0}return!1}function Pn(n,e,t){const i=hn();i.firstCreatePass&&(nI(i,new JP(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),tI(i,be(),e)}function pi(n,e,t,i){const r=hn();if(r.firstCreatePass){const s=Oi();nI(r,new JP(e,t,i),s.index),function s7(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}tI(r,be(),t)}function Dt(){return function r7(n,e){return n[19].queries[e].queryList}(be(),LE())}function tI(n,e,t){const i=new rc(4==(4&t));HA(n,e,i,i.destroy),null===e[19]&&(e[19]=new Xx),e[19].queries.push(new Wx(i))}function nI(n,e,t){null===n.queries&&(n.queries=new qx),n.queries.track(new Zx(e,t))}function iI(n,e){return n.queries.getByIndex(e)}function rI(n,e){return xg(n,e)}function Mg(...n){}const ew=new He("Application Initializer");let Sg=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Mg,this.reject=Mg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(ef(s))t.push(s);else if(Cx(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(re(ew,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const gf=new He("AppId",{providedIn:"root",factory:function MI(){return`${tw()}${tw()}${tw()}`}});function tw(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const SI=new He("Platform Initializer"),_f=new He("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),TI=new He("appBootstrapListener"),Er=new He("AnimationModuleType");let T7=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ko=new He("LocaleId",{providedIn:"root",factory:()=>Zl(ko,Ct.Optional|Ct.SkipSelf)||function C7(){return typeof $localize<"u"&&$localize.locale||Wu}()});class D7{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let nw=(()=>{class n{compileModuleSync(t){return new zx(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=aa(Xr(t).declarations).reduce((o,a)=>{const l=On(a);return l&&o.push(new Vx(l)),o},[]);return new D7(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const R7=(()=>Promise.resolve(0))();function iw(n){typeof Zone>"u"?R7.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Pt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new yt(!1),this.onMicrotaskEmpty=new yt(!1),this.onStable=new yt(!1),this.onError=new yt(!1),typeof Zone>"u")throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function P7(){let n=Rn.requestAnimationFrame,e=Rn.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function F7(n){const e=()=>{!function L7(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Rn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,sw(n),n.isCheckStableRunning=!0,rw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),sw(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return CI(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),EI(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return CI(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),EI(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,sw(n),rw(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Pt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,I7,Mg,Mg);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const I7={};function rw(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function sw(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function CI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function EI(n){n._nesting--,rw(n)}class k7{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new yt,this.onMicrotaskEmpty=new yt,this.onStable=new yt,this.onError=new yt}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const DI=new He(""),Tg=new He("");let lw,ow=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,lw||(function O7(n){lw=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pt.assertNotInAngularZone(),iw(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())iw(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(re(Pt),re(aw),re(Tg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),aw=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return lw?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),Za=null;const AI=new He("AllowMultipleToken"),RI=new He("PlatformOnDestroy");class PI{constructor(e,t){this.name=e,this.token=t}}function LI(n,e,t=[]){const i=`Platform: ${e}`,r=new He(i);return(s=[])=>{let o=cw();if(!o||o.injector.get(AI,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function j7(n){if(Za&&!Za.get(AI,!1))throw new et(400,"");Za=n;const e=n.get(kI);(function II(n){const e=n.get(SI,null);e&&e.forEach(t=>t())})(n)}(function FI(n=[],e){return Xi.create({name:e,providers:[{provide:Ub,useValue:"platform"},{provide:RI,useValue:()=>Za=null},...n]})}(a,i))}return function V7(n){const e=cw();if(!e)throw new et(401,"");return e}()}}function cw(){return Za?.get(kI)??null}let kI=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function z7(n,e){let t;return t="noop"===n?new k7:("zone.js"===n?void 0:n)||new Pt(e),t}(i?.ngZone,function OI(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:Pt,useValue:r}];return r.run(()=>{const o=Xi.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(oa,null);if(!l)throw new et(402,"");return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Cg(this._modules,a),c.unsubscribe()})}),function NI(n,e,t){try{const i=t();return ef(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(Sg);return c.runInitializers(),c.donePromise.then(()=>(function mP(n){Wr(n,"Expected localeId to be defined"),"string"==typeof n&&(pP=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(ko,Wu)||Wu),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=BI({},i);return function N7(n,e,t){const i=new zx(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(vf);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new et(403,"");t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new et(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i()),this._injector.get(RI,null)?.(),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(re(Xi))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function BI(n,e){return Array.isArray(e)?e.reduce(BI,n):{...n,...e}}let vf=(()=>{class n{constructor(t,i,r,s){this._zone=t,this._injector=i,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new wn(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new wn(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{Pt.assertNotInAngularZone(),iw(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const u=this._zone.onUnstable.subscribe(()=>{Pt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),u.unsubscribe()}});this.isStable=lu(o,a.pipe(T0()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof zP;if(!this._initStatus.done)throw!r&&function Yu(n){const e=On(n)||br(n)||xr(n);return null!==e&&e.standalone}(t),new et(405,false);let s;s=r?t:this._injector.get(Xa).resolveComponentFactory(t),this.componentTypes.push(s.componentType);const o=function B7(n){return n.isBoundToModule}(s)?void 0:this._injector.get(qa),l=s.create(Xi.NULL,[],i||s.selector,o),c=l.location.nativeElement,u=l.injector.get(DI,null);return u?.registerApplication(c),l.onDestroy(()=>{this.detachView(l.hostView),Cg(this.components,l),u?.unregisterApplication(c)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new et(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Cg(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(TI,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Cg(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new et(406,false);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(re(Pt),re(Xi),re(oa),re(Sg))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Cg(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let UI=!0,Ei=(()=>{class n{}return n.__NG_ELEMENT_ID__=W7,n})();function W7(n){return function X7(n,e,t){if(Cm(n)&&!t){const i=Zr(n.index,e);return new hf(i,i)}return 47&n.type?new hf(e[16],e):null}(Oi(),be(),16==(16&n))}class WI{constructor(){}supports(e){return $d(e)}create(e){return new $7(e)}}const Q7=(n,e)=>e;class $7{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Q7}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<qI(i,r,s)?t:i,a=qI(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let d=0;d<c;d++){const f=d<s.length?s[d]:s[d]=0,p=f+d;u<=p&&p<c&&(s[d]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!$d(e))throw new et(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function T8(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Jl()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new J7(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new XI),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new XI),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class J7{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class e9{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class XI{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new e9,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function qI(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class ZI{constructor(){}supports(e){return e instanceof Map||xx(e)}create(){return new t9}}class t9{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||xx(e)))throw new et(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new n9(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class n9{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function YI(){return new Ag([new WI])}let Ag=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||YI()),deps:[[n,new Su,new ms]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new et(901,"")}}return n.\u0275prov=We({token:n,providedIn:"root",factory:YI}),n})();function KI(){return new yf([new ZI])}let yf=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||KI()),deps:[[n,new Su,new ms]]}}find(t){const i=this.factories.find(s=>s.supports(t));if(i)return i;throw new et(901,"")}}return n.\u0275prov=We({token:n,providedIn:"root",factory:KI}),n})();const s9=LI(null,"core",[]);let o9=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(re(vf))},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();function ha(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let Rg=null;function No(){return Rg}const Ut=new He("DocumentToken");let bf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:function(){return function u9(){return re(QI)}()},providedIn:"platform"}),n})();const h9=new He("Location Initialized");let QI=(()=>{class n extends bf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return No().getBaseHref(this._doc)}onPopState(t){const i=No().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=No().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){$I()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){$I()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:function(){return function d9(){return new QI(re(Ut))}()},providedIn:"platform"}),n})();function $I(){return!!window.history.pushState}function pw(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function JI(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function da(n){return n&&"?"!==n[0]?"?"+n:n}let Qu=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:function(){return function f9(){const n=re(Ut).location;return new e2(re(bf),n&&n.origin||"")}()},providedIn:"root"}),n})();const mw=new He("appBaseHref");let e2=(()=>{class n extends Qu{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return pw(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+da(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+da(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+da(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(re(bf),re(mw,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),p9=(()=>{class n extends Qu{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=pw(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+da(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+da(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(re(bf),re(mw,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Pg=(()=>{class n{constructor(t){this._subject=new yt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._baseHref=JI(t2(i)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+da(i))}normalize(t){return n.stripTrailingSlash(function g9(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,t2(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+da(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+da(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=da,n.joinWithSlash=pw,n.stripTrailingSlash=JI,n.\u0275fac=function(t){return new(t||n)(re(Qu))},n.\u0275prov=We({token:n,factory:function(){return function m9(){return new Pg(re(Qu))}()},providedIn:"root"}),n})();function t2(n){return n.replace(/\/index.html$/,"")}function h2(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}let d2=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&($d(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${kn(i.item)}`);this._toggleClass(i.item,!0)}),t.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!0)):Object.keys(t).forEach(i=>this._toggleClass(i,!!t[i])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!1)):Object.keys(t).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(t,i){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(N(Ag),N(yf),N(qt),N(ua))},n.\u0275dir=tt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})(),f2=(()=>{class n{constructor(t){this._viewContainerRef=t,this.ngComponentOutlet=null}ngOnChanges(t){const{_viewContainerRef:i,ngComponentOutletNgModule:r,ngComponentOutletNgModuleFactory:s}=this;if(i.clear(),this._componentRef=void 0,this.ngComponentOutlet){const o=this.ngComponentOutletInjector||i.parentInjector;(t.ngComponentOutletNgModule||t.ngComponentOutletNgModuleFactory)&&(this._moduleRef&&this._moduleRef.destroy(),this._moduleRef=r?function AW(n,e){return new GP(n,e??null)}(r,p2(o)):s?s.create(p2(o)):void 0),this._componentRef=i.createComponent(this.ngComponentOutlet,{index:i.length,injector:o,ngModuleRef:this._moduleRef,projectableNodes:this.ngComponentOutletContent})}}ngOnDestroy(){this._moduleRef&&this._moduleRef.destroy()}}return n.\u0275fac=function(t){return new(t||n)(N(Ur))},n.\u0275dir=tt({type:n,selectors:[["","ngComponentOutlet",""]],inputs:{ngComponentOutlet:"ngComponentOutlet",ngComponentOutletInjector:"ngComponentOutletInjector",ngComponentOutletContent:"ngComponentOutletContent",ngComponentOutletNgModule:"ngComponentOutletNgModule",ngComponentOutletNgModuleFactory:"ngComponentOutletNgModuleFactory"},features:[$i]}),n})();function p2(n){return n.get(qa).injector}class J9{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let oc=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new J9(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),m2(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{m2(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(N(Ur),N(Ks),N(Ag))},n.\u0275dir=tt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function m2(n,e){n.context.$implicit=e.item}let $u=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new eX,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){g2("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){g2("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(N(Ur),N(Ks))},n.\u0275dir=tt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class eX{constructor(){this.$implicit=null,this.ngIf=null}}function g2(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${kn(e)}'.`)}class Tw{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Vg=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),_2=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new Tw(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(N(Ur),N(Ks),N(Vg,9))},n.\u0275dir=tt({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})();class rX{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}}class sX{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}}const oX=new sX,aX=new rX;let Cw=(()=>{class n{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(ef(t))return oX;if(SR(t))return aX;throw function $s(n,e){return new et(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(N(Ei,16))},n.\u0275pipe=Qi({name:"async",type:n,pure:!1}),n})(),Ya=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();const x2="browser";function w2(n){return n===x2}let EX=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>new DX(re(Ut),window)}),n})();class DX{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function AX(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=M2(this.window.history)||M2(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function M2(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class S2{}class Aw extends class RX extends class c9{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function l9(n){Rg||(Rg=n)}(new Aw)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function PX(){return Mf=Mf||document.querySelector("base"),Mf?Mf.getAttribute("href"):null}();return null==t?null:function IX(n){zg=zg||document.createElement("a"),zg.setAttribute("href",n);const e=zg.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Mf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return h2(document.cookie,e)}}let zg,Mf=null;const T2=new He("TRANSITION_ID"),FX=[{provide:ew,useFactory:function LX(n,e,t){return()=>{t.get(Sg).donePromise.then(()=>{const i=No(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[T2,Ut,Xi],multi:!0}];let OX=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Hg=new He("EventManagerPlugins");let Gg=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(re(Hg),re(Pt))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class C2{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=No().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let E2=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Sf=(()=>{class n extends E2{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(D2),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(D2))}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function D2(n){No().remove(n)}const Rw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Pw=/%COMP%/g;function Wg(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Wg(n,r,t):(r=r.replace(Pw,n),t.push(r))}return t}function P2(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Xg=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Iw(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Vs.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new zX(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Vs.ShadowDom:return new HX(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=Wg(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(re(Gg),re(Sf),re(gf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Iw{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Rw[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(L2(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(L2(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=Rw[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=Rw[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&($r.DashCase|$r.Important)?e.style.setProperty(t,i,r&$r.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&$r.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,P2(i)):this.eventManager.addEventListener(e,t,P2(i))}}function L2(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class zX extends Iw{constructor(e,t,i,r){super(e),this.component=i;const s=Wg(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function jX(n){return"_ngcontent-%COMP%".replace(Pw,n)}(r+"-"+i.id),this.hostAttr=function UX(n){return"_nghost-%COMP%".replace(Pw,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class HX extends Iw{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Wg(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let GX=(()=>{class n extends C2{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const F2=["alt","control","meta","shift"],XX={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},k2={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},qX={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ZX=(()=>{class n extends C2{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>No().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(F2.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function YX(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&k2.hasOwnProperty(e)&&(e=k2[e]))}return XX[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),F2.forEach(s=>{s!=r&&qX[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const O2=[{provide:_f,useValue:x2},{provide:SI,useValue:function KX(){Aw.makeCurrent()},multi:!0},{provide:Ut,useFactory:function $X(){return function d4(n){z0=n}(document),document},deps:[]}],JX=LI(s9,"browser",O2),N2=new He(""),B2=[{provide:Tg,useClass:class kX{addToWindow(e){Rn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Rn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Rn.getAllAngularRootElements=()=>e.getAllRootElements(),Rn.frameworkStabilizers||(Rn.frameworkStabilizers=[]),Rn.frameworkStabilizers.push(i=>{const r=Rn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?No().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:DI,useClass:ow,deps:[Pt,aw,Tg]},{provide:ow,useClass:ow,deps:[Pt,aw,Tg]}],j2=[{provide:Ub,useValue:"root"},{provide:oa,useFactory:function QX(){return new oa},deps:[]},{provide:Hg,useClass:GX,multi:!0,deps:[Ut,Pt,_f]},{provide:Hg,useClass:ZX,multi:!0,deps:[Ut]},{provide:Xg,useClass:Xg,deps:[Gg,Sf,gf]},{provide:uf,useExisting:Xg},{provide:E2,useExisting:Sf},{provide:Sf,useClass:Sf,deps:[Ut]},{provide:Gg,useClass:Gg,deps:[Hg,Pt]},{provide:S2,useClass:OX,deps:[]},[]];let U2=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:gf,useValue:t.appId},{provide:T2,useExisting:gf},FX]}}}return n.\u0275fac=function(t){return new(t||n)(re(N2,12))},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:[...j2,...B2],imports:[Ya,o9]}),n})(),V2=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:function(t){let i=null;return i=t?new t:function tq(){return new V2(re(Ut))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let qg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:function(t){let i=null;return i=t?new(t||n):re(G2),i},providedIn:"root"}),n})(),G2=(()=>{class n extends qg{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case fn.NONE:return i;case fn.HTML:return Do(i,"HTML")?Qr(i):MD(this._doc,String(i)).toString();case fn.STYLE:return Do(i,"Style")?Qr(i):i;case fn.SCRIPT:if(Do(i,"Script"))return Qr(i);throw new Error("unsafe value used in a script context");case fn.URL:return mD(i),Do(i,"URL")?Qr(i):Gd(String(i));case fn.RESOURCE_URL:if(Do(i,"ResourceURL"))return Qr(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function DH(n){return new MH(n)}(t)}bypassSecurityTrustStyle(t){return function AH(n){return new SH(n)}(t)}bypassSecurityTrustScript(t){return function RH(n){return new TH(n)}(t)}bypassSecurityTrustUrl(t){return function PH(n){return new CH(n)}(t)}bypassSecurityTrustResourceUrl(t){return function IH(n){return new EH(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:function(t){let i=null;return i=t?new t:function cq(n){return new G2(n.get(Ut))}(re(Xi)),i},providedIn:"root"}),n})();function Mt(...n){return vi(n,Cd(n))}class es extends Ft{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:uq}=Array,{getPrototypeOf:hq,prototype:dq,keys:fq}=Object;function W2(n){if(1===n.length){const e=n[0];if(uq(e))return{args:e,keys:null};if(function pq(n){return n&&"object"==typeof n&&hq(n)===dq}(e)){const t=fq(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:mq}=Array;function kw(n){return xt(e=>function gq(n,e){return mq(e)?n(...e):n(e)}(n,e))}function X2(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Ow(...n){const e=Cd(n),t=S0(n),{args:i,keys:r}=W2(n);if(0===i.length)return vi([],e);const s=new wn(function _q(n,e,t=ja){return i=>{q2(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)q2(e,()=>{const c=vi(n[l],e);let u=!1;c.subscribe(Jn(i,h=>{s[l]=h,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>X2(r,o):ja));return t?s.pipe(kw(t)):s}function q2(n,e,t){n?ea(t,n,e):e()}function Js(n,e){const t=un(n)?n:()=>n,i=r=>r.error(t());return new wn(e?r=>e.schedule(i,0,r):i)}const Tf=f0(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Zg(...n){return function vq(){return au(1)}()(vi(n,Cd(n)))}function Z2(n){return new wn(e=>{kr(n()).subscribe(e)})}function Yg(){return ui((n,e)=>{let t=null;n._refCount++;const i=Jn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Nw extends wn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Y1(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new $n;const t=this.getSubject();e.add(this.source.subscribe(Jn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=$n.EMPTY)}return e}refCount(){return Yg()(this)}}function Bo(n,e){return ui((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Jn(i,l=>{r?.unsubscribe();let c=0;const u=s++;kr(n(l,u)).subscribe(r=Jn(i,h=>i.next(e?e(l,h,u,c++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function pa(...n){const e=Cd(n);return ui((t,i)=>{(e?Zg(n,t,e):Zg(n,t)).subscribe(i)})}function yq(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Jn(o,u=>{const h=c++;l=a?n(l,u,h):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function Y2(n,e){return ui(yq(n,e,arguments.length>=2,!0))}function Ui(n,e){return ui((t,i)=>{let r=0;t.subscribe(Jn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function eo(n){return ui((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Jn(t,void 0,void 0,o=>{s=kr(n(o,eo(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Ju(n,e){return un(e)?Gi(n,e,1):Gi(n,1)}function Bw(n){return n<=0?()=>yr:ui((e,t)=>{let i=[];e.subscribe(Jn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function K2(n=bq){return ui((e,t)=>{let i=!1;e.subscribe(Jn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function bq(){return new Tf}function jw(n){return ui((e,t)=>{let i=!1;e.subscribe(Jn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function ac(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ui((r,s)=>n(r,s,i)):ja,Or(1),t?jw(e):K2(()=>new Tf))}function Wn(n,e,t){const i=un(n)||e||t?{next:n,error:e,complete:t}:n;return i?ui((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Jn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):ja}function Uw(n){return xt(()=>n)}function Kg(n){return ui((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}class ma{constructor(e,t){this.id=e,this.url=t}}class Vw extends ma{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Cf extends ma{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Q2 extends ma{constructor(e,t,i){super(e,t),this.reason=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class wq extends ma{constructor(e,t,i){super(e,t),this.error=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Mq extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Sq extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tq extends ma{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Cq extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Eq extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dq{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Aq{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Rq{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pq{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Iq{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Lq{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $2{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Qt="primary";class Fq{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function eh(n){return new Fq(n)}const J2="ngNavigationCancelingError";function zw(n){const e=Error("NavigationCancelingError: "+n);return e[J2]=!0,e}function Oq(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function jo(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!eL(n[r],e[r]))return!1;return!0}function eL(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function tL(n){return Array.prototype.concat.apply([],n)}function nL(n){return n.length>0?n[n.length-1]:null}function er(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function to(n){return Cx(n)?n:ef(n)?vi(Promise.resolve(n)):Mt(n)}const jq={exact:function sL(n,e,t){if(!cc(n.segments,e.segments)||!Qg(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!sL(n.children[i],e.children[i],t))return!1;return!0},subset:oL},iL={exact:function Uq(n,e){return jo(n,e)},subset:function Vq(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>eL(n[t],e[t]))},ignored:()=>!0};function rL(n,e,t){return jq[t.paths](n.root,e.root,t.matrixParams)&&iL[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function oL(n,e,t){return aL(n,e,e.segments,t)}function aL(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!cc(r,t)||e.hasChildren()||!Qg(r,t,i))}if(n.segments.length===t.length){if(!cc(n.segments,t)||!Qg(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!oL(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(cc(n.segments,r)&&Qg(n.segments,r,i)&&n.children[Qt])&&aL(n.children[Qt],e,s,i)}}function Qg(n,e,t){return e.every((i,r)=>iL[t](n[r].parameters,i.parameters))}class lc{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=eh(this.queryParams)),this._queryParamMap}toString(){return Gq.serialize(this)}}class on{constructor(e,t){this.segments=e,this.children=t,this.parent=null,er(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return $g(this)}}class Ef{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=eh(this.parameters)),this._parameterMap}toString(){return dL(this)}}function cc(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}class lL{}class cL{parse(e){const t=new Jq(e);return new lc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Df(e.root,!0)}`,i=function qq(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Jg(t)}=${Jg(r)}`).join("&"):`${Jg(t)}=${Jg(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Wq(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Gq=new cL;function $g(n){return n.segments.map(e=>dL(e)).join("/")}function Df(n,e){if(!n.hasChildren())return $g(n);if(e){const t=n.children[Qt]?Df(n.children[Qt],!1):"",i=[];return er(n.children,(r,s)=>{s!==Qt&&i.push(`${s}:${Df(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Hq(n,e){let t=[];return er(n.children,(i,r)=>{r===Qt&&(t=t.concat(e(i,r)))}),er(n.children,(i,r)=>{r!==Qt&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Qt?[Df(n.children[Qt],!1)]:[`${r}:${Df(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Qt]?`${$g(n)}/${t[0]}`:`${$g(n)}/(${t.join("//")})`}}function uL(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Jg(n){return uL(n).replace(/%3B/gi,";")}function Hw(n){return uL(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function e_(n){return decodeURIComponent(n)}function hL(n){return e_(n.replace(/\+/g,"%20"))}function dL(n){return`${Hw(n.path)}${function Xq(n){return Object.keys(n).map(e=>`;${Hw(e)}=${Hw(n[e])}`).join("")}(n.parameters)}`}const Zq=/^[^\/()?;=#]+/;function t_(n){const e=n.match(Zq);return e?e[0]:""}const Yq=/^[^=?&#]+/,Qq=/^[^&#]+/;class Jq{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new on([],{}):new on([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Qt]=new on(e,t)),i}parseSegment(){const e=t_(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Ef(e_(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=t_(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=t_(this.remaining);r&&(i=r,this.capture(i))}e[e_(t)]=e_(i)}parseQueryParam(e){const t=function Kq(n){const e=n.match(Yq);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function $q(n){const e=n.match(Qq);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=hL(t),s=hL(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=t_(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Qt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Qt]:new on([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class fL{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Gw(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Gw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Ww(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Ww(e,this._root).map(t=>t.value)}}function Gw(n,e){if(n===e.value)return e;for(const t of e.children){const i=Gw(n,t);if(i)return i}return null}function Ww(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Ww(n,t);if(i.length)return i.unshift(e),i}return[]}class ga{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function th(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class pL extends fL{constructor(e,t){super(e),this.snapshot=t,Xw(this,e)}toString(){return this.snapshot.toString()}}function mL(n,e){const t=function eZ(n,e){const o=new n_([],{},{},"",{},Qt,e,null,n.root,-1,{});return new _L("",new ga(o,[]))}(n,e),i=new es([new Ef("",{})]),r=new es({}),s=new es({}),o=new es({}),a=new es(""),l=new uc(i,r,o,a,s,Qt,e,t.root);return l.snapshot=t.root,new pL(new ga(l,[]),t)}class uc{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(xt(e=>eh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(xt(e=>eh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function gL(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function tZ(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class n_{constructor(e,t,i,r,s,o,a,l,c,u,h,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._correctedLastPathIndex=d??u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=eh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=eh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class _L extends fL{constructor(e,t){super(t),this.url=e,Xw(this,t)}toString(){return vL(this._root)}}function Xw(n,e){e.value._routerState=n,e.children.forEach(t=>Xw(n,t))}function vL(n){const e=n.children.length>0?` { ${n.children.map(vL).join(", ")} } `:"";return`${n.value}${e}`}function qw(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,jo(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),jo(e.params,t.params)||n.params.next(t.params),function Nq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!jo(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),jo(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Zw(n,e){const t=jo(n.params,e.params)&&function zq(n,e){return cc(n,e)&&n.every((t,i)=>jo(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Zw(n.parent,e.parent))}function Af(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function iZ(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Af(n,i,r);return Af(n,i)})}(n,e,t);return new ga(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Af(n,a)),o}}const i=function rZ(n){return new uc(new es(n.url),new es(n.params),new es(n.queryParams),new es(n.fragment),new es(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Af(n,s));return new ga(i,r)}}function i_(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Rf(n){return"object"==typeof n&&null!=n&&n.outlets}function Yw(n,e,t,i,r){let s={};if(i&&er(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),n===e)return new lc(t,s,r);const o=yL(n,e,t);return new lc(o,s,r)}function yL(n,e,t){const i={};return er(n.children,(r,s)=>{i[s]=r===e?t:yL(r,e,t)}),new on(n.segments,i)}class bL{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&i_(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(Rf);if(r&&r!==nL(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Kw{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function xL(n,e,t){if(n||(n=new on([],{})),0===n.segments.length&&n.hasChildren())return r_(n,e,t);const i=function uZ(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(Rf(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!ML(l,c,o))return s;i+=2}else{if(!ML(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new on(n.segments.slice(0,i.pathIndex),{});return s.children[Qt]=new on(n.segments.slice(i.pathIndex),n.children),r_(s,0,r)}return i.match&&0===r.length?new on(n.segments,{}):i.match&&!n.hasChildren()?Qw(n,e,t):i.match?r_(n,0,r):Qw(n,e,t)}function r_(n,e,t){if(0===t.length)return new on(n.segments,{});{const i=function cZ(n){return Rf(n[0])?n[0].outlets:{[Qt]:n}}(t),r={};return er(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=xL(n.children[o],e,s))}),er(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new on(n.segments,r)}}function Qw(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Rf(s)){const l=hZ(s.outlets);return new on(i,l)}if(0===r&&i_(t[0])){i.push(new Ef(n.segments[e].path,wL(t[0]))),r++;continue}const o=Rf(s)?s.outlets[Qt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&i_(a)?(i.push(new Ef(o,wL(a))),r+=2):(i.push(new Ef(o,{})),r++)}return new on(i,{})}function hZ(n){const e={};return er(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Qw(new on([],{}),0,t))}),e}function wL(n){const e={};return er(n,(t,i)=>e[i]=`${t}`),e}function ML(n,e,t){return n==t.path&&jo(e,t.parameters)}class dZ{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Pf,this.attachRef=null}}class Pf{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new dZ,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let $w=(()=>{class n{constructor(t,i,r,s,o){this.parentContexts=t,this.location=i,this.changeDetector=s,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new yt,this.deactivateEvents=new yt,this.attachEvents=new yt,this.detachEvents=new yt,this.name=r||Qt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const r=this.location,o=t._futureSnapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new fZ(t,a,r.injector);if(i&&function pZ(n){return!!n.resolveComponentFactory}(i)){const c=i.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(N(Pf),N(Ur),ql("name"),N(Ei),N($l))},n.\u0275dir=tt({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class fZ{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===uc?this.route:e===Pf?this.childContexts:this.parent.get(e,t)}}let SL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&Ye(0,"router-outlet")},dependencies:[$w],encapsulation:2}),n})();function TL(n,e){return n.providers&&!n._injector&&(n._injector=yg(n.providers,e,`Route: ${n.path}`)),n._injector??e}function eM(n){const e=n.children&&n.children.map(eM),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Qt&&(t.component=SL),t}function xs(n){return n.outlet||Qt}function CL(n,e){const t=n.filter(i=>xs(i)===e);return t.push(...n.filter(i=>xs(i)!==e)),t}function EL(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class yZ{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),qw(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=th(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),er(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=th(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=th(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=th(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Lq(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Pq(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(qw(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),qw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=EL(r.snapshot),l=a?.get(Xa)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}function Qa(n){return"function"==typeof n}function hc(n){return n instanceof lc}const If=Symbol("INITIAL_VALUE");function Lf(){return Bo(n=>Ow(n.map(e=>e.pipe(Or(1),pa(If)))).pipe(Y2((e,t)=>{let i=!1;return t.reduce((r,s,o)=>r!==If?r:(s===If&&(i=!0),i||!1!==s&&o!==t.length-1&&!hc(s)?r:s),e)},If),Ui(e=>e!==If),xt(e=>hc(e)?e:!0===e),Or(1)))}const DL={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function s_(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...DL}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Oq)(t,n,e);if(!r)return{...DL};const s={};er(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function o_(n,e,t,i,r="corrected"){if(t.length>0&&function EZ(n,e,t){return t.some(i=>a_(n,e,i)&&xs(i)!==Qt)}(n,t,i)){const o=new on(e,function CZ(n,e,t,i){const r={};r[Qt]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&xs(s)!==Qt){const o=new on([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[xs(s)]=o}return r}(n,e,i,new on(t,n.children)));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function DZ(n,e,t){return t.some(i=>a_(n,e,i))}(n,t,i)){const o=new on(n.segments,function TZ(n,e,t,i,r,s){const o={};for(const a of i)if(a_(n,t,a)&&!r[xs(a)]){const l=new on([],{});l._sourceSegment=n,l._segmentIndexShift="legacy"===s?n.segments.length:e.length,o[xs(a)]=l}return{...r,...o}}(n,e,t,i,n.children,r));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new on(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function a_(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function AL(n,e,t,i){return!!(xs(n)===i||i!==Qt&&a_(e,t,n))&&("**"===n.path||s_(e,n,t).matched)}function RL(n,e,t){return 0===e.length&&!n.children[t]}class l_{constructor(e){this.segmentGroup=e||null}}class PL{constructor(e){this.urlTree=e}}function Ff(n){return Js(new l_(n))}function IL(n){return Js(new PL(n))}class IZ{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=o_(this.urlTree.root,[],[],this.config).segmentGroup,t=new on(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Qt).pipe(xt(s=>this.createUrlTree(tM(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(eo(s=>{if(s instanceof PL)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof l_?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Qt).pipe(xt(r=>this.createUrlTree(tM(r),e.queryParams,e.fragment))).pipe(eo(r=>{throw r instanceof l_?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const r=e.segments.length>0?new on([],{[Qt]:e}):e;return new lc(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(xt(s=>new on([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return vi(r).pipe(Ju(s=>{const o=i.children[s],a=CL(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(xt(l=>({segment:l,outlet:s})))}),Y2((s,o)=>(s[o.outlet]=o.segment,s),{}),function xq(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ui((r,s)=>n(r,s,i)):ja,Bw(1),t?jw(e):K2(()=>new Tf))}())}expandSegment(e,t,i,r,s,o){return vi(i).pipe(Ju(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(eo(c=>{if(c instanceof l_)return Mt(null);throw c}))),ac(a=>!!a),eo((a,l)=>{if(a instanceof Tf||"EmptyError"===a.name)return RL(t,r,s)?Mt(new on([],{})):Ff(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return AL(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Ff(t):Ff(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?IL(s):this.lineralizeSegments(i,s).pipe(Gi(o=>{const a=new on(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=s_(t,r,s);if(!a)return Ff(t);const h=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?IL(h):this.lineralizeSegments(r,h).pipe(Gi(d=>this.expandSegment(e,t,i,d.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){if("**"===i.path)return e=TL(i,e),i.loadChildren?(i._loadedRoutes?Mt({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(xt(h=>(i._loadedRoutes=h.routes,i._loadedInjector=h.injector,new on(r,{})))):Mt(new on(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=s_(t,i,r);return o?(e=TL(i,e),this.getChildConfig(e,i,r).pipe(Gi(u=>{const h=u.injector??e,d=u.routes,{segmentGroup:f,slicedSegments:p}=o_(t,a,l,d),m=new on(f.segments,f.children);if(0===p.length&&m.hasChildren())return this.expandChildren(h,d,m).pipe(xt(y=>new on(a,y)));if(0===d.length&&0===p.length)return Mt(new on(a,{}));const g=xs(i)===s;return this.expandSegment(h,m,d,p,g?Qt:s,!0).pipe(xt(v=>new on(a.concat(v.segments),v.children)))}))):Ff(t)}getChildConfig(e,t,i){return t.children?Mt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Mt({routes:t._loadedRoutes,injector:t._loadedInjector}):this.runCanLoadGuards(e,t,i).pipe(Gi(r=>r?this.configLoader.loadChildren(e,t).pipe(Wn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function RZ(n){return Js(zw(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):Mt({routes:[],injector:e})}runCanLoadGuards(e,t,i){const r=t.canLoad;return r&&0!==r.length?Mt(r.map(o=>{const a=e.get(o);let l;if(function xZ(n){return n&&Qa(n.canLoad)}(a))l=a.canLoad(t,i);else{if(!Qa(a))throw new Error("Invalid CanLoad guard");l=a(t,i)}return to(l)})).pipe(Lf(),Wn(o=>{if(!hc(o))return;const a=zw(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),xt(o=>!0===o)):Mt(!0)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Mt(i);if(r.numberOfChildren>1||!r.children[Qt])return Js(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[Qt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new lc(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return er(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return er(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new on(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}function tM(n){const e={};for(const i of Object.keys(n.children)){const s=tM(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function LZ(n){if(1===n.numberOfChildren&&n.children[Qt]){const e=n.children[Qt];return new on(n.segments.concat(e.segments),e.children)}return n}(new on(n.segments,e))}class LL{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class c_{constructor(e,t){this.component=e,this.route=t}}function kZ(n,e,t){const i=n._root;return kf(i,e?e._root:null,t,[i.value])}function u_(n,e,t){return(EL(e)??t).get(n)}function kf(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=th(e);return n.children.forEach(o=>{(function NZ(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function BZ(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!cc(n.url,e.url);case"pathParamsOrQueryParamsChange":return!cc(n.url,e.url)||!jo(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Zw(n,e)||!jo(n.queryParams,e.queryParams);default:return!Zw(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new LL(i)):(s.data=o.data,s._resolvedData=o._resolvedData),kf(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new c_(a.outlet.component,o))}else o&&Of(e,a,r),r.canActivateChecks.push(new LL(i)),kf(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),er(s,(o,a)=>Of(o,t.getContext(a),r)),r}function Of(n,e,t){const i=th(n),r=n.value;er(i,(s,o)=>{Of(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new c_(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class qZ{}function kL(n){return new wn(e=>e.error(n))}class YZ{constructor(e,t,i,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=o_(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Qt);if(null===t)return null;const i=new n_([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Qt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new ga(i,t),s=new _L(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,i=gL(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=CL(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=OL(i);return function KZ(n){n.sort((e,t)=>e.value.outlet===Qt?-1:t.value.outlet===Qt?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,i,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,i,r);if(null!==o)return o}return RL(t,i,r)?[]:null}processSegmentAgainstRoute(e,t,i,r){if(e.redirectTo||!AL(e,t,i,r))return null;let s,o=[],a=[];if("**"===e.path){const f=i.length>0?nL(i).parameters:{},p=BL(t)+i.length;s=new n_(i,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,UL(e),xs(e),e.component??e._loadedComponent??null,e,NL(t),p,VL(e),p)}else{const f=s_(t,e,i);if(!f.matched)return null;o=f.consumedSegments,a=f.remainingSegments;const p=BL(t)+o.length;s=new n_(o,f.parameters,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,UL(e),xs(e),e.component??e._loadedComponent??null,e,NL(t),p,VL(e),p)}const l=function QZ(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:c,slicedSegments:u}=o_(t,o,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new ga(s,f)]}if(0===l.length&&0===u.length)return[new ga(s,[])];const h=xs(e)===r,d=this.processSegment(l,c,u,h?Qt:r);return null===d?null:[new ga(s,d)]}}function $Z(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function OL(n){const e=[],t=new Set;for(const i of n){if(!$Z(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=OL(i.children);e.push(new ga(i.value,r))}return e.filter(i=>!t.has(i))}function NL(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function BL(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function UL(n){return n.data||{}}function VL(n){return n.resolve||{}}const nM=Symbol("RouteTitle");function zL(n){return"string"==typeof n.title||null===n.title}function iM(n){return Bo(e=>{const t=n(e);return t?vi(t).pipe(xt(()=>e)):Mt(e)})}class aY extends class oY{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const rM=new He("ROUTES");let sM=(()=>{class n{constructor(t,i){this.injector=t,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Mt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=to(t.loadComponent()).pipe(Wn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Kg(()=>{this.componentLoaders.delete(t)})),r=new Nw(i,()=>new Ft).pipe(Yg());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Mt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(xt(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=tL(l.get(rM,[],Ct.Self|Ct.Optional)));return{routes:c.map(eM),injector:l}}),Kg(()=>{this.childrenLoaders.delete(i)})),o=new Nw(s,()=>new Ft).pipe(Yg());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return to(t()).pipe(Gi(i=>i instanceof VP||Array.isArray(i)?Mt(i):vi(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)(re(Xi),re(nw))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class cY{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function hY(n){throw n}function dY(n,e,t){return e.parse("/")}const fY={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},pY={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ts=(()=>{class n{constructor(t,i,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ft,this.errorHandler=hY,this.malformedUriErrorHandler=dY,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Mt(void 0),this.urlHandlingStrategy=new cY,this.routeReuseStrategy=new aY,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(sM),this.configLoader.onLoadEndListener=d=>this.triggerEvent(new Aq(d)),this.configLoader.onLoadStartListener=d=>this.triggerEvent(new Dq(d)),this.ngModule=o.get(qa),this.console=o.get(T7);const h=o.get(Pt);this.isNgZoneEnabled=h instanceof Pt&&Pt.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function Bq(){return new lc(new on([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=mL(this.currentUrlTree,this.rootComponentType),this.transitions=new es({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(Ui(r=>0!==r.id),xt(r=>({...r,extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Bo(r=>{let s=!1,o=!1;return Mt(r).pipe(Wn(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Bo(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return GL(a.source)&&(this.browserUrlTree=a.extractedUrl),Mt(a).pipe(Bo(h=>{const d=this.transitions.getValue();return i.next(new Vw(h.id,this.serializeUrl(h.extractedUrl),h.source,h.restoredState)),d!==this.transitions.getValue()?yr:Promise.resolve(h)}),function FZ(n,e,t,i){return Bo(r=>function PZ(n,e,t,i,r){return new IZ(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(xt(s=>({...r,urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Wn(h=>{this.currentNavigation={...this.currentNavigation,finalUrl:h.urlAfterRedirects}}),function JZ(n,e,t,i,r){return Gi(s=>function ZZ(n,e,t,i,r="emptyOnly",s="legacy"){try{const o=new YZ(n,e,t,i,r,s).recognize();return null===o?kL(new qZ):Mt(o)}catch(o){return kL(o)}}(n,e,s.urlAfterRedirects,t(s.urlAfterRedirects),i,r).pipe(xt(o=>({...s,targetSnapshot:o}))))}(this.rootComponentType,this.config,h=>this.serializeUrl(h),this.paramsInheritanceStrategy,this.relativeLinkResolution),Wn(h=>{if("eager"===this.urlUpdateStrategy){if(!h.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl);this.setBrowserUrl(f,h)}this.browserUrlTree=h.urlAfterRedirects}const d=new Mq(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);i.next(d)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:f,source:p,restoredState:m,extras:g}=a,_=new Vw(d,this.serializeUrl(f),p,m);i.next(_);const v=mL(f,this.rootComponentType).snapshot;return Mt({...a,targetSnapshot:v,urlAfterRedirects:f,extras:{...g,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=a.rawUrl,a.resolve(null),yr}),Wn(a=>{const l=new Sq(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),xt(a=>({...a,guards:kZ(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function jZ(n,e){return Gi(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Mt({...t,guardsResult:!0}):function UZ(n,e,t,i){return vi(n).pipe(Gi(r=>function XZ(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Mt(s.map(a=>{const l=u_(a,e,r);let c;if(function SZ(n){return n&&Qa(n.canDeactivate)}(l))c=to(l.canDeactivate(n,e,t,i));else{if(!Qa(l))throw new Error("Invalid CanDeactivate guard");c=to(l(n,e,t,i))}return c.pipe(ac())})).pipe(Lf()):Mt(!0)}(r.component,r.route,t,e,i)),ac(r=>!0!==r,!0))}(o,i,r,n).pipe(Gi(a=>a&&function bZ(n){return"boolean"==typeof n}(a)?function VZ(n,e,t,i){return vi(e).pipe(Ju(r=>Zg(function HZ(n,e){return null!==n&&e&&e(new Rq(n)),Mt(!0)}(r.route.parent,i),function zZ(n,e){return null!==n&&e&&e(new Iq(n)),Mt(!0)}(r.route,i),function WZ(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function OZ(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Z2(()=>Mt(o.guards.map(l=>{const c=u_(l,o.node,t);let u;if(function MZ(n){return n&&Qa(n.canActivateChild)}(c))u=to(c.canActivateChild(i,n));else{if(!Qa(c))throw new Error("Invalid CanActivateChild guard");u=to(c(i,n))}return u.pipe(ac())})).pipe(Lf())));return Mt(s).pipe(Lf())}(n,r.path,t),function GZ(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Mt(!0);const r=i.map(s=>Z2(()=>{const o=u_(s,e,t);let a;if(function wZ(n){return n&&Qa(n.canActivate)}(o))a=to(o.canActivate(e,n));else{if(!Qa(o))throw new Error("Invalid CanActivate guard");a=to(o(e,n))}return a.pipe(ac())}));return Mt(r).pipe(Lf())}(n,r.route,t))),ac(r=>!0!==r,!0))}(i,s,n,e):Mt(a)),xt(a=>({...t,guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Wn(a=>{if(hc(a.guardsResult)){const c=zw(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new Tq(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),Ui(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),iM(a=>{if(a.guards.canActivateChecks.length)return Mt(a).pipe(Wn(l=>{const c=new Cq(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),Bo(l=>{let c=!1;return Mt(l).pipe(function eY(n,e){return Gi(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Mt(t);let s=0;return vi(r).pipe(Ju(o=>function tY(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!zL(r)&&(s[nM]=r.title),function nY(n,e,t,i){const r=function iY(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Mt({});const s={};return vi(r).pipe(Gi(o=>function rY(n,e,t,i){const r=u_(n,e,i);return to(r.resolve?r.resolve(e,t):r(e,t))}(n[o],e,t,i).pipe(ac(),Wn(a=>{s[o]=a}))),Bw(1),Uw(s),eo(o=>o instanceof Tf?yr:Js(o)))}(s,n,e,i).pipe(xt(o=>(n._resolvedData=o,n.data=gL(n,t).resolve,r&&zL(r)&&(n.data[nM]=r.title),null)))}(o.route,i,n,e)),Wn(()=>s++),Bw(1),Gi(o=>s===r.length?Mt(t):yr))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Wn({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Wn(l=>{const c=new Eq(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),iM(()=>this.afterPreactivation()),iM(a=>{const l=c=>{const u=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(c.routeConfig).pipe(Wn(h=>{c.component=h}),xt(()=>{})));for(const h of c.children)u.push(...l(h));return u};return Ow(l(a.targetSnapshot.root)).pipe(jw(),Or(1))}),xt(a=>{const l=function nZ(n,e,t){const i=Af(n,e._root,t?t._root:void 0);return new pL(i,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return{...a,targetRouterState:l}}),Wn(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,e,t)=>xt(i=>(new yZ(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Wn({next(){s=!0},complete(){s=!0}}),Kg(()=>{s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),eo(a=>{if(o=!0,function kq(n){return n&&n[J2]}(a)){const l=hc(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new Q2(r.id,this.serializeUrl(r.extractedUrl),a.message);if(i.next(c),l){const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),h={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||GL(r.source)};this.scheduleNavigation(u,"imperative",null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new wq(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return yr}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{const r={replaceUrl:!0},s=t.state?.navigationId?t.state:null;if(s){const a={...s};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(r.state=a)}const o=this.parseUrl(t.url);this.scheduleNavigation(o,i,s,r)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(eM),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}return null!==h&&(h=this.removeEmptyProps(h)),function sZ(n,e,t,i,r){if(0===t.length)return Yw(e.root,e.root,e.root,i,r);const s=function oZ(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new bL(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return er(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new bL(t,e,i)}(t);return s.toRoot()?Yw(e.root,e.root,new on([],{}),i,r):function o(l){const c=function aZ(n,e,t,i){return n.isAbsolute?new Kw(e.root,!0,0):-1===i?new Kw(t,t===e.root,0):function lZ(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new Kw(i,!1,r-s)}(t,i+(i_(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,l),u=c.processChildren?r_(c.segmentGroup,c.index,s.commands):xL(c.segmentGroup,c.index,s.commands);return Yw(e.root,c.segmentGroup,u,i,r)}(n.snapshot?._lastPathIndex)}(c,this.currentUrlTree,t,h,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=hc(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function mY(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...fY}:!1===i?{...pY}:i,hc(t))return rL(this.currentUrlTree,t,r);const s=this.parseUrl(t);return rL(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Cf(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,f)=>{a=d,l=f});const u=++this.navigationId;let h;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),h=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):h=0,this.setTransition({id:u,targetPageId:h,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===r?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i){const r=new Q2(t.id,this.serializeUrl(t.extractedUrl),i);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){ig()},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function GL(n){return"imperative"!==n}let h_=(()=>{class n{constructor(t,i,r){this.router=t,this.route=i,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new Ft,this.subscription=t.events.subscribe(s=>{s instanceof Cf&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:null}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,i,r,s,o){if(0!==t||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const a={skipLocationChange:ha(this.skipLocationChange),replaceUrl:ha(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ha(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(N(ts),N(uc),N(Qu))},n.\u0275dir=tt({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,i){1&t&&gt("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&yi("target",i.target)("href",i.href,_b)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[$i]}),n})();class WL{buildTitle(e){let t,i=e.root;for(;void 0!==i;)t=this.getResolvedTitleForRoute(i)??t,i=i.children.find(r=>r.outlet===Qt);return t}getResolvedTitleForRoute(e){return e.data[nM]}}let vY=(()=>{class n extends WL{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(re(V2))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class XL{}class qL{preload(e,t){return Mt(null)}}let ZL=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ui(t=>t instanceof Cf),Ju(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=yg(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return vi(r).pipe(au())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Mt(null);const s=r.pipe(Gi(o=>null===o?Mt(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?vi([s,this.loader.loadComponent(i)]).pipe(au()):s})}}return n.\u0275fac=function(t){return new(t||n)(re(ts),re(nw),re($l),re(XL),re(sM))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),aM=(()=>{class n{constructor(t,i,r={}){this.router=t,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Vw?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Cf&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof $2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.router.triggerEvent(new $2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){ig()},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const dc=new He("ROUTER_CONFIGURATION"),YL=new He("ROUTER_FORROOT_GUARD"),bY=[Pg,{provide:lL,useClass:cL},{provide:ts,useFactory:function TY(n,e,t,i,r,s,o={},a,l,c,u){const h=new ts(null,n,e,t,i,r,tL(s));return c&&(h.urlHandlingStrategy=c),u&&(h.routeReuseStrategy=u),h.titleStrategy=l??a,function CY(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(o,h),h},deps:[lL,Pf,Pg,Xi,nw,rM,dc,vY,[WL,new ms],[class lY{},new ms],[class sY{},new ms]]},Pf,{provide:uc,useFactory:function EY(n){return n.routerState.root},deps:[ts]},ZL,qL,class yY{preload(e,t){return t().pipe(eo(()=>Mt(null)))}},{provide:dc,useValue:{enableTracing:!1}},sM];function xY(){return new PI("Router",ts)}let KL=(()=>{class n{constructor(t,i){}static forRoot(t,i){return{ngModule:n,providers:[bY,QL(t),{provide:YL,useFactory:SY,deps:[[ts,new ms,new Su]]},{provide:dc,useValue:i||{}},{provide:Qu,useFactory:MY,deps:[bf,[new Wm(mw),new ms],dc]},{provide:aM,useFactory:wY,deps:[ts,EX,dc]},{provide:XL,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:qL},{provide:PI,multi:!0,useFactory:xY},[lM,{provide:ew,multi:!0,useFactory:DY,deps:[lM]},{provide:$L,useFactory:AY,deps:[lM]},{provide:TI,multi:!0,useExisting:$L}]]}}static forChild(t){return{ngModule:n,providers:[QL(t)]}}}return n.\u0275fac=function(t){return new(t||n)(re(YL,8),re(ts,8))},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();function wY(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new aM(n,e,t)}function MY(n,e,t={}){return t.useHash?new p9(n,e):new e2(n,e)}function SY(n){return"guarded"}function QL(n){return[{provide:Y4,multi:!0,useValue:n},{provide:rM,multi:!0,useValue:n}]}let lM=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ft}appInitializer(){return this.injector.get(h9,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(ts),o=this.injector.get(dc);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabledBlocking"===o.initialNavigation?(s.afterPreactivation=()=>this.initNavigation?Mt(void 0):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(t){const i=this.injector.get(dc),r=this.injector.get(ZL),s=this.injector.get(aM),o=this.injector.get(ts),a=this.injector.get(vf);t===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(void 0),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(re(Xi))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function DY(n){return n.appInitializer.bind(n)}function AY(n){return n.bootstrapListener.bind(n)}const $L=new He("Router Initializer");function JL(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function no(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){JL(s,i,r,o,a,"next",l)}function a(l){JL(s,i,r,o,a,"throw",l)}o(void 0)})}}const d_="141",ws={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},_a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},eF=0,cM=1,tF=2,PY=3,IY=0,uM=1,nF=2,nh=3,$a=0,ns=1,io=2,iF=1,LY=2,ro=0,fc=1,ih=2,hM=3,dM=4,rF=5,pc=100,sF=101,oF=102,fM=103,pM=104,aF=200,lF=201,cF=202,uF=203,mM=204,gM=205,hF=206,dF=207,fF=208,pF=209,mF=210,gF=0,_F=1,vF=2,f_=3,yF=4,bF=5,xF=6,wF=7,Nf=0,MF=1,SF=2,Uo=0,TF=1,CF=2,EF=3,DF=4,AF=5,p_=300,Ja=301,el=302,Bf=303,jf=304,rh=306,tl=1e3,dr=1001,sh=1002,xi=1003,Uf=1004,FY=1004,Vf=1005,kY=1005,si=1006,m_=1007,OY=1007,va=1008,NY=1008,nl=1009,RF=1010,PF=1011,_M=1012,IF=1013,il=1014,so=1015,rl=1016,LF=1017,FF=1018,mc=1020,kF=1021,OF=1022,is=1023,vM=1024,NF=1025,sl=1026,gc=1027,yM=1028,BF=1029,jF=1030,UF=1031,VF=1033,g_=33776,__=33777,v_=33778,y_=33779,bM=35840,xM=35841,wM=35842,MM=35843,zF=36196,SM=37492,TM=37496,CM=37808,EM=37809,DM=37810,AM=37811,RM=37812,PM=37813,IM=37814,LM=37815,FM=37816,kM=37817,OM=37818,NM=37819,BM=37820,jM=37821,UM=36492,VM=2200,HF=2201,GF=2202,oh=2300,_c=2301,b_=2302,vc=2400,yc=2401,zf=2402,x_=2500,zM=2501,BY=0,WF=1,HM=2,ol=3e3,mn=3001,XF=3200,GM=3201,al=0,qF=1,jY="",Vo="srgb",ll="srgb-linear",UY=0,w_=7680,VY=7681,zY=7682,HY=7683,GY=34055,WY=34056,XY=5386,qY=512,ZY=513,YY=514,KY=515,QY=516,$Y=517,JY=518,ZF=519,M_=35044,S_=35048,eK=35040,tK=35045,nK=35049,iK=35041,rK=35046,sK=35050,oK=35042,aK="100",WM="300 es",T_=1035;class rs{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const tr=[];for(let n=0;n<256;n++)tr[n]=(n<16?"0":"")+n.toString(16);let YF=1234567;const bc=Math.PI/180,Hf=180/Math.PI;function ss(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(tr[255&n]+tr[n>>8&255]+tr[n>>16&255]+tr[n>>24&255]+"-"+tr[255&e]+tr[e>>8&255]+"-"+tr[e>>16&15|64]+tr[e>>24&255]+"-"+tr[63&t|128]+tr[t>>8&255]+"-"+tr[t>>16&255]+tr[t>>24&255]+tr[255&i]+tr[i>>8&255]+tr[i>>16&255]+tr[i>>24&255]).toLowerCase()}function wi(n,e,t){return Math.max(e,Math.min(t,n))}function XM(n,e){return(n%e+e)%e}function Gf(n,e,t){return(1-t)*n+t*e}function qM(n){return 0==(n&n-1)&&0!==n}function KF(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function C_(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}var Ot=Object.freeze({__proto__:null,DEG2RAD:bc,RAD2DEG:Hf,generateUUID:ss,clamp:wi,euclideanModulo:XM,mapLinear:function lK(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function cK(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:Gf,damp:function uK(n,e,t,i){return Gf(n,e,1-Math.exp(-t*i))},pingpong:function hK(n,e=1){return e-Math.abs(XM(n,2*e)-e)},smoothstep:function dK(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function fK(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function pK(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function mK(n,e){return n+Math.random()*(e-n)},randFloatSpread:function gK(n){return n*(.5-Math.random())},seededRandom:function _K(n){void 0!==n&&(YF=n);let e=YF+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function vK(n){return n*bc},radToDeg:function yK(n){return n*Hf},isPowerOfTwo:qM,ceilPowerOfTwo:KF,floorPowerOfTwo:C_,setQuaternionFromProperEuler:function bK(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*h,l*d,a*c);break;case"YZY":n.set(l*d,a*u,l*h,a*c);break;case"ZXZ":n.set(l*h,l*d,a*u,a*c);break;case"XZX":n.set(a*u,l*p,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*p,a*c);break;case"ZYZ":n.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function wK(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}},denormalize:function xK(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}});class te{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ms{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],m=r[0],g=r[3],_=r[6],v=r[1],y=r[4],b=r[7],w=r[2],M=r[5],T=r[8];return s[0]=o*m+a*v+l*w,s[3]=o*g+a*y+l*M,s[6]=o*_+a*b+l*T,s[1]=c*m+u*v+h*w,s[4]=c*g+u*y+h*M,s[7]=c*_+u*b+h*T,s[2]=d*m+f*v+p*w,s[5]=d*g+f*y+p*M,s[8]=d*_+f*b+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+i*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(r*c-u*i)*m,e[2]=(a*i-r*o)*m,e[3]=d*m,e[4]=(u*t-r*l)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(i*l-c*t)*m,e[8]=(o*t-i*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+i*l,r[3]=t*o+i*c,r[6]=t*a+i*u,r[1]=-i*s+t*l,r[4]=-i*o+t*c,r[7]=-i*a+t*u,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function QF(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}const MK={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ah(n,e){return new MK[n](e)}function Wf(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function xc(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function E_(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const ZM={[Vo]:{[ll]:xc},[ll]:{[Vo]:E_}},Ss={legacyMode:!0,get workingColorSpace(){return ll},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(ZM[e]&&void 0!==ZM[e][t]){const i=ZM[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},$F={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vi={r:0,g:0,b:0},oo={h:0,s:0,l:0},D_={h:0,s:0,l:0};function YM(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function A_(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let lh,Ce=(()=>{class n{constructor(t,i,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=Vo){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Ss.toWorkingColorSpace(this,i),this}setRGB(t,i,r,s=ll){return this.r=t,this.g=i,this.b=r,Ss.toWorkingColorSpace(this,s),this}setHSL(t,i,r,s=ll){if(t=XM(t,1),i=wi(i,0,1),r=wi(r,0,1),0===i)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+i):r+i-r*i,a=2*r-o;this.r=YM(a,o,t+1/3),this.g=YM(a,o,t),this.b=YM(a,o,t-1/3)}return Ss.toWorkingColorSpace(this,s),this}setStyle(t,i=Vo){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Ss.toWorkingColorSpace(this,i),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Ss.toWorkingColorSpace(this,i),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseInt(o[2],10)/100,h=parseInt(o[3],10)/100;return r(o[4]),this.setHSL(c,u,h,i)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Ss.toWorkingColorSpace(this,i),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Ss.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=Vo){const r=$F[t.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=xc(t.r),this.g=xc(t.g),this.b=xc(t.b),this}copyLinearToSRGB(t){return this.r=E_(t.r),this.g=E_(t.g),this.b=E_(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Vo){return Ss.fromWorkingColorSpace(A_(this,Vi),t),wi(255*Vi.r,0,255)<<16^wi(255*Vi.g,0,255)<<8^wi(255*Vi.b,0,255)<<0}getHexString(t=Vo){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=ll){Ss.fromWorkingColorSpace(A_(this,Vi),i);const r=Vi.r,s=Vi.g,o=Vi.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const d=a-l;switch(u=h<=.5?d/(a+l):d/(2-a-l),a){case r:c=(s-o)/d+(s<o?6:0);break;case s:c=(o-r)/d+2;break;case o:c=(r-s)/d+4}c/=6}return t.h=c,t.s=u,t.l=h,t}getRGB(t,i=ll){return Ss.fromWorkingColorSpace(A_(this,Vi),i),t.r=Vi.r,t.g=Vi.g,t.b=Vi.b,t}getStyle(t=Vo){return Ss.fromWorkingColorSpace(A_(this,Vi),t),t!==Vo?`color(${t} ${Vi.r} ${Vi.g} ${Vi.b})`:`rgb(${255*Vi.r|0},${255*Vi.g|0},${255*Vi.b|0})`}offsetHSL(t,i,r){return this.getHSL(oo),oo.h+=t,oo.s+=i,oo.l+=r,this.setHSL(oo.h,oo.s,oo.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(oo),t.getHSL(D_);const r=Gf(oo.h,D_.h,i),s=Gf(oo.s,D_.s,i),o=Gf(oo.l,D_.l,i);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return n.NAMES=$F,n})();class KM{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===lh&&(lh=Wf("canvas")),lh.width=e.width,lh.height=e.height;const i=lh.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=lh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Wf("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*xc(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*xc(t[i]/255)):xc(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class wc{constructor(e=null){this.isSource=!0,this.uuid=ss(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(QM(r[o].isDataTexture?r[o].image:r[o]))}else s=QM(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function QM(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?KM.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let SK=0,fr=(()=>{class n extends rs{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=dr,s=dr,o=si,a=va,l=is,c=nl,u=1,h=ol){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:SK++}),this.uuid=ss(),this.name="",this.source=new wc(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new te(0,0),this.repeat=new te(1,1),this.center=new te(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ms,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==p_)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case tl:t.x=t.x-Math.floor(t.x);break;case dr:t.x=t.x<0?0:1;break;case sh:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case tl:t.y=t.y-Math.floor(t.y);break;case dr:t.y=t.y<0?0:1;break;case sh:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=p_,n})();class gn{constructor(e=0,t=0,i=0,r=1){this.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],m=l[2],g=l[6],_=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,b=(f+1)/2,w=(_+1)/2,M=(u+d)/4,T=(h+m)/4,x=(p+g)/4;return y>b&&y>w?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=M/i,s=T/i):b>w?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=M/r,s=x/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=T/s,r=x/s),this.set(i,r,s,t),this}let v=Math.sqrt((g-p)*(g-p)+(h-m)*(h-m)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(g-p)/v,this.y=(h-m)/v,this.z=(d-u)/v,this.w=Math.acos((c+f+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Nn extends rs{constructor(e,t,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new gn(0,0,e,t),this.scissorTest=!1,this.viewport=new gn(0,0,e,t),this.texture=new fr({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:si,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new wc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Xf extends fr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=xi,this.minFilter=xi,this.wrapR=dr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class TK extends Nn{constructor(e,t,i){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Xf(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class R_ extends fr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=xi,this.minFilter=xi,this.wrapR=dr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class CK extends Nn{constructor(e,t,i){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new R_(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class EK extends Nn{constructor(e,t,i,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class bn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(h!==m||l!==d||c!==f||u!==p){let g=1-a;const _=l*d+c*f+u*p+h*m,v=_>=0?1:-1,y=1-_*_;if(y>Number.EPSILON){const w=Math.sqrt(y),M=Math.atan2(w,_*v);g=Math.sin(g*M)/w,a=Math.sin(a*M)/w}const b=a*v;if(l=l*g+d*b,c=c*g+f*b,u=u*g+p*b,h=h*g+m*b,g===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=w,c*=w,u*=w,h*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),h=a(s/2),d=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class C{constructor(e=0,t=0,i=0){this.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(JF.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(JF.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,h=l*r+s*i-o*t,d=-s*t-o*i-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return $M.copy(this).projectOnVector(e),this.sub($M)}reflect(e){return this.sub($M.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $M=new C,JF=new bn;class zo{constructor(e=new C(1/0,1/0,1/0),t=new C(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],h=e[l+1],d=e[l+2];u<t&&(t=u),h<i&&(i=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),h=e.getY(l),d=e.getZ(l);u<t&&(t=u),h<i&&(i=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Mc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)Mc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Mc)}else null===i.boundingBox&&i.computeBoundingBox(),JM.copy(i.boundingBox),JM.applyMatrix4(e.matrixWorld),this.union(JM);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Mc),Mc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qf),P_.subVectors(this.max,qf),ch.subVectors(e.a,qf),uh.subVectors(e.b,qf),hh.subVectors(e.c,qf),cl.subVectors(uh,ch),ul.subVectors(hh,uh),Sc.subVectors(ch,hh);let t=[0,-cl.z,cl.y,0,-ul.z,ul.y,0,-Sc.z,Sc.y,cl.z,0,-cl.x,ul.z,0,-ul.x,Sc.z,0,-Sc.x,-cl.y,cl.x,0,-ul.y,ul.x,0,-Sc.y,Sc.x,0];return!(!eS(t,ch,uh,hh,P_)||(t=[1,0,0,0,1,0,0,0,1],!eS(t,ch,uh,hh,P_)))&&(I_.crossVectors(cl,ul),t=[I_.x,I_.y,I_.z],eS(t,ch,uh,hh,P_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Mc.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Mc).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ya[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ya[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ya[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ya[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ya[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ya[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ya[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ya[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ya)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ya=[new C,new C,new C,new C,new C,new C,new C,new C],Mc=new C,JM=new zo,ch=new C,uh=new C,hh=new C,cl=new C,ul=new C,Sc=new C,qf=new C,P_=new C,I_=new C,Tc=new C;function eS(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Tc.fromArray(n,s);const a=r.x*Math.abs(Tc.x)+r.y*Math.abs(Tc.y)+r.z*Math.abs(Tc.z),l=e.dot(Tc),c=t.dot(Tc),u=i.dot(Tc);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const DK=new zo,ek=new C,L_=new C,tS=new C;class ba{constructor(e=new C,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):DK.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){tS.subVectors(e,this.center);const t=tS.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(tS.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?L_.set(0,0,1).multiplyScalar(e.radius):L_.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(ek.copy(e.center).add(L_)),this.expandByPoint(ek.copy(e.center).sub(L_)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const xa=new C,nS=new C,F_=new C,hl=new C,iS=new C,k_=new C,rS=new C;class Zf{constructor(e=new C,t=new C(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,xa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=xa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(xa.copy(this.direction).multiplyScalar(t).add(this.origin),xa.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){nS.copy(e).add(t).multiplyScalar(.5),F_.copy(t).sub(e).normalize(),hl.copy(this.origin).sub(nS);const s=.5*e.distanceTo(t),o=-this.direction.dot(F_),a=hl.dot(this.direction),l=-hl.dot(F_),c=hl.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const m=1/u;h*=m,d*=m,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(F_).multiplyScalar(d).add(nS),f}intersectSphere(e,t){xa.subVectors(e.center,this.origin);const i=xa.dot(this.direction),r=xa.dot(xa)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||i!=i)&&(i=s),(o<r||r!=r)&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,xa)}intersectTriangle(e,t,i,r,s){iS.subVectors(t,e),k_.subVectors(i,e),rS.crossVectors(iS,k_);let a,o=this.direction.dot(rS);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}hl.subVectors(this.origin,e);const l=a*this.direction.dot(k_.crossVectors(hl,k_));if(l<0)return null;const c=a*this.direction.dot(iS.cross(hl));if(c<0||l+c>o)return null;const u=-a*hl.dot(rS);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ot{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c,u,h,d,f,p,m,g){const _=this.elements;return _[0]=e,_[4]=t,_[8]=i,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=l,_[2]=c,_[6]=u,_[10]=h,_[14]=d,_[3]=f,_[7]=p,_[11]=m,_[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ot).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/dh.setFromMatrixColumn(e,0).length(),s=1/dh.setFromMatrixColumn(e,1).length(),o=1/dh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-m*c,t[9]=-a*l,t[2]=m-d*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d+m*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+d*a,t[10]=o*l}else if("ZXY"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d-m*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+m,t[1]=l*h,t[5]=m*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-m*h}else if("XZY"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+m,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(AK,e,RK)}lookAt(e,t,i){const r=this.elements;return os.subVectors(e,t),0===os.lengthSq()&&(os.z=1),os.normalize(),dl.crossVectors(i,os),0===dl.lengthSq()&&(1===Math.abs(i.z)?os.x+=1e-4:os.z+=1e-4,os.normalize(),dl.crossVectors(i,os)),dl.normalize(),O_.crossVectors(os,dl),r[0]=dl.x,r[4]=O_.x,r[8]=os.x,r[1]=dl.y,r[5]=O_.y,r[9]=os.y,r[2]=dl.z,r[6]=O_.z,r[10]=os.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],m=i[6],g=i[10],_=i[14],v=i[3],y=i[7],b=i[11],w=i[15],M=r[0],T=r[4],x=r[8],E=r[12],R=r[1],F=r[5],V=r[9],H=r[13],j=r[2],q=r[6],I=r[10],U=r[14],W=r[3],z=r[7],Y=r[11],oe=r[15];return s[0]=o*M+a*R+l*j+c*W,s[4]=o*T+a*F+l*q+c*z,s[8]=o*x+a*V+l*I+c*Y,s[12]=o*E+a*H+l*U+c*oe,s[1]=u*M+h*R+d*j+f*W,s[5]=u*T+h*F+d*q+f*z,s[9]=u*x+h*V+d*I+f*Y,s[13]=u*E+h*H+d*U+f*oe,s[2]=p*M+m*R+g*j+_*W,s[6]=p*T+m*F+g*q+_*z,s[10]=p*x+m*V+g*I+_*Y,s[14]=p*E+m*H+g*U+_*oe,s[3]=v*M+y*R+b*j+w*W,s[7]=v*T+y*F+b*q+w*z,s[11]=v*x+y*V+b*I+w*Y,s[15]=v*E+y*H+b*U+w*oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*l*h-r*c*h-s*a*d+i*c*d+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*h-t*a*f-s*o*h+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*h+t*a*d+r*o*h-i*o*d+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],_=e[15],v=h*g*c-m*d*c+m*l*f-a*g*f-h*l*_+a*d*_,y=p*d*c-u*g*c-p*l*f+o*g*f+u*l*_-o*d*_,b=u*m*c-p*h*c+p*a*f-o*m*f-u*a*_+o*h*_,w=p*h*l-u*m*l-p*a*d+o*m*d+u*a*g-o*h*g,M=t*v+i*y+r*b+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/M;return e[0]=v*T,e[1]=(m*d*s-h*g*s-m*r*f+i*g*f+h*r*_-i*d*_)*T,e[2]=(a*g*s-m*l*s+m*r*c-i*g*c-a*r*_+i*l*_)*T,e[3]=(h*l*s-a*d*s-h*r*c+i*d*c+a*r*f-i*l*f)*T,e[4]=y*T,e[5]=(u*g*s-p*d*s+p*r*f-t*g*f-u*r*_+t*d*_)*T,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*_-t*l*_)*T,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*T,e[8]=b*T,e[9]=(p*h*s-u*m*s-p*i*f+t*m*f+u*i*_-t*h*_)*T,e[10]=(o*m*s-p*a*s+p*i*c-t*m*c-o*i*_+t*a*_)*T,e[11]=(u*a*s-o*h*s-u*i*c+t*h*c+o*i*f-t*a*f)*T,e[12]=w*T,e[13]=(u*m*r-p*h*r+p*i*d-t*m*d-u*i*g+t*h*g)*T,e[14]=(p*a*r-o*m*r-p*i*l+t*m*l+o*i*g-t*a*g)*T,e[15]=(o*h*r-u*a*r+u*i*l-t*h*l-o*i*d+t*a*d)*T,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,m=o*u,g=o*h,_=a*h,v=l*c,y=l*u,b=l*h,w=i.x,M=i.y,T=i.z;return r[0]=(1-(m+_))*w,r[1]=(f+b)*w,r[2]=(p-y)*w,r[3]=0,r[4]=(f-b)*M,r[5]=(1-(d+_))*M,r[6]=(g+v)*M,r[7]=0,r[8]=(p+y)*T,r[9]=(g-v)*T,r[10]=(1-(d+m))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=dh.set(r[0],r[1],r[2]).length();const o=dh.set(r[4],r[5],r[6]).length(),a=dh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ao.copy(this);const c=1/s,u=1/o,h=1/a;return ao.elements[0]*=c,ao.elements[1]*=c,ao.elements[2]*=c,ao.elements[4]*=u,ao.elements[5]*=u,ao.elements[6]*=u,ao.elements[8]*=h,ao.elements[9]*=h,ao.elements[10]*=h,t.setFromRotationMatrix(ao),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),h=(i+r)/(i-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),h=(t+e)*l,d=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const dh=new C,ao=new ot,AK=new C(0,0,0),RK=new C(1,1,1),dl=new C,O_=new C,os=new C,tk=new ot,nk=new bn;let fh=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DefaultOrder){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(wi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(wi(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-wi(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(wi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return tk.makeRotationFromQuaternion(t),this.setFromRotationMatrix(tk,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return nk.setFromEuler(this),this.setFromQuaternion(nk,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return n.DefaultOrder="XYZ",n.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],n})();class N_{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let PK=0;const ik=new C,ph=new bn,wa=new ot,B_=new C,Yf=new C,IK=new C,LK=new bn,rk=new C(1,0,0),sk=new C(0,1,0),ok=new C(0,0,1),FK={type:"added"},ak={type:"removed"};class nn extends rs{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:PK++}),this.uuid=ss(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=nn.DefaultUp.clone();const e=new C,t=new fh,i=new bn,r=new C(1,1,1);t._onChange(function s(){i.setFromEuler(t,!1)}),i._onChange(function o(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ot},normalMatrix:{value:new Ms}}),this.matrix=new ot,this.matrixWorld=new ot,this.matrixAutoUpdate=nn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new N_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ph.setFromAxisAngle(e,t),this.quaternion.multiply(ph),this}rotateOnWorldAxis(e,t){return ph.setFromAxisAngle(e,t),this.quaternion.premultiply(ph),this}rotateX(e){return this.rotateOnAxis(rk,e)}rotateY(e){return this.rotateOnAxis(sk,e)}rotateZ(e){return this.rotateOnAxis(ok,e)}translateOnAxis(e,t){return ik.copy(e).applyQuaternion(this.quaternion),this.position.add(ik.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(rk,e)}translateY(e){return this.translateOnAxis(sk,e)}translateZ(e){return this.translateOnAxis(ok,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(wa.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?B_.copy(e):B_.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Yf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wa.lookAt(Yf,B_,this.up):wa.lookAt(B_,Yf,this.up),this.quaternion.setFromRotationMatrix(wa),r&&(wa.extractRotation(r.matrixWorld),ph.setFromRotationMatrix(wa),this.quaternion.premultiply(ph.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(FK)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ak)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(ak)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),wa.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),wa.multiply(e.parent.matrixWorld)),e.applyMatrix4(wa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(void 0!==o)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yf,e,IK),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yf,LK,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)s(e.shapes,l[c]);else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(s(e.animations,this.animations[a]))}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let i=0;i<e.children.length;i++)this.add(e.children[i].clone());return this}}nn.DefaultUp=new C(0,1,0),nn.DefaultMatrixAutoUpdate=!0;const lo=new C,Ma=new C,sS=new C,Sa=new C,mh=new C,gh=new C,lk=new C,oS=new C,aS=new C,lS=new C;class as{constructor(e=new C,t=new C,i=new C){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),lo.subVectors(e,t),r.cross(lo);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){lo.subVectors(r,t),Ma.subVectors(i,t),sS.subVectors(e,t);const o=lo.dot(lo),a=lo.dot(Ma),l=lo.dot(sS),c=Ma.dot(Ma),u=Ma.dot(sS),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Sa),Sa.x>=0&&Sa.y>=0&&Sa.x+Sa.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Sa),l.set(0,0),l.addScaledVector(s,Sa.x),l.addScaledVector(o,Sa.y),l.addScaledVector(a,Sa.z),l}static isFrontFacing(e,t,i,r){return lo.subVectors(i,t),Ma.subVectors(e,t),lo.cross(Ma).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return lo.subVectors(this.c,this.b),Ma.subVectors(this.a,this.b),.5*lo.cross(Ma).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return as.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return as.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return as.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return as.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return as.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;mh.subVectors(r,i),gh.subVectors(s,i),oS.subVectors(e,i);const l=mh.dot(oS),c=gh.dot(oS);if(l<=0&&c<=0)return t.copy(i);aS.subVectors(e,r);const u=mh.dot(aS),h=gh.dot(aS);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(mh,o);lS.subVectors(e,s);const f=mh.dot(lS),p=gh.dot(lS);if(p>=0&&f<=p)return t.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(gh,a);const g=u*p-f*h;if(g<=0&&h-u>=0&&f-p>=0)return lk.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(lk,a);const _=1/(g+m+d);return o=m*_,a=d*_,t.copy(i).addScaledVector(mh,o).addScaledVector(gh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let kK=0,mi=(()=>{class n extends rs{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:kK++}),this.uuid=ss(),this.name="",this.type="Material",this.blending=fc,this.side=$a,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=mM,this.blendDst=gM,this.blendEquation=pc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=f_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ZF,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=w_,this.stencilZFail=w_,this.stencilZPass=w_,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const i in t){const r=t[i];if(void 0===r){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if("shading"===i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===iF;continue}const s=this[i];void 0!==s?s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[i]=r:console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.")}}toJSON(t){const i=void 0===t||"string"==typeof t;i&&(t={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==fc&&(r.blending=this.blending),this.side!==$a&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i){const o=s(t.textures),a=s(t.images);o.length>0&&(r.textures=o),a.length>0&&(r.images=a)}return r}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const i=t.clippingPlanes;let r=null;if(null!==i){const s=i.length;r=new Array(s);for(let o=0;o!==s;++o)r[o]=i[o].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}return n.fromType=function(){return null},n})();class nr extends mi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ce(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ri=new C,j_=new te;class En{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=M_,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Ce),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new te),t[i++]=o.x,t[i++]=o.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new C),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new gn),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)j_.fromBufferAttribute(this,t),j_.applyMatrix3(e),this.setXY(t,j_.x,j_.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Ri.fromBufferAttribute(this,t),Ri.applyMatrix3(e),this.setXYZ(t,Ri.x,Ri.y,Ri.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ri.fromBufferAttribute(this,t),Ri.applyMatrix4(e),this.setXYZ(t,Ri.x,Ri.y,Ri.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ri.fromBufferAttribute(this,t),Ri.applyNormalMatrix(e),this.setXYZ(t,Ri.x,Ri.y,Ri.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ri.fromBufferAttribute(this,t),Ri.transformDirection(e),this.setXYZ(t,Ri.x,Ri.y,Ri.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==M_&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class OK extends En{constructor(e,t,i){super(new Int8Array(e),t,i)}}class NK extends En{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class BK extends En{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class jK extends En{constructor(e,t,i){super(new Int16Array(e),t,i)}}class cS extends En{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class UK extends En{constructor(e,t,i){super(new Int32Array(e),t,i)}}class U_ extends En{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class VK extends En{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}}class $e extends En{constructor(e,t,i){super(new Float32Array(e),t,i)}}class zK extends En{constructor(e,t,i){super(new Float64Array(e),t,i)}}let HK=0;const Ts=new ot,uS=new nn,_h=new C,ls=new zo,Kf=new zo,qi=new C;class wt extends rs{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:HK++}),this.uuid=ss(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(QF(e)?U_:cS)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Ms).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ts.makeRotationFromQuaternion(e),this.applyMatrix4(Ts),this}rotateX(e){return Ts.makeRotationX(e),this.applyMatrix4(Ts),this}rotateY(e){return Ts.makeRotationY(e),this.applyMatrix4(Ts),this}rotateZ(e){return Ts.makeRotationZ(e),this.applyMatrix4(Ts),this}translate(e,t,i){return Ts.makeTranslation(e,t,i),this.applyMatrix4(Ts),this}scale(e,t,i){return Ts.makeScale(e,t,i),this.applyMatrix4(Ts),this}lookAt(e){return uS.lookAt(e),uS.updateMatrix(),this.applyMatrix4(uS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_h).negate(),this.translate(_h.x,_h.y,_h.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new $e(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new zo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new C(-1/0,-1/0,-1/0),new C(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)ls.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(qi.addVectors(this.boundingBox.min,ls.min),this.boundingBox.expandByPoint(qi),qi.addVectors(this.boundingBox.max,ls.max),this.boundingBox.expandByPoint(qi)):(this.boundingBox.expandByPoint(ls.min),this.boundingBox.expandByPoint(ls.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ba);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new C,1/0);if(e){const i=this.boundingSphere.center;if(ls.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Kf.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(qi.addVectors(ls.min,Kf.min),ls.expandByPoint(qi),qi.addVectors(ls.max,Kf.max),ls.expandByPoint(qi)):(ls.expandByPoint(Kf.min),ls.expandByPoint(Kf.max));ls.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)qi.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(qi));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)qi.fromBufferAttribute(a,c),l&&(_h.fromBufferAttribute(e,c),qi.add(_h)),r=Math.max(r,i.distanceToSquared(qi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new En(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let R=0;R<a;R++)c[R]=new C,u[R]=new C;const h=new C,d=new C,f=new C,p=new te,m=new te,g=new te,_=new C,v=new C;function y(R,F,V){h.fromArray(r,3*R),d.fromArray(r,3*F),f.fromArray(r,3*V),p.fromArray(o,2*R),m.fromArray(o,2*F),g.fromArray(o,2*V),d.sub(h),f.sub(h),m.sub(p),g.sub(p);const H=1/(m.x*g.y-g.x*m.y);!isFinite(H)||(_.copy(d).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar(H),v.copy(f).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(H),c[R].add(_),c[F].add(_),c[V].add(_),u[R].add(v),u[F].add(v),u[V].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let R=0,F=b.length;R<F;++R){const V=b[R],H=V.start;for(let q=H,I=H+V.count;q<I;q+=3)y(i[q+0],i[q+1],i[q+2])}const w=new C,M=new C,T=new C,x=new C;function E(R){T.fromArray(s,3*R),x.copy(T);const F=c[R];w.copy(F),w.sub(T.multiplyScalar(T.dot(F))).normalize(),M.crossVectors(x,F);const H=M.dot(u[R])<0?-1:1;l[4*R]=w.x,l[4*R+1]=w.y,l[4*R+2]=w.z,l[4*R+3]=H}for(let R=0,F=b.length;R<F;++R){const V=b[R],H=V.start;for(let q=H,I=H+V.count;q<I;q+=3)E(i[q+0]),E(i[q+1]),E(i[q+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new En(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new C,s=new C,o=new C,a=new C,l=new C,c=new C,u=new C,h=new C;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,g),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,m),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const o=i[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let h=0,d=c;h<u;h++,d++)o[d]=l[h]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)qi.fromBufferAttribute(e,t),qi.normalize(),e.setXYZ(t,qi.x,qi.y,qi.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let m=0,g=l.length;m<g;m++){f=a.isInterleavedBufferAttribute?l[m]*a.data.stride+a.offset:l[m]*u;for(let _=0;_<u;_++)d[p++]=c[f++]}return new En(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new wt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++)u.push(c[h].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const ck=new ot,vh=new Zf,hS=new ba,fl=new C,pl=new C,ml=new C,dS=new C,fS=new C,pS=new C,V_=new C,z_=new C,H_=new C,G_=new te,W_=new te,X_=new te,mS=new C,q_=new C;class qe extends nn{constructor(e=new wt,t=new nr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),hS.copy(i.boundingSphere),hS.applyMatrix4(s),!1===e.ray.intersectsSphere(hS))||(ck.copy(s).invert(),vh.copy(e.ray).applyMatrix4(ck),null!==i.boundingBox&&!1===vh.intersectsBox(i.boundingBox)))return;let o;const a=i.index,l=i.attributes.position,c=i.morphAttributes.position,u=i.morphTargetsRelative,h=i.attributes.uv,d=i.attributes.uv2,f=i.groups,p=i.drawRange;if(null!==a)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const _=f[m],v=r[_.materialIndex];for(let w=Math.max(_.start,p.start),M=Math.min(a.count,Math.min(_.start+_.count,p.start+p.count));w<M;w+=3){const T=a.getX(w),x=a.getX(w+1),E=a.getX(w+2);o=Z_(this,v,e,vh,l,c,u,h,d,T,x,E),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=_.materialIndex,t.push(o))}}else for(let _=Math.max(0,p.start),v=Math.min(a.count,p.start+p.count);_<v;_+=3){const y=a.getX(_),b=a.getX(_+1),w=a.getX(_+2);o=Z_(this,r,e,vh,l,c,u,h,d,y,b,w),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const _=f[m],v=r[_.materialIndex];for(let w=Math.max(_.start,p.start),M=Math.min(l.count,Math.min(_.start+_.count,p.start+p.count));w<M;w+=3)o=Z_(this,v,e,vh,l,c,u,h,d,w,w+1,w+2),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=_.materialIndex,t.push(o))}else for(let _=Math.max(0,p.start),v=Math.min(l.count,p.start+p.count);_<v;_+=3)o=Z_(this,r,e,vh,l,c,u,h,d,_,_+1,_+2),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}}function Z_(n,e,t,i,r,s,o,a,l,c,u,h){fl.fromBufferAttribute(r,c),pl.fromBufferAttribute(r,u),ml.fromBufferAttribute(r,h);const d=n.morphTargetInfluences;if(s&&d){V_.set(0,0,0),z_.set(0,0,0),H_.set(0,0,0);for(let p=0,m=s.length;p<m;p++){const g=d[p],_=s[p];0!==g&&(dS.fromBufferAttribute(_,c),fS.fromBufferAttribute(_,u),pS.fromBufferAttribute(_,h),o?(V_.addScaledVector(dS,g),z_.addScaledVector(fS,g),H_.addScaledVector(pS,g)):(V_.addScaledVector(dS.sub(fl),g),z_.addScaledVector(fS.sub(pl),g),H_.addScaledVector(pS.sub(ml),g)))}fl.add(V_),pl.add(z_),ml.add(H_)}n.isSkinnedMesh&&(n.boneTransform(c,fl),n.boneTransform(u,pl),n.boneTransform(h,ml));const f=function GK(n,e,t,i,r,s,o,a){let l;if(l=e.side===ns?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side!==io,a),null===l)return null;q_.copy(a),q_.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(q_);return c<t.near||c>t.far?null:{distance:c,point:q_.clone(),object:n}}(n,e,t,i,fl,pl,ml,mS);if(f){a&&(G_.fromBufferAttribute(a,c),W_.fromBufferAttribute(a,u),X_.fromBufferAttribute(a,h),f.uv=as.getUV(mS,fl,pl,ml,G_,W_,X_,new te)),l&&(G_.fromBufferAttribute(l,c),W_.fromBufferAttribute(l,u),X_.fromBufferAttribute(l,h),f.uv2=as.getUV(mS,fl,pl,ml,G_,W_,X_,new te));const p={a:c,b:u,c:h,normal:new C,materialIndex:0};as.getNormal(fl,pl,ml,p.normal),f.face=p}return f}class Xn extends wt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;function p(m,g,_,v,y,b,w,M,T,x,E){const R=b/T,F=w/x,V=b/2,H=w/2,j=M/2,q=T+1,I=x+1;let U=0,W=0;const z=new C;for(let Y=0;Y<I;Y++){const oe=Y*F-H;for(let $=0;$<q;$++)z[m]=($*R-V)*v,z[g]=oe*y,z[_]=j,c.push(z.x,z.y,z.z),z[m]=0,z[g]=0,z[_]=M>0?1:-1,u.push(z.x,z.y,z.z),h.push($/T),h.push(1-Y/x),U+=1}for(let Y=0;Y<x;Y++)for(let oe=0;oe<T;oe++){const me=d+oe+q*(Y+1),he=d+(oe+1)+q*(Y+1),Ae=d+(oe+1)+q*Y;l.push(d+oe+q*Y,me,Ae),l.push(me,he,Ae),W+=6}a.addGroup(f,W,E),f+=W,d+=U}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new $e(c,3)),this.setAttribute("normal",new $e(u,3)),this.setAttribute("uv",new $e(h,2))}static fromJSON(e){return new Xn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function yh(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function pr(n){const e={};for(let t=0;t<n.length;t++){const i=yh(n[t]);for(const r in i)e[r]=i[r]}return e}const Ho={clone:yh,merge:pr};class Yn extends mi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yh(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Qf extends nn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ot,this.projectionMatrix=new ot,this.projectionMatrixInverse=new ot}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class zi extends Qf{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Hf*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*bc*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Hf*Math.atan(Math.tan(.5*bc*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*bc*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class uk extends nn{constructor(e,t,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new zi(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new C(1,0,0)),this.add(r);const s=new zi(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new C(-1,0,0)),this.add(s);const o=new zi(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new C(0,1,0)),this.add(o);const a=new zi(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new C(0,-1,0)),this.add(a);const l=new zi(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new C(0,0,1)),this.add(l);const c=new zi(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new C(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=Uo,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=h,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class $f extends fr{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:Ja,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class hk extends Nn{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new $f([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:si}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Xn(5,5,5),s=new Yn({name:"CubemapFromEquirect",uniforms:yh(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:ns,blending:ro});s.uniforms.tEquirect.value=t;const o=new qe(r,s),a=t.minFilter;return t.minFilter===va&&(t.minFilter=si),new uk(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const gS=new C,qK=new C,ZK=new Ms;class Go{constructor(e=new C(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=gS.subVectors(i,t).cross(qK.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(gS),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||ZK.getNormalMatrix(e),r=this.coplanarPoint(gS).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const wh=new ba,Y_=new C;class K_{constructor(e=new Go,t=new Go,i=new Go,r=new Go,s=new Go,o=new Go){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],f=i[9],p=i[10],m=i[11],g=i[12],_=i[13],v=i[14],y=i[15];return t[0].setComponents(a-r,h-l,m-d,y-g).normalize(),t[1].setComponents(a+r,h+l,m+d,y+g).normalize(),t[2].setComponents(a+s,h+c,m+f,y+_).normalize(),t[3].setComponents(a-s,h-c,m-f,y-_).normalize(),t[4].setComponents(a-o,h-u,m-p,y-v).normalize(),t[5].setComponents(a+o,h+u,m+p,y+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),wh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(wh)}intersectsSprite(e){return wh.center.set(0,0,0),wh.radius=.7071067811865476,wh.applyMatrix4(e.matrixWorld),this.intersectsSphere(wh)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Y_.x=r.normal.x>0?e.max.x:e.min.x,Y_.y=r.normal.y>0?e.max.y:e.min.y,Y_.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Y_)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function dk(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function YK(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const d=i.get(c);return void((!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);void 0===h?i.set(c,function r(c,u){const h=c.array,d=c.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,h,d),c.onUploadCallback(),h instanceof Float32Array)p=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(h instanceof Int16Array)p=5122;else if(h instanceof Uint32Array)p=5125;else if(h instanceof Int32Array)p=5124;else if(h instanceof Int8Array)p=5120;else if(h instanceof Uint8Array)p=5121;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);p=5121}return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}(c,u)):h.version<c.version&&(function s(c,u,h){const d=u.array,f=u.updateRange;n.bindBuffer(h,c),-1===f.count?n.bufferSubData(h,0,d):(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1)}(h.buffer,c,u),h.version=c.version)}}}class Ta extends wt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,f=[],p=[],m=[],g=[];for(let _=0;_<u;_++){const v=_*d-o;for(let y=0;y<c;y++)p.push(y*h-s,-v,0),m.push(0,0,1),g.push(y/a),g.push(1-_/l)}for(let _=0;_<l;_++)for(let v=0;v<a;v++){const b=v+c*(_+1),w=v+1+c*(_+1),M=v+1+c*_;f.push(v+c*_,b,M),f.push(b,w,M)}this.setIndex(f),this.setAttribute("position",new $e(p,3)),this.setAttribute("normal",new $e(m,3)),this.setAttribute("uv",new $e(g,2))}static fromJSON(e){return new Ta(e.width,e.height,e.widthSegments,e.heightSegments)}}const $t={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Qe={common:{diffuse:{value:new Ce(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ms},uv2Transform:{value:new Ms},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new te(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ce(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ce(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ms}},sprite:{diffuse:{value:new Ce(16777215)},opacity:{value:1},center:{value:new te(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ms}}},co={basic:{uniforms:pr([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.fog]),vertexShader:$t.meshbasic_vert,fragmentShader:$t.meshbasic_frag},lambert:{uniforms:pr([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)}}]),vertexShader:$t.meshlambert_vert,fragmentShader:$t.meshlambert_frag},phong:{uniforms:pr([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)},specular:{value:new Ce(1118481)},shininess:{value:30}}]),vertexShader:$t.meshphong_vert,fragmentShader:$t.meshphong_frag},standard:{uniforms:pr([Qe.common,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.roughnessmap,Qe.metalnessmap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag},toon:{uniforms:pr([Qe.common,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.gradientmap,Qe.fog,Qe.lights,{emissive:{value:new Ce(0)}}]),vertexShader:$t.meshtoon_vert,fragmentShader:$t.meshtoon_frag},matcap:{uniforms:pr([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,{matcap:{value:null}}]),vertexShader:$t.meshmatcap_vert,fragmentShader:$t.meshmatcap_frag},points:{uniforms:pr([Qe.points,Qe.fog]),vertexShader:$t.points_vert,fragmentShader:$t.points_frag},dashed:{uniforms:pr([Qe.common,Qe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$t.linedashed_vert,fragmentShader:$t.linedashed_frag},depth:{uniforms:pr([Qe.common,Qe.displacementmap]),vertexShader:$t.depth_vert,fragmentShader:$t.depth_frag},normal:{uniforms:pr([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,{opacity:{value:1}}]),vertexShader:$t.meshnormal_vert,fragmentShader:$t.meshnormal_frag},sprite:{uniforms:pr([Qe.sprite,Qe.fog]),vertexShader:$t.sprite_vert,fragmentShader:$t.sprite_frag},background:{uniforms:{uvTransform:{value:new Ms},t2D:{value:null}},vertexShader:$t.background_vert,fragmentShader:$t.background_frag},cube:{uniforms:pr([Qe.envmap,{opacity:{value:1}}]),vertexShader:$t.cube_vert,fragmentShader:$t.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$t.equirect_vert,fragmentShader:$t.equirect_frag},distanceRGBA:{uniforms:pr([Qe.common,Qe.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$t.distanceRGBA_vert,fragmentShader:$t.distanceRGBA_frag},shadow:{uniforms:pr([Qe.lights,Qe.fog,{color:{value:new Ce(0)},opacity:{value:1}}]),vertexShader:$t.shadow_vert,fragmentShader:$t.shadow_frag}};function q$(n,e,t,i,r,s){const o=new Ce(0);let l,c,a=!0===r?0:1,u=null,h=0,d=null;function p(m,g){t.buffers.color.setClear(m.r,m.g,m.b,g,s)}return{getClearColor:function(){return o},setClearColor:function(m,g=1){o.set(m),a=g,p(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(m){a=m,p(o,a)},render:function f(m,g){let _=!1,v=!0===g.isScene?g.background:null;v&&v.isTexture&&(v=e.get(v));const y=n.xr,b=y.getSession&&y.getSession();b&&"additive"===b.environmentBlendMode&&(v=null),null===v?p(o,a):v&&v.isColor&&(p(v,1),_=!0),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),v&&(v.isCubeTexture||v.mapping===rh)?(void 0===c&&(c=new qe(new Xn(1,1,1),new Yn({name:"BackgroundCubeMaterial",uniforms:yh(co.cube.uniforms),vertexShader:co.cube.vertexShader,fragmentShader:co.cube.fragmentShader,side:ns,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(w,M,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=v,c.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,(u!==v||h!==v.version||d!==n.toneMapping)&&(c.material.needsUpdate=!0,u=v,h=v.version,d=n.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null)):v&&v.isTexture&&(void 0===l&&(l=new qe(new Ta(2,2),new Yn({name:"BackgroundMaterial",uniforms:yh(co.background.uniforms),vertexShader:co.background.vertexShader,fragmentShader:co.background.fragmentShader,side:$a,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=v,!0===v.matrixAutoUpdate&&v.updateMatrix(),l.material.uniforms.uvTransform.value.copy(v.matrix),(u!==v||h!==v.version||d!==n.toneMapping)&&(l.material.needsUpdate=!0,u=v,h=v.version,d=n.toneMapping),l.layers.enableAll(),m.unshift(l,l.geometry,l.material,0,0,null))}}}function Z$(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(j){return i.isWebGL2?n.bindVertexArray(j):s.bindVertexArrayOES(j)}function p(j){return i.isWebGL2?n.deleteVertexArray(j):s.deleteVertexArrayOES(j)}function g(j){const q=[],I=[],U=[];for(let W=0;W<r;W++)q[W]=0,I[W]=0,U[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:I,attributeDivisors:U,object:j,attributes:{},index:null}}function y(){const j=c.newAttributes;for(let q=0,I=j.length;q<I;q++)j[q]=0}function b(j){w(j,0)}function w(j,q){const U=c.enabledAttributes,W=c.attributeDivisors;c.newAttributes[j]=1,0===U[j]&&(n.enableVertexAttribArray(j),U[j]=1),W[j]!==q&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](j,q),W[j]=q)}function M(){const j=c.newAttributes,q=c.enabledAttributes;for(let I=0,U=q.length;I<U;I++)q[I]!==j[I]&&(n.disableVertexAttribArray(I),q[I]=0)}function T(j,q,I,U,W,z){!0!==i.isWebGL2||5124!==I&&5125!==I?n.vertexAttribPointer(j,q,I,U,W,z):n.vertexAttribIPointer(j,q,I,W,z)}function V(){H(),u=!0,c!==l&&(c=l,f(c.object))}function H(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function h(j,q,I,U,W){let z=!1;if(o){const Y=function m(j,q,I){const U=!0===I.wireframe;let W=a[j.id];void 0===W&&(W={},a[j.id]=W);let z=W[q.id];void 0===z&&(z={},W[q.id]=z);let Y=z[U];return void 0===Y&&(Y=g(function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),z[U]=Y),Y}(U,I,q);c!==Y&&(c=Y,f(c.object)),z=function _(j,q,I,U){const W=c.attributes,z=q.attributes;let Y=0;const oe=I.getAttributes();for(const $ in oe)if(oe[$].location>=0){const he=W[$];let Ae=z[$];if(void 0===Ae&&("instanceMatrix"===$&&j.instanceMatrix&&(Ae=j.instanceMatrix),"instanceColor"===$&&j.instanceColor&&(Ae=j.instanceColor)),void 0===he||he.attribute!==Ae||Ae&&he.data!==Ae.data)return!0;Y++}return c.attributesNum!==Y||c.index!==U}(j,U,I,W),z&&function v(j,q,I,U){const W={},z=q.attributes;let Y=0;const oe=I.getAttributes();for(const $ in oe)if(oe[$].location>=0){let he=z[$];void 0===he&&("instanceMatrix"===$&&j.instanceMatrix&&(he=j.instanceMatrix),"instanceColor"===$&&j.instanceColor&&(he=j.instanceColor));const Ae={};Ae.attribute=he,he&&he.data&&(Ae.data=he.data),W[$]=Ae,Y++}c.attributes=W,c.attributesNum=Y,c.index=U}(j,U,I,W)}else{const Y=!0===q.wireframe;(c.geometry!==U.id||c.program!==I.id||c.wireframe!==Y)&&(c.geometry=U.id,c.program=I.id,c.wireframe=Y,z=!0)}null!==W&&t.update(W,34963),(z||u)&&(u=!1,function x(j,q,I,U){if(!1===i.isWebGL2&&(j.isInstancedMesh||U.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const W=U.attributes,z=I.getAttributes(),Y=q.defaultAttributeValues;for(const oe in z){const $=z[oe];if($.location>=0){let me=W[oe];if(void 0===me&&("instanceMatrix"===oe&&j.instanceMatrix&&(me=j.instanceMatrix),"instanceColor"===oe&&j.instanceColor&&(me=j.instanceColor)),void 0!==me){const he=me.normalized,Ae=me.itemSize,J=t.get(me);if(void 0===J)continue;const X=J.buffer,de=J.type,Le=J.bytesPerElement;if(me.isInterleavedBufferAttribute){const _e=me.data,st=_e.stride,ue=me.offset;if(_e.isInstancedInterleavedBuffer){for(let fe=0;fe<$.locationSize;fe++)w($.location+fe,_e.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===U._maxInstanceCount&&(U._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let fe=0;fe<$.locationSize;fe++)b($.location+fe);n.bindBuffer(34962,X);for(let fe=0;fe<$.locationSize;fe++)T($.location+fe,Ae/$.locationSize,de,he,st*Le,(ue+Ae/$.locationSize*fe)*Le)}else{if(me.isInstancedBufferAttribute){for(let _e=0;_e<$.locationSize;_e++)w($.location+_e,me.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===U._maxInstanceCount&&(U._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let _e=0;_e<$.locationSize;_e++)b($.location+_e);n.bindBuffer(34962,X);for(let _e=0;_e<$.locationSize;_e++)T($.location+_e,Ae/$.locationSize,de,he,Ae*Le,Ae/$.locationSize*_e*Le)}}else if(void 0!==Y){const he=Y[oe];if(void 0!==he)switch(he.length){case 2:n.vertexAttrib2fv($.location,he);break;case 3:n.vertexAttrib3fv($.location,he);break;case 4:n.vertexAttrib4fv($.location,he);break;default:n.vertexAttrib1fv($.location,he)}}}}M()}(j,q,I,U),null!==W&&n.bindBuffer(34963,t.get(W).buffer))},reset:V,resetDefaultState:H,dispose:function E(){V();for(const j in a){const q=a[j];for(const I in q){const U=q[I];for(const W in U)p(U[W].object),delete U[W];delete q[I]}delete a[j]}},releaseStatesOfGeometry:function R(j){if(void 0===a[j.id])return;const q=a[j.id];for(const I in q){const U=q[I];for(const W in U)p(U[W].object),delete U[W];delete q[I]}delete a[j.id]},releaseStatesOfProgram:function F(j){for(const q in a){const I=a[q];if(void 0===I[j.id])continue;const U=I[j.id];for(const W in U)p(U[W].object),delete U[W];delete I[j.id]}},initAttributes:y,enableAttribute:b,disableUnusedAttributes:M}}function Y$(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,h){if(0===h)return;let d,f;if(r)d=n,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,c,u,h),t.update(u,s,h)}}function K$(n,e,t){let i;function s(T){if("highp"===T){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return"mediump"===T&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=n.getParameter(34930),d=n.getParameter(35660),f=n.getParameter(3379),p=n.getParameter(34076),m=n.getParameter(34921),g=n.getParameter(36347),_=n.getParameter(36348),v=n.getParameter(36349),y=d>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:_,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:o?n.getParameter(36183):0}}function Q$(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Go,a=new Ms,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,f,p){const m=null!==h?h.length:0;let g=null;if(0!==m){if(g=l.value,!0!==p||null===g){const _=f+4*m,v=d.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<_)&&(g=new Float32Array(_));for(let y=0,b=f;y!==m;++y,b+=4)o.copy(h[y]).applyMatrix4(v,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d,f){const p=0!==h.length||d||0!==i||r;return r=d,t=u(h,f,0),i=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,_=n.get(h);if(!r||null===p||0===p.length||s&&!g)s?u(null):c();else{const v=s?0:i,y=4*v;let b=_.clippingState||null;l.value=b,b=u(p,d,y,f);for(let w=0;w!==y;++w)b[w]=t[w];_.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}}}function $$(n){let e=new WeakMap;function t(o,a){return a===Bf?o.mapping=Ja:a===jf&&(o.mapping=el),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===Bf||a===jf){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new hk(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}co.physical={uniforms:pr([co.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new te(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ce(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new te},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ce(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ce(1,1,1)},specularColorMap:{value:null}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag};class Cc extends Qf{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const fk=[.125,.215,.35,.446,.526,.582],_S=new Cc,pk=new Ce;let vS=null;const Dc=(1+Math.sqrt(5))/2,Sh=1/Dc,mk=[new C(1,1,1),new C(-1,1,1),new C(1,1,-1),new C(-1,1,-1),new C(0,Dc,Sh),new C(0,Dc,-Sh),new C(Sh,0,Dc),new C(-Sh,0,Dc),new C(Dc,Sh,0),new C(-Dc,Sh,0)];class yS{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){vS=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=vk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=_k(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(vS),e.scissorTest=!1,Q_(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Ja||e.mapping===el?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),vS=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:si,minFilter:si,generateMipmaps:!1,type:rl,format:is,encoding:ol,depthBuffer:!1},r=gk(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=gk(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function J$(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+fk.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=fk[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,_=1,v=new Float32Array(m*p*f),y=new Float32Array(g*p*f),b=new Float32Array(_*p*f);for(let M=0;M<f;M++){const T=M%3*2/3-1,x=M>2?0:-1;v.set([T,x,0,T+2/3,x,0,T+2/3,x+1,0,T,x,0,T+2/3,x+1,0,T,x+1,0],m*p*M),y.set(d,g*p*M),b.set([M,M,M,M,M,M],_*p*M)}const w=new wt;w.setAttribute("position",new En(v,m)),w.setAttribute("uv",new En(y,g)),w.setAttribute("faceIndex",new En(b,_)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function eJ(n,e,t){const i=new Float32Array(20),r=new C(0,1,0);return new Yn({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ro,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new qe(this._lodPlanes[0],e);this._renderer.compile(t,_S)}_sceneToCubeUV(e,t,i,r){const a=new zi(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(pk),u.toneMapping=Uo,u.autoClear=!1;const f=new nr({name:"PMREM.Background",side:ns,depthWrite:!1,depthTest:!1}),p=new qe(new Xn,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(pk),m=!0);for(let _=0;_<6;_++){const v=_%3;0===v?(a.up.set(0,l[_],0),a.lookAt(c[_],0,0)):1===v?(a.up.set(0,0,l[_]),a.lookAt(0,c[_],0)):(a.up.set(0,l[_],0),a.lookAt(0,0,c[_]));const y=this._cubeSize;Q_(r,v*y,_>2?y:0,y,y),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Ja||e.mapping===el;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=vk()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=_k());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new qe(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Q_(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,_S)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,mk[(r-1)%mk.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new qe(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,g=isFinite(s)?1+Math.floor(3*m):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const _=[];let v=0;for(let T=0;T<20;++T){const x=T/m,E=Math.exp(-x*x/2);_.push(E),0===T?v+=E:T<g&&(v+=2*E)}for(let T=0;T<_.length;T++)_[T]=_[T]/v;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=_,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const b=this._sizeLods[r];Q_(t,3*b*(r>y-4?r-y+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(h,_S)}}function gk(n,e,t){const i=new Nn(n,e,t);return i.texture.mapping=rh,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Q_(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function _k(){return new Yn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:ro,depthTest:!1,depthWrite:!1})}function vk(){return new Yn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ro,depthTest:!1,depthWrite:!1})}function tJ(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===Bf||l===jf,u=l===Ja||l===el;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new yS(n)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(h)){null===t&&(t=new yS(n));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function nJ(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function iJ(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function c(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(null!==f){const v=f.array;m=f.version;for(let y=0,b=v.length;y<b;y+=3){const w=v[y+0],M=v[y+1],T=v[y+2];d.push(w,M,M,T,T,w)}}else{m=p.version;for(let y=0,b=p.array.length/3-1;y<b;y+=3){const w=y+0,M=y+1,T=y+2;d.push(w,M,M,T,T,w)}}const g=new(QF(d)?U_:cS)(d,1);g.version=m;const _=s.get(h);_&&e.remove(_),s.set(h,g)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function l(h){const d=h.attributes;for(const p in d)e.update(d[p],34962);const f=h.morphAttributes;for(const p in f){const m=f[p];for(let g=0,_=m.length;g<_;g++)e.update(m[g],34962)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&c(h)}else c(h);return s.get(h)}}}function rJ(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(d){s=d},this.setIndex=function c(d){a=d.type,l=d.bytesPerElement},this.render=function u(d,f){n.drawElements(s,f,a,d*l),t.update(f,s,1)},this.renderInstances=function h(d,f,p){if(0===p)return;let m,g;if(r)m=n,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===m)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[g](s,f,a,d*l,p),t.update(f,s,p)}}function sJ(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function oJ(n,e){return n[0]-e[0]}function aJ(n,e){return Math.abs(e[1])-Math.abs(n[1])}function xS(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function lJ(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new gn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,h,d){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==p?p.length:0;let g=s.get(u);if(void 0===g||g.count!==m){let q=function(){H.dispose(),s.delete(u),u.removeEventListener("dispose",q)};void 0!==g&&g.texture.dispose();const y=void 0!==u.morphAttributes.position,b=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],T=u.morphAttributes.normal||[],x=u.morphAttributes.color||[];let E=0;!0===y&&(E=1),!0===b&&(E=2),!0===w&&(E=3);let R=u.attributes.position.count*E,F=1;R>e.maxTextureSize&&(F=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const V=new Float32Array(R*F*4*m),H=new Xf(V,R,F,m);H.type=so,H.needsUpdate=!0;const j=4*E;for(let I=0;I<m;I++){const U=M[I],W=T[I],z=x[I],Y=R*F*4*I;for(let oe=0;oe<U.count;oe++){const $=oe*j;!0===y&&(o.fromBufferAttribute(U,oe),!0===U.normalized&&xS(o,U),V[Y+$+0]=o.x,V[Y+$+1]=o.y,V[Y+$+2]=o.z,V[Y+$+3]=0),!0===b&&(o.fromBufferAttribute(W,oe),!0===W.normalized&&xS(o,W),V[Y+$+4]=o.x,V[Y+$+5]=o.y,V[Y+$+6]=o.z,V[Y+$+7]=0),!0===w&&(o.fromBufferAttribute(z,oe),!0===z.normalized&&xS(o,z),V[Y+$+8]=o.x,V[Y+$+9]=o.y,V[Y+$+10]=o.z,V[Y+$+11]=4===z.itemSize?o.w:1)}}g={count:m,texture:H,size:new te(R,F)},s.set(u,g),u.addEventListener("dispose",q)}let _=0;for(let y=0;y<f.length;y++)_+=f[y];const v=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(n,"morphTargetBaseInfluence",v),d.getUniforms().setValue(n,"morphTargetInfluences",f),d.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const p=void 0===f?0:f.length;let m=i[u.id];if(void 0===m||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];i[u.id]=m}for(let b=0;b<p;b++){const w=m[b];w[0]=b,w[1]=f[b]}m.sort(aJ);for(let b=0;b<8;b++)b<p&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(oJ);const g=u.morphAttributes.position,_=u.morphAttributes.normal;let v=0;for(let b=0;b<8;b++){const w=a[b],M=w[0],T=w[1];M!==Number.MAX_SAFE_INTEGER&&T?(g&&u.getAttribute("morphTarget"+b)!==g[M]&&u.setAttribute("morphTarget"+b,g[M]),_&&u.getAttribute("morphNormal"+b)!==_[M]&&u.setAttribute("morphNormal"+b,_[M]),r[b]=T,v+=T):(g&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),_&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}const y=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(n,"morphTargetBaseInfluence",y),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function cJ(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,h=e.get(l,l.geometry);return r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),h},dispose:function o(){r=new WeakMap}}}const yk=new fr,bk=new Xf,xk=new R_,wk=new $f,Mk=[],Sk=[],Tk=new Float32Array(16),Ck=new Float32Array(9),Ek=new Float32Array(4);function Th(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=Mk[r];if(void 0===s&&(s=new Float32Array(r),Mk[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Dr(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ar(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function $_(n,e){let t=Sk[e];void 0===t&&(t=new Int32Array(e),Sk[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function uJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function hJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Dr(t,e))return;n.uniform2fv(this.addr,e),Ar(t,e)}}function dJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Dr(t,e))return;n.uniform3fv(this.addr,e),Ar(t,e)}}function fJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Dr(t,e))return;n.uniform4fv(this.addr,e),Ar(t,e)}}function pJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ar(t,e)}else{if(Dr(t,i))return;Ek.set(i),n.uniformMatrix2fv(this.addr,!1,Ek),Ar(t,i)}}function mJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ar(t,e)}else{if(Dr(t,i))return;Ck.set(i),n.uniformMatrix3fv(this.addr,!1,Ck),Ar(t,i)}}function gJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Dr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ar(t,e)}else{if(Dr(t,i))return;Tk.set(i),n.uniformMatrix4fv(this.addr,!1,Tk),Ar(t,i)}}function _J(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function vJ(n,e){const t=this.cache;Dr(t,e)||(n.uniform2iv(this.addr,e),Ar(t,e))}function yJ(n,e){const t=this.cache;Dr(t,e)||(n.uniform3iv(this.addr,e),Ar(t,e))}function bJ(n,e){const t=this.cache;Dr(t,e)||(n.uniform4iv(this.addr,e),Ar(t,e))}function xJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function wJ(n,e){const t=this.cache;Dr(t,e)||(n.uniform2uiv(this.addr,e),Ar(t,e))}function MJ(n,e){const t=this.cache;Dr(t,e)||(n.uniform3uiv(this.addr,e),Ar(t,e))}function SJ(n,e){const t=this.cache;Dr(t,e)||(n.uniform4uiv(this.addr,e),Ar(t,e))}function TJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||yk,r)}function CJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||xk,r)}function EJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||wk,r)}function DJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||bk,r)}function RJ(n,e){n.uniform1fv(this.addr,e)}function PJ(n,e){const t=Th(e,this.size,2);n.uniform2fv(this.addr,t)}function IJ(n,e){const t=Th(e,this.size,3);n.uniform3fv(this.addr,t)}function LJ(n,e){const t=Th(e,this.size,4);n.uniform4fv(this.addr,t)}function FJ(n,e){const t=Th(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function kJ(n,e){const t=Th(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function OJ(n,e){const t=Th(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function NJ(n,e){n.uniform1iv(this.addr,e)}function BJ(n,e){n.uniform2iv(this.addr,e)}function jJ(n,e){n.uniform3iv(this.addr,e)}function UJ(n,e){n.uniform4iv(this.addr,e)}function VJ(n,e){n.uniform1uiv(this.addr,e)}function zJ(n,e){n.uniform2uiv(this.addr,e)}function HJ(n,e){n.uniform3uiv(this.addr,e)}function GJ(n,e){n.uniform4uiv(this.addr,e)}function WJ(n,e,t){const i=e.length,r=$_(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2D(e[s]||yk,r[s])}function XJ(n,e,t){const i=e.length,r=$_(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture3D(e[s]||xk,r[s])}function qJ(n,e,t){const i=e.length,r=$_(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTextureCube(e[s]||wk,r[s])}function ZJ(n,e,t){const i=e.length,r=$_(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||bk,r[s])}class KJ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function AJ(n){switch(n){case 5126:return uJ;case 35664:return hJ;case 35665:return dJ;case 35666:return fJ;case 35674:return pJ;case 35675:return mJ;case 35676:return gJ;case 5124:case 35670:return _J;case 35667:case 35671:return vJ;case 35668:case 35672:return yJ;case 35669:case 35673:return bJ;case 5125:return xJ;case 36294:return wJ;case 36295:return MJ;case 36296:return SJ;case 35678:case 36198:case 36298:case 36306:case 35682:return TJ;case 35679:case 36299:case 36307:return CJ;case 35680:case 36300:case 36308:case 36293:return EJ;case 36289:case 36303:case 36311:case 36292:return DJ}}(t.type)}}class QJ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function YJ(n){switch(n){case 5126:return RJ;case 35664:return PJ;case 35665:return IJ;case 35666:return LJ;case 35674:return FJ;case 35675:return kJ;case 35676:return OJ;case 5124:case 35670:return NJ;case 35667:case 35671:return BJ;case 35668:case 35672:return jJ;case 35669:case 35673:return UJ;case 5125:return VJ;case 36294:return zJ;case 36295:return HJ;case 36296:return GJ;case 35678:case 36198:case 36298:case 36306:case 35682:return WJ;case 35679:case 36299:case 36307:return XJ;case 35680:case 36300:case 36308:case 36293:return qJ;case 36289:case 36303:case 36311:case 36292:return ZJ}}(t.type)}}class $J{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const wS=/(\w+)(\])?(\[|\.)?/g;function Dk(n,e){n.seq.push(e),n.map[e.id]=e}function JJ(n,e,t){const i=n.name,r=i.length;for(wS.lastIndex=0;;){const s=wS.exec(i),o=wS.lastIndex;let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&o+2===r){Dk(t,void 0===c?new KJ(a,n,e):new QJ(a,n,e));break}{let h=t.map[a];void 0===h&&(h=new $J(a),Dk(t,h)),t=h}}}class J_{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);JJ(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function Ak(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let eee=0;function Rk(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function tee(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function iee(n,e){const t=function nee(n){switch(n){case ol:return["Linear","( value )"];case mn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ree(n,e){let t;switch(e){case TF:t="Linear";break;case CF:t="Reinhard";break;case EF:t="OptimizedCineon";break;case DF:t="ACESFilmic";break;case AF:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Jf(n){return""!==n}function Pk(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ik(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const lee=/^[ \t]*#include +<([\w\d./]+)>/gm;function MS(n){return n.replace(lee,cee)}function cee(n,e){const t=$t[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return MS(t)}const uee=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,hee=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Lk(n){return n.replace(hee,Fk).replace(uee,dee)}function dee(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Fk(0,e,t,i)}function Fk(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function kk(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function vee(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function fee(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===uM?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===nF?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===nh&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function pee(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ja:case el:e="ENVMAP_TYPE_CUBE";break;case rh:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function mee(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===el&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function gee(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Nf:e="ENVMAP_BLENDING_MULTIPLY";break;case MF:e="ENVMAP_BLENDING_MIX";break;case SF:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function _ee(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function see(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Jf).join("\n")}(t),p=function oee(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),m=r.createProgram();let g,_,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[p].filter(Jf).join("\n"),g.length>0&&(g+="\n"),_=[f,p].filter(Jf).join("\n"),_.length>0&&(_+="\n")):(g=[kk(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Jf).join("\n"),_=[f,kk(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Uo?"#define TONE_MAPPING":"",t.toneMapping!==Uo?$t.tonemapping_pars_fragment:"",t.toneMapping!==Uo?ree("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",$t.encodings_pars_fragment,iee("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Jf).join("\n")),o=MS(o),o=Pk(o,t),o=Ik(o,t),a=MS(a),a=Pk(a,t),a=Ik(a,t),o=Lk(o),a=Lk(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in",t.glslVersion===WM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===WM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const b=v+_+a,w=Ak(r,35633,v+g+o),M=Ak(r,35632,b);if(r.attachShader(m,w),r.attachShader(m,M),void 0!==t.index0AttributeName?r.bindAttribLocation(m,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),n.debug.checkShaderErrors){const E=r.getProgramInfoLog(m).trim(),R=r.getShaderInfoLog(w).trim(),F=r.getShaderInfoLog(M).trim();let V=!0,H=!0;if(!1===r.getProgramParameter(m,35714)){V=!1;const j=Rk(r,w,"vertex"),q=Rk(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+E+"\n"+j+"\n"+q)}else""!==E?console.warn("THREE.WebGLProgram: Program Info Log:",E):(""===R||""===F)&&(H=!1);H&&(this.diagnostics={runnable:V,programLog:E,vertexShader:{log:R,prefix:g},fragmentShader:{log:F,prefix:_}})}let T,x;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===T&&(T=new J_(r,m)),T},this.getAttributes=function(){return void 0===x&&(x=function aee(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,m)),x},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=eee++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=M,this}let yee=0;class bee{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const i=new xee(e);t.set(e,i)}return t.get(e)}}class xee{constructor(e){this.id=yee++,this.code=e,this.usedTimes=0}}function wee(n,e,t,i,r,s,o){const a=new N_,l=new bee,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(x,E,R,F,V){const H=F.fog,j=V.geometry,I=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?F.environment:null)),U=I&&I.mapping===rh?I.image.height:null,W=p[x.type];null!==x.precision&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const z=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,Y=void 0!==z?z.length:0;let $,me,he,Ae,oe=0;if(void 0!==j.morphAttributes.position&&(oe=1),void 0!==j.morphAttributes.normal&&(oe=2),void 0!==j.morphAttributes.color&&(oe=3),W){const st=co[W];$=st.vertexShader,me=st.fragmentShader}else $=x.vertexShader,me=x.fragmentShader,l.update(x),he=l.getVertexShaderID(x),Ae=l.getFragmentShaderID(x);const J=n.getRenderTarget(),de=x.clearcoat>0,Le=x.iridescence>0;return{isWebGL2:u,shaderID:W,shaderName:x.type,vertexShader:$,fragmentShader:me,defines:x.defines,customVertexShaderID:he,customFragmentShaderID:Ae,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:f,instancing:!0===V.isInstancedMesh,instancingColor:!0===V.isInstancedMesh&&null!==V.instanceColor,supportsVertexTextures:d,outputEncoding:null===J?n.outputEncoding:!0===J.isXRRenderTarget?J.texture.encoding:ol,map:!!x.map,matcap:!!x.matcap,envMap:!!I,envMapMode:I&&I.mapping,envMapCubeUVHeight:U,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===qF,tangentSpaceNormalMap:x.normalMapType===al,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===mn,clearcoat:de,clearcoatMap:de&&!!x.clearcoatMap,clearcoatRoughnessMap:de&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:de&&!!x.clearcoatNormalMap,iridescence:Le,iridescenceMap:Le&&!!x.iridescenceMap,iridescenceThicknessMap:Le&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&x.blending===fc,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!j.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!j.attributes.color&&4===j.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!H,useFog:!0===x.fog,fogExp2:H&&H.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===V.isSkinnedMesh,morphTargets:void 0!==j.morphAttributes.position,morphNormals:void 0!==j.morphAttributes.normal,morphColors:void 0!==j.morphAttributes.color,morphTargetsCount:Y,morphTextureStride:oe,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:Uo,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===io,flipSided:x.side===ns,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function g(x){const E=[];if(x.shaderID?E.push(x.shaderID):(E.push(x.customVertexShaderID),E.push(x.customFragmentShaderID)),void 0!==x.defines)for(const R in x.defines)E.push(R),E.push(x.defines[R]);return!1===x.isRawShaderMaterial&&(function _(x,E){x.push(E.precision),x.push(E.outputEncoding),x.push(E.envMapMode),x.push(E.envMapCubeUVHeight),x.push(E.combine),x.push(E.vertexUvs),x.push(E.fogExp2),x.push(E.sizeAttenuation),x.push(E.morphTargetsCount),x.push(E.morphAttributeCount),x.push(E.numDirLights),x.push(E.numPointLights),x.push(E.numSpotLights),x.push(E.numHemiLights),x.push(E.numRectAreaLights),x.push(E.numDirLightShadows),x.push(E.numPointLightShadows),x.push(E.numSpotLightShadows),x.push(E.shadowMapType),x.push(E.toneMapping),x.push(E.numClippingPlanes),x.push(E.numClipIntersection),x.push(E.depthPacking)}(E,x),function v(x,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),E.fog&&a.enable(33),x.push(a.mask),a.disableAll(),E.useFog&&a.enable(0),E.flatShading&&a.enable(1),E.logarithmicDepthBuffer&&a.enable(2),E.skinning&&a.enable(3),E.morphTargets&&a.enable(4),E.morphNormals&&a.enable(5),E.morphColors&&a.enable(6),E.premultipliedAlpha&&a.enable(7),E.shadowMapEnabled&&a.enable(8),E.physicallyCorrectLights&&a.enable(9),E.doubleSided&&a.enable(10),E.flipSided&&a.enable(11),E.useDepthPacking&&a.enable(12),E.dithering&&a.enable(13),E.specularIntensityMap&&a.enable(14),E.specularColorMap&&a.enable(15),E.transmission&&a.enable(16),E.transmissionMap&&a.enable(17),E.thicknessMap&&a.enable(18),E.sheen&&a.enable(19),E.sheenColorMap&&a.enable(20),E.sheenRoughnessMap&&a.enable(21),E.decodeVideoTexture&&a.enable(22),E.opaque&&a.enable(23),x.push(a.mask)}(E,x),E.push(n.outputEncoding)),E.push(x.customProgramCacheKey),E.join()},getUniforms:function y(x){const E=p[x.type];let R;return R=E?Ho.clone(co[E].uniforms):x.uniforms,R},acquireProgram:function b(x,E){let R;for(let F=0,V=c.length;F<V;F++){const H=c[F];if(H.cacheKey===E){R=H,++R.usedTimes;break}}return void 0===R&&(R=new vee(n,E,x,s),c.push(R)),R},releaseProgram:function w(x){if(0==--x.usedTimes){const E=c.indexOf(x);c[E]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function M(x){l.remove(x)},programs:c,dispose:function T(){l.dispose()}}}function Mee(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function See(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Ok(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Nk(){const n=[];let e=0;const t=[],i=[],r=[];function o(h,d,f,p,m,g){let _=n[e];return void 0===_?(_={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:g},n[e]=_):(_.id=h.id,_.object=h,_.geometry=d,_.material=f,_.groupOrder=p,_.renderOrder=h.renderOrder,_.z=m,_.group=g),e++,_}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(h,d,f,p,m,g){const _=o(h,d,f,p,m,g);f.transmission>0?i.push(_):!0===f.transparent?r.push(_):t.push(_)},unshift:function l(h,d,f,p,m,g){const _=o(h,d,f,p,m,g);f.transmission>0?i.unshift(_):!0===f.transparent?r.unshift(_):t.unshift(_)},finish:function u(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(h,d){t.length>1&&t.sort(h||See),i.length>1&&i.sort(d||Ok),r.length>1&&r.sort(d||Ok)}}}function Tee(){let n=new WeakMap;return{get:function e(i,r){let s;return!1===n.has(i)?(s=new Nk,n.set(i,[s])):r>=n.get(i).length?(s=new Nk,n.get(i).push(s)):s=n.get(i)[r],s},dispose:function t(){n=new WeakMap}}}function Cee(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new C,color:new Ce};break;case"SpotLight":t={position:new C,direction:new C,color:new Ce,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new C,color:new Ce,distance:0,decay:0};break;case"HemisphereLight":t={direction:new C,skyColor:new Ce,groundColor:new Ce};break;case"RectAreaLight":t={color:new Ce,position:new C,halfWidth:new C,halfHeight:new C}}return n[e.id]=t,t}}}let Dee=0;function Aee(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function Ree(n,e){const t=new Cee,i=function Eee(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new C);const s=new C,o=new ot,a=new ot;return{setup:function l(u,h){let d=0,f=0,p=0;for(let E=0;E<9;E++)r.probe[E].set(0,0,0);let m=0,g=0,_=0,v=0,y=0,b=0,w=0,M=0;u.sort(Aee);const T=!0!==h?Math.PI:1;for(let E=0,R=u.length;E<R;E++){const F=u[E],V=F.color,H=F.intensity,j=F.distance,q=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)d+=V.r*H*T,f+=V.g*H*T,p+=V.b*H*T;else if(F.isLightProbe)for(let I=0;I<9;I++)r.probe[I].addScaledVector(F.sh.coefficients[I],H);else if(F.isDirectionalLight){const I=t.get(F);if(I.color.copy(F.color).multiplyScalar(F.intensity*T),F.castShadow){const U=F.shadow,W=i.get(F);W.shadowBias=U.bias,W.shadowNormalBias=U.normalBias,W.shadowRadius=U.radius,W.shadowMapSize=U.mapSize,r.directionalShadow[m]=W,r.directionalShadowMap[m]=q,r.directionalShadowMatrix[m]=F.shadow.matrix,b++}r.directional[m]=I,m++}else if(F.isSpotLight){const I=t.get(F);if(I.position.setFromMatrixPosition(F.matrixWorld),I.color.copy(V).multiplyScalar(H*T),I.distance=j,I.coneCos=Math.cos(F.angle),I.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),I.decay=F.decay,F.castShadow){const U=F.shadow,W=i.get(F);W.shadowBias=U.bias,W.shadowNormalBias=U.normalBias,W.shadowRadius=U.radius,W.shadowMapSize=U.mapSize,r.spotShadow[_]=W,r.spotShadowMap[_]=q,r.spotShadowMatrix[_]=F.shadow.matrix,M++}r.spot[_]=I,_++}else if(F.isRectAreaLight){const I=t.get(F);I.color.copy(V).multiplyScalar(H),I.halfWidth.set(.5*F.width,0,0),I.halfHeight.set(0,.5*F.height,0),r.rectArea[v]=I,v++}else if(F.isPointLight){const I=t.get(F);if(I.color.copy(F.color).multiplyScalar(F.intensity*T),I.distance=F.distance,I.decay=F.decay,F.castShadow){const U=F.shadow,W=i.get(F);W.shadowBias=U.bias,W.shadowNormalBias=U.normalBias,W.shadowRadius=U.radius,W.shadowMapSize=U.mapSize,W.shadowCameraNear=U.camera.near,W.shadowCameraFar=U.camera.far,r.pointShadow[g]=W,r.pointShadowMap[g]=q,r.pointShadowMatrix[g]=F.shadow.matrix,w++}r.point[g]=I,g++}else if(F.isHemisphereLight){const I=t.get(F);I.skyColor.copy(F.color).multiplyScalar(H*T),I.groundColor.copy(F.groundColor).multiplyScalar(H*T),r.hemi[y]=I,y++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=Qe.LTC_FLOAT_1,r.rectAreaLTC2=Qe.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Qe.LTC_HALF_1,r.rectAreaLTC2=Qe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const x=r.hash;(x.directionalLength!==m||x.pointLength!==g||x.spotLength!==_||x.rectAreaLength!==v||x.hemiLength!==y||x.numDirectionalShadows!==b||x.numPointShadows!==w||x.numSpotShadows!==M)&&(r.directional.length=m,r.spot.length=_,r.rectArea.length=v,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=w,r.spotShadowMatrix.length=M,x.directionalLength=m,x.pointLength=g,x.spotLength=_,x.rectAreaLength=v,x.hemiLength=y,x.numDirectionalShadows=b,x.numPointShadows=w,x.numSpotShadows=M,r.version=Dee++)},setupView:function c(u,h){let d=0,f=0,p=0,m=0,g=0;const _=h.matrixWorldInverse;for(let v=0,y=u.length;v<y;v++){const b=u[v];if(b.isDirectionalLight){const w=r.directional[d];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),d++}else if(b.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(_),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),p++}else if(b.isRectAreaLight){const w=r.rectArea[m];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(_),a.identity(),o.copy(b.matrixWorld),o.premultiply(_),a.extractRotation(o),w.halfWidth.set(.5*b.width,0,0),w.halfHeight.set(0,.5*b.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(_),f++}else if(b.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(_),g++}}},state:r}}function Bk(n,e){const t=new Ree(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(h){t.setup(i,h)},setupLightsView:function c(h){t.setupView(i,h)},pushLight:function o(h){i.push(h)},pushShadow:function a(h){r.push(h)}}}function Pee(n,e){let t=new WeakMap;return{get:function i(s,o=0){let a;return!1===t.has(s)?(a=new Bk(n,e),t.set(s,[a])):o>=t.get(s).length?(a=new Bk(n,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class ev extends mi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=XF,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class SS extends mi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new C,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Fee(n,e,t){let i=new K_;const r=new te,s=new te,o=new gn,a=new ev({depthPacking:GM}),l=new SS,c={},u=t.maxTextureSize,h={0:ns,1:$a,2:io},d=new Yn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new te},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new wt;p.setAttribute("position",new En(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new qe(p,d),g=this;function _(b,w){const M=e.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(w,null,M,d,m,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(w,null,M,f,m,null)}function v(b,w,M,T,x,E){let R=null;const F=!0===M.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(R=void 0!==F?F:!0===M.isPointLight?l:a,n.localClippingEnabled&&!0===w.clipShadows&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0){const V=R.uuid,H=w.uuid;let j=c[V];void 0===j&&(j={},c[V]=j);let q=j[H];void 0===q&&(q=R.clone(),j[H]=q),R=q}return R.visible=w.visible,R.wireframe=w.wireframe,R.side=E===nh?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:h[w.side],R.alphaMap=w.alphaMap,R.alphaTest=w.alphaTest,R.clipShadows=w.clipShadows,R.clippingPlanes=w.clippingPlanes,R.clipIntersection=w.clipIntersection,R.displacementMap=w.displacementMap,R.displacementScale=w.displacementScale,R.displacementBias=w.displacementBias,R.wireframeLinewidth=w.wireframeLinewidth,R.linewidth=w.linewidth,!0===M.isPointLight&&!0===R.isMeshDistanceMaterial&&(R.referencePosition.setFromMatrixPosition(M.matrixWorld),R.nearDistance=T,R.farDistance=x),R}function y(b,w,M,T,x){if(!1===b.visible)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&x===nh)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,b.matrixWorld);const F=e.update(b),V=b.material;if(Array.isArray(V)){const H=F.groups;for(let j=0,q=H.length;j<q;j++){const I=H[j],U=V[I.materialIndex];if(U&&U.visible){const W=v(b,U,T,M.near,M.far,x);n.renderBufferDirect(M,null,F,W,b,I)}}}else if(V.visible){const H=v(b,V,T,M.near,M.far,x);n.renderBufferDirect(M,null,F,H,b,null)}}const R=b.children;for(let F=0,V=R.length;F<V;F++)y(R[F],w,M,T,x)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=uM,this.render=function(b,w,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===b.length)return;const T=n.getRenderTarget(),x=n.getActiveCubeFace(),E=n.getActiveMipmapLevel(),R=n.state;R.setBlending(ro),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let F=0,V=b.length;F<V;F++){const H=b[F],j=H.shadow;if(void 0===j){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(!1===j.autoUpdate&&!1===j.needsUpdate)continue;r.copy(j.mapSize);const q=j.getFrameExtents();r.multiply(q),s.copy(j.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/q.x),r.x=s.x*q.x,j.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/q.y),r.y=s.y*q.y,j.mapSize.y=s.y)),null===j.map&&!j.isPointLightShadow&&this.type===nh&&(j.map=new Nn(r.x,r.y),j.map.texture.name=H.name+".shadowMap",j.mapPass=new Nn(r.x,r.y),j.camera.updateProjectionMatrix()),null===j.map&&(j.map=new Nn(r.x,r.y,{minFilter:xi,magFilter:xi,format:is}),j.map.texture.name=H.name+".shadowMap",j.camera.updateProjectionMatrix()),n.setRenderTarget(j.map),n.clear();const I=j.getViewportCount();for(let U=0;U<I;U++){const W=j.getViewport(U);o.set(s.x*W.x,s.y*W.y,s.x*W.z,s.y*W.w),R.viewport(o),j.updateMatrices(H,U),i=j.getFrustum(),y(w,M,j.camera,H,this.type)}!j.isPointLightShadow&&this.type===nh&&_(j,M),j.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(T,x,E)}}function kee(n,e,t){const i=t.isWebGL2,a=new function r(){let G=!1;const De=new gn;let je=null;const _t=new gn(0,0,0,0);return{setMask:function(Fe){je!==Fe&&!G&&(n.colorMask(Fe,Fe,Fe,Fe),je=Fe)},setLocked:function(Fe){G=Fe},setClear:function(Fe,Ke,Be,ge,Yt){!0===Yt&&(Fe*=ge,Ke*=ge,Be*=ge),De.set(Fe,Ke,Be,ge),!1===_t.equals(De)&&(n.clearColor(Fe,Ke,Be,ge),_t.copy(De))},reset:function(){G=!1,je=null,_t.set(-1,0,0,0)}}},l=new function s(){let G=!1,De=null,je=null,_t=null;return{setTest:function(Fe){Fe?Ae(2929):J(2929)},setMask:function(Fe){De!==Fe&&!G&&(n.depthMask(Fe),De=Fe)},setFunc:function(Fe){if(je!==Fe){if(Fe)switch(Fe){case gF:n.depthFunc(512);break;case _F:n.depthFunc(519);break;case vF:n.depthFunc(513);break;case f_:n.depthFunc(515);break;case yF:n.depthFunc(514);break;case bF:n.depthFunc(518);break;case xF:n.depthFunc(516);break;case wF:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);je=Fe}},setLocked:function(Fe){G=Fe},setClear:function(Fe){_t!==Fe&&(n.clearDepth(Fe),_t=Fe)},reset:function(){G=!1,De=null,je=null,_t=null}}},c=new function o(){let G=!1,De=null,je=null,_t=null,Fe=null,Ke=null,Be=null,ge=null,Yt=null;return{setTest:function(xn){G||(xn?Ae(2960):J(2960))},setMask:function(xn){De!==xn&&!G&&(n.stencilMask(xn),De=xn)},setFunc:function(xn,or,Bs){(je!==xn||_t!==or||Fe!==Bs)&&(n.stencilFunc(xn,or,Bs),je=xn,_t=or,Fe=Bs)},setOp:function(xn,or,Bs){(Ke!==xn||Be!==or||ge!==Bs)&&(n.stencilOp(xn,or,Bs),Ke=xn,Be=or,ge=Bs)},setLocked:function(xn){G=xn},setClear:function(xn){Yt!==xn&&(n.clearStencil(xn),Yt=xn)},reset:function(){G=!1,De=null,je=null,_t=null,Fe=null,Ke=null,Be=null,ge=null,Yt=null}}};let u={},h={},d=new WeakMap,f=[],p=null,m=!1,g=null,_=null,v=null,y=null,b=null,w=null,M=null,T=!1,x=null,E=null,R=null,F=null,V=null;const H=n.getParameter(35661);let j=!1,q=0;const I=n.getParameter(7938);-1!==I.indexOf("WebGL")?(q=parseFloat(/^WebGL (\d)/.exec(I)[1]),j=q>=1):-1!==I.indexOf("OpenGL ES")&&(q=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),j=q>=2);let U=null,W={};const z=n.getParameter(3088),Y=n.getParameter(2978),oe=(new gn).fromArray(z),$=(new gn).fromArray(Y);function me(G,De,je){const _t=new Uint8Array(4),Fe=n.createTexture();n.bindTexture(G,Fe),n.texParameteri(G,10241,9728),n.texParameteri(G,10240,9728);for(let Ke=0;Ke<je;Ke++)n.texImage2D(De+Ke,0,6408,1,1,0,6408,5121,_t);return Fe}const he={};function Ae(G){!0!==u[G]&&(n.enable(G),u[G]=!0)}function J(G){!1!==u[G]&&(n.disable(G),u[G]=!1)}he[3553]=me(3553,3553,1),he[34067]=me(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ae(2929),l.setFunc(f_),Me(!1),Je(cM),Ae(2884),ue(ro);const _e={[pc]:32774,[sF]:32778,[oF]:32779};if(i)_e[fM]=32775,_e[pM]=32776;else{const G=e.get("EXT_blend_minmax");null!==G&&(_e[fM]=G.MIN_EXT,_e[pM]=G.MAX_EXT)}const st={[aF]:0,[lF]:1,[cF]:768,[mM]:770,[mF]:776,[fF]:774,[hF]:772,[uF]:769,[gM]:771,[pF]:775,[dF]:773};function ue(G,De,je,_t,Fe,Ke,Be,ge){if(G!==ro){if(!1===m&&(Ae(3042),m=!0),G===rF)Fe=Fe||De,Ke=Ke||je,Be=Be||_t,(De!==_||Fe!==b)&&(n.blendEquationSeparate(_e[De],_e[Fe]),_=De,b=Fe),(je!==v||_t!==y||Ke!==w||Be!==M)&&(n.blendFuncSeparate(st[je],st[_t],st[Ke],st[Be]),v=je,y=_t,w=Ke,M=Be),g=G,T=null;else if(G!==g||ge!==T){if((_!==pc||b!==pc)&&(n.blendEquation(32774),_=pc,b=pc),ge)switch(G){case fc:n.blendFuncSeparate(1,771,1,771);break;case ih:n.blendFunc(1,1);break;case hM:n.blendFuncSeparate(0,769,0,1);break;case dM:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",G)}else switch(G){case fc:n.blendFuncSeparate(770,771,1,771);break;case ih:n.blendFunc(770,1);break;case hM:n.blendFuncSeparate(0,769,0,1);break;case dM:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",G)}v=null,y=null,w=null,M=null,g=G,T=ge}}else!0===m&&(J(3042),m=!1)}function Me(G){x!==G&&(n.frontFace(G?2304:2305),x=G)}function Je(G){G!==eF?(Ae(2884),G!==E&&n.cullFace(G===cM?1029:G===tF?1028:1032)):J(2884),E=G}function bt(G,De,je){G?(Ae(32823),(F!==De||V!==je)&&(n.polygonOffset(De,je),F=De,V=je)):J(32823)}function dt(G){void 0===G&&(G=33984+H-1),U!==G&&(n.activeTexture(G),U=G)}return{buffers:{color:a,depth:l,stencil:c},enable:Ae,disable:J,bindFramebuffer:function X(G,De){return h[G]!==De&&(n.bindFramebuffer(G,De),h[G]=De,i&&(36009===G&&(h[36160]=De),36160===G&&(h[36009]=De)),!0)},drawBuffers:function de(G,De){let je=f,_t=!1;if(G)if(je=d.get(De),void 0===je&&(je=[],d.set(De,je)),G.isWebGLMultipleRenderTargets){const Fe=G.texture;if(je.length!==Fe.length||36064!==je[0]){for(let Ke=0,Be=Fe.length;Ke<Be;Ke++)je[Ke]=36064+Ke;je.length=Fe.length,_t=!0}}else 36064!==je[0]&&(je[0]=36064,_t=!0);else 1029!==je[0]&&(je[0]=1029,_t=!0);_t&&(t.isWebGL2?n.drawBuffers(je):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(je))},useProgram:function Le(G){return p!==G&&(n.useProgram(G),p=G,!0)},setBlending:ue,setMaterial:function fe(G,De){G.side===io?J(2884):Ae(2884);let je=G.side===ns;De&&(je=!je),Me(je),G.blending===fc&&!1===G.transparent?ue(ro):ue(G.blending,G.blendEquation,G.blendSrc,G.blendDst,G.blendEquationAlpha,G.blendSrcAlpha,G.blendDstAlpha,G.premultipliedAlpha),l.setFunc(G.depthFunc),l.setTest(G.depthTest),l.setMask(G.depthWrite),a.setMask(G.colorWrite);const _t=G.stencilWrite;c.setTest(_t),_t&&(c.setMask(G.stencilWriteMask),c.setFunc(G.stencilFunc,G.stencilRef,G.stencilFuncMask),c.setOp(G.stencilFail,G.stencilZFail,G.stencilZPass)),bt(G.polygonOffset,G.polygonOffsetFactor,G.polygonOffsetUnits),!0===G.alphaToCoverage?Ae(32926):J(32926)},setFlipSided:Me,setCullFace:Je,setLineWidth:function Ge(G){G!==R&&(j&&n.lineWidth(G),R=G)},setPolygonOffset:bt,setScissorTest:function mt(G){G?Ae(3089):J(3089)},activeTexture:dt,bindTexture:function Jt(G,De){null===U&&dt();let je=W[U];void 0===je&&(je={type:void 0,texture:void 0},W[U]=je),(je.type!==G||je.texture!==De)&&(n.bindTexture(G,De||he[G]),je.type=G,je.texture=De)},unbindTexture:function Wt(){const G=W[U];void 0!==G&&void 0!==G.type&&(n.bindTexture(G.type,null),G.type=void 0,G.texture=void 0)},compressedTexImage2D:function B(){try{n.compressedTexImage2D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texImage2D:function ht(){try{n.texImage2D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texImage3D:function L(){try{n.texImage3D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texStorage2D:function Pe(){try{n.texStorage2D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texStorage3D:function Ue(){try{n.texStorage3D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texSubImage2D:function P(){try{n.texSubImage2D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},texSubImage3D:function ae(){try{n.texSubImage3D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},compressedTexSubImage2D:function xe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(G){console.error("THREE.WebGLState:",G)}},scissor:function le(G){!1===oe.equals(G)&&(n.scissor(G.x,G.y,G.z,G.w),oe.copy(G))},viewport:function Ne(G){!1===$.equals(G)&&(n.viewport(G.x,G.y,G.z,G.w),$.copy(G))},reset:function Ve(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},U=null,W={},h={},d=new WeakMap,f=[],p=null,m=!1,g=null,_=null,v=null,y=null,b=null,w=null,M=null,T=!1,x=null,E=null,R=null,F=null,V=null,oe.set(0,0,n.canvas.width,n.canvas.height),$.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function Oee(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(B,P){return _?new OffscreenCanvas(B,P):Wf("canvas")}function y(B,P,ae,xe){let Pe=1;if((B.width>xe||B.height>xe)&&(Pe=xe/Math.max(B.width,B.height)),Pe<1||!0===P){if(typeof HTMLImageElement<"u"&&B instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&B instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&B instanceof ImageBitmap){const Ue=P?C_:Math.floor,ht=Ue(Pe*B.width),L=Ue(Pe*B.height);void 0===m&&(m=v(ht,L));const le=ae?v(ht,L):m;return le.width=ht,le.height=L,le.getContext("2d").drawImage(B,0,0,ht,L),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+B.width+"x"+B.height+") to ("+ht+"x"+L+")."),le}return"data"in B&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+B.width+"x"+B.height+")."),B}return B}function b(B){return qM(B.width)&&qM(B.height)}function M(B,P){return B.generateMipmaps&&P&&B.minFilter!==xi&&B.minFilter!==si}function T(B){n.generateMipmap(B)}function x(B,P,ae,xe,Pe=!1){if(!1===a)return P;if(null!==B){if(void 0!==n[B])return n[B];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+B+"'")}let Ue=P;return 6403===P&&(5126===ae&&(Ue=33326),5131===ae&&(Ue=33325),5121===ae&&(Ue=33321)),33319===P&&(5126===ae&&(Ue=33328),5131===ae&&(Ue=33327),5121===ae&&(Ue=33323)),6408===P&&(5126===ae&&(Ue=34836),5131===ae&&(Ue=34842),5121===ae&&(Ue=xe===mn&&!1===Pe?35907:32856),32819===ae&&(Ue=32854),32820===ae&&(Ue=32855)),(33325===Ue||33326===Ue||33327===Ue||33328===Ue||34842===Ue||34836===Ue)&&e.get("EXT_color_buffer_float"),Ue}function E(B,P,ae){return!0===M(B,ae)||B.isFramebufferTexture&&B.minFilter!==xi&&B.minFilter!==si?Math.log2(Math.max(P.width,P.height))+1:void 0!==B.mipmaps&&B.mipmaps.length>0?B.mipmaps.length:B.isCompressedTexture&&Array.isArray(B.image)?P.mipmaps.length:1}function R(B){return B===xi||B===Uf||B===Vf?9728:9729}function F(B){const P=B.target;P.removeEventListener("dispose",F),function H(B){const P=i.get(B);if(void 0===P.__webglInit)return;const ae=B.source,xe=g.get(ae);if(xe){const Pe=xe[P.__cacheKey];Pe.usedTimes--,0===Pe.usedTimes&&j(B),0===Object.keys(xe).length&&g.delete(ae)}i.remove(B)}(P),P.isVideoTexture&&p.delete(P)}function V(B){const P=B.target;P.removeEventListener("dispose",V),function q(B){const P=B.texture,ae=i.get(B),xe=i.get(P);if(void 0!==xe.__webglTexture&&(n.deleteTexture(xe.__webglTexture),o.memory.textures--),B.depthTexture&&B.depthTexture.dispose(),B.isWebGLCubeRenderTarget)for(let Pe=0;Pe<6;Pe++)n.deleteFramebuffer(ae.__webglFramebuffer[Pe]),ae.__webglDepthbuffer&&n.deleteRenderbuffer(ae.__webglDepthbuffer[Pe]);else{if(n.deleteFramebuffer(ae.__webglFramebuffer),ae.__webglDepthbuffer&&n.deleteRenderbuffer(ae.__webglDepthbuffer),ae.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ae.__webglMultisampledFramebuffer),ae.__webglColorRenderbuffer)for(let Pe=0;Pe<ae.__webglColorRenderbuffer.length;Pe++)ae.__webglColorRenderbuffer[Pe]&&n.deleteRenderbuffer(ae.__webglColorRenderbuffer[Pe]);ae.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ae.__webglDepthRenderbuffer)}if(B.isWebGLMultipleRenderTargets)for(let Pe=0,Ue=P.length;Pe<Ue;Pe++){const ht=i.get(P[Pe]);ht.__webglTexture&&(n.deleteTexture(ht.__webglTexture),o.memory.textures--),i.remove(P[Pe])}i.remove(P),i.remove(B)}(P)}function j(B){const P=i.get(B);n.deleteTexture(P.__webglTexture),delete g.get(B.source)[P.__cacheKey],o.memory.textures--}let I=0;function Y(B,P){const ae=i.get(B);if(B.isVideoTexture&&function Jt(B){const P=o.render.frame;p.get(B)!==P&&(p.set(B,P),B.update())}(B),!1===B.isRenderTargetTexture&&B.version>0&&ae.__version!==B.version){const xe=B.image;if(null===xe)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==xe.complete)return void de(ae,B,P);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+P),t.bindTexture(3553,ae.__webglTexture)}const he={[tl]:10497,[dr]:33071,[sh]:33648},Ae={[xi]:9728,[Uf]:9984,[Vf]:9986,[si]:9729,[m_]:9985,[va]:9987};function J(B,P,ae){if(ae?(n.texParameteri(B,10242,he[P.wrapS]),n.texParameteri(B,10243,he[P.wrapT]),(32879===B||35866===B)&&n.texParameteri(B,32882,he[P.wrapR]),n.texParameteri(B,10240,Ae[P.magFilter]),n.texParameteri(B,10241,Ae[P.minFilter])):(n.texParameteri(B,10242,33071),n.texParameteri(B,10243,33071),(32879===B||35866===B)&&n.texParameteri(B,32882,33071),(P.wrapS!==dr||P.wrapT!==dr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(B,10240,R(P.magFilter)),n.texParameteri(B,10241,R(P.minFilter)),P.minFilter!==xi&&P.minFilter!==si&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const xe=e.get("EXT_texture_filter_anisotropic");if(P.type===so&&!1===e.has("OES_texture_float_linear")||!1===a&&P.type===rl&&!1===e.has("OES_texture_half_float_linear"))return;(P.anisotropy>1||i.get(P).__currentAnisotropy)&&(n.texParameterf(B,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,r.getMaxAnisotropy())),i.get(P).__currentAnisotropy=P.anisotropy)}}function X(B,P){let ae=!1;void 0===B.__webglInit&&(B.__webglInit=!0,P.addEventListener("dispose",F));const xe=P.source;let Pe=g.get(xe);void 0===Pe&&(Pe={},g.set(xe,Pe));const Ue=function z(B){const P=[];return P.push(B.wrapS),P.push(B.wrapT),P.push(B.magFilter),P.push(B.minFilter),P.push(B.anisotropy),P.push(B.internalFormat),P.push(B.format),P.push(B.type),P.push(B.generateMipmaps),P.push(B.premultiplyAlpha),P.push(B.flipY),P.push(B.unpackAlignment),P.push(B.encoding),P.join()}(P);if(Ue!==B.__cacheKey){void 0===Pe[Ue]&&(Pe[Ue]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ae=!0),Pe[Ue].usedTimes++;const ht=Pe[B.__cacheKey];void 0!==ht&&(Pe[B.__cacheKey].usedTimes--,0===ht.usedTimes&&j(P)),B.__cacheKey=Ue,B.__webglTexture=Pe[Ue].texture}return ae}function de(B,P,ae){let xe=3553;P.isDataArrayTexture&&(xe=35866),P.isData3DTexture&&(xe=32879);const Pe=X(B,P),Ue=P.source;if(t.activeTexture(33984+ae),t.bindTexture(xe,B.__webglTexture),Ue.version!==Ue.__currentVersion||!0===Pe){n.pixelStorei(37440,P.flipY),n.pixelStorei(37441,P.premultiplyAlpha),n.pixelStorei(3317,P.unpackAlignment),n.pixelStorei(37443,0);const ht=function w(B){return!a&&(B.wrapS!==dr||B.wrapT!==dr||B.minFilter!==xi&&B.minFilter!==si)}(P)&&!1===b(P.image);let L=y(P.image,ht,!1,u);L=Wt(P,L);const le=b(L)||a,Ne=s.convert(P.format,P.encoding);let De,Ve=s.convert(P.type),G=x(P.internalFormat,Ne,Ve,P.encoding,P.isVideoTexture);J(xe,P,le);const je=P.mipmaps,_t=a&&!0!==P.isVideoTexture,Fe=void 0===Ue.__currentVersion||!0===Pe,Ke=E(P,L,le);if(P.isDepthTexture)G=6402,a?G=P.type===so?36012:P.type===il?33190:P.type===mc?35056:33189:P.type===so&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),P.format===sl&&6402===G&&P.type!==_M&&P.type!==il&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),P.type=il,Ve=s.convert(P.type)),P.format===gc&&6402===G&&(G=34041,P.type!==mc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),P.type=mc,Ve=s.convert(P.type))),Fe&&(_t?t.texStorage2D(3553,1,G,L.width,L.height):t.texImage2D(3553,0,G,L.width,L.height,0,Ne,Ve,null));else if(P.isDataTexture)if(je.length>0&&le){_t&&Fe&&t.texStorage2D(3553,Ke,G,je[0].width,je[0].height);for(let Be=0,ge=je.length;Be<ge;Be++)De=je[Be],_t?t.texSubImage2D(3553,Be,0,0,De.width,De.height,Ne,Ve,De.data):t.texImage2D(3553,Be,G,De.width,De.height,0,Ne,Ve,De.data);P.generateMipmaps=!1}else _t?(Fe&&t.texStorage2D(3553,Ke,G,L.width,L.height),t.texSubImage2D(3553,0,0,0,L.width,L.height,Ne,Ve,L.data)):t.texImage2D(3553,0,G,L.width,L.height,0,Ne,Ve,L.data);else if(P.isCompressedTexture){_t&&Fe&&t.texStorage2D(3553,Ke,G,je[0].width,je[0].height);for(let Be=0,ge=je.length;Be<ge;Be++)De=je[Be],P.format!==is?null!==Ne?_t?t.compressedTexSubImage2D(3553,Be,0,0,De.width,De.height,Ne,De.data):t.compressedTexImage2D(3553,Be,G,De.width,De.height,0,De.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_t?t.texSubImage2D(3553,Be,0,0,De.width,De.height,Ne,Ve,De.data):t.texImage2D(3553,Be,G,De.width,De.height,0,Ne,Ve,De.data)}else if(P.isDataArrayTexture)_t?(Fe&&t.texStorage3D(35866,Ke,G,L.width,L.height,L.depth),t.texSubImage3D(35866,0,0,0,0,L.width,L.height,L.depth,Ne,Ve,L.data)):t.texImage3D(35866,0,G,L.width,L.height,L.depth,0,Ne,Ve,L.data);else if(P.isData3DTexture)_t?(Fe&&t.texStorage3D(32879,Ke,G,L.width,L.height,L.depth),t.texSubImage3D(32879,0,0,0,0,L.width,L.height,L.depth,Ne,Ve,L.data)):t.texImage3D(32879,0,G,L.width,L.height,L.depth,0,Ne,Ve,L.data);else if(P.isFramebufferTexture){if(Fe)if(_t)t.texStorage2D(3553,Ke,G,L.width,L.height);else{let Be=L.width,ge=L.height;for(let Yt=0;Yt<Ke;Yt++)t.texImage2D(3553,Yt,G,Be,ge,0,Ne,Ve,null),Be>>=1,ge>>=1}}else if(je.length>0&&le){_t&&Fe&&t.texStorage2D(3553,Ke,G,je[0].width,je[0].height);for(let Be=0,ge=je.length;Be<ge;Be++)De=je[Be],_t?t.texSubImage2D(3553,Be,0,0,Ne,Ve,De):t.texImage2D(3553,Be,G,Ne,Ve,De);P.generateMipmaps=!1}else _t?(Fe&&t.texStorage2D(3553,Ke,G,L.width,L.height),t.texSubImage2D(3553,0,0,0,Ne,Ve,L)):t.texImage2D(3553,0,G,Ne,Ve,L);M(P,le)&&T(xe),Ue.__currentVersion=Ue.version,P.onUpdate&&P.onUpdate(P)}B.__version=P.version}function _e(B,P,ae,xe,Pe){const Ue=s.convert(ae.format,ae.encoding),ht=s.convert(ae.type),L=x(ae.internalFormat,Ue,ht,ae.encoding);i.get(P).__hasExternalTextures||(32879===Pe||35866===Pe?t.texImage3D(Pe,0,L,P.width,P.height,P.depth,0,Ue,ht,null):t.texImage2D(Pe,0,L,P.width,P.height,0,Ue,ht,null)),t.bindFramebuffer(36160,B),dt(P)?d.framebufferTexture2DMultisampleEXT(36160,xe,Pe,i.get(ae).__webglTexture,0,mt(P)):n.framebufferTexture2D(36160,xe,Pe,i.get(ae).__webglTexture,0),t.bindFramebuffer(36160,null)}function st(B,P,ae){if(n.bindRenderbuffer(36161,B),P.depthBuffer&&!P.stencilBuffer){let xe=33189;if(ae||dt(P)){const Pe=P.depthTexture;Pe&&Pe.isDepthTexture&&(Pe.type===so?xe=36012:Pe.type===il&&(xe=33190));const Ue=mt(P);dt(P)?d.renderbufferStorageMultisampleEXT(36161,Ue,xe,P.width,P.height):n.renderbufferStorageMultisample(36161,Ue,xe,P.width,P.height)}else n.renderbufferStorage(36161,xe,P.width,P.height);n.framebufferRenderbuffer(36160,36096,36161,B)}else if(P.depthBuffer&&P.stencilBuffer){const xe=mt(P);ae&&!1===dt(P)?n.renderbufferStorageMultisample(36161,xe,35056,P.width,P.height):dt(P)?d.renderbufferStorageMultisampleEXT(36161,xe,35056,P.width,P.height):n.renderbufferStorage(36161,34041,P.width,P.height),n.framebufferRenderbuffer(36160,33306,36161,B)}else{const xe=!0===P.isWebGLMultipleRenderTargets?P.texture:[P.texture];for(let Pe=0;Pe<xe.length;Pe++){const Ue=xe[Pe],ht=s.convert(Ue.format,Ue.encoding),L=s.convert(Ue.type),le=x(Ue.internalFormat,ht,L,Ue.encoding),Ne=mt(P);ae&&!1===dt(P)?n.renderbufferStorageMultisample(36161,Ne,le,P.width,P.height):dt(P)?d.renderbufferStorageMultisampleEXT(36161,Ne,le,P.width,P.height):n.renderbufferStorage(36161,le,P.width,P.height)}}n.bindRenderbuffer(36161,null)}function fe(B){const P=i.get(B),ae=!0===B.isWebGLCubeRenderTarget;if(B.depthTexture&&!P.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");!function ue(B,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,B),!P.depthTexture||!P.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(P.depthTexture).__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),Y(P.depthTexture,0);const xe=i.get(P.depthTexture).__webglTexture,Pe=mt(P);if(P.depthTexture.format===sl)dt(P)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,xe,0,Pe):n.framebufferTexture2D(36160,36096,3553,xe,0);else{if(P.depthTexture.format!==gc)throw new Error("Unknown depthTexture format");dt(P)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,xe,0,Pe):n.framebufferTexture2D(36160,33306,3553,xe,0)}}(P.__webglFramebuffer,B)}else if(ae){P.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)t.bindFramebuffer(36160,P.__webglFramebuffer[xe]),P.__webglDepthbuffer[xe]=n.createRenderbuffer(),st(P.__webglDepthbuffer[xe],B,!1)}else t.bindFramebuffer(36160,P.__webglFramebuffer),P.__webglDepthbuffer=n.createRenderbuffer(),st(P.__webglDepthbuffer,B,!1);t.bindFramebuffer(36160,null)}function mt(B){return Math.min(h,B.samples)}function dt(B){const P=i.get(B);return a&&B.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==P.__useRenderToTexture}function Wt(B,P){const ae=B.encoding,xe=B.format,Pe=B.type;return!0===B.isCompressedTexture||!0===B.isVideoTexture||B.format===T_||ae!==ol&&(ae===mn?!1===a?!0===e.has("EXT_sRGB")&&xe===is?(B.format=T_,B.minFilter=si,B.generateMipmaps=!1):P=KM.sRGBToLinear(P):(xe!==is||Pe!==nl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ae)),P}this.allocateTextureUnit=function W(){const B=I;return B>=l&&console.warn("THREE.WebGLTextures: Trying to use "+B+" texture units while this GPU supports only "+l),I+=1,B},this.resetTextureUnits=function U(){I=0},this.setTexture2D=Y,this.setTexture2DArray=function oe(B,P){const ae=i.get(B);B.version>0&&ae.__version!==B.version?de(ae,B,P):(t.activeTexture(33984+P),t.bindTexture(35866,ae.__webglTexture))},this.setTexture3D=function $(B,P){const ae=i.get(B);B.version>0&&ae.__version!==B.version?de(ae,B,P):(t.activeTexture(33984+P),t.bindTexture(32879,ae.__webglTexture))},this.setTextureCube=function me(B,P){const ae=i.get(B);B.version>0&&ae.__version!==B.version?function Le(B,P,ae){if(6!==P.image.length)return;const xe=X(B,P),Pe=P.source;if(t.activeTexture(33984+ae),t.bindTexture(34067,B.__webglTexture),Pe.version!==Pe.__currentVersion||!0===xe){n.pixelStorei(37440,P.flipY),n.pixelStorei(37441,P.premultiplyAlpha),n.pixelStorei(3317,P.unpackAlignment),n.pixelStorei(37443,0);const Ue=P.isCompressedTexture||P.image[0].isCompressedTexture,ht=P.image[0]&&P.image[0].isDataTexture,L=[];for(let Be=0;Be<6;Be++)L[Be]=Ue||ht?ht?P.image[Be].image:P.image[Be]:y(P.image[Be],!1,!0,c),L[Be]=Wt(P,L[Be]);const le=L[0],Ne=b(le)||a,Ve=s.convert(P.format,P.encoding),G=s.convert(P.type),De=x(P.internalFormat,Ve,G,P.encoding),je=a&&!0!==P.isVideoTexture,_t=void 0===Pe.__currentVersion||!0===xe;let Ke,Fe=E(P,le,Ne);if(J(34067,P,Ne),Ue){je&&_t&&t.texStorage2D(34067,Fe,De,le.width,le.height);for(let Be=0;Be<6;Be++){Ke=L[Be].mipmaps;for(let ge=0;ge<Ke.length;ge++){const Yt=Ke[ge];P.format!==is?null!==Ve?je?t.compressedTexSubImage2D(34069+Be,ge,0,0,Yt.width,Yt.height,Ve,Yt.data):t.compressedTexImage2D(34069+Be,ge,De,Yt.width,Yt.height,0,Yt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):je?t.texSubImage2D(34069+Be,ge,0,0,Yt.width,Yt.height,Ve,G,Yt.data):t.texImage2D(34069+Be,ge,De,Yt.width,Yt.height,0,Ve,G,Yt.data)}}}else{Ke=P.mipmaps,je&&_t&&(Ke.length>0&&Fe++,t.texStorage2D(34067,Fe,De,L[0].width,L[0].height));for(let Be=0;Be<6;Be++)if(ht){je?t.texSubImage2D(34069+Be,0,0,0,L[Be].width,L[Be].height,Ve,G,L[Be].data):t.texImage2D(34069+Be,0,De,L[Be].width,L[Be].height,0,Ve,G,L[Be].data);for(let ge=0;ge<Ke.length;ge++){const xn=Ke[ge].image[Be].image;je?t.texSubImage2D(34069+Be,ge+1,0,0,xn.width,xn.height,Ve,G,xn.data):t.texImage2D(34069+Be,ge+1,De,xn.width,xn.height,0,Ve,G,xn.data)}}else{je?t.texSubImage2D(34069+Be,0,0,0,Ve,G,L[Be]):t.texImage2D(34069+Be,0,De,Ve,G,L[Be]);for(let ge=0;ge<Ke.length;ge++){const Yt=Ke[ge];je?t.texSubImage2D(34069+Be,ge+1,0,0,Ve,G,Yt.image[Be]):t.texImage2D(34069+Be,ge+1,De,Ve,G,Yt.image[Be])}}}M(P,Ne)&&T(34067),Pe.__currentVersion=Pe.version,P.onUpdate&&P.onUpdate(P)}B.__version=P.version}(ae,B,P):(t.activeTexture(33984+P),t.bindTexture(34067,ae.__webglTexture))},this.rebindTextures=function Me(B,P,ae){const xe=i.get(B);void 0!==P&&_e(xe.__webglFramebuffer,B,B.texture,36064,3553),void 0!==ae&&fe(B)},this.setupRenderTarget=function Je(B){const P=B.texture,ae=i.get(B),xe=i.get(P);B.addEventListener("dispose",V),!0!==B.isWebGLMultipleRenderTargets&&(void 0===xe.__webglTexture&&(xe.__webglTexture=n.createTexture()),xe.__version=P.version,o.memory.textures++);const Pe=!0===B.isWebGLCubeRenderTarget,Ue=!0===B.isWebGLMultipleRenderTargets,ht=b(B)||a;if(Pe){ae.__webglFramebuffer=[];for(let L=0;L<6;L++)ae.__webglFramebuffer[L]=n.createFramebuffer()}else{if(ae.__webglFramebuffer=n.createFramebuffer(),Ue)if(r.drawBuffers){const L=B.texture;for(let le=0,Ne=L.length;le<Ne;le++){const Ve=i.get(L[le]);void 0===Ve.__webglTexture&&(Ve.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&B.samples>0&&!1===dt(B)){const L=Ue?P:[P];ae.__webglMultisampledFramebuffer=n.createFramebuffer(),ae.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,ae.__webglMultisampledFramebuffer);for(let le=0;le<L.length;le++){const Ne=L[le];ae.__webglColorRenderbuffer[le]=n.createRenderbuffer(),n.bindRenderbuffer(36161,ae.__webglColorRenderbuffer[le]);const Ve=s.convert(Ne.format,Ne.encoding),G=s.convert(Ne.type),De=x(Ne.internalFormat,Ve,G,Ne.encoding),je=mt(B);n.renderbufferStorageMultisample(36161,je,De,B.width,B.height),n.framebufferRenderbuffer(36160,36064+le,36161,ae.__webglColorRenderbuffer[le])}n.bindRenderbuffer(36161,null),B.depthBuffer&&(ae.__webglDepthRenderbuffer=n.createRenderbuffer(),st(ae.__webglDepthRenderbuffer,B,!0)),t.bindFramebuffer(36160,null)}}if(Pe){t.bindTexture(34067,xe.__webglTexture),J(34067,P,ht);for(let L=0;L<6;L++)_e(ae.__webglFramebuffer[L],B,P,36064,34069+L);M(P,ht)&&T(34067),t.unbindTexture()}else if(Ue){const L=B.texture;for(let le=0,Ne=L.length;le<Ne;le++){const Ve=L[le],G=i.get(Ve);t.bindTexture(3553,G.__webglTexture),J(3553,Ve,ht),_e(ae.__webglFramebuffer,B,Ve,36064+le,3553),M(Ve,ht)&&T(3553)}t.unbindTexture()}else{let L=3553;(B.isWebGL3DRenderTarget||B.isWebGLArrayRenderTarget)&&(a?L=B.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(L,xe.__webglTexture),J(L,P,ht),_e(ae.__webglFramebuffer,B,P,36064,L),M(P,ht)&&T(L),t.unbindTexture()}B.depthBuffer&&fe(B)},this.updateRenderTargetMipmap=function Ge(B){const P=b(B)||a,ae=!0===B.isWebGLMultipleRenderTargets?B.texture:[B.texture];for(let xe=0,Pe=ae.length;xe<Pe;xe++){const Ue=ae[xe];if(M(Ue,P)){const ht=B.isWebGLCubeRenderTarget?34067:3553,L=i.get(Ue).__webglTexture;t.bindTexture(ht,L),T(ht),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function bt(B){if(a&&B.samples>0&&!1===dt(B)){const P=B.isWebGLMultipleRenderTargets?B.texture:[B.texture],ae=B.width,xe=B.height;let Pe=16384;const Ue=[],ht=B.stencilBuffer?33306:36096,L=i.get(B),le=!0===B.isWebGLMultipleRenderTargets;if(le)for(let Ne=0;Ne<P.length;Ne++)t.bindFramebuffer(36160,L.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ne,36161,null),t.bindFramebuffer(36160,L.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ne,3553,null,0);t.bindFramebuffer(36008,L.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,L.__webglFramebuffer);for(let Ne=0;Ne<P.length;Ne++){Ue.push(36064+Ne),B.depthBuffer&&Ue.push(ht);const Ve=void 0!==L.__ignoreDepthValues&&L.__ignoreDepthValues;if(!1===Ve&&(B.depthBuffer&&(Pe|=256),B.stencilBuffer&&(Pe|=1024)),le&&n.framebufferRenderbuffer(36008,36064,36161,L.__webglColorRenderbuffer[Ne]),!0===Ve&&(n.invalidateFramebuffer(36008,[ht]),n.invalidateFramebuffer(36009,[ht])),le){const G=i.get(P[Ne]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,G,0)}n.blitFramebuffer(0,0,ae,xe,0,0,ae,xe,Pe,9728),f&&n.invalidateFramebuffer(36008,Ue)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),le)for(let Ne=0;Ne<P.length;Ne++){t.bindFramebuffer(36160,L.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ne,36161,L.__webglColorRenderbuffer[Ne]);const Ve=i.get(P[Ne]).__webglTexture;t.bindFramebuffer(36160,L.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ne,3553,Ve,0)}t.bindFramebuffer(36009,L.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=fe,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=dt}function jk(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===nl)return 5121;if(s===LF)return 32819;if(s===FF)return 32820;if(s===RF)return 5120;if(s===PF)return 5122;if(s===_M)return 5123;if(s===IF)return 5124;if(s===il)return 5125;if(s===so)return 5126;if(s===rl)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===kF)return 6406;if(s===is)return 6408;if(s===vM)return 6409;if(s===NF)return 6410;if(s===sl)return 6402;if(s===gc)return 34041;if(s===yM)return 6403;if(s===OF)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===T_)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===BF)return 36244;if(s===jF)return 33319;if(s===UF)return 33320;if(s===VF)return 36249;if(s===g_||s===__||s===v_||s===y_)if(o===mn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===g_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===__)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===v_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===y_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===g_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===__)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===v_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===y_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===bM||s===xM||s===wM||s===MM){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===bM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===xM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===wM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===MM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===zF)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===SM||s===TM){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===SM)return o===mn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===TM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===CM||s===EM||s===DM||s===AM||s===RM||s===PM||s===IM||s===LM||s===FM||s===kM||s===OM||s===NM||s===BM||s===jM){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===CM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===EM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===DM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===AM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===RM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===PM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===IM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===LM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===FM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===kM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===OM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===NM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===BM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===jM)return o===mn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===UM){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===UM)return o===mn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===mc?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class Uk extends zi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Wo extends nn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Nee={type:"move"};class TS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Wo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Wo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new C,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new C),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Wo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new C,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new C),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(r=t.getPose(e.targetRaySpace,i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Nee))),c&&e.hand){o=!0;for(const m of e.hand.values()){const g=t.getJointPose(m,i);if(void 0===c.joints[m.jointName]){const v=new Wo;v.matrixAutoUpdate=!1,v.visible=!1,c.joints[m.jointName]=v,c.add(v)}const _=c.joints[m.jointName];null!==g&&(_.matrix.fromArray(g.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=g.radius),_.visible=null!==g}const d=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}}class Vk extends fr{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:sl)!==sl&&u!==gc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===sl&&(i=il),void 0===i&&u===gc&&(i=mc),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:xi,this.minFilter=void 0!==l?l:xi,this.flipY=!1,this.generateMipmaps=!1}}class Bee extends rs{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,h=null,d=null,f=null;const p=t.getContextAttributes();let m=null,g=null;const _=[],v=new Map,y=new zi;y.layers.enable(1),y.viewport=new gn;const b=new zi;b.layers.enable(2),b.viewport=new gn;const w=[y,b],M=new Uk;M.layers.enable(1),M.layers.enable(2);let T=null,x=null;function E(z){const Y=v.get(z.inputSource);void 0!==Y&&Y.dispatchEvent({type:z.type,data:z.inputSource})}function R(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",F),v.forEach(function(z,Y){void 0!==z&&z.disconnect(Y)}),v.clear(),T=null,x=null,e.setRenderTarget(m),d=null,h=null,u=null,r=null,g=null,W.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function F(z){const Y=r.inputSources;for(let oe=0;oe<Y.length;oe++)v.set(Y[oe],_["right"===Y[oe].handedness?1:0]);for(let oe=0;oe<z.removed.length;oe++){const $=z.removed[oe],me=v.get($);me&&(me.dispatchEvent({type:"disconnected",data:$}),v.delete($))}for(let oe=0;oe<z.added.length;oe++){const $=z.added[oe],me=v.get($);me&&me.dispatchEvent({type:"connected",data:$})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(z){let Y=_[z];return void 0===Y&&(Y=new TS,_[z]=Y),Y.getTargetRaySpace()},this.getControllerGrip=function(z){let Y=_[z];return void 0===Y&&(Y=new TS,_[z]=Y),Y.getGripSpace()},this.getHand=function(z){let Y=_[z];return void 0===Y&&(Y=new TS,_[z]=Y),Y.getHandSpace()},this.setFramebufferScaleFactor=function(z){s=z,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(z){a=z,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(z){l=z},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var z=no(function*(Y){if(r=Y,null!==r){if(m=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",R),r.addEventListener("inputsourceschange",F),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),g=new Nn(d.framebufferWidth,d.framebufferHeight,{format:is,type:nl,encoding:e.outputEncoding});else{let oe=null,$=null,me=null;p.depth&&(me=p.stencil?35056:33190,oe=p.stencil?gc:sl,$=p.stencil?mc:il);const he={colorFormat:e.outputEncoding===mn?35907:32856,depthFormat:me,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(he),r.updateRenderState({layers:[h]}),g=new Nn(h.textureWidth,h.textureHeight,{format:is,type:nl,depthTexture:new Vk(h.textureWidth,h.textureHeight,$,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=yield r.requestReferenceSpace(a),W.setContext(r),W.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Y){return z.apply(this,arguments)}}();const V=new C,H=new C;function q(z,Y){null===Y?z.matrixWorld.copy(z.matrix):z.matrixWorld.multiplyMatrices(Y.matrixWorld,z.matrix),z.matrixWorldInverse.copy(z.matrixWorld).invert()}this.updateCamera=function(z){if(null===r)return;M.near=b.near=y.near=z.near,M.far=b.far=y.far=z.far,(T!==M.near||x!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),T=M.near,x=M.far);const Y=z.parent,oe=M.cameras;q(M,Y);for(let me=0;me<oe.length;me++)q(oe[me],Y);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),z.position.copy(M.position),z.quaternion.copy(M.quaternion),z.scale.copy(M.scale),z.matrix.copy(M.matrix),z.matrixWorld.copy(M.matrixWorld);const $=z.children;for(let me=0,he=$.length;me<he;me++)$[me].updateMatrixWorld(!0);2===oe.length?function j(z,Y,oe){V.setFromMatrixPosition(Y.matrixWorld),H.setFromMatrixPosition(oe.matrixWorld);const $=V.distanceTo(H),me=Y.projectionMatrix.elements,he=oe.projectionMatrix.elements,Ae=me[14]/(me[10]-1),J=me[14]/(me[10]+1),X=(me[9]+1)/me[5],de=(me[9]-1)/me[5],Le=(me[8]-1)/me[0],_e=(he[8]+1)/he[0],st=Ae*Le,ue=Ae*_e,fe=$/(-Le+_e),Me=fe*-Le;Y.matrixWorld.decompose(z.position,z.quaternion,z.scale),z.translateX(Me),z.translateZ(fe),z.matrixWorld.compose(z.position,z.quaternion,z.scale),z.matrixWorldInverse.copy(z.matrixWorld).invert();const Je=Ae+fe,Ge=J+fe;z.projectionMatrix.makePerspective(st-Me,ue+($-Me),X*J/Ge*Je,de*J/Ge*Je,Je,Ge)}(M,y,b):M.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){return null!==h?h.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(z){null!==h&&(h.fixedFoveation=z),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=z)};let I=null;const W=new dk;W.setAnimationLoop(function U(z,Y){if(c=Y.getViewerPose(l||o),f=Y,null!==c){const $=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let me=!1;$.length!==M.cameras.length&&(M.cameras.length=0,me=!0);for(let he=0;he<$.length;he++){const Ae=$[he];let J=null;if(null!==d)J=d.getViewport(Ae);else{const de=u.getViewSubImage(h,Ae);J=de.viewport,0===he&&(e.setRenderTargetTextures(g,de.colorTexture,h.ignoreDepthValues?void 0:de.depthStencilTexture),e.setRenderTarget(g))}let X=w[he];void 0===X&&(X=new zi,X.layers.enable(he),X.viewport=new gn,w[he]=X),X.matrix.fromArray(Ae.transform.matrix),X.projectionMatrix.fromArray(Ae.projectionMatrix),X.viewport.set(J.x,J.y,J.width,J.height),0===he&&M.matrix.copy(X.matrix),!0===me&&M.cameras.push(X)}}const oe=r.inputSources;for(let $=0;$<_.length;$++){const me=oe[$],he=v.get(me);void 0!==he&&he.update(me,Y,l||o)}I&&I(z,Y),f=null}),this.setAnimationLoop=function(z){I=z},this.dispose=function(){}}}function jee(n,e){function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===ns&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===ns&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const _=e.get(g).envMap;if(_&&(m.envMap.value=_,m.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const b=!0!==n.physicallyCorrectLights?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}let v,y;g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity),g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix)),g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(m,g){m.fogColor.value.copy(g.color),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function i(m,g,_,v,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(r(m,g),function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(r(m,g),function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function d(m,g,_){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===ns&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=_.texture,m.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}(m,g,y)):g.isMeshMatcapMaterial?(r(m,g),function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}(m,g),g.isLineDashedMaterial&&function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function a(m,g,_,v){let y;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*_,m.scale.value=.5*v,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}(m,g,_,v):g.isSpriteMaterial?function l(m,g){let _;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),m.uvTransform.value.copy(_.matrix))}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function CS(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function Uee(){const n=Wf("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let h=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ol,this.physicallyCorrectLights=!1,this.toneMapping=Uo,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const m=this;let g=!1,_=0,v=0,y=null,b=-1,w=null;const M=new gn,T=new gn;let x=null,E=e.width,R=e.height,F=1,V=null,H=null;const j=new gn(0,0,E,R),q=new gn(0,0,E,R);let I=!1;const U=new K_;let W=!1,z=!1,Y=null;const oe=new ot,$=new te,me=new C,he={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ae(){return null===y?F:1}let de,Le,_e,st,ue,fe,Me,Je,Ge,bt,mt,dt,Jt,Wt,B,P,ae,xe,Pe,Ue,ht,L,le,J=t;function X(k,ne){for(let ce=0;ce<k.length;ce++){const ye=e.getContext(k[ce],ne);if(null!==ye)return ye}return null}try{const k={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${d_}`),e.addEventListener("webglcontextlost",G,!1),e.addEventListener("webglcontextrestored",De,!1),e.addEventListener("webglcontextcreationerror",je,!1),null===J){const ne=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&ne.shift(),J=X(ne,k),null===J)throw X(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===J.getShaderPrecisionFormat&&(J.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(k){throw console.error("THREE.WebGLRenderer: "+k.message),k}function Ne(){de=new nJ(J),Le=new K$(J,de,n),de.init(Le),L=new jk(J,de,Le),_e=new kee(J,de,Le),st=new sJ(J),ue=new Mee,fe=new Oee(J,de,_e,ue,Le,L,st),Me=new $$(m),Je=new tJ(m),Ge=new YK(J,Le),le=new Z$(J,de,Ge,Le),bt=new iJ(J,Ge,st,le),mt=new cJ(J,bt,Ge,st),Pe=new lJ(J,Le,fe),P=new Q$(ue),dt=new wee(m,Me,Je,de,Le,le,P),Jt=new jee(m,ue),Wt=new Tee,B=new Pee(de,Le),xe=new q$(m,Me,_e,mt,u,o),ae=new Fee(m,mt,Le),Ue=new Y$(J,de,st,Le),ht=new rJ(J,de,st,Le),st.programs=dt.programs,m.capabilities=Le,m.extensions=de,m.properties=ue,m.renderLists=Wt,m.shadowMap=ae,m.state=_e,m.info=st}Ne();const Ve=new Bee(m,J);function G(k){k.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function De(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const k=st.autoReset,ne=ae.enabled,ce=ae.autoUpdate,K=ae.needsUpdate,ye=ae.type;Ne(),st.autoReset=k,ae.enabled=ne,ae.autoUpdate=ce,ae.needsUpdate=K,ae.type=ye}function je(k){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",k.statusMessage)}function _t(k){const ne=k.target;ne.removeEventListener("dispose",_t),function Fe(k){(function Ke(k){const ne=ue.get(k).programs;void 0!==ne&&(ne.forEach(function(ce){dt.releaseProgram(ce)}),k.isShaderMaterial&&dt.releaseShaderCache(k))})(k),ue.remove(k)}(ne)}this.xr=Ve,this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){const k=de.get("WEBGL_lose_context");k&&k.loseContext()},this.forceContextRestore=function(){const k=de.get("WEBGL_lose_context");k&&k.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(k){void 0!==k&&(F=k,this.setSize(E,R,!1))},this.getSize=function(k){return k.set(E,R)},this.setSize=function(k,ne,ce){Ve.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=k,R=ne,e.width=Math.floor(k*F),e.height=Math.floor(ne*F),!1!==ce&&(e.style.width=k+"px",e.style.height=ne+"px"),this.setViewport(0,0,k,ne))},this.getDrawingBufferSize=function(k){return k.set(E*F,R*F).floor()},this.setDrawingBufferSize=function(k,ne,ce){E=k,R=ne,F=ce,e.width=Math.floor(k*ce),e.height=Math.floor(ne*ce),this.setViewport(0,0,k,ne)},this.getCurrentViewport=function(k){return k.copy(M)},this.getViewport=function(k){return k.copy(j)},this.setViewport=function(k,ne,ce,K){k.isVector4?j.set(k.x,k.y,k.z,k.w):j.set(k,ne,ce,K),_e.viewport(M.copy(j).multiplyScalar(F).floor())},this.getScissor=function(k){return k.copy(q)},this.setScissor=function(k,ne,ce,K){k.isVector4?q.set(k.x,k.y,k.z,k.w):q.set(k,ne,ce,K),_e.scissor(T.copy(q).multiplyScalar(F).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(k){_e.setScissorTest(I=k)},this.setOpaqueSort=function(k){V=k},this.setTransparentSort=function(k){H=k},this.getClearColor=function(k){return k.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(k=!0,ne=!0,ce=!0){let K=0;k&&(K|=16384),ne&&(K|=256),ce&&(K|=1024),J.clear(K)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",G,!1),e.removeEventListener("webglcontextrestored",De,!1),e.removeEventListener("webglcontextcreationerror",je,!1),Wt.dispose(),B.dispose(),ue.dispose(),Me.dispose(),Je.dispose(),mt.dispose(),le.dispose(),dt.dispose(),Ve.dispose(),Ve.removeEventListener("sessionstart",Yt),Ve.removeEventListener("sessionend",xn),Y&&(Y.dispose(),Y=null),or.stop()},this.renderBufferDirect=function(k,ne,ce,K,ye,It){null===ne&&(ne=he);const S=ye.isMesh&&ye.matrixWorld.determinant()<0,D=function j1(k,ne,ce,K,ye){!0!==ne.isScene&&(ne=he),fe.resetTextureUnits();const It=ne.fog,D=null===y?m.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:ol,O=(K.isMeshStandardMaterial?Je:Me).get(K.envMap||(K.isMeshStandardMaterial?ne.environment:null)),Z=!0===K.vertexColors&&!!ce.attributes.color&&4===ce.attributes.color.itemSize,ie=!!K.normalMap&&!!ce.attributes.tangent,ee=!!ce.morphAttributes.position,ve=!!ce.morphAttributes.normal,ke=!!ce.morphAttributes.color,ze=K.toneMapped?m.toneMapping:Uo,we=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,Ie=void 0!==we?we.length:0,Oe=ue.get(K),lt=d.state.lights;!0!==W||!0!==z&&k===w||P.setState(K,k,k===w&&K.id===b);let rt=!1;K.version===Oe.__version?(Oe.needsLights&&Oe.lightsStateVersion!==lt.state.version||Oe.outputEncoding!==D||ye.isInstancedMesh&&!1===Oe.instancing||!ye.isInstancedMesh&&!0===Oe.instancing||ye.isSkinnedMesh&&!1===Oe.skinning||!ye.isSkinnedMesh&&!0===Oe.skinning||Oe.envMap!==O||!0===K.fog&&Oe.fog!==It||void 0!==Oe.numClippingPlanes&&(Oe.numClippingPlanes!==P.numPlanes||Oe.numIntersection!==P.numIntersection)||Oe.vertexAlphas!==Z||Oe.vertexTangents!==ie||Oe.morphTargets!==ee||Oe.morphNormals!==ve||Oe.morphColors!==ke||Oe.toneMapping!==ze||!0===Le.isWebGL2&&Oe.morphTargetsCount!==Ie)&&(rt=!0):(rt=!0,Oe.__version=K.version);let Tt=Oe.currentProgram;!0===rt&&(Tt=dm(K,ne,ye));let ct=!1,ft=!1,Kt=!1;const en=Tt.getUniforms(),Vn=Oe.uniforms;if(_e.useProgram(Tt.program)&&(ct=!0,ft=!0,Kt=!0),K.id!==b&&(b=K.id,ft=!0),ct||w!==k){if(en.setValue(J,"projectionMatrix",k.projectionMatrix),Le.logarithmicDepthBuffer&&en.setValue(J,"logDepthBufFC",2/(Math.log(k.far+1)/Math.LN2)),w!==k&&(w=k,ft=!0,Kt=!0),K.isShaderMaterial||K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshStandardMaterial||K.envMap){const cn=en.map.cameraPosition;void 0!==cn&&cn.setValue(J,me.setFromMatrixPosition(k.matrixWorld))}(K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshLambertMaterial||K.isMeshBasicMaterial||K.isMeshStandardMaterial||K.isShaderMaterial)&&en.setValue(J,"isOrthographic",!0===k.isOrthographicCamera),(K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshLambertMaterial||K.isMeshBasicMaterial||K.isMeshStandardMaterial||K.isShaderMaterial||K.isShadowMaterial||ye.isSkinnedMesh)&&en.setValue(J,"viewMatrix",k.matrixWorldInverse)}if(ye.isSkinnedMesh){en.setOptional(J,ye,"bindMatrix"),en.setOptional(J,ye,"bindMatrixInverse");const cn=ye.skeleton;cn&&(Le.floatVertexTextures?(null===cn.boneTexture&&cn.computeBoneTexture(),en.setValue(J,"boneTexture",cn.boneTexture,fe),en.setValue(J,"boneTextureSize",cn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const ar=ce.morphAttributes;return(void 0!==ar.position||void 0!==ar.normal||void 0!==ar.color&&!0===Le.isWebGL2)&&Pe.update(ye,ce,K,Tt),(ft||Oe.receiveShadow!==ye.receiveShadow)&&(Oe.receiveShadow=ye.receiveShadow,en.setValue(J,"receiveShadow",ye.receiveShadow)),ft&&(en.setValue(J,"toneMappingExposure",m.toneMappingExposure),Oe.needsLights&&function U1(k,ne){k.ambientLightColor.needsUpdate=ne,k.lightProbe.needsUpdate=ne,k.directionalLights.needsUpdate=ne,k.directionalLightShadows.needsUpdate=ne,k.pointLights.needsUpdate=ne,k.pointLightShadows.needsUpdate=ne,k.spotLights.needsUpdate=ne,k.spotLightShadows.needsUpdate=ne,k.rectAreaLights.needsUpdate=ne,k.hemisphereLights.needsUpdate=ne}(Vn,Kt),It&&!0===K.fog&&Jt.refreshFogUniforms(Vn,It),Jt.refreshMaterialUniforms(Vn,K,F,R,Y),J_.upload(J,Oe.uniformsList,Vn,fe)),K.isShaderMaterial&&!0===K.uniformsNeedUpdate&&(J_.upload(J,Oe.uniformsList,Vn,fe),K.uniformsNeedUpdate=!1),K.isSpriteMaterial&&en.setValue(J,"center",ye.center),en.setValue(J,"modelViewMatrix",ye.modelViewMatrix),en.setValue(J,"normalMatrix",ye.normalMatrix),en.setValue(J,"modelMatrix",ye.matrixWorld),Tt}(k,ne,ce,K,ye);_e.setMaterial(K,S);let O=ce.index;const Z=ce.attributes.position;if(null===O){if(void 0===Z||0===Z.count)return}else if(0===O.count)return;let ie=1;!0===K.wireframe&&(O=bt.getWireframeAttribute(ce),ie=2),le.setup(ye,K,D,ce,O);let ee,ve=Ue;null!==O&&(ee=Ge.get(O),ve=ht,ve.setIndex(ee));const ke=null!==O?O.count:Z.count,ze=ce.drawRange.start*ie,we=ce.drawRange.count*ie,Ie=null!==It?It.start*ie:0,Oe=null!==It?It.count*ie:1/0,lt=Math.max(ze,Ie),rt=Math.min(ke,ze+we,Ie+Oe)-1,Tt=Math.max(0,rt-lt+1);if(0!==Tt){if(ye.isMesh)!0===K.wireframe?(_e.setLineWidth(K.wireframeLinewidth*Ae()),ve.setMode(1)):ve.setMode(4);else if(ye.isLine){let ct=K.linewidth;void 0===ct&&(ct=1),_e.setLineWidth(ct*Ae()),ve.setMode(ye.isLineSegments?1:ye.isLineLoop?2:3)}else ye.isPoints?ve.setMode(0):ye.isSprite&&ve.setMode(4);if(ye.isInstancedMesh)ve.renderInstances(lt,Tt,ye.count);else if(ce.isInstancedBufferGeometry){const ct=Math.min(ce.instanceCount,ce._maxInstanceCount);ve.renderInstances(lt,Tt,ct)}else ve.render(lt,Tt)}},this.compile=function(k,ne){d=B.get(k),d.init(),p.push(d),k.traverseVisible(function(ce){ce.isLight&&ce.layers.test(ne.layers)&&(d.pushLight(ce),ce.castShadow&&d.pushShadow(ce))}),d.setupLights(m.physicallyCorrectLights),k.traverse(function(ce){const K=ce.material;if(K)if(Array.isArray(K))for(let ye=0;ye<K.length;ye++)dm(K[ye],k,ce);else dm(K,k,ce)}),p.pop(),d=null};let Be=null;function Yt(){or.stop()}function xn(){or.start()}const or=new dk;function Bs(k,ne,ce,K){if(!1===k.visible)return;if(k.layers.test(ne.layers))if(k.isGroup)ce=k.renderOrder;else if(k.isLOD)!0===k.autoUpdate&&k.update(ne);else if(k.isLight)d.pushLight(k),k.castShadow&&d.pushShadow(k);else if(k.isSprite){if(!k.frustumCulled||U.intersectsSprite(k)){K&&me.setFromMatrixPosition(k.matrixWorld).applyMatrix4(oe);const S=mt.update(k),D=k.material;D.visible&&h.push(k,S,D,ce,me.z,null)}}else if((k.isMesh||k.isLine||k.isPoints)&&(k.isSkinnedMesh&&k.skeleton.frame!==st.render.frame&&(k.skeleton.update(),k.skeleton.frame=st.render.frame),!k.frustumCulled||U.intersectsObject(k))){K&&me.setFromMatrixPosition(k.matrixWorld).applyMatrix4(oe);const S=mt.update(k),D=k.material;if(Array.isArray(D)){const O=S.groups;for(let Z=0,ie=O.length;Z<ie;Z++){const ee=O[Z],ve=D[ee.materialIndex];ve&&ve.visible&&h.push(k,S,ve,ce,me.z,ee)}}else D.visible&&h.push(k,S,D,ce,me.z,null)}const It=k.children;for(let S=0,D=It.length;S<D;S++)Bs(It[S],ne,ce,K)}function c0(k,ne,ce,K){const ye=k.opaque,It=k.transmissive,S=k.transparent;d.setupLightsView(ce),It.length>0&&function N1(k,ne,ce){const K=Le.isWebGL2;null===Y&&(Y=new Nn(1,1,{generateMipmaps:!0,type:de.has("EXT_color_buffer_half_float")?rl:nl,minFilter:va,samples:K&&!0===s?4:0})),m.getDrawingBufferSize($),K?Y.setSize($.x,$.y):Y.setSize(C_($.x),C_($.y));const ye=m.getRenderTarget();m.setRenderTarget(Y),m.clear();const It=m.toneMapping;m.toneMapping=Uo,Md(k,ne,ce),m.toneMapping=It,fe.updateMultisampleRenderTarget(Y),fe.updateRenderTargetMipmap(Y),m.setRenderTarget(ye)}(ye,ne,ce),K&&_e.viewport(M.copy(K)),ye.length>0&&Md(ye,ne,ce),It.length>0&&Md(It,ne,ce),S.length>0&&Md(S,ne,ce),_e.buffers.depth.setTest(!0),_e.buffers.depth.setMask(!0),_e.buffers.color.setMask(!0),_e.setPolygonOffset(!1)}function Md(k,ne,ce){const K=!0===ne.isScene?ne.overrideMaterial:null;for(let ye=0,It=k.length;ye<It;ye++){const S=k[ye],D=S.object,O=S.geometry,Z=null===K?S.material:K,ie=S.group;D.layers.test(ce.layers)&&B1(D,ne,ce,O,Z,ie)}}function B1(k,ne,ce,K,ye,It){k.onBeforeRender(m,ne,ce,K,ye,It),k.modelViewMatrix.multiplyMatrices(ce.matrixWorldInverse,k.matrixWorld),k.normalMatrix.getNormalMatrix(k.modelViewMatrix),ye.onBeforeRender(m,ne,ce,K,k,It),!0===ye.transparent&&ye.side===io?(ye.side=ns,ye.needsUpdate=!0,m.renderBufferDirect(ce,ne,K,ye,k,It),ye.side=$a,ye.needsUpdate=!0,m.renderBufferDirect(ce,ne,K,ye,k,It),ye.side=io):m.renderBufferDirect(ce,ne,K,ye,k,It),k.onAfterRender(m,ne,ce,K,ye,It)}function dm(k,ne,ce){!0!==ne.isScene&&(ne=he);const K=ue.get(k),ye=d.state.lights,S=ye.state.version,D=dt.getParameters(k,ye.state,d.state.shadowsArray,ne,ce),O=dt.getProgramCacheKey(D);let Z=K.programs;K.environment=k.isMeshStandardMaterial?ne.environment:null,K.fog=ne.fog,K.envMap=(k.isMeshStandardMaterial?Je:Me).get(k.envMap||K.environment),void 0===Z&&(k.addEventListener("dispose",_t),Z=new Map,K.programs=Z);let ie=Z.get(O);if(void 0!==ie){if(K.currentProgram===ie&&K.lightsStateVersion===S)return u0(k,D),ie}else D.uniforms=dt.getUniforms(k),k.onBuild(ce,D,m),k.onBeforeCompile(D,m),ie=dt.acquireProgram(D,O),Z.set(O,ie),K.uniforms=D.uniforms;const ee=K.uniforms;(!k.isShaderMaterial&&!k.isRawShaderMaterial||!0===k.clipping)&&(ee.clippingPlanes=P.uniform),u0(k,D),K.needsLights=function Sd(k){return k.isMeshLambertMaterial||k.isMeshToonMaterial||k.isMeshPhongMaterial||k.isMeshStandardMaterial||k.isShadowMaterial||k.isShaderMaterial&&!0===k.lights}(k),K.lightsStateVersion=S,K.needsLights&&(ee.ambientLightColor.value=ye.state.ambient,ee.lightProbe.value=ye.state.probe,ee.directionalLights.value=ye.state.directional,ee.directionalLightShadows.value=ye.state.directionalShadow,ee.spotLights.value=ye.state.spot,ee.spotLightShadows.value=ye.state.spotShadow,ee.rectAreaLights.value=ye.state.rectArea,ee.ltc_1.value=ye.state.rectAreaLTC1,ee.ltc_2.value=ye.state.rectAreaLTC2,ee.pointLights.value=ye.state.point,ee.pointLightShadows.value=ye.state.pointShadow,ee.hemisphereLights.value=ye.state.hemi,ee.directionalShadowMap.value=ye.state.directionalShadowMap,ee.directionalShadowMatrix.value=ye.state.directionalShadowMatrix,ee.spotShadowMap.value=ye.state.spotShadowMap,ee.spotShadowMatrix.value=ye.state.spotShadowMatrix,ee.pointShadowMap.value=ye.state.pointShadowMap,ee.pointShadowMatrix.value=ye.state.pointShadowMatrix);const ve=ie.getUniforms(),ke=J_.seqWithValue(ve.seq,ee);return K.currentProgram=ie,K.uniformsList=ke,ie}function u0(k,ne){const ce=ue.get(k);ce.outputEncoding=ne.outputEncoding,ce.instancing=ne.instancing,ce.skinning=ne.skinning,ce.morphTargets=ne.morphTargets,ce.morphNormals=ne.morphNormals,ce.morphColors=ne.morphColors,ce.morphTargetsCount=ne.morphTargetsCount,ce.numClippingPlanes=ne.numClippingPlanes,ce.numIntersection=ne.numClipIntersection,ce.vertexAlphas=ne.vertexAlphas,ce.vertexTangents=ne.vertexTangents,ce.toneMapping=ne.toneMapping}or.setAnimationLoop(function ge(k){Be&&Be(k)}),typeof self<"u"&&or.setContext(self),this.setAnimationLoop=function(k){Be=k,Ve.setAnimationLoop(k),null===k?or.stop():or.start()},Ve.addEventListener("sessionstart",Yt),Ve.addEventListener("sessionend",xn),this.render=function(k,ne){if(void 0===ne||!0===ne.isCamera){if(!0!==g){if(!0===k.autoUpdate&&k.updateMatrixWorld(),null===ne.parent&&ne.updateMatrixWorld(),!0===Ve.enabled&&!0===Ve.isPresenting&&(!0===Ve.cameraAutoUpdate&&Ve.updateCamera(ne),ne=Ve.getCamera()),!0===k.isScene&&k.onBeforeRender(m,k,ne,y),d=B.get(k,p.length),d.init(),p.push(d),oe.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),U.setFromProjectionMatrix(oe),z=this.localClippingEnabled,W=P.init(this.clippingPlanes,z,ne),h=Wt.get(k,f.length),h.init(),f.push(h),Bs(k,ne,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(V,H),!0===W&&P.beginShadows(),ae.render(d.state.shadowsArray,k,ne),!0===W&&P.endShadows(),!0===this.info.autoReset&&this.info.reset(),xe.render(h,k),d.setupLights(m.physicallyCorrectLights),ne.isArrayCamera){const K=ne.cameras;for(let ye=0,It=K.length;ye<It;ye++){const S=K[ye];c0(h,k,S,S.viewport)}}else c0(h,k,ne);null!==y&&(fe.updateMultisampleRenderTarget(y),fe.updateRenderTargetMipmap(y)),!0===k.isScene&&k.onAfterRender(m,k,ne),le.resetDefaultState(),b=-1,w=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(k,ne,ce){ue.get(k.texture).__webglTexture=ne,ue.get(k.depthTexture).__webglTexture=ce;const K=ue.get(k);K.__hasExternalTextures=!0,K.__hasExternalTextures&&(K.__autoAllocateDepthBuffer=void 0===ce,K.__autoAllocateDepthBuffer||!0===de.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),K.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(k,ne){const ce=ue.get(k);ce.__webglFramebuffer=ne,ce.__useDefaultFramebuffer=void 0===ne},this.setRenderTarget=function(k,ne=0,ce=0){y=k,_=ne,v=ce;let K=!0;if(k){const O=ue.get(k);void 0!==O.__useDefaultFramebuffer?(_e.bindFramebuffer(36160,null),K=!1):void 0===O.__webglFramebuffer?fe.setupRenderTarget(k):O.__hasExternalTextures&&fe.rebindTextures(k,ue.get(k.texture).__webglTexture,ue.get(k.depthTexture).__webglTexture)}let ye=null,It=!1,S=!1;if(k){const O=k.texture;(O.isData3DTexture||O.isDataArrayTexture)&&(S=!0);const Z=ue.get(k).__webglFramebuffer;k.isWebGLCubeRenderTarget?(ye=Z[ne],It=!0):ye=Le.isWebGL2&&k.samples>0&&!1===fe.useMultisampledRTT(k)?ue.get(k).__webglMultisampledFramebuffer:Z,M.copy(k.viewport),T.copy(k.scissor),x=k.scissorTest}else M.copy(j).multiplyScalar(F).floor(),T.copy(q).multiplyScalar(F).floor(),x=I;if(_e.bindFramebuffer(36160,ye)&&Le.drawBuffers&&K&&_e.drawBuffers(k,ye),_e.viewport(M),_e.scissor(T),_e.setScissorTest(x),It){const O=ue.get(k.texture);J.framebufferTexture2D(36160,36064,34069+ne,O.__webglTexture,ce)}else if(S){const O=ue.get(k.texture);J.framebufferTextureLayer(36160,36064,O.__webglTexture,ce||0,ne||0)}b=-1},this.readRenderTargetPixels=function(k,ne,ce,K,ye,It,S){if(!k||!k.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let D=ue.get(k).__webglFramebuffer;if(k.isWebGLCubeRenderTarget&&void 0!==S&&(D=D[S]),D){_e.bindFramebuffer(36160,D);try{const O=k.texture,Z=O.format,ie=O.type;if(Z!==is&&L.convert(Z)!==J.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ee=ie===rl&&(de.has("EXT_color_buffer_half_float")||Le.isWebGL2&&de.has("EXT_color_buffer_float"));if(!(ie===nl||L.convert(ie)===J.getParameter(35738)||ie===so&&(Le.isWebGL2||de.has("OES_texture_float")||de.has("WEBGL_color_buffer_float"))||ee))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ne>=0&&ne<=k.width-K&&ce>=0&&ce<=k.height-ye&&J.readPixels(ne,ce,K,ye,L.convert(Z),L.convert(ie),It)}finally{const O=null!==y?ue.get(y).__webglFramebuffer:null;_e.bindFramebuffer(36160,O)}}},this.copyFramebufferToTexture=function(k,ne,ce=0){const K=Math.pow(2,-ce),ye=Math.floor(ne.image.width*K),It=Math.floor(ne.image.height*K);fe.setTexture2D(ne,0),J.copyTexSubImage2D(3553,ce,0,0,k.x,k.y,ye,It),_e.unbindTexture()},this.copyTextureToTexture=function(k,ne,ce,K=0){const ye=ne.image.width,It=ne.image.height,S=L.convert(ce.format),D=L.convert(ce.type);fe.setTexture2D(ce,0),J.pixelStorei(37440,ce.flipY),J.pixelStorei(37441,ce.premultiplyAlpha),J.pixelStorei(3317,ce.unpackAlignment),ne.isDataTexture?J.texSubImage2D(3553,K,k.x,k.y,ye,It,S,D,ne.image.data):ne.isCompressedTexture?J.compressedTexSubImage2D(3553,K,k.x,k.y,ne.mipmaps[0].width,ne.mipmaps[0].height,S,ne.mipmaps[0].data):J.texSubImage2D(3553,K,k.x,k.y,S,D,ne.image),0===K&&ce.generateMipmaps&&J.generateMipmap(3553),_e.unbindTexture()},this.copyTextureToTexture3D=function(k,ne,ce,K,ye=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const It=k.max.x-k.min.x+1,S=k.max.y-k.min.y+1,D=k.max.z-k.min.z+1,O=L.convert(K.format),Z=L.convert(K.type);let ie;if(K.isData3DTexture)fe.setTexture3D(K,0),ie=32879;else{if(!K.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");fe.setTexture2DArray(K,0),ie=35866}J.pixelStorei(37440,K.flipY),J.pixelStorei(37441,K.premultiplyAlpha),J.pixelStorei(3317,K.unpackAlignment);const ee=J.getParameter(3314),ve=J.getParameter(32878),ke=J.getParameter(3316),ze=J.getParameter(3315),we=J.getParameter(32877),Ie=ce.isCompressedTexture?ce.mipmaps[0]:ce.image;J.pixelStorei(3314,Ie.width),J.pixelStorei(32878,Ie.height),J.pixelStorei(3316,k.min.x),J.pixelStorei(3315,k.min.y),J.pixelStorei(32877,k.min.z),ce.isDataTexture||ce.isData3DTexture?J.texSubImage3D(ie,ye,ne.x,ne.y,ne.z,It,S,D,O,Z,Ie.data):ce.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),J.compressedTexSubImage3D(ie,ye,ne.x,ne.y,ne.z,It,S,D,O,Ie.data)):J.texSubImage3D(ie,ye,ne.x,ne.y,ne.z,It,S,D,O,Z,Ie),J.pixelStorei(3314,ee),J.pixelStorei(32878,ve),J.pixelStorei(3316,ke),J.pixelStorei(3315,ze),J.pixelStorei(32877,we),0===ye&&K.generateMipmaps&&J.generateMipmap(ie),_e.unbindTexture()},this.initTexture=function(k){fe.setTexture2D(k,0),_e.unbindTexture()},this.resetState=function(){_=0,v=0,y=null,_e.reset(),le.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class zk extends CS{}zk.prototype.isWebGL1Renderer=!0;class tv{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ce(e),this.density=t}clone(){return new tv(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class ep{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Ce(e),this.near=t,this.far=i}clone(){return new ep(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ES extends nn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class tp{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=M_,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ss()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Rr=new C;class gl{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.applyMatrix4(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.applyNormalMatrix(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.transformDirection(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new En(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new gl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class DS extends mi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ce(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ch;const np=new C,Eh=new C,Dh=new C,Ah=new te,ip=new te,Hk=new ot,nv=new C,rp=new C,iv=new C,Gk=new te,AS=new te,Wk=new te;class Xk extends nn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Ch){Ch=new wt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new tp(t,5);Ch.setIndex([0,1,2,0,2,3]),Ch.setAttribute("position",new gl(i,3,0,!1)),Ch.setAttribute("uv",new gl(i,2,3,!1))}this.geometry=Ch,this.material=void 0!==e?e:new DS,this.center=new te(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Eh.setFromMatrixScale(this.matrixWorld),Hk.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Dh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Eh.multiplyScalar(-Dh.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;rv(nv.set(-.5,-.5,0),Dh,o,Eh,r,s),rv(rp.set(.5,-.5,0),Dh,o,Eh,r,s),rv(iv.set(.5,.5,0),Dh,o,Eh,r,s),Gk.set(0,0),AS.set(1,0),Wk.set(1,1);let a=e.ray.intersectTriangle(nv,rp,iv,!1,np);if(null===a&&(rv(rp.set(-.5,.5,0),Dh,o,Eh,r,s),AS.set(0,1),a=e.ray.intersectTriangle(nv,iv,rp,!1,np),null===a))return;const l=e.ray.origin.distanceTo(np);l<e.near||l>e.far||t.push({distance:l,point:np.clone(),uv:as.getUV(np,nv,rp,iv,Gk,AS,Wk,new te),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function rv(n,e,t,i,r,s){Ah.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(ip.x=s*Ah.x-r*Ah.y,ip.y=r*Ah.x+s*Ah.y):ip.copy(Ah),n.copy(e),n.x+=ip.x,n.y+=ip.y,n.applyMatrix4(Hk)}const sv=new C,qk=new C;class Zk extends nn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r&&!(e<t[i].distance);i++);return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){sv.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(sv);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){sv.setFromMatrixPosition(e.matrixWorld),qk.setFromMatrixPosition(this.matrixWorld);const i=sv.distanceTo(qk)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s&&i>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}const Yk=new C,Kk=new gn,Qk=new gn,Vee=new C,$k=new ot;class RS extends qe{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ot,this.bindMatrixInverse=new ot}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;Kk.fromBufferAttribute(r.attributes.skinIndex,e),Qk.fromBufferAttribute(r.attributes.skinWeight,e),Yk.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=Qk.getComponent(s);if(0!==o){const a=Kk.getComponent(s);$k.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Vee.copy(Yk).applyMatrix4($k),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class ov extends nn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ac extends fr{constructor(e=null,t=1,i=1,r,s,o,a,l,c=xi,u=xi,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Jk=new ot,zee=new ot;class sp{constructor(e=[],t=[]){this.uuid=ss(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new ot)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new ot;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)Jk.multiplyMatrices(e[s]?e[s].matrixWorld:zee,t[s]),Jk.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new sp(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=KF(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Ac(t,e,e,is,so);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new ov),this.bones.push(o),this.boneInverses.push((new ot).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Rh extends En{constructor(e,t,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const eO=new ot,tO=new ot,av=[],op=new qe;class PS extends qe{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Rh(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(op.geometry=this.geometry,op.material=this.material,void 0!==op.material)for(let s=0;s<r;s++){this.getMatrixAt(s,eO),tO.multiplyMatrices(i,eO),op.matrixWorld=tO,op.raycast(e,av);for(let o=0,a=av.length;o<a;o++){const l=av[o];l.instanceId=s,l.object=this,t.push(l)}av.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Rh(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Pi extends mi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ce(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const nO=new C,iO=new C,rO=new ot,IS=new Zf,lv=new ba;class Mi extends nn{constructor(e=new wt,t=new Pi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)nO.fromBufferAttribute(t,r-1),iO.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=nO.distanceTo(iO);e.setAttribute("lineDistance",new $e(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),lv.copy(i.boundingSphere),lv.applyMatrix4(r),lv.radius+=s,!1===e.ray.intersectsSphere(lv))return;rO.copy(r).invert(),IS.copy(e.ray).applyMatrix4(rO);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new C,u=new C,h=new C,d=new C,f=this.isLineSegments?2:1,p=i.index,g=i.attributes.position;if(null!==p)for(let y=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count)-1;y<b;y+=f){const w=p.getX(y),M=p.getX(y+1);if(c.fromBufferAttribute(g,w),u.fromBufferAttribute(g,M),IS.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const x=e.ray.origin.distanceTo(d);x<e.near||x>e.far||t.push({distance:x,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),b=Math.min(g.count,o.start+o.count)-1;y<b;y+=f){if(c.fromBufferAttribute(g,y),u.fromBufferAttribute(g,y+1),IS.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||t.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const sO=new C,oO=new C;class Cs extends Mi{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)sO.fromBufferAttribute(t,r),oO.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+sO.distanceTo(oO);e.setAttribute("lineDistance",new $e(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LS extends Mi{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class cv extends mi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ce(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const aO=new ot,FS=new Zf,uv=new ba,hv=new C;class kS extends nn{constructor(e=new wt,t=new cv){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),uv.copy(i.boundingSphere),uv.applyMatrix4(r),uv.radius+=s,!1===e.ray.intersectsSphere(uv))return;aO.copy(r).invert(),FS.copy(e.ray).applyMatrix4(aO);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,h=i.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);p<m;p++){const g=c.getX(p);hv.fromBufferAttribute(h,g),lO(hv,g,l,r,e,t,this)}else for(let p=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);p<m;p++)hv.fromBufferAttribute(h,p),lO(hv,p,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function lO(n,e,t,i,r,s,o){const a=FS.distanceSqToPoint(n);if(a<t){const l=new C;FS.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Hee extends fr{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:si,this.magFilter=void 0!==s?s:si,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Gee extends fr{constructor(e,t,i){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=xi,this.minFilter=xi,this.generateMipmaps=!1,this.needsUpdate=!0}}class cO extends fr{constructor(e,t,i,r,s,o,a,l,c,u,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class OS extends fr{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class uo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new te:new C);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new C,r=[],s=[],o=[],a=new C,l=new ot;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new C);s[0]=new C,o[0]=new C;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),h<=c&&(c=h,i.set(0,1,0)),d<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(wi(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(wi(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class _l extends uo{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new te,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*u-f*h+this.aX,c=d*h+f*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class uO extends _l{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function NS(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+h)+(l-a)/h;d*=u,f*=u,r(o,a,d,f)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const dv=new C,BS=new NS,jS=new NS,US=new NS;class hO extends uo{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new C){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,u,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(dv.subVectors(r[0],r[1]).add(r[0]),c=dv);const h=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(dv.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=dv),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let p=Math.pow(c.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(d),f),g=Math.pow(d.distanceToSquared(u),f);m<1e-4&&(m=1),p<1e-4&&(p=m),g<1e-4&&(g=m),BS.initNonuniformCatmullRom(c.x,h.x,d.x,u.x,p,m,g),jS.initNonuniformCatmullRom(c.y,h.y,d.y,u.y,p,m,g),US.initNonuniformCatmullRom(c.z,h.z,d.z,u.z,p,m,g)}else"catmullrom"===this.curveType&&(BS.initCatmullRom(c.x,h.x,d.x,u.x,this.tension),jS.initCatmullRom(c.y,h.y,d.y,u.y,this.tension),US.initCatmullRom(c.z,h.z,d.z,u.z,this.tension));return i.set(BS.calc(l),jS.calc(l),US.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new C).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function dO(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function ap(n,e,t,i){return function Wee(n,e){const t=1-n;return t*t*e}(n,e)+function Xee(n,e){return 2*(1-n)*n*e}(n,t)+function qee(n,e){return n*n*e}(n,i)}function lp(n,e,t,i,r){return function Zee(n,e){const t=1-n;return t*t*t*e}(n,e)+function Yee(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function Kee(n,e){return 3*(1-n)*n*n*e}(n,i)+function Qee(n,e){return n*n*n*e}(n,r)}class VS extends uo{constructor(e=new te,t=new te,i=new te,r=new te){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new te){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(lp(e,r.x,s.x,o.x,a.x),lp(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fO extends uo{constructor(e=new C,t=new C,i=new C,r=new C){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new C){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(lp(e,r.x,s.x,o.x,a.x),lp(e,r.y,s.y,o.y,a.y),lp(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fv extends uo{constructor(e=new te,t=new te){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new te){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new te;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class pO extends uo{constructor(e=new C,t=new C){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new C){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zS extends uo{constructor(e=new te,t=new te,i=new te){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new te){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(ap(e,r.x,s.x,o.x),ap(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class HS extends uo{constructor(e=new C,t=new C,i=new C){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new C){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(ap(e,r.x,s.x,o.x),ap(e,r.y,s.y,o.y),ap(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class GS extends uo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new te){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(dO(a,l.x,c.x,u.x,h.x),dO(a,l.y,c.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new te).fromArray(r))}return this}}var WS=Object.freeze({__proto__:null,ArcCurve:uO,CatmullRomCurve3:hO,CubicBezierCurve:VS,CubicBezierCurve3:fO,EllipseCurve:_l,LineCurve:fv,LineCurve3:pO,QuadraticBezierCurve:zS,QuadraticBezierCurve3:HS,SplineCurve:GS});class mO extends uo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new fv(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new WS[r.type]).fromJSON(r))}return this}}class cp extends mO{constructor(e){super(),this.type="Path",this.currentPoint=new te,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new fv(this.currentPoint.clone(),new te(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new zS(this.currentPoint.clone(),new te(e,t),new te(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new VS(this.currentPoint.clone(),new te(e,t),new te(i,r),new te(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new GS(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new _l(e,t,i,r,s,o,a,l);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Rc extends wt{constructor(e=[new te(0,.5),new te(.5,0),new te(0,-.5)],t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=wi(r,0,2*Math.PI);const s=[],o=[],a=[],l=[],c=[],u=1/t,h=new C,d=new te,f=new C,p=new C,m=new C;let g=0,_=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,_=e[v+1].y-e[v].y,f.x=1*_,f.y=-g,f.z=0*_,m.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[v+1].x-e[v].x,_=e[v+1].y-e[v].y,f.x=1*_,f.y=-g,f.z=0*_,p.copy(f),f.x+=m.x,f.y+=m.y,f.z+=m.z,f.normalize(),l.push(f.x,f.y,f.z),m.copy(p)}for(let v=0;v<=t;v++){const y=i+v*u*r,b=Math.sin(y),w=Math.cos(y);for(let M=0;M<=e.length-1;M++)h.x=e[M].x*b,h.y=e[M].y,h.z=e[M].x*w,o.push(h.x,h.y,h.z),d.x=v/t,d.y=M/(e.length-1),a.push(d.x,d.y),c.push(l[3*M+0]*b,l[3*M+1],l[3*M+0]*w)}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){const b=y+v*e.length,M=b+e.length,T=b+e.length+1,x=b+1;s.push(b,M,x),s.push(T,x,M)}this.setIndex(s),this.setAttribute("position",new $e(o,3)),this.setAttribute("uv",new $e(a,2)),this.setAttribute("normal",new $e(c,3))}static fromJSON(e){return new Rc(e.points,e.segments,e.phiStart,e.phiLength)}}class Ph extends Rc{constructor(e=1,t=1,i=4,r=8){const s=new cp;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new Ph(e.radius,e.length,e.capSegments,e.radialSegments)}}class Ih extends wt{constructor(e=1,t=8,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new C,u=new te;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,d=3;h<=t;h++,d+=3){const f=i+h/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[d]/e+1)/2,u.y=(o[d+1]/e+1)/2,l.push(u.x,u.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new $e(o,3)),this.setAttribute("normal",new $e(a,3)),this.setAttribute("uv",new $e(l,2))}static fromJSON(e){return new Ih(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class gi extends wt{constructor(e=1,t=1,i=1,r=8,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const m=[],g=i/2;let _=0;function y(b){const w=p,M=new te,T=new C;let x=0;const E=!0===b?e:t,R=!0===b?1:-1;for(let V=1;V<=r;V++)h.push(0,g*R,0),d.push(0,R,0),f.push(.5,.5),p++;const F=p;for(let V=0;V<=r;V++){const j=V/r*l+a,q=Math.cos(j),I=Math.sin(j);T.x=E*I,T.y=g*R,T.z=E*q,h.push(T.x,T.y,T.z),d.push(0,R,0),M.x=.5*q+.5,M.y=.5*I*R+.5,f.push(M.x,M.y),p++}for(let V=0;V<r;V++){const H=w+V,j=F+V;!0===b?u.push(j,j+1,H):u.push(j+1,j,H),x+=3}c.addGroup(_,x,!0===b?1:2),_+=x}(function v(){const b=new C,w=new C;let M=0;const T=(t-e)/i;for(let x=0;x<=s;x++){const E=[],R=x/s,F=R*(t-e)+e;for(let V=0;V<=r;V++){const H=V/r,j=H*l+a,q=Math.sin(j),I=Math.cos(j);w.x=F*q,w.y=-R*i+g,w.z=F*I,h.push(w.x,w.y,w.z),b.set(q,T,I).normalize(),d.push(b.x,b.y,b.z),f.push(H,1-R),E.push(p++)}m.push(E)}for(let x=0;x<r;x++)for(let E=0;E<s;E++){const F=m[E+1][x],V=m[E+1][x+1],H=m[E][x+1];u.push(m[E][x],F,H),u.push(F,V,H),M+=6}c.addGroup(_,M,0),_+=M})(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.setAttribute("position",new $e(h,3)),this.setAttribute("normal",new $e(d,3)),this.setAttribute("uv",new $e(f,2))}static fromJSON(e){return new gi(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Lh extends gi{constructor(e=1,t=1,i=8,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Lh(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ho extends wt{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function l(v,y,b,w){const M=w+1,T=[];for(let x=0;x<=M;x++){T[x]=[];const E=v.clone().lerp(b,x/M),R=y.clone().lerp(b,x/M),F=M-x;for(let V=0;V<=F;V++)T[x][V]=0===V&&x===M?E:E.clone().lerp(R,V/F)}for(let x=0;x<M;x++)for(let E=0;E<2*(M-x)-1;E++){const R=Math.floor(E/2);E%2==0?(d(T[x][R+1]),d(T[x+1][R]),d(T[x][R])):(d(T[x][R+1]),d(T[x+1][R+1]),d(T[x+1][R]))}}function d(v){s.push(v.x,v.y,v.z)}function f(v,y){const b=3*v;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function m(v,y,b,w){w<0&&1===v.x&&(o[y]=v.x-1),0===b.x&&0===b.z&&(o[y]=w/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function _(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const y=new C,b=new C,w=new C;for(let M=0;M<t.length;M+=3)f(t[M+0],y),f(t[M+1],b),f(t[M+2],w),l(y,b,w,v)})(r),function c(v){const y=new C;for(let b=0;b<s.length;b+=3)y.x=s[b+0],y.y=s[b+1],y.z=s[b+2],y.normalize().multiplyScalar(v),s[b+0]=y.x,s[b+1]=y.y,s[b+2]=y.z}(i),function u(){const v=new C;for(let y=0;y<s.length;y+=3){v.x=s[y+0],v.y=s[y+1],v.z=s[y+2];const b=g(v)/2/Math.PI+.5,w=_(v)/Math.PI+.5;o.push(b,1-w)}(function p(){const v=new C,y=new C,b=new C,w=new C,M=new te,T=new te,x=new te;for(let E=0,R=0;E<s.length;E+=9,R+=6){v.set(s[E+0],s[E+1],s[E+2]),y.set(s[E+3],s[E+4],s[E+5]),b.set(s[E+6],s[E+7],s[E+8]),M.set(o[R+0],o[R+1]),T.set(o[R+2],o[R+3]),x.set(o[R+4],o[R+5]),w.copy(v).add(y).add(b).divideScalar(3);const F=g(w);m(M,R+0,v,F),m(T,R+2,y,F),m(x,R+4,b,F)}})(),function h(){for(let v=0;v<o.length;v+=6){const y=o[v+0],b=o[v+2],w=o[v+4],M=Math.max(y,b,w),T=Math.min(y,b,w);M>.9&&T<.1&&(y<.2&&(o[v+0]+=1),b<.2&&(o[v+2]+=1),w<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new $e(s,3)),this.setAttribute("normal",new $e(s.slice(),3)),this.setAttribute("uv",new $e(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new ho(e.vertices,e.indices,e.radius,e.details)}}class Fh extends ho{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Fh(e.radius,e.detail)}}const pv=new C,mv=new C,XS=new C,gv=new as;class gO extends wt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(bc*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:m,b:g,c:_}=gv;if(m.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),_.fromBufferAttribute(a,c[2]),gv.getNormal(XS),h[0]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,h[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[2]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let v=0;v<3;v++){const y=(v+1)%3,b=h[v],w=h[y],M=gv[u[v]],T=gv[u[y]],x=`${b}_${w}`,E=`${w}_${b}`;E in d&&d[E]?(XS.dot(d[E].normal)<=s&&(f.push(M.x,M.y,M.z),f.push(T.x,T.y,T.z)),d[E]=null):x in d||(d[x]={index0:c[v],index1:c[y],normal:XS.clone()})}}for(const p in d)if(d[p]){const{index0:m,index1:g}=d[p];pv.fromBufferAttribute(a,m),mv.fromBufferAttribute(a,g),f.push(pv.x,pv.y,pv.z),f.push(mv.x,mv.y,mv.z)}this.setAttribute("position",new $e(f,3))}}}class Pc extends cp{constructor(e){super(e),this.uuid=ss(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new cp).fromJSON(r))}return this}}function _O(n,e,t,i,r){let s,o;if(r===function pte(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=bO(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=bO(s,n[s],n[s+1],o);return o&&_v(o,o.next)&&(dp(o),o=o.next),o}function vl(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!_v(t,t.next)&&0!==oi(t.prev,t,t.next))t=t.next;else{if(dp(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function up(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function lte(n,e,t,i){let r=n;do{null===r.z&&(r.z=qS(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function cte(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?ete(n,i,r,s):Jee(n))e.push(l.i/t),e.push(n.i/t),e.push(c.i/t),dp(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?up(n=tte(vl(n),e,t),e,t,i,r,s,2):2===o&&nte(n,e,t,i,r,s):up(vl(n),e,t,i,r,s,1);break}}function Jee(n){const e=n.prev,t=n,i=n.next;if(oi(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(kh(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&oi(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function ete(n,e,t,i){const r=n.prev,s=n,o=n.next;if(oi(r,s,o)>=0)return!1;const c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=qS(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,i),d=qS(c,u,e,t,i);let f=n.prevZ,p=n.nextZ;for(;f&&f.z>=h&&p&&p.z<=d;){if(f!==n.prev&&f!==n.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&oi(f.prev,f,f.next)>=0||(f=f.prevZ,p!==n.prev&&p!==n.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&oi(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==n.prev&&f!==n.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&oi(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==n.prev&&p!==n.next&&kh(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&oi(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function tte(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!_v(r,s)&&vO(r,i,i.next,s)&&hp(r,s)&&hp(s,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(s.i/t),dp(i),dp(i.next),i=n=s),i=i.next}while(i!==n);return vl(i)}function nte(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&hte(o,a)){let l=yO(o,a);return o=vl(o,o.next),l=vl(l,l.next),up(o,e,t,i,r,s),void up(l,e,t,i,r,s)}a=a.next}o=o.next}while(o!==n)}function rte(n,e){return n.x-e.x}function ste(n,e){if(e=function ote(n,e){let t=e;const i=n.x,r=n.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=i&&d>s){if(s=d,d===i){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(i===s)return o;const a=o,l=o.x,c=o.y;let h,u=1/0;t=o;do{i>=t.x&&t.x>=l&&i!==t.x&&kh(r<c?i:s,r,l,c,r<c?s:i,r,t.x,t.y)&&(h=Math.abs(r-t.y)/(i-t.x),hp(t,n)&&(h<u||h===u&&(t.x>o.x||t.x===o.x&&ate(o,t)))&&(o=t,u=h)),t=t.next}while(t!==a);return o}(n,e),e){const t=yO(e,n);vl(e,e.next),vl(t,t.next)}}function ate(n,e){return oi(n.prev,n,e.prev)<0&&oi(e.next,n,n.next)<0}function qS(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*r)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ute(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function kh(n,e,t,i,r,s,o,a){return(r-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(i-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(i-a)>=0}function hte(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function dte(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&vO(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(hp(n,e)&&hp(e,n)&&function fte(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(oi(n.prev,n,e.prev)||oi(n,e.prev,e))||_v(n,e)&&oi(n.prev,n,n.next)>0&&oi(e.prev,e,e.next)>0)}function oi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function _v(n,e){return n.x===e.x&&n.y===e.y}function vO(n,e,t,i){const r=yv(oi(n,e,t)),s=yv(oi(n,e,i)),o=yv(oi(t,i,n)),a=yv(oi(t,i,e));return!!(r!==s&&o!==a||0===r&&vv(n,t,e)||0===s&&vv(n,i,e)||0===o&&vv(t,n,i)||0===a&&vv(t,e,i))}function vv(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function yv(n){return n>0?1:n<0?-1:0}function hp(n,e){return oi(n.prev,n,n.next)<0?oi(n,e,n.next)>=0&&oi(n,n.prev,e)>=0:oi(n,e,n.prev)<0||oi(n,n.next,e)<0}function yO(n,e){const t=new ZS(n.i,n.x,n.y),i=new ZS(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function bO(n,e,t,i){const r=new ZS(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function dp(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function ZS(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Xo{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Xo.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];xO(e),wO(i,e);let o=e.length;t.forEach(xO);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,wO(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=_O(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,f;if(i&&(s=function ite(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=_O(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(ute(c));for(r.sort(rte),s=0;s<r.length;s++)ste(r[s],t),t=vl(t,t.next);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let p=t;p<r;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return up(s,o,t,a,l,f),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function xO(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function wO(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Oh extends wt{constructor(e=new Pc([new te(.5,.5),new te(-.5,.5),new te(-.5,-.5),new te(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1;let h=void 0!==t.depth?t.depth:1,d=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:f-.1,m=void 0!==t.bevelOffset?t.bevelOffset:0,g=void 0!==t.bevelSegments?t.bevelSegments:3;const _=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:mte;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),h=t.amount);let y,w,M,T,x,b=!1;_&&(y=_.getSpacedPoints(u),b=!0,d=!1,w=_.computeFrenetFrames(u,!1),M=new C,T=new C,x=new C),d||(g=0,f=0,p=0,m=0);const E=a.extractPoints(c);let R=E.shape;const F=E.holes;if(!Xo.isClockWise(R)){R=R.reverse();for(let ue=0,fe=F.length;ue<fe;ue++){const Me=F[ue];Xo.isClockWise(Me)&&(F[ue]=Me.reverse())}}const H=Xo.triangulateShape(R,F),j=R;for(let ue=0,fe=F.length;ue<fe;ue++)R=R.concat(F[ue]);function q(ue,fe,Me){return fe||console.error("THREE.ExtrudeGeometry: vec does not exist"),fe.clone().multiplyScalar(Me).add(ue)}const I=R.length,U=H.length;function W(ue,fe,Me){let Je,Ge,bt;const mt=ue.x-fe.x,dt=ue.y-fe.y,Jt=Me.x-ue.x,Wt=Me.y-ue.y,B=mt*mt+dt*dt;if(Math.abs(mt*Wt-dt*Jt)>Number.EPSILON){const ae=Math.sqrt(B),xe=Math.sqrt(Jt*Jt+Wt*Wt),Pe=fe.x-dt/ae,Ue=fe.y+mt/ae,le=((Me.x-Wt/xe-Pe)*Wt-(Me.y+Jt/xe-Ue)*Jt)/(mt*Wt-dt*Jt);Je=Pe+mt*le-ue.x,Ge=Ue+dt*le-ue.y;const Ne=Je*Je+Ge*Ge;if(Ne<=2)return new te(Je,Ge);bt=Math.sqrt(Ne/2)}else{let ae=!1;mt>Number.EPSILON?Jt>Number.EPSILON&&(ae=!0):mt<-Number.EPSILON?Jt<-Number.EPSILON&&(ae=!0):Math.sign(dt)===Math.sign(Wt)&&(ae=!0),ae?(Je=-dt,Ge=mt,bt=Math.sqrt(B)):(Je=mt,Ge=dt,bt=Math.sqrt(B/2))}return new te(Je/bt,Ge/bt)}const z=[];for(let ue=0,fe=j.length,Me=fe-1,Je=ue+1;ue<fe;ue++,Me++,Je++)Me===fe&&(Me=0),Je===fe&&(Je=0),z[ue]=W(j[ue],j[Me],j[Je]);const Y=[];let oe,$=z.concat();for(let ue=0,fe=F.length;ue<fe;ue++){const Me=F[ue];oe=[];for(let Je=0,Ge=Me.length,bt=Ge-1,mt=Je+1;Je<Ge;Je++,bt++,mt++)bt===Ge&&(bt=0),mt===Ge&&(mt=0),oe[Je]=W(Me[Je],Me[bt],Me[mt]);Y.push(oe),$=$.concat(oe)}for(let ue=0;ue<g;ue++){const fe=ue/g,Me=f*Math.cos(fe*Math.PI/2),Je=p*Math.sin(fe*Math.PI/2)+m;for(let Ge=0,bt=j.length;Ge<bt;Ge++){const mt=q(j[Ge],z[Ge],Je);X(mt.x,mt.y,-Me)}for(let Ge=0,bt=F.length;Ge<bt;Ge++){const mt=F[Ge];oe=Y[Ge];for(let dt=0,Jt=mt.length;dt<Jt;dt++){const Wt=q(mt[dt],oe[dt],Je);X(Wt.x,Wt.y,-Me)}}}const me=p+m;for(let ue=0;ue<I;ue++){const fe=d?q(R[ue],$[ue],me):R[ue];b?(T.copy(w.normals[0]).multiplyScalar(fe.x),M.copy(w.binormals[0]).multiplyScalar(fe.y),x.copy(y[0]).add(T).add(M),X(x.x,x.y,x.z)):X(fe.x,fe.y,0)}for(let ue=1;ue<=u;ue++)for(let fe=0;fe<I;fe++){const Me=d?q(R[fe],$[fe],me):R[fe];b?(T.copy(w.normals[ue]).multiplyScalar(Me.x),M.copy(w.binormals[ue]).multiplyScalar(Me.y),x.copy(y[ue]).add(T).add(M),X(x.x,x.y,x.z)):X(Me.x,Me.y,h/u*ue)}for(let ue=g-1;ue>=0;ue--){const fe=ue/g,Me=f*Math.cos(fe*Math.PI/2),Je=p*Math.sin(fe*Math.PI/2)+m;for(let Ge=0,bt=j.length;Ge<bt;Ge++){const mt=q(j[Ge],z[Ge],Je);X(mt.x,mt.y,h+Me)}for(let Ge=0,bt=F.length;Ge<bt;Ge++){const mt=F[Ge];oe=Y[Ge];for(let dt=0,Jt=mt.length;dt<Jt;dt++){const Wt=q(mt[dt],oe[dt],Je);b?X(Wt.x,Wt.y+y[u-1].y,y[u-1].x+Me):X(Wt.x,Wt.y,h+Me)}}}function J(ue,fe){let Me=ue.length;for(;--Me>=0;){const Je=Me;let Ge=Me-1;Ge<0&&(Ge=ue.length-1);for(let bt=0,mt=u+2*g;bt<mt;bt++){const dt=I*bt,Jt=I*(bt+1);Le(fe+Je+dt,fe+Ge+dt,fe+Ge+Jt,fe+Je+Jt)}}}function X(ue,fe,Me){l.push(ue),l.push(fe),l.push(Me)}function de(ue,fe,Me){_e(ue),_e(fe),_e(Me);const Je=r.length/3,Ge=v.generateTopUV(i,r,Je-3,Je-2,Je-1);st(Ge[0]),st(Ge[1]),st(Ge[2])}function Le(ue,fe,Me,Je){_e(ue),_e(fe),_e(Je),_e(fe),_e(Me),_e(Je);const Ge=r.length/3,bt=v.generateSideWallUV(i,r,Ge-6,Ge-3,Ge-2,Ge-1);st(bt[0]),st(bt[1]),st(bt[3]),st(bt[1]),st(bt[2]),st(bt[3])}function _e(ue){r.push(l[3*ue+0]),r.push(l[3*ue+1]),r.push(l[3*ue+2])}function st(ue){s.push(ue.x),s.push(ue.y)}(function he(){const ue=r.length/3;if(d){let fe=0,Me=I*fe;for(let Je=0;Je<U;Je++){const Ge=H[Je];de(Ge[2]+Me,Ge[1]+Me,Ge[0]+Me)}fe=u+2*g,Me=I*fe;for(let Je=0;Je<U;Je++){const Ge=H[Je];de(Ge[0]+Me,Ge[1]+Me,Ge[2]+Me)}}else{for(let fe=0;fe<U;fe++){const Me=H[fe];de(Me[2],Me[1],Me[0])}for(let fe=0;fe<U;fe++){const Me=H[fe];de(Me[0]+I*u,Me[1]+I*u,Me[2]+I*u)}}i.addGroup(ue,r.length/3-ue,0)})(),function Ae(){const ue=r.length/3;let fe=0;J(j,fe),fe+=j.length;for(let Me=0,Je=F.length;Me<Je;Me++){const Ge=F[Me];J(Ge,fe),fe+=Ge.length}i.addGroup(ue,r.length/3-ue,1)}()}this.setAttribute("position",new $e(r,3)),this.setAttribute("uv",new $e(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function gte(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new WS[r.type]).fromJSON(r)),new Oh(i,e.options)}}const mte={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new te(e[3*t],e[3*t+1]),new te(a,l),new te(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],f=e[3*r+1],p=e[3*r+2],m=e[3*s],g=e[3*s+1],_=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new te(o,1-l),new te(c,1-h),new te(d,1-p),new te(m,1-_)]:[new te(a,1-l),new te(u,1-h),new te(f,1-p),new te(g,1-_)]}};class Ic extends ho{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ic(e.radius,e.detail)}}class fo extends ho{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new fo(e.radius,e.detail)}}class Nh extends wt{constructor(e=.5,t=1,i=8,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i);const a=[],l=[],c=[],u=[];let h=e;const d=(t-e)/(r=Math.max(1,r)),f=new C,p=new te;for(let m=0;m<=r;m++){for(let g=0;g<=i;g++){const _=s+g/i*o;f.x=h*Math.cos(_),f.y=h*Math.sin(_),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}h+=d}for(let m=0;m<r;m++){const g=m*(i+1);for(let _=0;_<i;_++){const v=_+g,b=v+i+1,w=v+i+2,M=v+1;a.push(v,b,M),a.push(b,w,M)}}this.setIndex(a),this.setAttribute("position",new $e(l,3)),this.setAttribute("normal",new $e(c,3)),this.setAttribute("uv",new $e(u,2))}static fromJSON(e){return new Nh(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Bh extends wt{constructor(e=new Pc([new te(0,.5),new te(-.5,-.5),new te(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const h=r.length/3,d=u.extractPoints(t);let f=d.shape;const p=d.holes;!1===Xo.isClockWise(f)&&(f=f.reverse());for(let g=0,_=p.length;g<_;g++){const v=p[g];!0===Xo.isClockWise(v)&&(p[g]=v.reverse())}const m=Xo.triangulateShape(f,p);for(let g=0,_=p.length;g<_;g++)f=f.concat(p[g]);for(let g=0,_=f.length;g<_;g++){const v=f[g];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,_=m.length;g<_;g++){const v=m[g];i.push(v[0]+h,v[1]+h,v[2]+h),l+=3}}this.setIndex(i),this.setAttribute("position",new $e(r,3)),this.setAttribute("normal",new $e(s,3)),this.setAttribute("uv",new $e(o,2))}toJSON(){const e=super.toJSON();return function _te(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new Bh(i,e.curveSegments)}}class Ca extends wt{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],h=new C,d=new C,f=[],p=[],m=[],g=[];for(let _=0;_<=i;_++){const v=[],y=_/i;let b=0;0==_&&0==o?b=.5/t:_==i&&l==Math.PI&&(b=-.5/t);for(let w=0;w<=t;w++){const M=w/t;h.x=-e*Math.cos(r+M*s)*Math.sin(o+y*a),h.y=e*Math.cos(o+y*a),h.z=e*Math.sin(r+M*s)*Math.sin(o+y*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(M+b,1-y),v.push(c++)}u.push(v)}for(let _=0;_<i;_++)for(let v=0;v<t;v++){const y=u[_][v+1],b=u[_][v],w=u[_+1][v],M=u[_+1][v+1];(0!==_||o>0)&&f.push(y,b,M),(_!==i-1||l<Math.PI)&&f.push(b,w,M)}this.setIndex(f),this.setAttribute("position",new $e(p,3)),this.setAttribute("normal",new $e(m,3)),this.setAttribute("uv",new $e(g,2))}static fromJSON(e){return new Ca(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class jh extends ho{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jh(e.radius,e.detail)}}class po extends wt{constructor(e=1,t=.4,i=8,r=6,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new C,h=new C,d=new C;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const m=p/r*s,g=f/i*Math.PI*2;h.x=(e+t*Math.cos(g))*Math.cos(m),h.y=(e+t*Math.cos(g))*Math.sin(m),h.z=t*Math.sin(g),a.push(h.x,h.y,h.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),d.subVectors(h,u).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const g=(r+1)*(f-1)+p-1,_=(r+1)*(f-1)+p,v=(r+1)*f+p;o.push((r+1)*f+p-1,g,v),o.push(g,_,v)}this.setIndex(o),this.setAttribute("position",new $e(a,3)),this.setAttribute("normal",new $e(l,3)),this.setAttribute("uv",new $e(c,2))}static fromJSON(e){return new po(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Uh extends wt{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],u=[],h=new C,d=new C,f=new C,p=new C,m=new C,g=new C,_=new C;for(let y=0;y<=i;++y){const b=y/i*s*Math.PI*2;v(b,s,o,e,f),v(b+.01,s,o,e,p),g.subVectors(p,f),_.addVectors(p,f),m.crossVectors(g,_),_.crossVectors(m,g),m.normalize(),_.normalize();for(let w=0;w<=r;++w){const M=w/r*Math.PI*2,T=-t*Math.cos(M),x=t*Math.sin(M);h.x=f.x+(T*_.x+x*m.x),h.y=f.y+(T*_.y+x*m.y),h.z=f.z+(T*_.z+x*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,f).normalize(),c.push(d.x,d.y,d.z),u.push(y/i),u.push(w/r)}}for(let y=1;y<=i;y++)for(let b=1;b<=r;b++){const M=(r+1)*y+(b-1),T=(r+1)*y+b,x=(r+1)*(y-1)+b;a.push((r+1)*(y-1)+(b-1),M,x),a.push(M,T,x)}function v(y,b,w,M,T){const x=Math.cos(y),E=Math.sin(y),R=w/b*y,F=Math.cos(R);T.x=M*(2+F)*.5*x,T.y=M*(2+F)*E*.5,T.z=M*Math.sin(R)*.5}this.setIndex(a),this.setAttribute("position",new $e(l,3)),this.setAttribute("normal",new $e(c,3)),this.setAttribute("uv",new $e(u,2))}static fromJSON(e){return new Uh(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Vh extends wt{constructor(e=new HS(new C(-1,-1,0),new C(-1,1,0),new C(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new C,l=new C,c=new te;let u=new C;const h=[],d=[],f=[],p=[];function g(y){u=e.getPointAt(y/t,u);const b=o.normals[y],w=o.binormals[y];for(let M=0;M<=r;M++){const T=M/r*Math.PI*2,x=Math.sin(T),E=-Math.cos(T);l.x=E*b.x+x*w.x,l.y=E*b.y+x*w.y,l.z=E*b.z+x*w.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=u.x+i*l.x,a.y=u.y+i*l.y,a.z=u.z+i*l.z,h.push(a.x,a.y,a.z)}}(function m(){for(let y=0;y<t;y++)g(y);g(!1===s?t:0),function v(){for(let y=0;y<=t;y++)for(let b=0;b<=r;b++)c.x=y/t,c.y=b/r,f.push(c.x,c.y)}(),function _(){for(let y=1;y<=t;y++)for(let b=1;b<=r;b++){const M=(r+1)*y+(b-1),T=(r+1)*y+b,x=(r+1)*(y-1)+b;p.push((r+1)*(y-1)+(b-1),M,x),p.push(M,T,x)}}()})(),this.setIndex(p),this.setAttribute("position",new $e(h,3)),this.setAttribute("normal",new $e(d,3)),this.setAttribute("uv",new $e(f,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Vh((new WS[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class MO extends wt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],i=new Set,r=new C,s=new C;if(null!==e.index){const o=e.attributes.position,a=e.index;let l=e.groups;0===l.length&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const h=l[c],d=h.start;for(let p=d,m=d+h.count;p<m;p+=3)for(let g=0;g<3;g++){const _=a.getX(p+g),v=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,_),s.fromBufferAttribute(o,v),!0===SO(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+(c+1)%3;r.fromBufferAttribute(o,3*a+c),s.fromBufferAttribute(o,h),!0===SO(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new $e(t,3))}}}function SO(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return!0!==t.has(i)&&!0!==t.has(r)&&(t.add(i),t.add(r),!0)}var TO=Object.freeze({__proto__:null,BoxGeometry:Xn,BoxBufferGeometry:Xn,CapsuleGeometry:Ph,CapsuleBufferGeometry:Ph,CircleGeometry:Ih,CircleBufferGeometry:Ih,ConeGeometry:Lh,ConeBufferGeometry:Lh,CylinderGeometry:gi,CylinderBufferGeometry:gi,DodecahedronGeometry:Fh,DodecahedronBufferGeometry:Fh,EdgesGeometry:gO,ExtrudeGeometry:Oh,ExtrudeBufferGeometry:Oh,IcosahedronGeometry:Ic,IcosahedronBufferGeometry:Ic,LatheGeometry:Rc,LatheBufferGeometry:Rc,OctahedronGeometry:fo,OctahedronBufferGeometry:fo,PlaneGeometry:Ta,PlaneBufferGeometry:Ta,PolyhedronGeometry:ho,PolyhedronBufferGeometry:ho,RingGeometry:Nh,RingBufferGeometry:Nh,ShapeGeometry:Bh,ShapeBufferGeometry:Bh,SphereGeometry:Ca,SphereBufferGeometry:Ca,TetrahedronGeometry:jh,TetrahedronBufferGeometry:jh,TorusGeometry:po,TorusBufferGeometry:po,TorusKnotGeometry:Uh,TorusKnotBufferGeometry:Uh,TubeGeometry:Vh,TubeBufferGeometry:Vh,WireframeGeometry:MO});class CO extends mi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ce(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class EO extends Yn{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class mo extends mi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ce(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ea extends mo{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new te(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ce(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ce(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ce(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class YS extends mi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ce(16777215),this.specular=new Ce(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class DO extends mi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ce(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class AO extends mi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class RO extends mi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ce(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ce(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Nf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class PO extends mi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ce(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=al,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class IO extends Pi{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const vte={ShadowMaterial:CO,SpriteMaterial:DS,RawShaderMaterial:EO,ShaderMaterial:Yn,PointsMaterial:cv,MeshPhysicalMaterial:Ea,MeshStandardMaterial:mo,MeshPhongMaterial:YS,MeshToonMaterial:DO,MeshNormalMaterial:AO,MeshLambertMaterial:RO,MeshDepthMaterial:ev,MeshDistanceMaterial:SS,MeshBasicMaterial:nr,MeshMatcapMaterial:PO,LineDashedMaterial:IO,LineBasicMaterial:Pi,Material:mi};mi.fromType=function(n){return new vte[n]};const Kn={arraySlice:function(n,e,t){return Kn.isTypedArray(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r},flattenJSON:function(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)},subclip:function(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),h=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<t||p>=i)){h.push(c.times[f]);for(let m=0;m<u;++m)d.push(c.values[f*u+m])}}0!==h.length&&(c.times=Kn.convertArray(h,c.times.constructor),c.values=Kn.convertArray(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=n.tracks.find(function(_){return _.name===a.name&&_.ValueTypeName===l});if(void 0===c)continue;let u=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let m;if(s<=a.times[0])m=Kn.arraySlice(a.values,u,h-u);else if(s>=a.times[p]){const _=p*h+u;m=Kn.arraySlice(a.values,_,_+h-u)}else{const _=a.createInterpolant(),v=u,y=h-u;_.evaluate(s),m=Kn.arraySlice(_.resultBuffer,v,y)}"quaternion"===l&&(new bn).fromArray(m).normalize().conjugate().toArray(m);const g=c.times.length;for(let _=0;_<g;++_){const v=_*f+d;if("quaternion"===l)bn.multiplyQuaternionsFlat(c.values,v,m,0,c.values,v);else{const y=f-2*d;for(let b=0;b<y;++b)c.values[v+b]-=m[b]}}}return n.blendMode=zM,n}};class zh{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class LO extends zh{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:vc,endingEnd:vc}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case yc:s=e,a=2*t-i;break;case zf:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case yc:o=e,l=2*i-t;break;case zf:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),m=p*p,g=m*p,_=-d*g+2*d*m-d*p,v=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,y=(-1-f)*g+(1.5+f)*m+.5*p,b=f*g-f*m;for(let w=0;w!==a;++w)s[w]=_*o[u+w]+v*o[c+w]+y*o[l+w]+b*o[h+w];return s}}class KS extends zh{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*h+o[l+d]*u;return s}}class FO extends zh{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class go{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kn.convertArray(t,this.TimeBufferType),this.values=Kn.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Kn.convertArray(e.times,Array),values:Kn.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new FO(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new KS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new LO(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case oh:t=this.InterpolantFactoryMethodDiscrete;break;case _c:t=this.InterpolantFactoryMethodLinear;break;case b_:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return oh;case this.InterpolantFactoryMethodLinear:return _c;case this.InterpolantFactoryMethodSmooth:return b_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Kn.arraySlice(i,s,o),this.values=Kn.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Kn.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Kn.arraySlice(this.times),t=Kn.arraySlice(this.values),i=this.getValueSize(),r=this.getInterpolation()===b_,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const h=a*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const m=t[h+p];if(m!==t[d+p]||m!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*i,d=o*i;for(let f=0;f!==i;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Kn.arraySlice(e,0,o),this.values=Kn.arraySlice(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Kn.arraySlice(this.times,0),t=Kn.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}go.prototype.TimeBufferType=Float32Array,go.prototype.ValueBufferType=Float32Array,go.prototype.DefaultInterpolation=_c;class Lc extends go{}Lc.prototype.ValueTypeName="bool",Lc.prototype.ValueBufferType=Array,Lc.prototype.DefaultInterpolation=oh,Lc.prototype.InterpolantFactoryMethodLinear=void 0,Lc.prototype.InterpolantFactoryMethodSmooth=void 0;class QS extends go{}QS.prototype.ValueTypeName="color";class Hh extends go{}Hh.prototype.ValueTypeName="number";class kO extends zh{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)bn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class yl extends go{InterpolantFactoryMethodLinear(e){return new kO(this.times,this.values,this.getValueSize(),e)}}yl.prototype.ValueTypeName="quaternion",yl.prototype.DefaultInterpolation=_c,yl.prototype.InterpolantFactoryMethodSmooth=void 0;class Fc extends go{}Fc.prototype.ValueTypeName="string",Fc.prototype.ValueBufferType=Array,Fc.prototype.DefaultInterpolation=oh,Fc.prototype.InterpolantFactoryMethodLinear=void 0,Fc.prototype.InterpolantFactoryMethodSmooth=void 0;class Gh extends go{}Gh.prototype.ValueTypeName="vector";class Wh{constructor(e,t=-1,i,r=x_){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=ss(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(bte(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(go.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Kn.getKeyframeOrder(l);l=Kn.sortedArray(l,1,u),c=Kn.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new Hh(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,m){if(0!==f.length){const g=[],_=[];Kn.flattenJSON(f,g,_,p),0!==g.length&&m.push(new h(d,g,_))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const d=c[h].keys;if(d&&0!==d.length)if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)f[d[p].morphTargets[m]]=-1;for(const m in f){const g=[],_=[];for(let v=0;v!==d[p].morphTargets.length;++v){const y=d[p];g.push(y.time),_.push(y.morphTarget===m?1:0)}r.push(new Hh(".morphTargetInfluence["+m+"]",g,_))}l=f.length*o}else{const f=".bones["+t[h].name+"]";i(Gh,f+".position",d,"pos",r),i(yl,f+".quaternion",d,"rot",r),i(Gh,f+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function bte(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function yte(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Hh;case"vector":case"vector2":case"vector3":case"vector4":return Gh;case"color":return QS;case"quaternion":return yl;case"bool":case"boolean":return Lc;case"string":return Fc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Kn.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const kc={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class $S{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return-1!==h&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){const f=c[h],p=c[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const OO=new $S;class Pr{constructor(e){this.manager=void 0!==e?e:OO,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Da={};class Es extends Pr{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=kc.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Da[e])return void Da[e].push({onLoad:t,onProgress:i,onError:r});Da[e]=[],Da[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=Da[e],h=c.body.getReader(),d=c.headers.get("Content-Length"),f=d?parseInt(d):0,p=0!==f;let m=0;const g=new ReadableStream({start(_){!function v(){h.read().then(({done:y,value:b})=>{if(y)_.close();else{m+=b.byteLength;const w=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let M=0,T=u.length;M<T;M++){const x=u[M];x.onProgress&&x.onProgress(w)}_.enqueue(b),v()}})}()}});return new Response(g)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{kc.add(e,c);const u=Da[e];delete Da[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=Da[e];if(void 0===u)throw this.manager.itemError(e),c;delete Da[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class xte extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Es(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=Wh.parse(e[i]);t.push(r)}return t}}class wte extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new cO,l=new Es(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(h){l.load(e[h],function(d){const f=s.parse(d,!0);o[h]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,6===c&&(1===f.mipmapCount&&(a.minFilter=si),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)u(h);else l.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let m=0;m<d.mipmapCount;m++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+m]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;1===d.mipmapCount&&(a.minFilter=si),a.format=d.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}class fp extends Pr{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=kc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Wf("img");function l(){u(),kc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Mte extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=new $f,o=new fp(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Ste extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Ac,a=new Es(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);!c||(void 0!==c.image?o.image=c.image:void 0!==c.data&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=void 0!==c.wrapS?c.wrapS:dr,o.wrapT=void 0!==c.wrapT?c.wrapT:dr,o.magFilter=void 0!==c.magFilter?c.magFilter:si,o.minFilter=void 0!==c.minFilter?c.minFilter:si,o.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.encoding&&(o.encoding=c.encoding),void 0!==c.flipY&&(o.flipY=c.flipY),void 0!==c.format&&(o.format=c.format),void 0!==c.type&&(o.type=c.type),void 0!==c.mipmaps&&(o.mipmaps=c.mipmaps,o.minFilter=va),1===c.mipmapCount&&(o.minFilter=si),void 0!==c.generateMipmaps&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},i,r),o}}class NO extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=new fr,o=new fp(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class Aa extends nn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ce(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class JS extends Aa{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(nn.DefaultUp),this.updateMatrix(),this.groundColor=new Ce(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const BO=new ot,jO=new C,UO=new C;class eT{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new te(512,512),this.map=null,this.mapPass=null,this.matrix=new ot,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new K_,this._frameExtents=new te(1,1),this._viewportCount=1,this._viewports=[new gn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;jO.setFromMatrixPosition(e.matrixWorld),t.position.copy(jO),UO.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(UO),t.updateMatrixWorld(),BO.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(BO),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Tte extends eT{constructor(){super(new zi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*Hf*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class tT extends Aa{constructor(e,t,i=0,r=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(nn.DefaultUp),this.updateMatrix(),this.target=new nn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new Tte}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const VO=new ot,pp=new C,nT=new C;class Cte extends eT{constructor(){super(new zi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new te(4,2),this._viewportCount=6,this._viewports=[new gn(2,1,1,1),new gn(0,1,1,1),new gn(3,1,1,1),new gn(1,1,1,1),new gn(3,0,1,1),new gn(1,0,1,1)],this._cubeDirections=[new C(1,0,0),new C(-1,0,0),new C(0,0,1),new C(0,0,-1),new C(0,1,0),new C(0,-1,0)],this._cubeUps=[new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,0,1),new C(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),pp.setFromMatrixPosition(e.matrixWorld),i.position.copy(pp),nT.copy(i.position),nT.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(nT),i.updateMatrixWorld(),r.makeTranslation(-pp.x,-pp.y,-pp.z),VO.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(VO)}}class bv extends Aa{constructor(e,t,i=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Cte}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ete extends eT{constructor(){super(new Cc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class xv extends Aa{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(nn.DefaultUp),this.updateMatrix(),this.target=new nn,this.shadow=new Ete}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class iT extends Aa{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class zO extends Aa{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class HO{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new C)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class wv extends Aa{constructor(e=new HO,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class GO extends Pr{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Es(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=mi.fromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Ce).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=(new Ce).setHex(o.value);break;case"v2":r.uniforms[s].value=(new te).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new C).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new gn).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new Ms).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new ot).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new te).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=i(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=i(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new te).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=i(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=i(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=i(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=i(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}}class _o{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class WO extends wt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class XO extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Es(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(f,p){if(void 0!==t[p])return t[p];const g=f.interleavedBuffers[p],_=function s(f,p){if(void 0!==i[p])return i[p];const _=new Uint32Array(f.arrayBuffers[p]).buffer;return i[p]=_,_}(f,g.buffer),v=ah(g.type,_),y=new tp(v,g.stride);return y.uuid=g.uuid,t[p]=y,y}const o=e.isInstancedBufferGeometry?new WO:new wt,a=e.data.index;if(void 0!==a){const f=ah(a.type,a.array);o.setIndex(new En(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let m;if(p.isInterleavedBufferAttribute){const g=r(e.data,p.data);m=new gl(g,p.itemSize,p.offset,p.normalized)}else{const g=ah(p.type,p.array);m=new(p.isInstancedBufferAttribute?Rh:En)(g,p.itemSize,p.normalized)}void 0!==p.name&&(m.name=p.name),void 0!==p.usage&&m.setUsage(p.usage),void 0!==p.updateRange&&(m.updateRange.offset=p.updateRange.offset,m.updateRange.count=p.updateRange.count),o.setAttribute(f,m)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],m=[];for(let g=0,_=p.length;g<_;g++){const v=p[g];let y;if(v.isInterleavedBufferAttribute){const b=r(e.data,v.data);y=new gl(b,v.itemSize,v.offset,v.normalized)}else{const b=ah(v.type,v.array);y=new En(b,v.itemSize,v.normalized)}void 0!==v.name&&(y.name=v.name),m.push(y)}o.morphAttributes[f]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==h)for(let f=0,p=h.length;f!==p;++f){const m=h[f];o.addGroup(m.start,m.count,m.materialIndex)}const d=e.data.boundingSphere;if(void 0!==d){const f=new C;void 0!==d.center&&f.fromArray(d.center),o.boundingSphere=new ba(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Dte extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=""===this.path?_o.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Es(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(h){return void 0!==r&&r(h),void console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message)}const u=c.metadata;void 0!==u&&void 0!==u.type&&"geometry"!==u.type.toLowerCase()?s.parse(c,t):console.error("THREE.ObjectLoader: Can't load "+e)},i,r)}loadAsync(e,t){var i=this;return no(function*(){const r=i,s=""===i.path?_o.extractUrlBase(e):i.path;i.resourcePath=i.resourcePath||s;const o=new Es(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials);const a=yield o.loadAsync(e,t),l=JSON.parse(a),c=l.metadata;if(void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(l)})()}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),void 0!==t){let h=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){h=!0;break}!1===h&&t(c)}return c}parseAsync(e){var t=this;return no(function*(){const i=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),a=t.parseTextures(e.textures,o),l=t.parseMaterials(e.materials,a),c=t.parseObject(e.object,s,l,a,i),u=t.parseSkeletons(e.skeletons,c);return t.bindSkeletons(c,u),c})()}parseShapes(e){const t={};if(void 0!==e)for(let i=0,r=e.length;i<r;i++){const s=(new Pc).fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=(new sp).fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(void 0!==e){const r=new XO;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:l.type in TO?a=TO[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),!0===a.isBufferGeometry&&void 0!==l.userData&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(void 0!==e){const s=new GO;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];if("MultiMaterial"===l.type){const c=[];for(let u=0;u<l.materials.length;u++){const h=l.materials[u];void 0===i[h.uuid]&&(i[h.uuid]=s.parse(h)),c.push(i[h.uuid])}r[l.uuid]=c}else void 0===i[l.uuid]&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let i=0;i<e.length;i++){const s=Wh.parse(e[i]);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function a(l){if("string"==typeof l){const c=l;return function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c)}return l.data?{data:ah(l.type,l.data),width:l.width,height:l.height}:null}if(void 0!==e&&e.length>0){const l=new $S(t);s=new fp(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const h=e[c],d=h.url;if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const _=a(d[p]);null!==_&&(_ instanceof HTMLImageElement?f.push(_):f.push(new Ac(_.data,_.width,_.height)))}r[h.uuid]=new wc(f)}else{const f=a(h.url);r[h.uuid]=new wc(f)}}}return r}parseImagesAsync(e){var t=this;return no(function*(){const i=t,r={};let s;function o(l){return a.apply(this,arguments)}function a(){return(a=no(function*(l){if("string"==typeof l){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return yield s.loadAsync(u)}return l.data?{data:ah(l.type,l.data),width:l.width,height:l.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new fp(t.manager),s.setCrossOrigin(t.crossOrigin);for(let l=0,c=e.length;l<c;l++){const u=e[l],h=u.url;if(Array.isArray(h)){const d=[];for(let f=0,p=h.length;f<p;f++){const m=h[f],g=yield o(m);null!==g&&(g instanceof HTMLImageElement?d.push(g):d.push(new Ac(g.data,g.width,g.height)))}r[u.uuid]=new wc(d)}else{const d=yield o(u.url);r[u.uuid]=new wc(d)}}}return r})()}parseTextures(e,t){function i(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=e[s];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new $f,6===c.length&&(u.needsUpdate=!0)):(u=c&&c.data?new Ac:new fr,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,void 0!==a.name&&(u.name=a.name),void 0!==a.mapping&&(u.mapping=i(a.mapping,Ate)),void 0!==a.offset&&u.offset.fromArray(a.offset),void 0!==a.repeat&&u.repeat.fromArray(a.repeat),void 0!==a.center&&u.center.fromArray(a.center),void 0!==a.rotation&&(u.rotation=a.rotation),void 0!==a.wrap&&(u.wrapS=i(a.wrap[0],qO),u.wrapT=i(a.wrap[1],qO)),void 0!==a.format&&(u.format=a.format),void 0!==a.type&&(u.type=a.type),void 0!==a.encoding&&(u.encoding=a.encoding),void 0!==a.minFilter&&(u.minFilter=i(a.minFilter,ZO)),void 0!==a.magFilter&&(u.magFilter=i(a.magFilter,ZO)),void 0!==a.anisotropy&&(u.anisotropy=a.anisotropy),void 0!==a.flipY&&(u.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(u.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(u.unpackAlignment=a.unpackAlignment),void 0!==a.userData&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,i,r,s){let o,u,h;function a(d){return void 0===t[d]&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function l(d){if(void 0!==d){if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const g=d[p];void 0===i[g]&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(i[g])}return f}return void 0===i[d]&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function c(d){return void 0===r[d]&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}switch(e.type){case"Scene":o=new ES,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new Ce(e.background):c(e.background)),void 0!==e.environment&&(o.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new ep(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new tv(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new zi(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Cc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new iT(e.color,e.intensity);break;case"DirectionalLight":o=new xv(e.color,e.intensity);break;case"PointLight":o=new bv(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new zO(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new tT(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new JS(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new wv).fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),h=l(e.material),o=new RS(u,h),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),h=l(e.material),o=new qe(u,h);break;case"InstancedMesh":u=a(e.geometry),h=l(e.material);const f=e.instanceMatrix,p=e.instanceColor;o=new PS(u,h,e.count),o.instanceMatrix=new Rh(new Float32Array(f.array),16),void 0!==p&&(o.instanceColor=new Rh(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new Zk;break;case"Line":o=new Mi(a(e.geometry),l(e.material));break;case"LineLoop":o=new LS(a(e.geometry),l(e.material));break;case"LineSegments":o=new Cs(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new kS(a(e.geometry),l(e.material));break;case"Sprite":o=new Xk(l(e.material));break;case"Group":o=new Wo;break;case"Bone":o=new ov;break;default:o=new nn}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],t,i,r,s))}if(void 0!==e.animations){const d=e.animations;for(let f=0;f<d.length;f++)o.animations.push(s[d[f]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],m=o.getObjectByProperty("uuid",p.object);void 0!==m&&o.addLevel(m,p.distance)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(i){if(!0===i.isSkinnedMesh&&void 0!==i.skeleton){const r=t[i.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const Ate={UVMapping:p_,CubeReflectionMapping:Ja,CubeRefractionMapping:el,EquirectangularReflectionMapping:Bf,EquirectangularRefractionMapping:jf,CubeUVReflectionMapping:rh},qO={RepeatWrapping:tl,ClampToEdgeWrapping:dr,MirroredRepeatWrapping:sh},ZO={NearestFilter:xi,NearestMipmapNearestFilter:Uf,NearestMipmapLinearFilter:Vf,LinearFilter:si,LinearMipmapNearestFilter:m_,LinearMipmapLinearFilter:va};class YO extends Pr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=kc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){kc.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Mv;const rT={getContext:function(){return void 0===Mv&&(Mv=new(window.AudioContext||window.webkitAudioContext)),Mv},setContext:function(n){Mv=n}};class Rte extends Pr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Es(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);rT.getContext().decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}}class Pte extends wv{constructor(e,t,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const r=(new Ce).set(e),s=(new Ce).set(t),o=new C(r.r,r.g,r.b),a=new C(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class Ite extends wv{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const i=(new Ce).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const KO=new ot,QO=new ot,Oc=new ot;class Lte{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Oc.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(bc*t.fov*.5)/t.zoom;let a,l;QO.elements[12]=-r,KO.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,Oc.elements[0]=2*t.near/(l-a),Oc.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Oc),a=-o*t.aspect-s,l=o*t.aspect-s,Oc.elements[0]=2*t.near/(l-a),Oc.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Oc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(QO),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(KO)}}class Sv{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=$O(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=$O();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function $O(){return(typeof performance>"u"?Date:performance).now()}const Nc=new C,JO=new bn,Fte=new C,Bc=new C;class kte extends nn{constructor(){super(),this.type="AudioListener",this.context=rT.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Sv}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Nc,JO,Fte),Bc.set(0,0,-1).applyQuaternion(JO),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Nc.x,r),t.positionY.linearRampToValueAtTime(Nc.y,r),t.positionZ.linearRampToValueAtTime(Nc.z,r),t.forwardX.linearRampToValueAtTime(Bc.x,r),t.forwardY.linearRampToValueAtTime(Bc.y,r),t.forwardZ.linearRampToValueAtTime(Bc.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Nc.x,Nc.y,Nc.z),t.setOrientation(Bc.x,Bc.y,Bc.z,i.x,i.y,i.z)}}class eN extends nn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const jc=new C,tN=new bn,Ote=new C,Uc=new C;class Nte extends eN{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(jc,tN,Ote),Uc.set(0,0,1).applyQuaternion(tN);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(jc.x,i),t.positionY.linearRampToValueAtTime(jc.y,i),t.positionZ.linearRampToValueAtTime(jc.z,i),t.orientationX.linearRampToValueAtTime(Uc.x,i),t.orientationY.linearRampToValueAtTime(Uc.y,i),t.orientationZ.linearRampToValueAtTime(Uc.z,i)}else t.setPosition(jc.x,jc.y,jc.z),t.setOrientation(Uc.x,Uc.y,Uc.z)}}class Bte{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class nN{constructor(e,t,i){let r,s,o;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else o+=t,this._mixBufferRegion(i,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){bn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;bn.multiplyQuaternionsFlat(e,o,e,t,e,i),bn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const sT="\\[\\]\\.:\\/",jte=new RegExp("["+sT+"]","g"),oT="[^"+sT+"]",Ute="[^"+sT.replace("\\.","")+"]",Vte=/((?:WC+[\/:])*)/.source.replace("WC",oT),zte=/(WCOD+)?/.source.replace("WCOD",Ute),Hte=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",oT),Gte=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",oT),Wte=new RegExp("^"+Vte+zte+Hte+Gte+"$"),Xte=["material","materials","bones"];class qte{constructor(e,t,i){const r=i||Bn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Bn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(jte,"")}static parseTrackName(t){const i=Wte.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Xte.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=qte,n})();Bn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Bn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Bn.prototype.GetterByBindingType=[Bn.prototype._getValue_direct,Bn.prototype._getValue_array,Bn.prototype._getValue_arrayElement,Bn.prototype._getValue_toArray],Bn.prototype.SetterByBindingTypeAndVersioning=[[Bn.prototype._setValue_direct,Bn.prototype._setValue_direct_setNeedsUpdate,Bn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bn.prototype._setValue_array,Bn.prototype._setValue_array_setNeedsUpdate,Bn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bn.prototype._setValue_arrayElement,Bn.prototype._setValue_arrayElement_setNeedsUpdate,Bn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bn.prototype._setValue_fromArray,Bn.prototype._setValue_fromArray_setNeedsUpdate,Bn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Zte{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ss(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const d=arguments[u],f=d.uuid;let p=t[f];if(void 0===p){p=l++,t[f]=p,e.push(d);for(let m=0,g=o;m!==g;++m)s[m].push(new Bn(d,i[m],r[m]))}else if(p<c){a=e[p];const m=--c,g=e[m];t[g.uuid]=p,e[p]=g,t[f]=m,e[m]=d;for(let _=0,v=o;_!==v;++_){const y=s[_];let w=y[p];y[p]=y[m],void 0===w&&(w=new Bn(d,i[_],r[_])),y[m]=w}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(void 0!==u&&u>=s){const h=s++,d=e[h];t[d.uuid]=u,e[u]=d,t[c]=h,e[h]=l;for(let f=0,p=r;f!==p;++f){const m=i[f],_=m[u];m[u]=m[h],m[h]=_}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a].uuid,h=t[u];if(void 0!==h)if(delete t[u],h<s){const d=--s,f=e[d],p=--o,m=e[p];t[f.uuid]=h,e[h]=f,t[m.uuid]=d,e[d]=m,e.pop();for(let g=0,_=r;g!==_;++g){const v=i[g],b=v[p];v[h]=v[d],v[d]=b,v.pop()}}else{const d=--o,f=e[d];d>0&&(t[f.uuid]=h),e[h]=f,e.pop();for(let p=0,m=r;p!==m;++p){const g=i[p];g[h]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(void 0!==r)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,u=this.nCachedObjects_,h=new Array(l.length);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(h);for(let d=u,f=l.length;d!==f;++d)h[d]=new Bn(l[d],e,t);return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a];t[e[a]]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class Yte{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:vc,endingEnd:vc};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=HF,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*i;if(l<0||0===i)return;this._startTime=null,t=i*l}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(this.blendMode===zM)for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===GF;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(i===VM){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=yc,r.endingEnd=yc):(r.endingStart=e?this.zeroSlopeAtStart?yc:vc:zf,r.endingEnd=t?this.zeroSlopeAtEnd?yc:vc:zf)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const Kte=new Float32Array(1);class iN extends rs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let h=0;h!==s;++h){const d=r[h],f=d.name;let p=u[f];if(void 0!==p)++p.referenceCount,o[h]=p;else{if(p=o[h],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}p=new nN(Bn.create(i,f,t&&t._propertyBindings[h].binding.parsedPath),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[h]=p}a[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new KS(new Float32Array(2),new Float32Array(2),1,Kte),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o="string"==typeof e?Wh.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==o?o.blendMode:x_),void 0!==l){const h=l.actionByRoot[s];if(void 0!==h&&h.blendMode===i)return h;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new Yte(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s="string"==typeof e?Wh.findByName(i,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,h=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,t[u]=h,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class aT{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new aT(void 0===this.value.clone?this.value:this.value.clone())}}class Qte extends tp{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class $te{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class mp{constructor(e,t,i=0,r=1/0){this.ray=new Zf(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new N_,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return lT(e,this,i,t),i.sort(rN),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)lT(e[r],this,i,t);return i.sort(rN),i}}function rN(n,e){return n.distance-e.distance}function lT(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)lT(r[s],e,t,!0)}}class Tv{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(wi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Jte{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const sN=new te;class ene{constructor(e=new te(1/0,1/0),t=new te(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=sN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return sN.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const oN=new C,Cv=new C;class aN{constructor(e=new C,t=new C){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){oN.subVectors(e,this.start),Cv.subVectors(this.end,this.start);const i=Cv.dot(Cv);let s=Cv.dot(oN)/i;return t&&(s=wi(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const lN=new C;class tne extends nn{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const i=new wt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new $e(r,3));const s=new Pi({fog:!1,toneMapped:!1});this.cone=new Cs(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),lN.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(lN),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const bl=new C,Ev=new ot,cT=new ot;class nne extends Cs{constructor(e){const t=cN(e),i=new wt,r=[],s=[],o=new Ce(0,0,1),a=new Ce(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new $e(r,3)),i.setAttribute("color",new $e(s,3)),super(i,new Pi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");cT.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Ev.multiplyMatrices(cT,a.matrixWorld),bl.setFromMatrixPosition(Ev),r.setXYZ(o,bl.x,bl.y,bl.z),Ev.multiplyMatrices(cT,a.parent.matrixWorld),bl.setFromMatrixPosition(Ev),r.setXYZ(o+1,bl.x,bl.y,bl.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function cN(n){const e=[];!0===n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,cN(n.children[t]));return e}class ine extends qe{constructor(e,t,i){super(new Ca(t,4,2),new nr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const rne=new C,uN=new Ce,hN=new Ce;class sne extends nn{constructor(e,t,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const r=new fo(t);r.rotateY(.5*Math.PI),this.material=new nr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(3*s.count);r.setAttribute("color",new En(o,3)),this.add(new qe(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");uN.copy(this.light.color),hN.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?uN:hN;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}e.lookAt(rne.setFromMatrixPosition(this.light.matrixWorld).negate())}}class uT extends Cs{constructor(e=10,t=10,i=4473924,r=8947848){i=new Ce(i),r=new Ce(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=t;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=d===s?i:r;m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3}const u=new wt;u.setAttribute("position",new $e(l,3)),u.setAttribute("color",new $e(c,3)),super(u,new Pi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class one extends Cs{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new Ce(s),o=new Ce(o);const a=[],l=[];for(let h=0;h<=t;h++){const d=h/t*(2*Math.PI),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const m=1&h?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let h=0;h<=i;h++){const d=1&h?s:o,f=e-e/i*h;for(let p=0;p<r;p++){let m=p/r*(2*Math.PI),g=Math.sin(m)*f,_=Math.cos(m)*f;a.push(g,0,_),l.push(d.r,d.g,d.b),m=(p+1)/r*(2*Math.PI),g=Math.sin(m)*f,_=Math.cos(m)*f,a.push(g,0,_),l.push(d.r,d.g,d.b)}}const c=new wt;c.setAttribute("position",new $e(a,3)),c.setAttribute("color",new $e(l,3)),super(c,new Pi({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const dN=new C,Dv=new C,fN=new C;class ane extends nn{constructor(e,t,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===t&&(t=1);let r=new wt;r.setAttribute("position",new $e([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Pi({fog:!1,toneMapped:!1});this.lightPlane=new Mi(r,s),this.add(this.lightPlane),r=new wt,r.setAttribute("position",new $e([0,0,0,0,0,1],3)),this.targetLine=new Mi(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){dN.setFromMatrixPosition(this.light.matrixWorld),Dv.setFromMatrixPosition(this.light.target.matrixWorld),fN.subVectors(Dv,dN),this.lightPlane.lookAt(Dv),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Dv),this.targetLine.scale.z=fN.length()}}const Av=new C,_i=new Qf;class lne extends Cs{constructor(e){const t=new wt,i=new Pi({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={},a=new Ce(16755200),l=new Ce(16711680),c=new Ce(43775),u=new Ce(16777215),h=new Ce(3355443);function d(p,m,g){f(p,g),f(m,g)}function f(p,m){r.push(0,0,0),s.push(m.r,m.g,m.b),void 0===o[p]&&(o[p]=[]),o[p].push(r.length/3-1)}d("n1","n2",a),d("n2","n4",a),d("n4","n3",a),d("n3","n1",a),d("f1","f2",a),d("f2","f4",a),d("f4","f3",a),d("f3","f1",a),d("n1","f1",a),d("n2","f2",a),d("n3","f3",a),d("n4","f4",a),d("p","n1",l),d("p","n2",l),d("p","n3",l),d("p","n4",l),d("u1","u2",c),d("u2","u3",c),d("u3","u1",c),d("c","t",u),d("p","c",h),d("cn1","cn2",h),d("cn3","cn4",h),d("cf1","cf2",h),d("cf3","cf4",h),t.setAttribute("position",new $e(r,3)),t.setAttribute("color",new $e(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const e=this.geometry,t=this.pointMap;_i.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Si("c",t,e,_i,0,0,-1),Si("t",t,e,_i,0,0,1),Si("n1",t,e,_i,-1,-1,-1),Si("n2",t,e,_i,1,-1,-1),Si("n3",t,e,_i,-1,1,-1),Si("n4",t,e,_i,1,1,-1),Si("f1",t,e,_i,-1,-1,1),Si("f2",t,e,_i,1,-1,1),Si("f3",t,e,_i,-1,1,1),Si("f4",t,e,_i,1,1,1),Si("u1",t,e,_i,.7,1.1,-1),Si("u2",t,e,_i,-.7,1.1,-1),Si("u3",t,e,_i,0,2,-1),Si("cf1",t,e,_i,-1,0,1),Si("cf2",t,e,_i,1,0,1),Si("cf3",t,e,_i,0,-1,1),Si("cf4",t,e,_i,0,1,1),Si("cn1",t,e,_i,-1,0,-1),Si("cn2",t,e,_i,1,0,-1),Si("cn3",t,e,_i,0,-1,-1),Si("cn4",t,e,_i,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Si(n,e,t,i,r,s,o){Av.set(r,s,o).unproject(i);const a=e[n];if(void 0!==a){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],Av.x,Av.y,Av.z)}}const Rv=new zo;class cne extends Cs{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new wt;s.setIndex(new En(i,1)),s.setAttribute("position",new En(r,3)),super(s,new Pi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Rv.setFromObject(this.object),Rv.isEmpty())return;const t=Rv.min,i=Rv.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}}class pN extends Cs{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new wt;s.setIndex(new En(i,1)),s.setAttribute("position",new $e([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new Pi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class une extends Mi{constructor(e,t=1,i=16776960){const r=i,o=new wt;o.setAttribute("position",new $e([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),super(o,new Pi({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=new wt;l.setAttribute("position",new $e([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),l.computeBoundingSphere(),this.add(new qe(l,new nr({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?ns:$a,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const mN=new C;let Pv,hT;class hne extends nn{constructor(e=new C(0,0,1),t=new C(0,0,0),i=1,r=16776960,s=.2*i,o=.2*s){super(),this.type="ArrowHelper",void 0===Pv&&(Pv=new wt,Pv.setAttribute("position",new $e([0,0,0,0,1,0],3)),hT=new gi(0,.5,1,5,1),hT.translate(0,-.5,0)),this.position.copy(t),this.line=new Mi(Pv,new Pi({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new qe(hT,new nr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{mN.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(mN,t)}}setLength(e,t=.2*e,i=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class dne extends Cs{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new wt;r.setAttribute("position",new $e(t,3)),r.setAttribute("color",new $e([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new Pi({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new Ce,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class fne{constructor(){this.type="ShapePath",this.color=new Ce,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new cp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function i(v){const y=[];for(let b=0,w=v.length;b<w;b++){const M=v[b],T=new Pc;T.curves=M.curves,y.push(T)}return y}function r(v,y){const b=y.length;let w=!1;for(let M=b-1,T=0;T<b;M=T++){let x=y[M],E=y[T],R=E.x-x.x,F=E.y-x.y;if(Math.abs(F)>Number.EPSILON){if(F<0&&(x=y[T],R=-R,E=y[M],F=-F),v.y<x.y||v.y>E.y)continue;if(v.y===x.y){if(v.x===x.x)return!0}else{const V=F*(v.x-x.x)-R*(v.y-x.y);if(0===V)return!0;if(V<0)continue;w=!w}}else{if(v.y!==x.y)continue;if(E.x<=v.x&&v.x<=x.x||x.x<=v.x&&v.x<=E.x)return!0}}return w}const s=Xo.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return i(o);let a,l,c;const u=[];if(1===o.length)return l=o[0],c=new Pc,c.curves=l.curves,u.push(c),u;let h=!s(o[0].getPoints());h=e?!h:h;const d=[],f=[];let g,_,p=[],m=0;f[m]=void 0,p[m]=[];for(let v=0,y=o.length;v<y;v++)l=o[v],g=l.getPoints(),a=s(g),a=e?!a:a,a?(!h&&f[m]&&m++,f[m]={s:new Pc,p:g},f[m].s.curves=l.curves,h&&m++,p[m]=[]):p[m].push({h:l,p:g[0]});if(!f[0])return i(o);if(f.length>1){let v=!1,y=0;for(let b=0,w=f.length;b<w;b++)d[b]=[];for(let b=0,w=f.length;b<w;b++){const M=p[b];for(let T=0;T<M.length;T++){const x=M[T];let E=!0;for(let R=0;R<f.length;R++)r(x.p,f[R].p)&&(b!==R&&y++,E?(E=!1,d[R].push(x)):v=!0);E&&d[b].push(x)}}y>0&&!1===v&&(p=d)}for(let v=0,y=f.length;v<y;v++){c=f[v].s,u.push(c),_=p[v];for(let b=0,w=_.length;b<w;b++)c.holes.push(_[b].h)}return u}}class gp{static toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=wi(e,-65504,65504),_N[0]=e;const t=vN[0],i=t>>23&511;return vo[i]+((8388607&t)>>yo[i])}static fromHalfFloat(e){const t=e>>10;return vN[0]=dT[yN[t]+(1023&e)]+Xh[t],_N[0]}}const gN=new ArrayBuffer(4),_N=new Float32Array(gN),vN=new Uint32Array(gN),vo=new Uint32Array(512),yo=new Uint32Array(512);for(let n=0;n<256;++n){const e=n-127;e<-27?(vo[n]=0,vo[256|n]=32768,yo[n]=24,yo[256|n]=24):e<-14?(vo[n]=1024>>-e-14,vo[256|n]=1024>>-e-14|32768,yo[n]=-e-1,yo[256|n]=-e-1):e<=15?(vo[n]=e+15<<10,vo[256|n]=e+15<<10|32768,yo[n]=13,yo[256|n]=13):e<128?(vo[n]=31744,vo[256|n]=64512,yo[n]=24,yo[256|n]=24):(vo[n]=31744,vo[256|n]=64512,yo[n]=13,yo[256|n]=13)}const dT=new Uint32Array(2048),Xh=new Uint32Array(64),yN=new Uint32Array(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,dT[n]=e|t}for(let n=1024;n<2048;++n)dT[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)Xh[n]=n<<23;Xh[31]=1199570944,Xh[32]=2147483648;for(let n=33;n<63;++n)Xh[n]=2147483648+(n-32<<23);Xh[63]=3347054592;for(let n=1;n<64;++n)32!==n&&(yN[n]=1024);class pne extends wt{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class mne extends wt{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function gne(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function _ne(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function vne(){console.error("THREE.ImmediateRenderObject has been removed.")}class yne extends Nn{constructor(e,t,i){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,i),this.samples=4}}class bne extends Xf{constructor(e,t,i,r){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,i,r)}}class xne extends R_{constructor(e,t,i,r){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,i,r)}}function bN(n){return!(!n||!n.set)}function Lt(n,e){return bN(n)?void 0===e?n:Array.isArray(e)?(n.set(...e),n):n.copy&&e?(n.copy(e),n):void 0!==e?(n.set(e),n):n:e}function fT(n){return void 0!==n&&(n.observed||n.observers?.length>0)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:d_}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=d_);const pT={now:()=>(pT.delegate||Date).now(),delegate:void 0};class mT extends Ft{constructor(e=1/0,t=1/0,i=pT){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let a=0;for(let l=1;l<i.length&&i[l]<=o;l+=2)a=l;a&&i.splice(0,a+1)}}}class Mne{constructor(){this.memberMap=new Map,this.children=[],this.eventListener={},this.add=(...e)=>(this.objRef&&this.objRef.add(...e),this.children.push(...e),this),this.remove=(...e)=>{this.objRef&&this.objRef.remove(...e);for(const t of e){const i=this.children.indexOf(t);i>=0&&(this.children=this.children.splice(i,1))}return this},this.applyToObject3D=e=>{if(this.memberMap.forEach((t,i)=>{const r=e[i];bN(r)?Lt(r,t):e[i]=t}),this.children.forEach(t=>e.add(t)),this.objRef?.parent){const t=this.objRef?.parent;t.remove(this.objRef),t.add(e)}},this.addEventListener=(e,t)=>{let i=this.eventListener[e];i||(i=[],this.eventListener[e]=i),i.push(t),this.objRef&&this.objRef.addEventListener(e,t)},this.removeEventListener=(e,t)=>{const i=this.eventListener[e];if(!i)return;const r=i.indexOf(t);r>=0&&i.splice(r,1)}}get(e,t,i){switch(t){case"__isProxy":return!0;case"applyToObject3D":return this.applyToObject3D;case"objRef":return this.objRef;case"add":return this.add;case"remove":return this.remove;case"children":return this.objRef?this.objRef.children:this.children;default:{const r=t;let s=this.objRef?this.objRef[r]:this.memberMap.get(r);return void 0===s&&(s=e[r],void 0!==s&&this.memberMap.set(r,s)),s??e[r]}}}set(e,t,i,r){return"objRef"===t?(i&&this.applyToObject3D(i),this.objRef=i):(this.memberMap.set(t,i),this.objRef&&(this.objRef[t]=i)),!0}}function xN(n){return!0===n.__isProxy&&void 0===n.objRef}let qh=(()=>{class n{constructor(){this.autoAddToParent=!0,this.autoDispose=!0}set objRef(t){this.applyObjRef(t)}get objRef(){return this._objRef}addToParent(){}removeFromParent(){}get onUpdate(){return this.updateEmitter||(this.updateEmitter=new yt),this.updateEmitter}get objRef$(){return this._objRef$||(this._objRef$=new mT(1)),this._objRef$}ngOnInit(){this.objRef||(this.objRef=this.createThreeInstance(this.args))}getType(){throw new Error("derive me")}createThreeInstance(t){return Array.isArray(t)?new(this.getType())(...t):new(this.getType())(t)}ngOnChanges(t){if(!this.objRef||xN(this.objRef)){t.objRef?.currentValue?this.objRef=t.objRef?.currentValue:this.objRef||(this.objRef=this.createThreeInstance(t.args?.currentValue));for(const i in t)this[i]=t[i].currentValue;this.emitPropertyChanges(t)}else this.emitPropertyChanges(t)}disposeObjRef(){(function wne(n){return!(!n||"function"!=typeof n.dispose)})(this.objRef)&&this.objRef.dispose()}ngOnDestroy(){this.removeFromParent(),this.autoDispose&&this.disposeObjRef()}applyObjRef(t){this._objRef!==t&&(this.removeFromParent(),this._objRef=t,this.autoAddToParent&&this.addToParent(),this.emitObjRefChange())}emitObjRefChange(){this._objRef&&!xN(this._objRef)&&(this._objRef.dispatchEvent?.({type:"loaded",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitPropertyChanges(t){this._objRef&&this._objRef.dispatchEvent?.({type:"changes",changes:t}),this.updateEmitter&&this.updateEmitter.next(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["th-abs-wrapper"]],inputs:{autoAddToParent:"autoAddToParent",autoDispose:"autoDispose",objRef:"objRef",args:"args"},outputs:{onUpdate:"onUpdate",objRef$:"objRef$"},features:[$i],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})(),Tne=(()=>{class n extends qh{constructor(t){super(),this.parent=t}addToParent(){this._objRef&&this._objRef.parent&&this._objRef.parent.uuid!==this.parent.objRef.uuid&&this.parent.objRef.add(this._objRef)}removeFromParent(){this._objRef?.parent?.remove(this._objRef)}applyObjRef(t){this.attachToParent(t,this._objRef),this._objRef=t,this.emitObjRefChange()}attachToParent(t,i){!this.parent.objRef||t===i&&i?.parent?.uuid===this.parent.objRef.uuid||(i&&i.parent&&i.parent.remove(i),t&&(!t.parent||t.parent&&t.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(t))}set lookAt(t){Promise.resolve().then(()=>{!this.objRef||(Array.isArray(t)?this.objRef.lookAt(...t):this.objRef.lookAt(t))})}}return n.\u0275fac=function(t){return new(t||n)(N(n))},n.\u0275cmp=Re({type:n,selectors:[["th-abs-object"]],inputs:{lookAt:"lookAt"},features:[Se],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})(),an=(()=>{class n extends Tne{constructor(t){super(t)}getType(){return nn}set id(t){this._objRef&&(this._objRef.id=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set name(t){this._objRef&&(this._objRef.name=t)}set type(t){this._objRef&&(this._objRef.type=t)}set children(t){this._objRef&&(this._objRef.children=t)}set up(t){this._objRef&&(this._objRef.up=Lt(this._objRef.up,t))}set position(t){this._objRef&&Lt(this._objRef.position,t)}set rotation(t){this._objRef&&Lt(this._objRef.rotation,t)}set quaternion(t){this._objRef&&Lt(this._objRef.quaternion,t)}set scale(t){this._objRef&&Lt(this._objRef.scale,t)}set modelViewMatrix(t){this._objRef&&Lt(this._objRef.modelViewMatrix,t)}set normalMatrix(t){this._objRef&&Lt(this._objRef.normalMatrix,t)}set matrix(t){this._objRef&&(this._objRef.matrix=Lt(this._objRef.matrix,t))}set matrixWorld(t){this._objRef&&(this._objRef.matrixWorld=Lt(this._objRef.matrixWorld,t))}set matrixAutoUpdate(t){this._objRef&&(this._objRef.matrixAutoUpdate=t)}set matrixWorldNeedsUpdate(t){this._objRef&&(this._objRef.matrixWorldNeedsUpdate=t)}set layers(t){this._objRef&&(this._objRef.layers=Lt(this._objRef.layers,t))}set visible(t){this._objRef&&(this._objRef.visible=t)}set castShadow(t){this._objRef&&(this._objRef.castShadow=t)}set receiveShadow(t){this._objRef&&(this._objRef.receiveShadow=t)}set frustumCulled(t){this._objRef&&(this._objRef.frustumCulled=t)}set renderOrder(t){this._objRef&&(this._objRef.renderOrder=t)}set animations(t){this._objRef&&(this._objRef.animations=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set customDepthMaterial(t){this._objRef&&(this._objRef.customDepthMaterial=t)}set customDistanceMaterial(t){this._objRef&&(this._objRef.customDistanceMaterial=t)}set onBeforeRender(t){this._objRef&&(this._objRef.onBeforeRender=t)}set onAfterRender(t){this._objRef&&(this._objRef.onAfterRender=t)}}return n.\u0275fac=function(t){return new(t||n)(N(n,4))},n.\u0275cmp=Re({type:n,selectors:[["th-object3D"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",children:"children",up:"up",position:"position",rotation:"rotation",quaternion:"quaternion",scale:"scale",modelViewMatrix:"modelViewMatrix",normalMatrix:"normalMatrix",matrix:"matrix",matrixWorld:"matrixWorld",matrixAutoUpdate:"matrixAutoUpdate",matrixWorldNeedsUpdate:"matrixWorldNeedsUpdate",layers:"layers",visible:"visible",castShadow:"castShadow",receiveShadow:"receiveShadow",frustumCulled:"frustumCulled",renderOrder:"renderOrder",animations:"animations",userData:"userData",customDepthMaterial:"customDepthMaterial",customDistanceMaterial:"customDistanceMaterial",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),gT=(()=>{class n extends an{getType(){return Qf}set matrixWorldInverse(t){this._objRef&&(this._objRef.matrixWorldInverse=Lt(this._objRef.matrixWorldInverse,t))}set projectionMatrix(t){this._objRef&&(this._objRef.projectionMatrix=Lt(this._objRef.projectionMatrix,t))}set projectionMatrixInverse(t){this._objRef&&(this._objRef.projectionMatrixInverse=Lt(this._objRef.projectionMatrixInverse,t))}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-camera"]],inputs:{matrixWorldInverse:"matrixWorldInverse",projectionMatrix:"projectionMatrix",projectionMatrixInverse:"projectionMatrixInverse"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Ir=(()=>{class n extends gT{getType(){return zi}set type(t){this._objRef&&(this._objRef.type=t)}set zoom(t){this._objRef&&(this._objRef.zoom=t)}set fov(t){this._objRef&&(this._objRef.fov=t)}set aspect(t){this._objRef&&(this._objRef.aspect=t)}set near(t){this._objRef&&(this._objRef.near=t)}set far(t){this._objRef&&(this._objRef.far=t)}set focus(t){this._objRef&&(this._objRef.focus=t)}set view(t){this._objRef&&(this._objRef.view=t)}set filmGauge(t){this._objRef&&(this._objRef.filmGauge=t)}set filmOffset(t){this._objRef&&(this._objRef.filmOffset=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-perspectiveCamera"]],inputs:{type:"type",zoom:"zoom",fov:"fov",aspect:"aspect",near:"near",far:"far",focus:"focus",view:"view",filmGauge:"filmGauge",filmOffset:"filmOffset"},features:[Xe([{provide:an,useExisting:Ze(()=>n)},{provide:gT,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Cne=(()=>{class n extends an{getType(){return Mi}set geometry(t){this._objRef&&(this._objRef.geometry=t)}set material(t){this._objRef&&(this._objRef.material=t)}set type(t){this._objRef&&(this._objRef.type=t)}set morphTargetInfluences(t){this._objRef&&(this._objRef.morphTargetInfluences=t)}set morphTargetDictionary(t){this._objRef&&(this._objRef.morphTargetDictionary=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-line"]],inputs:{geometry:"geometry",material:"material",type:"type",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),wN=(()=>{class n extends Cne{getType(){return Cs}set type(t){this._objRef&&(this._objRef.type=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-lineSegments"]],inputs:{type:"type"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Vc=(()=>{class n extends wN{getType(){return uT}set type(t){this._objRef&&(this._objRef.type=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-gridHelper"]],inputs:{type:"type"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),_p=(()=>{class n extends an{getType(){return Aa}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=Lt(this._objRef.color,t))}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}set shadowCameraFov(t){this._objRef&&(this._objRef.shadowCameraFov=t)}set shadowCameraLeft(t){this._objRef&&(this._objRef.shadowCameraLeft=t)}set shadowCameraRight(t){this._objRef&&(this._objRef.shadowCameraRight=t)}set shadowCameraTop(t){this._objRef&&(this._objRef.shadowCameraTop=t)}set shadowCameraBottom(t){this._objRef&&(this._objRef.shadowCameraBottom=t)}set shadowCameraNear(t){this._objRef&&(this._objRef.shadowCameraNear=t)}set shadowCameraFar(t){this._objRef&&(this._objRef.shadowCameraFar=t)}set shadowBias(t){this._objRef&&(this._objRef.shadowBias=t)}set shadowMapWidth(t){this._objRef&&(this._objRef.shadowMapWidth=t)}set shadowMapHeight(t){this._objRef&&(this._objRef.shadowMapHeight=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-light"]],inputs:{type:"type",color:"color",intensity:"intensity",shadow:"shadow",shadowCameraFov:"shadowCameraFov",shadowCameraLeft:"shadowCameraLeft",shadowCameraRight:"shadowCameraRight",shadowCameraTop:"shadowCameraTop",shadowCameraBottom:"shadowCameraBottom",shadowCameraNear:"shadowCameraNear",shadowCameraFar:"shadowCameraFar",shadowBias:"shadowBias",shadowMapWidth:"shadowMapWidth",shadowMapHeight:"shadowMapHeight"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),_T=(()=>{class n extends _p{getType(){return JS}set type(t){this._objRef&&(this._objRef.type=t)}set position(t){this._objRef&&(this._objRef.position=Lt(this._objRef.position,t))}set groundColor(t){this._objRef&&(this._objRef.groundColor=Lt(this._objRef.groundColor,t))}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-hemisphereLight"]],inputs:{type:"type",position:"position",groundColor:"groundColor"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),vp=(()=>{class n extends _p{getType(){return xv}set type(t){this._objRef&&(this._objRef.type=t)}set position(t){this._objRef&&Lt(this._objRef.position,t)}set target(t){this._objRef&&(this._objRef.target=t)}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-directionalLight"]],inputs:{type:"type",position:"position",target:"target",intensity:"intensity",shadow:"shadow"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Ds=(()=>{class n extends an{getType(){return qe}set geometry(t){this._objRef&&(this._objRef.geometry=t)}set material(t){this._objRef&&(this._objRef.material=t)}set morphTargetInfluences(t){this._objRef&&(this._objRef.morphTargetInfluences=t)}set morphTargetDictionary(t){this._objRef&&(this._objRef.morphTargetDictionary=t)}set type(t){this._objRef&&(this._objRef.type=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-mesh"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",type:"type"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),mr=(()=>{class n extends an{getType(){return ES}set type(t){this._objRef&&(this._objRef.type=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}set overrideMaterial(t){this._objRef&&(this._objRef.overrideMaterial=t)}set autoUpdate(t){this._objRef&&(this._objRef.autoUpdate=t)}set background(t){this._objRef&&(this._objRef.background=Lt(this._objRef.background,t))}set environment(t){this._objRef&&(this._objRef.environment=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-scene"]],inputs:{type:"type",fog:"fog",overrideMaterial:"overrideMaterial",autoUpdate:"autoUpdate",background:"background",environment:"environment"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Ene=(()=>{class n extends qh{constructor(t){super(),this.parent=t}addToParent(){if(!this.parent.objRef)throw new Error("parent object doesn't hold a three js object instance");this.parent.objRef.material=this.objRef}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.material=void 0)}}return n.\u0275fac=function(t){return new(t||n)(N(an))},n.\u0275cmp=Re({type:n,selectors:[["th-abs-material"]],features:[Se],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})(),Zh=(()=>{class n extends Ene{constructor(t){super(t)}getType(){return mi}set alphaTest(t){this._objRef&&(this._objRef.alphaTest=t)}set alphaToCoverage(t){this._objRef&&(this._objRef.alphaToCoverage=t)}set blendDst(t){this._objRef&&(this._objRef.blendDst=t)}set blendDstAlpha(t){this._objRef&&(this._objRef.blendDstAlpha=t)}set blendEquation(t){this._objRef&&(this._objRef.blendEquation=t)}set blendEquationAlpha(t){this._objRef&&(this._objRef.blendEquationAlpha=t)}set blending(t){this._objRef&&(this._objRef.blending=t)}set blendSrc(t){this._objRef&&(this._objRef.blendSrc=t)}set blendSrcAlpha(t){this._objRef&&(this._objRef.blendSrcAlpha=t)}set clipIntersection(t){this._objRef&&(this._objRef.clipIntersection=t)}set clippingPlanes(t){this._objRef&&(this._objRef.clippingPlanes=t)}set clipShadows(t){this._objRef&&(this._objRef.clipShadows=t)}set colorWrite(t){this._objRef&&(this._objRef.colorWrite=t)}set defines(t){this._objRef&&(this._objRef.defines=t)}set depthFunc(t){this._objRef&&(this._objRef.depthFunc=t)}set depthTest(t){this._objRef&&(this._objRef.depthTest=t)}set depthWrite(t){this._objRef&&(this._objRef.depthWrite=t)}set id(t){this._objRef&&(this._objRef.id=t)}set stencilWrite(t){this._objRef&&(this._objRef.stencilWrite=t)}set stencilFunc(t){this._objRef&&(this._objRef.stencilFunc=t)}set stencilRef(t){this._objRef&&(this._objRef.stencilRef=t)}set stencilWriteMask(t){this._objRef&&(this._objRef.stencilWriteMask=t)}set stencilFuncMask(t){this._objRef&&(this._objRef.stencilFuncMask=t)}set stencilFail(t){this._objRef&&(this._objRef.stencilFail=t)}set stencilZFail(t){this._objRef&&(this._objRef.stencilZFail=t)}set stencilZPass(t){this._objRef&&(this._objRef.stencilZPass=t)}set name(t){this._objRef&&(this._objRef.name=t)}set needsUpdate(t){this._objRef&&(this._objRef.needsUpdate=t)}set opacity(t){this._objRef&&(this._objRef.opacity=t)}set polygonOffset(t){this._objRef&&(this._objRef.polygonOffset=t)}set polygonOffsetFactor(t){this._objRef&&(this._objRef.polygonOffsetFactor=t)}set polygonOffsetUnits(t){this._objRef&&(this._objRef.polygonOffsetUnits=t)}set precision(t){this._objRef&&(this._objRef.precision=t)}set premultipliedAlpha(t){this._objRef&&(this._objRef.premultipliedAlpha=t)}set dithering(t){this._objRef&&(this._objRef.dithering=t)}set side(t){this._objRef&&(this._objRef.side=t)}set shadowSide(t){this._objRef&&(this._objRef.shadowSide=t)}set toneMapped(t){this._objRef&&(this._objRef.toneMapped=t)}set transparent(t){this._objRef&&(this._objRef.transparent=t)}set type(t){this._objRef&&(this._objRef.type=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set vertexColors(t){this._objRef&&(this._objRef.vertexColors=t)}set visible(t){this._objRef&&(this._objRef.visible=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set version(t){this._objRef&&(this._objRef.version=t)}}return n.\u0275fac=function(t){return new(t||n)(N(an,4))},n.\u0275cmp=Re({type:n,selectors:[["th-material"]],inputs:{alphaTest:"alphaTest",alphaToCoverage:"alphaToCoverage",blendDst:"blendDst",blendDstAlpha:"blendDstAlpha",blendEquation:"blendEquation",blendEquationAlpha:"blendEquationAlpha",blending:"blending",blendSrc:"blendSrc",blendSrcAlpha:"blendSrcAlpha",clipIntersection:"clipIntersection",clippingPlanes:"clippingPlanes",clipShadows:"clipShadows",colorWrite:"colorWrite",defines:"defines",depthFunc:"depthFunc",depthTest:"depthTest",depthWrite:"depthWrite",id:"id",stencilWrite:"stencilWrite",stencilFunc:"stencilFunc",stencilRef:"stencilRef",stencilWriteMask:"stencilWriteMask",stencilFuncMask:"stencilFuncMask",stencilFail:"stencilFail",stencilZFail:"stencilZFail",stencilZPass:"stencilZPass",name:"name",needsUpdate:"needsUpdate",opacity:"opacity",polygonOffset:"polygonOffset",polygonOffsetFactor:"polygonOffsetFactor",polygonOffsetUnits:"polygonOffsetUnits",precision:"precision",premultipliedAlpha:"premultipliedAlpha",dithering:"dithering",side:"side",shadowSide:"shadowSide",toneMapped:"toneMapped",transparent:"transparent",type:"type",uuid:"uuid",vertexColors:"vertexColors",visible:"visible",userData:"userData",version:"version"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Yh=(()=>{class n extends Zh{getType(){return YS}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=Lt(this._objRef.color,t))}set specular(t){this._objRef&&(this._objRef.specular=Lt(this._objRef.specular,t))}set shininess(t){this._objRef&&(this._objRef.shininess=t)}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set emissive(t){this._objRef&&(this._objRef.emissive=Lt(this._objRef.emissive,t))}set emissiveIntensity(t){this._objRef&&(this._objRef.emissiveIntensity=t)}set emissiveMap(t){this._objRef&&(this._objRef.emissiveMap=t)}set bumpMap(t){this._objRef&&(this._objRef.bumpMap=t)}set bumpScale(t){this._objRef&&(this._objRef.bumpScale=t)}set normalMap(t){this._objRef&&(this._objRef.normalMap=t)}set normalMapType(t){this._objRef&&(this._objRef.normalMapType=t)}set normalScale(t){this._objRef&&(this._objRef.normalScale=Lt(this._objRef.normalScale,t))}set displacementMap(t){this._objRef&&(this._objRef.displacementMap=t)}set displacementScale(t){this._objRef&&(this._objRef.displacementScale=t)}set displacementBias(t){this._objRef&&(this._objRef.displacementBias=t)}set specularMap(t){this._objRef&&(this._objRef.specularMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set combine(t){this._objRef&&(this._objRef.combine=t)}set reflectivity(t){this._objRef&&(this._objRef.reflectivity=t)}set refractionRatio(t){this._objRef&&(this._objRef.refractionRatio=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set flatShading(t){this._objRef&&(this._objRef.flatShading=t)}set metal(t){this._objRef&&(this._objRef.metal=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-meshPhongMaterial"]],inputs:{type:"type",color:"color",specular:"specular",shininess:"shininess",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",metal:"metal",fog:"fog"},features:[Xe([{provide:Zh,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Dne=(()=>{class n extends qh{constructor(t){super(),this.parent=t}addToParent(){!this.parent.objRef||(this.parent.objRef.geometry=this.objRef,this.parent.objRef.updateMorphTargets&&this.parent.objRef.updateMorphTargets())}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.geometry=void 0)}}return n.\u0275fac=function(t){return new(t||n)(N(an))},n.\u0275cmp=Re({type:n,selectors:[["th-abs-geometry"]],features:[Se],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})(),bo=(()=>{class n extends Dne{constructor(t){super(t)}getType(){return wt}set id(t){this._objRef&&(this._objRef.id=t)}set uuid(t){this._objRef&&(this._objRef.uuid=t)}set name(t){this._objRef&&(this._objRef.name=t)}set type(t){this._objRef&&(this._objRef.type=t)}set index(t){this._objRef&&(this._objRef.index=Lt(this._objRef.index,t))}set attributes(t){this._objRef&&(this._objRef.attributes=t)}set morphAttributes(t){this._objRef&&(this._objRef.morphAttributes=t)}set morphTargetsRelative(t){this._objRef&&(this._objRef.morphTargetsRelative=t)}set groups(t){this._objRef&&(this._objRef.groups=t)}set boundingBox(t){this._objRef&&(this._objRef.boundingBox=Lt(this._objRef.boundingBox,t))}set boundingSphere(t){this._objRef&&(this._objRef.boundingSphere=Lt(this._objRef.boundingSphere,t))}set drawRange(t){this._objRef&&(this._objRef.drawRange=t)}set userData(t){this._objRef&&(this._objRef.userData=t)}set drawcalls(t){this._objRef&&(this._objRef.drawcalls=t)}set offsets(t){this._objRef&&(this._objRef.offsets=t)}}return n.\u0275fac=function(t){return new(t||n)(N(an,4))},n.\u0275cmp=Re({type:n,selectors:[["th-bufferGeometry"]],inputs:{id:"id",uuid:"uuid",name:"name",type:"type",index:"index",attributes:"attributes",morphAttributes:"morphAttributes",morphTargetsRelative:"morphTargetsRelative",groups:"groups",boundingBox:"boundingBox",boundingSphere:"boundingSphere",drawRange:"drawRange",userData:"userData",drawcalls:"drawcalls",offsets:"offsets"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),vT=(()=>{class n extends bo{getType(){return Ta}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-planeGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:bo,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();var Kh=(()=>{return(n=Kh||(Kh={})).mouseEnter="mouseEnter",n.mouseExit="mouseExit",n.click="click",Kh;var n})();let yp=(()=>{class n{constructor(){this.raycaster=new mp,this.selected=null,this.enabled=!0,this.groups=[],this.paused=!1,this.maxClickDistance=23,this.nid=n.instanceCnt++,this.onPointerMove=this.onPointerMove.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}ngOnDestroy(){this.disable(),this.unsubscribe()}subscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.addEventListener("pointermove",this.onPointerMove),this.canvas.addEventListener("pointerdown",this.onPointerDown),this.canvas.addEventListener("pointerup",this.onPointerUp)}unsubscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.removeEventListener("pointermove",this.onPointerMove),this.canvas.removeEventListener("pointerdown",this.onPointerDown),this.canvas.removeEventListener("pointerup",this.onPointerUp)}enable(){this.enabled=!0}disable(){this.enabled=!1}pause(){this.paused=!0}resume(){this.paused=!1}get isEnabled(){return this.enabled}init(t,i){this.camera=t,this.canvas=i,this.subscribe()}addEventTarget(t){this.groups.push(t)}removeEventTarget(t){const i=this.groups.indexOf(t);i>=0&&this.groups.splice(i,1)}onPointerMove(t){if(!this.isReady())return;const i=this.getFirstIntersectedGroup(t.layerX,t.layerY);if((!this.selected||this.selected!==i.target)&&(this.selected&&(this.selected.host.objRef?.dispatchEvent({type:Kh.mouseExit}),this.selected.onMouseExit(),this.selected=null),i&&i.target)){this.selected=i.target;const r={type:Kh.mouseEnter,face:i.face};this.selected.host.objRef?.dispatchEvent(r),this.selected.onMouseEnter(r)}}onPointerDown(t){this.maxClickDistance=t.width,this.pointerDownEvent=t}onPointerUp(t){const i=this.pointerDownEvent;if(this.pointerDownEvent=void 0,!this.isReady()||this.calcPointerDownUpDinstance(t,i)>this.maxClickDistance)return;const r=this.getFirstIntersectedGroup(t.layerX,t.layerY);if(r&&r.target&&r.target.host.objRef){const s={type:Kh.click,face:r.face};r.target.host.objRef.dispatchEvent(s),r.target.onClick(s)}}isReady(t){return!!(this.enabled&&(t||!this.paused)&&this.camera&&this.camera.objRef&&this.groups&&this.groups.length>0)}calcPointerDownUpDinstance(t,i){if(!i)return Number.MAX_VALUE;const r=t.layerX-i.layerX,s=t.layerY-i.layerY;return Math.sqrt(r*r+s*s)}getFirstIntersectedGroup(t,i){if(!this.camera||!this.canvas||!this.camera.objRef)return{face:null,target:null};const r=new te(t=t/this.canvas.clientWidth*2-1,i=-i/this.canvas.clientHeight*2+1);this.raycaster.setFromCamera(r,this.camera.objRef);let o,a,s=null;for(const l of this.groups){const c=l.host.objRef;if(!c)continue;const u=this.raycaster.intersectObject(c,!0);u.length>0&&(!o||o.distance>u[0].distance)&&(o=u[0],s=o.face,a=l)}return a?{target:a,face:s}:{target:null,face:null}}}return n.instanceCnt=0,n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function jn(n){return ui((e,t)=>{kr(n).subscribe(Jn(t,()=>t.complete(),m0)),!t.closed&&e.subscribe(t)})}const MN={alpha:!0,antialias:!0,preserveDrawingBuffer:!0};let zc=(()=>{class n{constructor(t){this.ngZone=t,this.clock=new Sv,this.destroyed$=new Ft,this.resizeEmitter=new yt,this.beforeRenderEmitter=new yt,this.views=[],this.beforeRender$=this.beforeRenderEmitter.pipe(jn(this.destroyed$)),this.resize$=this.resizeEmitter.pipe(jn(this.destroyed$))}get canvas(){return this.rendererParameters?.domElement}get renderer(){return this._renderer}ngOnDestroy(){this.resizeObserver&&this.canvas&&this.resizeObserver.unobserve(this.canvas)}initResizeObserver(){this.ngZone.runOutsideAngular(()=>{if(!this.canvas)throw new Error("missing canvas element");this.resize(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.resize()})),this.resizeObserver.observe(this.canvas)})}initRenderer(){this._renderer||(this._renderer=new CS({canvas:this.rendererParameters?.domElement,...MN}),Object.assign(this._renderer,{...MN,...this.rendererParameters}),this.resize())}setRenderer(t){this.rendererParameters=t,this.initRenderer(),this.initResizeObserver()}addView(t){this.views.push(t);const i=this.calcRendererSize();i&&this.adjustViewDimensions(t,i.width,i.height)}render(){this.beforeRenderEmitter.emit({engine:this,delta:this.clock.getDelta()});for(const t of this.views)this.renderView(t)}renderView(t){if(!this._renderer)return;const i=t.camera,r=t.scene;if(!(i&&r&&i.objRef&&r.objRef))return;const s=this._renderer;fT(t.onRender)&&this.ngZone.run(()=>t.onRender.emit({renderer:s,scene:r,camera:i})),this.applyRendererParametersFromView(t),t.effectComposer?t.effectComposer.render():this._renderer.render(r.objRef,i.objRef)}applyRendererParametersFromView(t){!this._renderer||(t.viewPort&&(t.viewPort instanceof gn?this._renderer.setViewport(t.viewPort):this._renderer.setViewport(t.viewPort.x,t.viewPort.y,t.viewPort.width,t.viewPort.height)),t.scissor&&(t.scissor instanceof gn?this._renderer.setScissor(t.scissor):this._renderer.setScissor(t.scissor.x,t.scissor.y,t.scissor.width,t.scissor.height)),void 0!==t.scissorTest&&this._renderer.setScissorTest(t.scissorTest),t.clearColor&&this._renderer.setClearColor(t.clearColor),void 0!==t.clearAlpha&&this._renderer.setClearAlpha(t.clearAlpha),void 0!==t.shadow&&(this._renderer.shadowMap.enabled=!0))}resize(){if(!this._renderer||!this.canvas)return!1;const{width:t,height:i}=this.calcRendererSize();this._renderer.setSize(t,i,!1);for(const r of this.views)this.adjustViewDimensions(r,t,i);return this.resizeEmitter.emit({width:t,height:i}),!0}calcRendererSize(){if(!this._renderer||!this.canvas)return;const t=window.devicePixelRatio;return{width:(this.canvas.clientWidth??0)*t,height:(this.canvas.clientHeight??0)*t}}adjustViewDimensions(t,i,r){t.viewPort||(t.camera&&t.camera.objRef.aspect&&(t.camera.objRef.aspect=i/r,t.camera.objRef.updateProjectionMatrix()),t.effectComposer?.setSize(i,r))}}return n.\u0275fac=function(t){return new(t||n)(re(Pt))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),bp=(()=>{class n{constructor(t,i){this.engineService=t,this.ngZone=i,this.active=!0,this.destroyed$=new Ft,this.beforeRender$=this.engineService.beforeRender$,this.engineService.resize$.pipe(jn(this.destroyed$)).subscribe(()=>this.requestAnimationFrame())}ngOnDestroy(){this.stop(),this.destroyed$.next(),this.destroyed$.complete()}start(){this.active||(this.active=!0,this.requestAnimationFrame())}stop(){this.active=!1,void 0!==this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=void 0)}isActive(){return this.active}requestAnimationFrame(){void 0===this.frameId&&this.ngZone.runOutsideAngular(()=>this.frameId=requestAnimationFrame(()=>{this.frameId=void 0,this.engineService.render(),this.active&&this.requestAnimationFrame()}))}}return n.\u0275fac=function(t){return new(t||n)(re(zc),re(Pt))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),xl=(()=>{class n{constructor(t,i){this.engServ=t,this.raycaster=i,this.onRender=new yt}set contentScene(t){t&&(this.scene=t)}set effectComposer(t){this._effectComposer=t,this.configureEffectComposerRenderTarget()}get effectComposer(){return this._effectComposer}set camera(t){this._camera=t,this.initRaycaster()}get camera(){return this._camera}set contentCamera(t){t&&(this.camera=t)}set viewPort(t){this._viewPort=t,this.configureEffectComposerRenderTarget()}get viewPort(){return this._viewPort}ngOnInit(){this.initRaycaster()}initRaycaster(){this.camera&&this.engServ.canvas&&this.raycaster.init(this.camera,this.engServ.canvas)}add(t){}remove(t){}configureEffectComposerRenderTarget(){if(this.viewPort&&this.effectComposer){let t,i;this.viewPort instanceof gn?(t=this.viewPort.z,i=this.viewPort?.width):(t=this.viewPort.width,i=this.viewPort.height),this.effectComposer.setSize(t,i)}}}return n.\u0275fac=function(t){return new(t||n)(N(zc),N(yp))},n.\u0275cmp=Re({type:n,selectors:[["th-view"]],contentQueries:function(t,i,r){if(1&t&&(pi(r,mr,5),pi(r,gT,5)),2&t){let s;Et(s=Dt())&&(i.contentScene=s.first),Et(s=Dt())&&(i.contentCamera=s.first)}},inputs:{scene:"scene",effectComposer:"effectComposer",camera:"camera",shadow:"shadow",viewPort:"viewPort",scissor:"scissor",scissorTest:"scissorTest",clearColor:"clearColor",clearAlpha:"clearAlpha"},outputs:{onRender:"onRender"},features:[Xe([{provide:an,useExisting:Ze(()=>n)},yp])],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})();const Ane=["rendererCanvas"];let ir=(()=>{class n extends xl{constructor(t,i,r){super(t,r),this.engServ=t,this.animationLoop=i,this.raycaster=r,this.nid=n.instanceCnt++,this.disableDefaultView=!1,console.log("canvas "+this.nid)}get obj(){return this}set views(t){t.forEach(i=>this.engServ.addView(i))}set rendererCanvas(t){!t||(this._rendererCanvas=t,t.nativeElement.id+=this.nid)}get rendererCanvas(){return this._rendererCanvas}ngAfterContentChecked(){this.animationLoop.requestAnimationFrame()}ngAfterViewInit(){this.animationLoop.requestAnimationFrame()}ngOnInit(){this.applyRendererParameters(),super.ngOnInit(),this.disableDefaultView||this.engServ.addView(this)}applyRendererParameters(){if(!this.rendererCanvas)throw new Error("Missing Canvas");this.engServ.setRenderer({...this.rendererParameters,domElement:this.rendererCanvas.nativeElement})}}return n.instanceCnt=0,n.\u0275fac=function(t){return new(t||n)(N(zc),N(bp),N(Ze(()=>yp)))},n.\u0275cmp=Re({type:n,selectors:[["th-canvas"]],contentQueries:function(t,i,r){if(1&t&&pi(r,xl,4),2&t){let s;Et(s=Dt())&&(i.views=s)}},viewQuery:function(t,i){if(1&t&&Pn(Ane,7),2&t){let r;Et(r=Dt())&&(i.rendererCanvas=r.first)}},inputs:{rendererParameters:"rendererParameters",disableDefaultView:"disableDefaultView"},features:[Xe([{provide:an,useExisting:Ze(()=>n)},zc,bp,Ze(()=>yp),{provide:xl,useExisting:Ze(()=>n)}]),Se],decls:2,vars:0,consts:[["id","rendererCanvas"],["rendererCanvas",""]],template:function(t,i){1&t&&Ye(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{display:flex;flex:auto;line-height:0;height:100%}canvas[_ngcontent-%COMP%]{flex:auto;outline:none;width:100%;height:100%}"],changeDetection:0}),n})();var xp=function(){var n=0,e=document.createElement("div");function t(u){return e.appendChild(u.dom),u}function i(u){for(var h=0;h<e.children.length;h++)e.children[h].style.display=h===u?"block":"none";n=u}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),i(++n%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new xp.Panel("FPS","#0ff","#002")),l=t(new xp.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new xp.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){o++;var u=(performance||Date).now();if(l.update(u-r,200),u>=s+1e3&&(a.update(1e3*o/(u-s),100),s=u,o=0,c)){var h=performance.memory;c.update(h.usedJSHeapSize/1048576,h.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:i}};xp.Panel=function(n,e,t){var i=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,u=2*o,h=3*o,d=15*o,f=74*o,p=30*o,m=document.createElement("canvas");m.width=a,m.height=l,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=t,g.fillRect(0,0,a,l),g.fillStyle=e,g.fillText(n,c,u),g.fillRect(h,d,f,p),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(h,d,f,p),{dom:m,update:function(_,v){i=Math.min(i,_),r=Math.max(r,_),g.fillStyle=t,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=e,g.fillText(s(_)+" "+n+" ("+s(i)+"-"+s(r)+")",c,u),g.drawImage(m,h+o,d,f-o,p,h,d,f-o,p),g.fillRect(h+f-o,d,o,p),g.fillStyle=t,g.globalAlpha=.9,g.fillRect(h+f-o,d,o,s((1-_/v)*p))}}};const Rne=xp;let wp=(()=>{class n{constructor(t){this.engineService=t,this.stats=Rne()}ngOnDestroy(){this.renderSubscription&&this.renderSubscription.unsubscribe()}ngOnInit(){if(!this.engineService.canvas)throw new Error("No canvas present");const t=this.engineService.canvas.parentElement;t&&(t.style.position="relative",this.stats.domElement.style.position="absolute",this.stats.showPanel(0),this.engineService.canvas.parentElement?.appendChild(this.stats.dom),this.renderSubscription=this.engineService.beforeRender$.subscribe(()=>{this.stats.update()}))}set thStats(t){this.stats.domElement.style.visibility=t?"visible":"hidden"}}return n.\u0275fac=function(t){return new(t||n)(N(zc))},n.\u0275dir=tt({type:n,selectors:[["","thStats",""]],inputs:{thStats:"thStats"}}),n})();const SN="https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/assets/",Ra="assets/";class Pne extends Pr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new One(t)}),this.register(function(t){return new Hne(t)}),this.register(function(t){return new Gne(t)}),this.register(function(t){return new Bne(t)}),this.register(function(t){return new jne(t)}),this.register(function(t){return new Une(t)}),this.register(function(t){return new Vne(t)}),this.register(function(t){return new kne(t)}),this.register(function(t){return new zne(t)}),this.register(function(t){return new Nne(t)}),this.register(function(t){return new Lne(t)}),this.register(function(t){return new Wne(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:_o.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Es(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={};if("string"==typeof e)s=e;else if(_o.decodeText(new Uint8Array(e,0,4))===TN){try{o[rn.KHR_BINARY_GLTF]=new Xne(e)}catch(h){return void(r&&r(h))}s=o[rn.KHR_BINARY_GLTF].content}else s=_o.decodeText(new Uint8Array(e));const l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new sie(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](c);a[h.name]=h,o[h.name]=!0}if(l.extensionsUsed)for(let u=0;u<l.extensionsUsed.length;++u){const h=l.extensionsUsed[u],d=l.extensionsRequired||[];switch(h){case rn.KHR_MATERIALS_UNLIT:o[h]=new Fne;break;case rn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[h]=new Yne;break;case rn.KHR_DRACO_MESH_COMPRESSION:o[h]=new qne(l,this.dracoLoader);break;case rn.KHR_TEXTURE_TRANSFORM:o[h]=new Zne;break;case rn.KHR_MESH_QUANTIZATION:o[h]=new Kne;break;default:d.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function Ine(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const rn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class Lne{constructor(e){this.parser=e,this.name=rn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new Ce(16777215);void 0!==l.color&&u.fromArray(l.color);const h=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new xv(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new bv(u),c.distance=h;break;case"spot":c=new tT(u),c.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class Fne{constructor(){this.name=rn.KHR_MATERIALS_UNLIT}getMaterialType(){return nr}extendParams(e,t,i){const r=[];e.color=new Ce(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,mn))}return Promise.all(r)}}class kne{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class One{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new te(a,a)}return Promise.all(s)}}class Nne{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Bne{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ce(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,mn)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class jne{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Une{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ce(a[0],a[1],a[2]),Promise.all(s)}}class Vne{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class zne{constructor(e){this.parser=e,this.name=rn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ea:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Ce(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,mn)),Promise.all(s)}}class Hne{constructor(e){this.parser=e,this.name=rn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Gne{constructor(e){this.parser=e,this.name=rn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Wne{constructor(e){this.name=rn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,d=new ArrayBuffer(u*h),f=new Uint8Array(a[0],l,c);return o.decodeGltfBuffer(new Uint8Array(d),u,h,f,r.mode,r.filter),d})}return null}}const TN="glTF";class Xne{constructor(e){this.name=rn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:_o.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==TN)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<i;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,1313821514===a){const l=new Uint8Array(e,12+s,o);this.content=_o.decodeText(l)}else if(5130562===a){const l=12+s;this.body=e.slice(l,l+o)}s+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class qne{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=rn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const h=xT[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=xT[u]||u.toLowerCase();if(void 0!==o[u]){const d=i.accessors[e.attributes[u]];c[h]=Sp[d.componentType],l[h]=!0===d.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h){r.decodeDracoFile(u,function(d){for(const f in d.attributes){const p=d.attributes[f],m=l[f];void 0!==m&&(p.normalized=m)}h(d)},a,c)})})}}class Zne{constructor(){this.name=rn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class yT extends mo{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),i=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new Ce).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(l){for(const c in a)l.uniforms[c]=a[c];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(l){a.specular.value=l}},specularMap:{get:function(){return a.specularMap.value},set:function(l){a.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(l){a.glossiness.value=l}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(l){a.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Yne{constructor(){this.name=rn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return yT}extendParams(e,t,i){const r=t.extensions[this.name];e.color=new Ce(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==r.diffuseTexture&&s.push(i.assignTexture(e,"map",r.diffuseTexture,mn)),e.emissive=new Ce(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new Ce(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const o=r.specularGlossinessTexture;s.push(i.assignTexture(e,"glossinessMap",o)),s.push(i.assignTexture(e,"specularMap",o,mn))}return Promise.all(s)}createMaterial(e){const t=new yT(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=void 0===e.emissiveIntensity?1:e.emissiveIntensity,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=al,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t}}class Kne{constructor(){this.name=rn.KHR_MESH_QUANTIZATION}}class bT extends zh{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}}bT.prototype.interpolate_=function(n,e,t,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=i-e,u=(t-e)/c,h=u*u,d=h*u,f=n*l,p=f-l,m=-2*d+3*h,g=d-h,_=1-m,v=g-h+u;for(let y=0;y!==o;y++)r[y]=_*s[p+y+o]+v*(s[p+y+a]*c)+m*s[f+y+o]+g*(s[f+y]*c);return r};const Qne=new bn;class $ne extends bT{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Qne.fromArray(s).normalize().toArray(s),s}}const Sp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},EN={9728:xi,9729:si,9984:Uf,9985:m_,9986:Vf,9987:va},DN={33071:dr,33648:sh,10497:tl},AN={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},xT={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},wl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Jne={CUBICSPLINE:void 0,LINEAR:_c,STEP:oh};function Tp(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Hc(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function nie(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function iie(n){const e=n.extensions&&n.extensions[rn.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+RN(e.attributes):n.indices+":"+RN(n.attributes)+":"+n.mode,t}function RN(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function MT(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class sie{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Ine,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new NO(this.options.manager):new YO(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Es(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Tp(s,a,r),Hc(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[rn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(_o.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=AN[r.type],c=Sp[r.componentType],u=c.BYTES_PER_ELEMENT,d=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let m,g;if(f&&f!==u*l){const _=Math.floor(d/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+_+":"+r.count;let y=t.cache.get(v);y||(m=new c(a,_*f,r.count*f/u),y=new tp(m,f/u),t.cache.add(v,y)),g=new gl(y,l,d%f/u,p)}else m=null===a?new c(r.count*l):new c(a,d,r.count*l),g=new En(m,l,p);if(void 0!==r.sparse){const b=r.sparse.values.byteOffset||0,w=new(0,Sp[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*AN.SCALAR),M=new c(o[2],b,r.sparse.count*l);null!==a&&(g=new En(g.array.slice(),g.itemSize,g.normalized));for(let T=0,x=w.length;T<x;T++){const E=w[T];if(g.setX(E,M[T*l]),l>=2&&g.setY(E,M[T*l+1]),l>=3&&g.setZ(E,M[T*l+2]),l>=4&&g.setW(E,M[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,o.name&&(u.name=o.name);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=EN[d.magFilter]||si,u.minFilter=EN[d.minFilter]||va,u.wrapS=DN[d.wrapS]||tl,u.wrapT=DN[d.wrapT]||tl,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(h){return new Promise(function(d,f){let p=d;!0===t.isImageBitmapLoader&&(p=function(m){const g=new fr(m);g.needsUpdate=!0,d(g)}),t.load(_o.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return!0===c&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||function rie(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(void 0!==i.texCoord&&0!=i.texCoord&&!("aoMap"===t&&1==i.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),s.extensions[rn.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[rn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[rn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new cv,mi.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Pi,mi.prototype.copy.call(l,i),l.color.copy(i.color),this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return mo}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[rn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const h=r[rn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else if(l[rn.KHR_MATERIALS_UNLIT]){const h=r[rn.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new Ce(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}void 0!==h.baseColorTexture&&c.push(t.assignTexture(a,"map",h.baseColorTexture,mn)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=io);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==nr&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new te(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}return void 0!==s.occlusionTexture&&o!==nr&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==nr&&(a.emissive=(new Ce).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==nr&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,mn)),Promise.all(c).then(function(){let h;return h=o===yT?r[rn.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),s.name&&(h.name=s.name),Hc(h,s),t.associations.set(h,{materials:e}),s.extensions&&Tp(r,h,s),h})}createUniqueName(e){const t=Bn.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[rn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return IN(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=iie(c),h=r[u];if(h)o.push(h.promise);else{let d;d=c.extensions&&c.extensions[rn.KHR_DRACO_MESH_COMPRESSION]?s(c):IN(new wt,c,t),r[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new mo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:$a})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let f=0,p=u.length;f<p;f++){const m=u[f],g=o[f];let _;const v=c[f];if(4===g.mode||5===g.mode||6===g.mode||void 0===g.mode)_=!0===s.isSkinnedMesh?new RS(m,v):new qe(m,v),!0===_.isSkinnedMesh&&!_.geometry.attributes.skinWeight.normalized&&_.normalizeSkinWeights(),5===g.mode?_.geometry=LN(_.geometry,WF):6===g.mode&&(_.geometry=LN(_.geometry,HM));else if(1===g.mode)_=new Cs(m,v);else if(3===g.mode)_=new Mi(m,v);else if(2===g.mode)_=new LS(m,v);else{if(0!==g.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);_=new kS(m,v)}Object.keys(_.geometry.morphAttributes).length>0&&nie(_,s),_.name=t.createUniqueName(s.name||"mesh_"+e),Hc(_,s),g.extensions&&Tp(r,_,g),t.assignFinalMaterial(_),h.push(_)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(1===h.length)return h[0];const d=new Wo;t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new zi(Ot.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Cc(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Hc(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return i.inverseBindMatrices=r,i})}loadAnimation(e){const i=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=i.channels.length;c<u;c++){const h=i.channels[c],d=i.samplers[h.sampler],f=h.target,m=void 0!==i.parameters?i.parameters[d.input]:d.input,g=void 0!==i.parameters?i.parameters[d.output]:d.output;r.push(this.getDependency("node",void 0!==f.node?f.node:f.id)),s.push(this.getDependency("accessor",m)),o.push(this.getDependency("accessor",g)),a.push(d),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],d=c[2],f=c[3],p=c[4],m=[];for(let _=0,v=u.length;_<v;_++){const y=u[_],b=h[_],w=d[_],M=f[_],T=p[_];if(void 0===y)continue;let x;switch(y.updateMatrix(),y.matrixAutoUpdate=!0,wl[T.path]){case wl.weights:x=Hh;break;case wl.rotation:x=yl;break;default:x=Gh}const E=y.name?y.name:y.uuid,R=void 0!==M.interpolation?Jne[M.interpolation]:_c,F=[];wl[T.path]===wl.weights?y.traverse(function(H){H.morphTargetInfluences&&F.push(H.name?H.name:H.uuid)}):F.push(E);let V=w.array;if(w.normalized){const H=MT(V.constructor),j=new Float32Array(V.length);for(let q=0,I=V.length;q<I;q++)j[q]=V[q]*H;V=j}for(let H=0,j=F.length;H<j;H++){const q=new x(F[H]+"."+wl[T.path],b.array,V,R);"CUBICSPLINE"===M.interpolation&&(q.createInterpolant=function(U){return new(this instanceof yl?$ne:bT)(this.times,this.values,this.getValueSize()/3,U)},q.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(q)}}return new Wh(i.name?i.name:"animation_"+e,void 0,m)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),Promise.all(a)}().then(function(a){let l;if(l=!0===s.isBone?new ov:a.length>1?new Wo:1===a.length?a[0]:new nn,l!==a[0])for(let c=0,u=a.length;c<u;c++)l.add(a[c]);if(s.name&&(l.userData.name=s.name,l.name=o),Hc(l,s),s.extensions&&Tp(i,l,s),void 0!==s.matrix){const c=new ot;c.fromArray(s.matrix),l.applyMatrix4(c)}else void 0!==s.translation&&l.position.fromArray(s.translation),void 0!==s.rotation&&l.quaternion.fromArray(s.rotation),void 0!==s.scale&&l.scale.fromArray(s.scale);return r.associations.has(l)||r.associations.set(l,{}),r.associations.get(l).nodes=e,l})}loadScene(e){const t=this.json,i=this.extensions,r=this.json.scenes[e],s=this,o=new Wo;r.name&&(o.name=s.createUniqueName(r.name)),Hc(o,r),r.extensions&&Tp(i,o,r);const a=r.nodes||[],l=[];for(let c=0,u=a.length;c<u;c++)l.push(PN(a[c],o,t,s));return Promise.all(l).then(function(){return s.associations=(u=>{const h=new Map;for(const[d,f]of s.associations)(d instanceof mi||d instanceof fr)&&h.set(d,f);return u.traverse(d=>{const f=s.associations.get(d);null!=f&&h.set(d,f)}),h})(o),o})}}function PN(n,e,t,i){const r=t.nodes[n];return i.getDependency("node",n).then(function(s){if(void 0===r.skin)return s;let o;return i.getDependency("skin",r.skin).then(function(a){o=a;const l=[];for(let c=0,u=o.joints.length;c<u;c++)l.push(i.getDependency("node",o.joints[c]));return Promise.all(l)}).then(function(a){return s.traverse(function(l){if(!l.isMesh)return;const c=[],u=[];for(let h=0,d=a.length;h<d;h++){const f=a[h];if(f){c.push(f);const p=new ot;void 0!==o.inverseBindMatrices&&p.fromArray(o.inverseBindMatrices.array,16*h),u.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[h])}l.bind(new sp(c,u),l.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let l=0,c=a.length;l<c;l++)o.push(PN(a[l],s,t,i))}return Promise.all(o)})}function IN(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=xT[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Hc(n,e),function oie(n,e,t){const i=e.attributes,r=new zo;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new C(l[0],l[1],l[2]),new C(c[0],c[1],c[2])),a.normalized){const u=MT(Sp[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new C,l=new C;for(let c=0,u=s.length;c<u;c++){const h=s[c];if(void 0!==h.POSITION){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(void 0!==f&&void 0!==p){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const m=MT(Sp[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new ba;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function tie(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const h=e[c];if(void 0!==h.POSITION&&(i=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];if(i){const d=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(d)}if(r){const d=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(d)}if(s){const d=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[1],d=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}function LN(n,e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(e===HM)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s}let FN=(()=>{class n{load(...t){return(new this.clazz).loadAsync(...t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),kN=(()=>{class n{constructor(t,i){this.host=t,this.zone=i,this.initialized=!1,this.animationLoop=Zl(bp),this.proxy=function Sne(){return new Proxy(new nn,new Mne)}(),t.objRef=this.proxy}set url(t){this._url=t,console.log("got some model"),this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new yt),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new yt),this.onProgress$}ngOnInit(){this.initialized=!0,this.load()}load(){var t=this;return no(function*(){if(!t.initialized)return;if(void 0===t._url)throw new Error("missing url");if(!t.proxy)return;const i=t._url,r=fT(t.onProgress$)?o=>{t.zone.run(()=>{t.onProgress$?.next(o)})}:void 0,s=yield t.zone.runOutsideAngular(()=>t.service.load(i,r));t.animationLoop.requestAnimationFrame(),t.proxy.objRef=t.getRefFromResponse(s),t.host.objRef=t.proxy,t.onLoaded$&&void 0!==s&&t.zone.run(()=>t.onLoaded$?.next(s))})()}}return n.\u0275fac=function(t){ig()},n.\u0275dir=tt({type:n,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}}),n})(),aie=(()=>{class n extends FN{constructor(){super(...arguments),this.clazz=Pne}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Qh=(()=>{class n extends kN{constructor(t,i,r){super(t,i),this.host=t,this.zone=i,this.service=r}getRefFromResponse(t){return t.scene}}return n.\u0275fac=function(t){return new(t||n)(N(an,1),N(Pt),N(aie))},n.\u0275dir=tt({type:n,selectors:[["","loadGLTF",""]],features:[Se]}),n})(),ON=(()=>{class n{constructor(t,i){this.engineService=t,this.animationLoopService=i}get beforeRender(){return this.engineService.beforeRender$}get onResize(){return this.engineService.resize$}set renderOnDemand(t){t?this.animationLoopService.stop():this.animationLoopService.start()}get renderOnDemand(){return!this.animationLoopService.isActive()}}return n.\u0275fac=function(t){return new(t||n)(N(zc),N(bp))},n.\u0275dir=tt({type:n,selectors:[["","beforeRender",""],["","onResize",""],["","renderOnDemand",""]],inputs:{renderOnDemand:"renderOnDemand"},outputs:{beforeRender:"beforeRender",onResize:"onResize"}}),n})(),lie=(()=>{class n{constructor(){this.assetPath=Ra+"RobotExpressive.glb",this.states=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],this.emotes=["Jump","Yes","No","Wave","Punch","ThumbsUp"],this.actions={}}onInit(t){this.animationMixer=new iN(t.scene),t.scene.traverse(i=>{i.isMesh&&(i.castShadow=!0,i.receiveShadow=!0)});for(const i of t.animations){const r=this.animationMixer.clipAction(i);this.actions[i.name]=r,(this.emotes.indexOf(i.name)>=0||this.states.indexOf(i.name)>=4)&&(r.clampWhenFinished=!0,r.loop=VM)}this.activeAction=this.actions.Walking,this.activeAction.play()}beforeRender(t){this.animationMixer&&this.animationMixer.update(t.delta)}fadeToAction(t,i){this.previousAction=this.activeAction,this.activeAction=this.actions[t],this.previousAction&&this.previousAction!==this.activeAction&&this.previousAction.fadeOut(i),this.activeAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(i).play()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-robot"]],decls:1,vars:2,consts:[["loadGLTF","",3,"url","castShadow","onLoaded","beforeRender"]],template:function(t,i){1&t&&(pe(0,"th-mesh",0),gt("onLoaded",function(s){return i.onInit(s)})("beforeRender",function(s){return i.beforeRender(s)}),Te()),2&t&&Q("url",i.assetPath)("castShadow",!0)},dependencies:[Ds,Qh,ON],encapsulation:2,changeDetection:0}),n})(),NN=(()=>{class n{transform(t){return new ep(...t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=Qi({name:"fog",type:n,pure:!0}),n})();const cie=["gridHelper"],uie=function(n){return{outputEncoding:n}},hie=function(){return["#e0e0e0"]},die=function(){return["#e0e0e0",20,100]},fie=function(){return[45,2,.25,100]},pie=function(n){return[n,5,10]},mie=function(){return[0,2,0]},gie=function(){return["#ffffff","#444444"]},_ie=function(){return[0,20,0]},vie=function(){return["#ffffff"]},yie=function(){return[0,20,10]},bie=function(n){return[n,0,0]},xie=function(){return[2e3,2e3]},wie=function(){return{color:"#999999",depthWrite:!1}},Mie=function(){return[200,40,"#000000","#000000"]};let Sie=(()=>{class n{constructor(){this.Math=Math,this.outputEncoding=mn}ngAfterViewInit(){const t=this.gridHelper?.objRef?.material;t&&(t.opacity=.2,t.transparent=!0)}onBeforeRender(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-animation-example"]],viewQuery:function(t,i){if(1&t&&Pn(cie,7),2&t){let r;Et(r=Dt())&&(i.gridHelper=r.first)}},decls:12,vars:38,consts:[[3,"rendererParameters","thStats","shadow","onRender"],[3,"background","fog"],[3,"args","position","lookAt"],[3,"args","position"],[3,"args","position","castShadow"],[3,"rotation","receiveShadow"],[3,"args"],[3,"args","receiveShadow"],["gridHelper",""]],template:function(t,i){1&t&&(pe(0,"th-canvas",0),gt("onRender",function(){return i.onBeforeRender()}),pe(1,"th-scene",1),_s(2,"fog"),Ye(3,"th-perspectiveCamera",2)(4,"th-hemisphereLight",3)(5,"th-directionalLight",4),pe(6,"th-mesh",5),Ye(7,"th-planeGeometry",6)(8,"th-meshPhongMaterial",6),Te(),Ye(9,"th-gridHelper",7,8)(11,"app-robot"),Te()()),2&t&&(Q("rendererParameters",Tn(21,uie,i.outputEncoding))("thStats",!0)("shadow",!0),se(1),Q("background",Ee(23,hie))("fog",vs(2,19,Ee(24,die))),se(2),Q("args",Ee(25,fie))("position",Tn(26,pie,-5))("lookAt",Ee(28,mie)),se(1),Q("args",Ee(29,gie))("position",Ee(30,_ie)),se(1),Q("args",Ee(31,vie))("position",Ee(32,yie))("castShadow",!0),se(1),Q("rotation",Tn(33,bie,-.5*i.Math.PI))("receiveShadow",!0),se(1),Q("args",Ee(35,xie)),se(1),Q("args",Ee(36,wie)),se(1),Q("args",Ee(37,Mie))("receiveShadow",!0))},dependencies:[Ir,Vc,_T,vp,Ds,mr,Yh,vT,ir,wp,lie,NN],encapsulation:2,changeDetection:0}),n})(),qo=(()=>{class n extends _p{getType(){return iT}set type(t){this._objRef&&(this._objRef.type=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-ambientLight"]],inputs:{type:"type"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),BN=(()=>{class n extends Zh{getType(){return nr}set type(t){this._objRef&&(this._objRef.type=t)}set color(t){this._objRef&&(this._objRef.color=Lt(this._objRef.color,t))}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set specularMap(t){this._objRef&&(this._objRef.specularMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set combine(t){this._objRef&&(this._objRef.combine=t)}set reflectivity(t){this._objRef&&(this._objRef.reflectivity=t)}set refractionRatio(t){this._objRef&&(this._objRef.refractionRatio=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-meshBasicMaterial"]],inputs:{type:"type",color:"color",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[Xe([{provide:Zh,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),ST=(()=>{class n extends bo{getType(){return Xn}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-boxGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:bo,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Tie=function(){return{color:"purple"}},Cie=function(){return[75,2,.1,1e3]},Eie=function(){return[1,1,5]};let Die=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-basic-example"]],decls:7,vars:6,consts:[[3,"args"],[3,"args","position"]],template:function(t,i){1&t&&(pe(0,"th-canvas")(1,"th-scene")(2,"th-mesh"),Ye(3,"th-boxGeometry")(4,"th-meshBasicMaterial",0),Te(),Ye(5,"th-ambientLight")(6,"th-perspectiveCamera",1),Te()()),2&t&&(se(4),Q("args",Ee(3,Tie)),se(2),Q("args",Ee(4,Cie))("position",Ee(5,Eie)))},dependencies:[Ir,qo,Ds,mr,BN,ST,ir],encapsulation:2,changeDetection:0}),n})();const jN={type:"change"},TT={type:"start"},UN={type:"end"};class VN extends rs{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new C,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ws.ROTATE,MIDDLE:ws.DOLLY,RIGHT:ws.PAN},this.touches={ONE:_a.ROTATE,TWO:_a.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(L){L.addEventListener("keydown",Wt),this._domElementKeyEvents=L},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(jN),i.update(),s=r.NONE},this.update=function(){const L=new C,le=(new bn).setFromUnitVectors(e.up,new C(0,1,0)),Ne=le.clone().invert(),Ve=new C,G=new bn,De=2*Math.PI;return function(){const _t=i.object.position;L.copy(_t).sub(i.target),L.applyQuaternion(le),a.setFromVector3(L),i.autoRotate&&s===r.NONE&&E(function T(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Fe=i.minAzimuthAngle,Ke=i.maxAzimuthAngle;return isFinite(Fe)&&isFinite(Ke)&&(Fe<-Math.PI?Fe+=De:Fe>Math.PI&&(Fe-=De),Ke<-Math.PI?Ke+=De:Ke>Math.PI&&(Ke-=De),a.theta=Fe<=Ke?Math.max(Fe,Math.min(Ke,a.theta)):a.theta>(Fe+Ke)/2?Math.max(Fe,a.theta):Math.min(Ke,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),L.setFromSpherical(a),L.applyQuaternion(Ne),_t.copy(i.target).add(L),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(h||Ve.distanceToSquared(i.object.position)>o||8*(1-G.dot(i.object.quaternion))>o)&&(i.dispatchEvent(jN),Ve.copy(i.object.position),G.copy(i.object.quaternion),h=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",ae),i.domElement.removeEventListener("pointerdown",Me),i.domElement.removeEventListener("pointercancel",bt),i.domElement.removeEventListener("wheel",Jt),i.domElement.removeEventListener("pointermove",Je),i.domElement.removeEventListener("pointerup",Ge),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",Wt)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new Tv,l=new Tv;let c=1;const u=new C;let h=!1;const d=new te,f=new te,p=new te,m=new te,g=new te,_=new te,v=new te,y=new te,b=new te,w=[],M={};function x(){return Math.pow(.95,i.zoomSpeed)}function E(L){l.theta-=L}function R(L){l.phi-=L}const F=function(){const L=new C;return function(Ne,Ve){L.setFromMatrixColumn(Ve,0),L.multiplyScalar(-Ne),u.add(L)}}(),V=function(){const L=new C;return function(Ne,Ve){!0===i.screenSpacePanning?L.setFromMatrixColumn(Ve,1):(L.setFromMatrixColumn(Ve,0),L.crossVectors(i.object.up,L)),L.multiplyScalar(Ne),u.add(L)}}(),H=function(){const L=new C;return function(Ne,Ve){const G=i.domElement;if(i.object.isPerspectiveCamera){L.copy(i.object.position).sub(i.target);let je=L.length();je*=Math.tan(i.object.fov/2*Math.PI/180),F(2*Ne*je/G.clientHeight,i.object.matrix),V(2*Ve*je/G.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(F(Ne*(i.object.right-i.object.left)/i.object.zoom/G.clientWidth,i.object.matrix),V(Ve*(i.object.top-i.object.bottom)/i.object.zoom/G.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function j(L){i.object.isPerspectiveCamera?c/=L:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*L)),i.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function q(L){i.object.isPerspectiveCamera?c*=L:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/L)),i.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function I(L){d.set(L.clientX,L.clientY)}function W(L){m.set(L.clientX,L.clientY)}function he(){1===w.length?d.set(w[0].pageX,w[0].pageY):d.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function Ae(){1===w.length?m.set(w[0].pageX,w[0].pageY):m.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function J(){const L=w[0].pageX-w[1].pageX,le=w[0].pageY-w[1].pageY,Ne=Math.sqrt(L*L+le*le);v.set(0,Ne)}function Le(L){if(1==w.length)f.set(L.pageX,L.pageY);else{const Ne=ht(L);f.set(.5*(L.pageX+Ne.x),.5*(L.pageY+Ne.y))}p.subVectors(f,d).multiplyScalar(i.rotateSpeed);const le=i.domElement;E(2*Math.PI*p.x/le.clientHeight),R(2*Math.PI*p.y/le.clientHeight),d.copy(f)}function _e(L){if(1===w.length)g.set(L.pageX,L.pageY);else{const le=ht(L);g.set(.5*(L.pageX+le.x),.5*(L.pageY+le.y))}_.subVectors(g,m).multiplyScalar(i.panSpeed),H(_.x,_.y),m.copy(g)}function st(L){const le=ht(L),Ne=L.pageX-le.x,Ve=L.pageY-le.y,G=Math.sqrt(Ne*Ne+Ve*Ve);y.set(0,G),b.set(0,Math.pow(y.y/v.y,i.zoomSpeed)),j(b.y),v.copy(y)}function Me(L){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(L.pointerId),i.domElement.addEventListener("pointermove",Je),i.domElement.addEventListener("pointerup",Ge)),function xe(L){w.push(L)}(L),"touch"===L.pointerType?function B(L){switch(Ue(L),w.length){case 1:switch(i.touches.ONE){case _a.ROTATE:if(!1===i.enableRotate)return;he(),s=r.TOUCH_ROTATE;break;case _a.PAN:if(!1===i.enablePan)return;Ae(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case _a.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function X(){i.enableZoom&&J(),i.enablePan&&Ae()})(),s=r.TOUCH_DOLLY_PAN;break;case _a.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function de(){i.enableZoom&&J(),i.enableRotate&&he()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(TT)}(L):function mt(L){let le;switch(L.button){case 0:le=i.mouseButtons.LEFT;break;case 1:le=i.mouseButtons.MIDDLE;break;case 2:le=i.mouseButtons.RIGHT;break;default:le=-1}switch(le){case ws.DOLLY:if(!1===i.enableZoom)return;(function U(L){v.set(L.clientX,L.clientY)})(L),s=r.DOLLY;break;case ws.ROTATE:if(L.ctrlKey||L.metaKey||L.shiftKey){if(!1===i.enablePan)return;W(L),s=r.PAN}else{if(!1===i.enableRotate)return;I(L),s=r.ROTATE}break;case ws.PAN:if(L.ctrlKey||L.metaKey||L.shiftKey){if(!1===i.enableRotate)return;I(L),s=r.ROTATE}else{if(!1===i.enablePan)return;W(L),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(TT)}(L))}function Je(L){!1!==i.enabled&&("touch"===L.pointerType?function P(L){switch(Ue(L),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Le(L),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;_e(L),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function ue(L){i.enableZoom&&st(L),i.enablePan&&_e(L)})(L),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function fe(L){i.enableZoom&&st(L),i.enableRotate&&Le(L)})(L),i.update();break;default:s=r.NONE}}(L):function dt(L){if(!1!==i.enabled)switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function z(L){f.set(L.clientX,L.clientY),p.subVectors(f,d).multiplyScalar(i.rotateSpeed);const le=i.domElement;E(2*Math.PI*p.x/le.clientHeight),R(2*Math.PI*p.y/le.clientHeight),d.copy(f),i.update()}(L);break;case r.DOLLY:if(!1===i.enableZoom)return;!function Y(L){y.set(L.clientX,L.clientY),b.subVectors(y,v),b.y>0?j(x()):b.y<0&&q(x()),v.copy(y),i.update()}(L);break;case r.PAN:if(!1===i.enablePan)return;!function oe(L){g.set(L.clientX,L.clientY),_.subVectors(g,m).multiplyScalar(i.panSpeed),H(_.x,_.y),m.copy(g),i.update()}(L)}}(L))}function Ge(L){Pe(L),0===w.length&&(i.domElement.releasePointerCapture(L.pointerId),i.domElement.removeEventListener("pointermove",Je),i.domElement.removeEventListener("pointerup",Ge)),i.dispatchEvent(UN),s=r.NONE}function bt(L){Pe(L)}function Jt(L){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(L.preventDefault(),i.dispatchEvent(TT),function $(L){L.deltaY<0?q(x()):L.deltaY>0&&j(x()),i.update()}(L),i.dispatchEvent(UN))}function Wt(L){!1===i.enabled||!1===i.enablePan||function me(L){let le=!1;switch(L.code){case i.keys.UP:H(0,i.keyPanSpeed),le=!0;break;case i.keys.BOTTOM:H(0,-i.keyPanSpeed),le=!0;break;case i.keys.LEFT:H(i.keyPanSpeed,0),le=!0;break;case i.keys.RIGHT:H(-i.keyPanSpeed,0),le=!0}le&&(L.preventDefault(),i.update())}(L)}function ae(L){!1!==i.enabled&&L.preventDefault()}function Pe(L){delete M[L.pointerId];for(let le=0;le<w.length;le++)if(w[le].pointerId==L.pointerId)return void w.splice(le,1)}function Ue(L){let le=M[L.pointerId];void 0===le&&(le=new te,M[L.pointerId]=le),le.set(L.pageX,L.pageY)}function ht(L){return M[(L.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}i.domElement.addEventListener("contextmenu",ae),i.domElement.addEventListener("pointerdown",Me),i.domElement.addEventListener("pointercancel",bt),i.domElement.addEventListener("wheel",Jt,{passive:!1}),this.update()}}class Aie extends VN{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=ws.PAN,this.mouseButtons.RIGHT=ws.ROTATE,this.touches.ONE=_a.PAN,this.touches.TWO=_a.DOLLY_ROTATE}}let gr=(()=>{class n extends qh{constructor(t,i){super(),this._camera=t,this.canvas=i,this.renderLoop=Zl(bp)}createThreeInstance(t){t||(t=[this._camera.objRef,this.canvas?.rendererCanvas?.nativeElement]);const i=super.createThreeInstance(t);return this.patchDispatchEvent(i),this.subscribeControlUpdater(i),i}patchDispatchEvent(t){if(t.dispatchEvent){const i=this.origDispatchEventMethod=t.dispatchEvent;t.dispatchEvent=r=>{i.apply(t,r),this.renderLoop.requestAnimationFrame()}}}ngOnDestroy(){super.ngOnDestroy(),this.unpatchDispatchEvent(),this.unsubscribeControlUpdater()}unpatchDispatchEvent(){this.origDispatchEventMethod&&this._objRef&&(this._objRef.dispatchEvent=this.origDispatchEventMethod)}subscribeControlUpdater(t){void 0!==t.update&&(this.beforeRenderSubscription=this.renderLoop.beforeRender$.subscribe(i=>{t.update(i.delta)}))}unsubscribeControlUpdater(){this.beforeRenderSubscription&&this.beforeRenderSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(N(an),N(ir))},n.\u0275cmp=Re({type:n,selectors:[["th-abs-control"]],features:[Se],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})(),Cp=(()=>{class n extends gr{getType(){return VN}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set target(t){this._objRef&&(this._objRef.target=Lt(this._objRef.target,t))}set center(t){this._objRef&&(this._objRef.center=Lt(this._objRef.center,t))}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set minZoom(t){this._objRef&&(this._objRef.minZoom=t)}set maxZoom(t){this._objRef&&(this._objRef.maxZoom=t)}set minPolarAngle(t){this._objRef&&(this._objRef.minPolarAngle=t)}set maxPolarAngle(t){this._objRef&&(this._objRef.maxPolarAngle=t)}set minAzimuthAngle(t){this._objRef&&(this._objRef.minAzimuthAngle=t)}set maxAzimuthAngle(t){this._objRef&&(this._objRef.maxAzimuthAngle=t)}set enableDamping(t){this._objRef&&(this._objRef.enableDamping=t)}set dampingFactor(t){this._objRef&&(this._objRef.dampingFactor=t)}set enableZoom(t){this._objRef&&(this._objRef.enableZoom=t)}set zoomSpeed(t){this._objRef&&(this._objRef.zoomSpeed=t)}set enableRotate(t){this._objRef&&(this._objRef.enableRotate=t)}set rotateSpeed(t){this._objRef&&(this._objRef.rotateSpeed=t)}set enablePan(t){this._objRef&&(this._objRef.enablePan=t)}set panSpeed(t){this._objRef&&(this._objRef.panSpeed=t)}set screenSpacePanning(t){this._objRef&&(this._objRef.screenSpacePanning=t)}set keyPanSpeed(t){this._objRef&&(this._objRef.keyPanSpeed=t)}set autoRotate(t){this._objRef&&(this._objRef.autoRotate=t)}set autoRotateSpeed(t){this._objRef&&(this._objRef.autoRotateSpeed=t)}set keys(t){this._objRef&&(this._objRef.keys=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}set touches(t){this._objRef&&(this._objRef.touches=t)}set target0(t){this._objRef&&(this._objRef.target0=Lt(this._objRef.target0,t))}set position0(t){this._objRef&&(this._objRef.position0=Lt(this._objRef.position0,t))}set zoomO(t){this._objRef&&(this._objRef.zoomO=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-orbitControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",target:"target",center:"center",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",minAzimuthAngle:"minAzimuthAngle",maxAzimuthAngle:"maxAzimuthAngle",enableDamping:"enableDamping",dampingFactor:"dampingFactor",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",enableRotate:"enableRotate",rotateSpeed:"rotateSpeed",enablePan:"enablePan",panSpeed:"panSpeed",screenSpacePanning:"screenSpacePanning",keyPanSpeed:"keyPanSpeed",autoRotate:"autoRotate",autoRotateSpeed:"autoRotateSpeed",keys:"keys",mouseButtons:"mouseButtons",touches:"touches",target0:"target0",position0:"position0",zoomO:"zoomO"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Gc=(()=>{class n extends _p{getType(){return bv}set type(t){this._objRef&&(this._objRef.type=t)}set intensity(t){this._objRef&&(this._objRef.intensity=t)}set distance(t){this._objRef&&(this._objRef.distance=t)}set decay(t){this._objRef&&(this._objRef.decay=t)}set shadow(t){this._objRef&&(this._objRef.shadow=t)}set power(t){this._objRef&&(this._objRef.power=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-pointLight"]],inputs:{type:"type",intensity:"intensity",distance:"distance",decay:"decay",shadow:"shadow",power:"power"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Iv=(()=>{class n{constructor(t,i){this.host=t,this.raycasterService=i,this.mouseEnter=new yt,this.mouseExit=new yt,this.click=new yt,this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseExit=this.onMouseExit.bind(this),this.onClick=this.onClick.bind(this)}ngAfterViewInit(){this.subscribeEvents()}subscribeEvents(){this.raycasterService.addEventTarget(this)}unSubscribeEvents(){this.raycasterService.removeEventTarget(this)}onMouseExit(){this.mouseExit.emit({component:this.host})}onMouseEnter(t){this.mouseEnter.emit({component:this.host,face:t.face})}onClick(t){this.click.emit({component:this.host,face:t.face})}ngOnDestroy(){this.unSubscribeEvents()}}return n.\u0275fac=function(t){return new(t||n)(N(an,1),N(yp))},n.\u0275dir=tt({type:n,selectors:[["","onClick",""],["","onMouseEnter",""],["","onMouseExit",""]],outputs:{mouseEnter:"onMouseEnter",mouseExit:"onMouseExit",click:"onClick"}}),n})();const Rie=function(){return[2,2,2]},Pie=function(){return[1,1,1]},Iie=function(){return[10,10]},zN=function(){return[10,10,10]},Lie=function(){return[45,2,.1,100]},Fie=function(){return[0,0,0]};let kie=(()=>{class n{constructor(){this.selected=!1,this.glbPath=`${Ra}DamagedHelmet.glb`}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-controls-example"]],decls:8,vars:15,consts:[[3,"thStats"],["loadGLTF","",3,"url","scale","onClick"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,i){1&t&&(pe(0,"th-canvas",0)(1,"th-scene"),Ye(2,"th-ambientLight"),pe(3,"th-object3D",1),gt("onClick",function(){return i.selected=!i.selected}),Te(),Ye(4,"th-gridHelper",2)(5,"th-pointLight",3),pe(6,"th-perspectiveCamera",4),Ye(7,"th-orbitControls"),Te()()()),2&t&&(Q("thStats",!0),se(3),Q("url",i.glbPath)("scale",i.selected?Ee(8,Rie):Ee(9,Pie)),se(1),Q("args",Ee(10,Iie)),se(1),Q("position",Ee(11,zN)),se(1),Q("args",Ee(12,Lie))("position",Ee(13,zN))("lookAt",Ee(14,Fie)))},dependencies:[Cp,Ir,an,Vc,Gc,qo,mr,ir,Qh,Iv,wp],encapsulation:2,changeDetection:0}),n})();const Oie=function(){return[0,1,0]},Nie=function(){return[10,10]},HN=function(){return[10,10,10]},Bie=function(){return[45,2,.1,100]},jie=function(){return[0,0,0]};let Uie=(()=>{class n{constructor(t){this.cdref=t,this.modelScale=[1,1,1],this.rotation=[0,0,0],this.modelUrl1=`${Ra}DamagedHelmet.glb`,this.modelUrl2=`${Ra}BoomBox.glb`,this.modelUrl=this.toggleModel(),this.intervalHandle=window.setInterval(()=>this.toggleModel(),3e3)}toggleModel(){return this.modelUrl=this.modelUrl!==this.modelUrl1?this.modelUrl1:this.modelUrl2,this.cdref.markForCheck(),this.modelUrl}onLoaded(){this.modelScale=this.modelUrl!==this.modelUrl1?[100,100,100]:[1,1,1]}onRefChange(t){}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}ngOnDestroy(){window.clearInterval(this.intervalHandle)}}return n.\u0275fac=function(t){return new(t||n)(N(Ei))},n.\u0275cmp=Re({type:n,selectors:[["app-dynamic-loader-example"]],decls:7,vars:15,consts:[[3,"onRender"],["loadGLTF","",3,"url","scale","rotation","position","onLoaded","objRef$"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,i){1&t&&(pe(0,"th-canvas",0),gt("onRender",function(){return i.onBeforeRender()}),pe(1,"th-scene"),Ye(2,"th-ambientLight"),pe(3,"th-object3D",1),gt("onLoaded",function(){return i.onLoaded()})("objRef$",function(s){return i.onRefChange(s)}),Te(),Ye(4,"th-gridHelper",2)(5,"th-pointLight",3)(6,"th-perspectiveCamera",4),Te()()),2&t&&(se(3),Q("url",i.modelUrl)("scale",i.modelScale)("rotation",i.rotation)("position",Ee(9,Oie)),se(1),Q("args",Ee(10,Nie)),se(1),Q("position",Ee(11,HN)),se(1),Q("args",Ee(12,Bie))("position",Ee(13,HN))("lookAt",Ee(14,jie)))},dependencies:[Ir,an,Vc,Gc,qo,mr,ir,Qh],encapsulation:2}),n})();function Vie(n,e){if(1&n&&(pe(0,"li"),Cn(1),Te()),2&n){const t=e.$implicit;se(1),fg(" ",t," ")}}const zie=function(){return[10,10]},GN=function(){return[10,10,10]},Hie=function(){return[45,2,.1,100]},Gie=function(){return[0,0,0]};let Wie=(()=>{class n{constructor(t){this.cdref=t,this.changes=[],this.rotation=[0,0,0],this.position=[0,1,0],this.assetPath=`${Ra}DamagedHelmet.glb`,window.setInterval(()=>{this.rotation=[0,this.rotation[1]+.05,0],this.cdref.markForCheck()},1500),window.setInterval(()=>{this.position=[0,(this.position[1]+1)%5,0],this.cdref.markForCheck()},3e3)}logUpdates(t){this.changes.length>=20&&this.changes.shift(),this.changes.push(Object.keys(t).toString())}onLoaded(){this.changes.push("Model loaded")}}return n.\u0275fac=function(t){return new(t||n)(N(Ei))},n.\u0275cmp=Re({type:n,selectors:[["app-events-example"]],decls:12,vars:14,consts:[["loadGLTF","",3,"url","rotation","position","onUpdate","onLoaded"],[3,"args"],[3,"position"],[3,"args","position","lookAt"],[1,"change-list"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(pe(0,"th-canvas")(1,"th-scene"),Ye(2,"th-ambientLight"),pe(3,"th-object3D",0),gt("onUpdate",function(s){return i.logUpdates(s)})("onLoaded",function(){return i.onLoaded()}),Te(),Ye(4,"th-gridHelper",1)(5,"th-pointLight",2)(6,"th-perspectiveCamera",3),Te()(),pe(7,"div",4)(8,"h1"),Cn(9,"Updates"),Te(),pe(10,"ol"),Sn(11,Vie,2,1,"li",5),Te()()),2&t&&(se(3),Q("url",i.assetPath)("rotation",i.rotation)("position",i.position),se(1),Q("args",Ee(9,zie)),se(1),Q("position",Ee(10,GN)),se(1),Q("args",Ee(11,Hie))("position",Ee(12,GN))("lookAt",Ee(13,Gie)),se(5),Q("ngForOf",i.changes))},dependencies:[oc,Ir,an,Vc,Gc,qo,mr,ir,Qh],styles:[".change-list[_ngcontent-%COMP%]{padding:1em;box-shadow:0 4px 8px #0003;transition:.3s}[_nghost-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr)}"],changeDetection:0}),n})();const $h=JSON.parse('{"name":"ngx-three","version":"0.17.0","scripts":{"ng":"ng","start":"ng serve","build":"ng build ngx-three","build:prod":"ng build ngx-three --configuration production","build:demo":"ng build ngx-three-demo --configuration production --base-href /ngx-three/","test":"ng test","test-headless":"ng test --watch=false --browsers=ChromeHeadless","lint":"ng lint","e2e":"ng e2e","copy:docs":"(cp README.md dist/ngx-three/ || copy README.md dist\\\\ngx-three)","package":"ng build --configuration production ngx-three && npm run copy:docs","format":"prettier-eslint --write \\"{,!(node_modules|dist)/**/}*.{ts,tsx}\\""},"private":true,"dependencies":{"@angular/animations":"^14.0.2","@angular/cdk":"^14.0.2","@angular/common":"^14.0.2","@angular/compiler":"^14.0.2","@angular/core":"^14.0.2","@angular/forms":"^14.0.2","@angular/material":"^14.0.2","@angular/platform-browser":"^14.0.2","@angular/platform-browser-dynamic":"^14.0.2","@angular/router":"^14.0.2","@stackblitz/sdk":"^1.5.3","ngx-highlightjs":"^7.0.0","normalize.css":"^8.0.1","rxjs":"~7.5.5","simplex-noise":"^3.0.1","three":"~0.141.0","tslib":"^2.3.1","zone.js":"~0.11.4"},"devDependencies":{"@angular-devkit/build-angular":"^14.0.2","@angular-eslint/builder":"~13.5.0","@angular-eslint/eslint-plugin":"~13.5.0","@angular-eslint/eslint-plugin-template":"~13.5.0","@angular-eslint/schematics":"^14.0.0-alpha.3","@angular-eslint/template-parser":"~13.5.0","@angular/cli":"^14.0.2","@angular/compiler-cli":"^14.0.2","@types/jasmine":"~3.6.0","@types/node":"^18.0.0","@types/prettier":"^2.6.3","@types/three":"~0.141.0","@typescript-eslint/eslint-plugin":"5.29.0","@typescript-eslint/parser":"5.29.0","eslint":"^8.18.0","eslint-plugin-import":"^2.26.0","eslint-plugin-jsdoc":"^39.3.3","eslint-plugin-prefer-arrow":"^1.2.3","jasmine-core":"~3.6.0","jasmine-spec-reporter":"~5.0.0","karma":"~6.3.9","karma-chrome-launcher":"~3.1.0","karma-coverage":"~2.0.3","karma-jasmine":"~4.0.0","karma-jasmine-html-reporter":"^1.5.0","ng-packagr":"^14.0.2","prettier":"^2.7.1","prettier-eslint":"^15.0.1","prettier-eslint-cli":"^5.0.1","protractor":"~7.0.0","ts-node":"^10.8.1","typescript":"~4.7.4","utility-types":"^3.10.0","acorn":">=8"}}'),WN='\nimport "zone.js";';function CT(){return(CT=no(function*(n,e){const i=Ep(YN(n)),r=ZN(i),s={"package.json":Zie(),"src/index.html":{content:qN(r)},"src/main.ts":{content:XN(i,e)},"src/polyfills.ts":{content:WN},"src/assets.ts":{content:`export const ASSET_PATH = '${SN}';`}};yield qie(n,s),fetch("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({files:s})}).then(o=>o.json()).then(o=>window.open(`https://codesandbox.io/s/${o.sandbox_id}`,"_blank"))})).apply(this,arguments)}function qie(n,e){return Promise.all(n.map(t=>fetch(t).then(function(){var i=no(function*(r){e[`src/app/${Ep(t)}`]={content:yield r.text()}});return function(r){return i.apply(this,arguments)}}())))}function Zie(){return{content:{main:"src/main.ts",dependencies:{"ngx-three":"latest","@types/three":$h.devDependencies["@types/three"],...$h.dependencies},devDependencies:{...$h.devDependencies}}}}function Ep(n){return n.replace(/^.*[\\\/]/,"")}function XN(n,e){const t=function Qie(n){if(n&&n.length>0)return n[0]}(e)??function Yie(n){return n.replace(".ts","").replace(/(?:^\w|[A-Z]|\b\w)/g,(e,t)=>e.toUpperCase()).replace(/[-.]/g,"")}(n),i=function $ie(n,e){return n&&n.length>0?n.join(","):e}(e,t);return`\n            import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n            import { NgModule } from '@angular/core';\n            import { BrowserModule } from '@angular/platform-browser';\n            import { NgxThreeModule } from 'ngx-three';\n            import { FormsModule } from '@angular/forms';\n            import { ${i} } from './app/${n.replace(".ts","")}';\n\n            @NgModule({\n                imports: [\n                    BrowserModule,\n                    NgxThreeModule,\n                    FormsModule\n                ],\n                providers: [],\n                declarations: [${i}],\n                bootstrap: [${t}]\n            })\n            export class AppModule {}\n\n            platformBrowserDynamic().bootstrapModule(AppModule)\n            .catch(err => console.log(err));\n            `}function qN(n){return`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="utf-8" />\n        <title>NgxThreeDemo</title>\n        <base href="/" />\n        <meta name="viewport" content="width=device-width, initial-scale=1" />\n        <link rel="icon" type="image/x-icon" href="favicon.ico" />\n    </head>\n    <body>\n        <${n}></${n}>\n    </body>\n    </html>\n    `}function ZN(n){return"app-"+n.replace(".component.ts","")}function YN(n){for(const e of n)if(e.endsWith(".ts"))return e;return""}function Kie(n){for(const e of n)if(e.endsWith(".html"))return e}function Jh(n){return n&&n.origin?n.origin:"https://stackblitz.com"}function KN(){return Math.random().toString(36).substring(7)}function ed(n){var e=[];return n&&(n.forceEmbedLayout&&e.push("embed=1"),n.clickToLoad&&e.push("ctl=1"),"string"==typeof n.openFile&&e.push("file="+n.openFile),"preview"!==n.view&&"editor"!==n.view||e.push("view="+n.view),"light"!==n.theme&&"dark"!==n.theme||e.push("theme="+n.theme),n.hideExplorer&&e.push("hideExplorer=1"),n.hideNavigation&&e.push("hideNavigation=1"),n.hideDevTools&&e.push("hidedevtools=1"),"number"==typeof n.devToolsHeight&&n.devToolsHeight>=0&&n.devToolsHeight<=100&&e.push("devtoolsheight="+Math.round(n.devToolsHeight))),e.length?"?"+e.join("&"):""}function ET(n,e,t){if(null===n.parentNode)throw new Error("Invalid Element");e.id=n.id,function ere(n,e){e&&(e.hasOwnProperty("height")&&(n.height=""+e.height),e.hasOwnProperty("width")&&(n.width=""+e.width)),n.height||(n.height="300"),n.width||n.setAttribute("style","width:100%;")}(e,t),n.parentNode.replaceChild(e,n)}function DT(n){if("string"==typeof n){var e=document.getElementById(n);if(null!==e)return e}else if(n instanceof HTMLElement)return n;throw new Error("Invalid Element")}function AT(n){return n&&!1===n.newWindow?"_self":"_blank"}var QN=function(n){var e=this;this.pending={},this.port=n,this.port.onmessage=function(t){if(t.data.payload.__reqid){var i=t.data.payload.__reqid,r=t.data.payload.__success;if(e.pending[i]){if(delete t.data.payload.__reqid,delete t.data.payload.__success,r){var s=0===Object.keys(t.data.payload).length&&t.data.payload.constructor===Object?null:t.data.payload;e.pending[i].resolve(s)}else e.pending[i].reject(t.data.payload.error?t.data.type+": "+t.data.payload.error:t.data.type);delete e.pending[i]}}}};QN.prototype.request=function(n){var e=this,t=KN();return new Promise(function(i,r){e.pending[t]={resolve:i,reject:r},n.payload.__reqid=t,e.port.postMessage(n)})};var Lv=function(n,e){var t=this;this.rdc=new QN(n),this.preview={},Object.defineProperty(this.preview,"origin",{value:e.previewOrigin,writable:!1}),this.editor={openFile:function(i){return t.rdc.request({type:"SDK_OPEN_FILE",payload:{path:i}})}}};Lv.prototype.applyFsDiff=function(n){return this.rdc.request({type:"SDK_APPLY_FS_DIFF",payload:n})},Lv.prototype.getFsSnapshot=function(){return this.rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},Lv.prototype.getDependencies=function(){return this.rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})};var Fv=[],tre=function(n){var e=this;this.id=KN(),this.element=n,this.pending=new Promise(function(t,i){var r=function(c){c.data.action&&"SDK_INIT_SUCCESS"===c.data.action&&c.data.id===e.id&&(e.vm=new Lv(c.ports[0],c.data.payload),t(e.vm),o())},s=function(){e.element.contentWindow&&e.element.contentWindow.postMessage({action:"SDK_INIT",id:e.id},"*")};function o(){window.clearInterval(l),window.removeEventListener("message",r)}window.addEventListener("message",r),s();var a=0,l=window.setInterval(function(){if(e.vm)o();else{if(a>=20)return o(),i("Timeout: Unable to establish a connection with the StackBlitz VM"),void Fv.forEach(function(c,u){c.id===e.id&&Fv.splice(u,1)});a++,s()}},500)}),Fv.push(this)},$N=["typescript","create-react-app","angular-cli","javascript","polymer","vue"];function Wc(n,e){var t=document.createElement("input");return t.type="hidden",t.name=n,t.value=e,t}function JN(n){-1===$N.indexOf(n.template)&&console.warn("Unsupported project template, must be one of: "+$N.join(", "));var e=document.createElement("form");return e.method="POST",e.setAttribute("style","display:none;"),e.appendChild(Wc("project[title]",n.title)),e.appendChild(Wc("project[description]",n.description)),e.appendChild(Wc("project[template]",n.template)),n.tags&&n.tags.forEach(function(t){e.appendChild(Wc("project[tags][]",t))}),n.dependencies&&e.appendChild(Wc("project[dependencies]",JSON.stringify(n.dependencies))),n.settings&&e.appendChild(Wc("project[settings]",JSON.stringify(n.settings))),Object.keys(n.files).forEach(function(t){e.appendChild(Wc("project[files]["+t+"]",n.files[t]))}),e}var kv={connect:function(n){if(!n||!n.contentWindow)return Promise.reject("Provided element is not an iframe.");var e=function(n){var e=n instanceof Element?"element":"id";return Fv.find(function(i){return i[e]===n})||null}(n);return e?e.pending:new tre(n).pending},openGithubProject:function(n,e){window.open(Jh(e)+"/github/"+n+ed(e),AT(e))},openProject:function(n,e){!function rre(n,e){var t=JN(n);t.action=Jh(e)+"/run"+ed(e),t.target=AT(e),document.body.appendChild(t),t.submit(),document.body.removeChild(t)}(n,e)},openProjectId:function(n,e){window.open(Jh(e)+"/edit/"+n+ed(e),AT(e))},embedGithubProject:function(n,e,t){var i=DT(n),r=document.createElement("iframe");return r.src=Jh(t)+"/github/"+e+ed(t),ET(i,r,t),kv.connect(r)},embedProject:function(n,e,t){var i=DT(n),r=function ire(n,e){var t=JN(n);return t.action=Jh(e)+"/run"+ed(e),t.id="sb","<html><head><title></title></head><body>"+t.outerHTML+"<script>document.getElementById('sb').submit();<\/script></body></html>"}(e,t),s=document.createElement("iframe");return ET(i,s,t),s.contentDocument&&s.contentDocument.write(r),kv.connect(s)},embedProjectId:function(n,e,t){var i=DT(n),r=document.createElement("iframe");return r.src=Jh(t)+"/edit/"+e+ed(t),ET(i,r,t),kv.connect(r)}};const sre=kv;function RT(){return(RT=no(function*(n,e){const t=YN(n),i=Kie(n),r=Ep(t),s=ZN(r),o={template:"angular-cli",title:s,description:"ngx-three example "+s,files:{"src/index.html":qN(s),"src/main.ts":XN(r,e),"src/polyfills.ts":WN,"src/assets.ts":`export const ASSET_PATH = '${SN}';`},dependencies:{"ngx-three":"latest","@types/three":$h.devDependencies["@types/three"],...$h.dependencies},devDependencies:{...$h.devDependencies}};yield are(n,o.files);const a=i?{openFile:`src/app/${Ep(i)}`}:void 0;sre.openProject(o,a)})).apply(this,arguments)}function are(n,e){return Promise.all(n.map(t=>fetch(t).then(function(){var i=no(function*(r){const s=yield r.text();e[`src/app/${Ep(t)}`]=s});return function(r){return i.apply(this,arguments)}}())))}class Ov{constructor(){this.urls=[],this.fileNames=[]}setUrls(e){this.urls=e,this.fileNames=this.extractFileNames()}extractFileNames(){return this.urls.map(e=>e.split("/").pop()??"")}toStackblitz(e){e?.preventDefault(),function ore(n,e){RT.apply(this,arguments)}(this.urls,this.declarations)}toCodeSandbox(e){e?.preventDefault(),function Xie(n,e){CT.apply(this,arguments)}(this.urls,this.declarations)}}let PT;try{PT=typeof Intl<"u"&&Intl.v8BreakIterator}catch{PT=!1}let Dp,Nv,Xc,IT,_r=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?w2(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!PT)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(re(_f))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ap(n){return function lre(){if(null==Dp&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Dp=!0}))}finally{Dp=Dp||!1}return Dp}()?n:!!n.capture}function t3(){if(null==Xc){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Xc=!1,Xc;if("scrollBehavior"in document.documentElement.style)Xc=!0;else{const n=Element.prototype.scrollTo;Xc=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Xc}function Rp(){if("object"!=typeof document||!document)return 0;if(null==Nv){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),Nv=0,0===n.scrollLeft&&(n.scrollLeft=1,Nv=0===n.scrollLeft?1:2),n.remove()}return Nv}function qc(n){return n.composedPath?n.composedPath()[0]:n.target}function LT(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function nd(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}class Mre extends $n{constructor(e,t){super()}schedule(e,t=0){return this}}const Bv={setInterval(n,e,...t){const{delegate:i}=Bv;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=Bv;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class OT extends Mre{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return Bv.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;Bv.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,pm(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class Pp{constructor(e,t=Pp.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Pp.now=pT.now;class NT extends Pp{constructor(e,t=Pp.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const BT=new NT(OT),Sre=BT;function jv(n,e=BT){return ui((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,i.next(c)}};function l(){const c=o+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(Jn(i,c=>{s=c,o=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}function jT(n){return Ui((e,t)=>n<=t)}function UT(n,e=ja){return n=n??Tre,ui((t,i)=>{let r,s=!0;t.subscribe(Jn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}function Tre(n,e){return n===e}function ai(n){return null!=n&&"false"!=`${n}`}function As(n,e=0){return function Cre(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function Uv(n){return Array.isArray(n)?n:[n]}function Ii(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Zc(n){return n instanceof qt?n.nativeElement:n}let u3=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ere=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=Zc(t);return new wn(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new Ft,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(re(u3))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Dre=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new yt,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=ai(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=As(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(jv(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(N(Ere),N(qt),N(Pt))},n.\u0275dir=tt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),VT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:[u3]}),n})(),Are=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();const h3=new Set;let id,Rre=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Ire}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Pre(n){if(!h3.has(n))try{id||(id=document.createElement("style"),id.setAttribute("type","text/css"),document.head.appendChild(id)),id.sheet&&(id.sheet.insertRule(`@media ${n} {body{ }}`,0),h3.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(re(_r))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ire(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let d3=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Ft}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return f3(Uv(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Ow(f3(Uv(t)).map(o=>this._registerQuery(o).observable));return s=Zg(s.pipe(Or(1)),s.pipe(jT(1),jv(0))),s.pipe(xt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new wn(o=>{const a=l=>this._zone.run(()=>o.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(pa(i),xt(({matches:o})=>({query:t,matches:o})),jn(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(re(Rre),re(Pt))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function f3(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}class g3 extends class Ore{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Ft,this._typeaheadSubscription=$n.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Ft,this.change=new Ft,e instanceof rc&&e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}})}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Wn(t=>this._pressedLetters.push(t)),jv(e),Ui(()=>this._pressedLetters.length>0),xt(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,o=i[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;default:return void((r||nd(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof rc?this._items.toArray():this._items}}{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let _3=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function Bre(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function Nre(n){try{return n.frameElement}catch{return null}}(function Xre(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===y3(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=y3(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function Gre(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function Wre(n){return!function Ure(n){return function zre(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function jre(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function Vre(n){return function Hre(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||v3(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(re(_r))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function v3(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function y3(n){if(!v3(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class qre{constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Or(1)).subscribe(e)}}let Zre=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new qre(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(re(_3),re(Pt),re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function b3(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function x3(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const Yre=new He("cdk-input-modality-detector-options"),Kre={ignoreKeys:[18,17,224,91,16]},rd=Ap({passive:!0,capture:!0});let Qre=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new es(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=qc(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(b3(o)?"keyboard":"mouse"),this._mostRecentTarget=qc(o))},this._onTouchstart=o=>{x3(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=qc(o))},this._options={...Kre,...s},this.modalityDetected=this._modality.pipe(jT(1)),this.modalityChanged=this.modalityDetected.pipe(UT()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,rd),r.addEventListener("mousedown",this._onMousedown,rd),r.addEventListener("touchstart",this._onTouchstart,rd)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,rd),document.removeEventListener("mousedown",this._onMousedown,rd),document.removeEventListener("touchstart",this._onTouchstart,rd))}}return n.\u0275fac=function(t){return new(t||n)(re(_r),re(Pt),re(Ut),re(Yre,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Jre=new He("cdk-focus-monitor-default-options"),Vv=Ap({passive:!0,capture:!0});let Ip=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ft,this._rootNodeFocusAndBlurListener=a=>{const l=qc(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,i=!1){const r=Zc(t);if(!this._platform.isBrowser||1!==r.nodeType)return Mt(null);const s=function ure(n){if(function cre(){if(null==IT){const n=typeof document<"u"?document.head:null;IT=!(!n||!n.createShadowRoot&&!n.attachShadow)}return IT}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new Ft,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=Zc(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Zc(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=qc(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Vv),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Vv)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(jn(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Vv),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Vv),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(re(Pt),re(_r),re(Qre),re(Ut,8),re(Jre,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ese=(()=>{class n{constructor(t,i){this._elementRef=t,this._focusMonitor=i,this.cdkFocusChange=new yt}ngAfterViewInit(){const t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,1===t.nodeType&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(i=>this.cdkFocusChange.emit(i))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ip))},n.\u0275dir=tt({type:n,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),n})();const M3="cdk-high-contrast-black-on-white",S3="cdk-high-contrast-white-on-black",zT="cdk-high-contrast-active";let T3=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Zl(d3).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(zT,M3,S3),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(zT,M3):2===i&&t.add(zT,S3)}}}return n.\u0275fac=function(t){return new(t||n)(re(_r),re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),tse=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(re(T3))},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[VT]}),n})();const nse=new He("cdk-dir-doc",{providedIn:"root",factory:function ise(){return Zl(Ut)}}),rse=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Ia=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new yt,t){const r=t.documentElement?t.documentElement.dir:null;this.value=function sse(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?rse.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(re(nse,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Lp=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();const ase=new He("mat-sanity-checks",{providedIn:"root",factory:function ose(){return!0}});let In=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!LT()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(re(T3),re(ase,8),re(Ut))},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Lp,Lp]}),n})();function Fp(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=ai(e)}}}function kp(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function sd(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=ai(e)}}}let D3=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),n})();function Op(n,e,t){n.nativeElement.classList.toggle(e,t)}let R3=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In,In]}),n})();class use{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const P3={enterDuration:225,exitDuration:150},HT=Ap({passive:!0}),I3=["mousedown","touchstart"],L3=["mouseup","mouseleave","touchend","touchcancel"];class dse{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Zc(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...P3,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function fse(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u);const h=window.getComputedStyle(u),f=h.transitionDuration,p="none"===h.transitionProperty||"0s"===f||"0s, 0s"===f,m=new use(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",m.state=0,i.persistent||(this._mostRecentTransientRipple=m);let g=null;return!p&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const _=()=>this._finishRippleTransition(m),v=()=>this._destroyRipple(m);u.addEventListener("transitionend",_),u.addEventListener("transitioncancel",v),g={onTransitionEnd:_,onTransitionCancel:v}}),this._activeRipples.set(m,g),(p||!c)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...P3,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Zc(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(I3))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(L3),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=b3(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!x3(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,HT)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(I3.forEach(e=>{this._triggerElement.removeEventListener(e,this,HT)}),this._pointerUpEventsRegistered&&L3.forEach(e=>{this._triggerElement.removeEventListener(e,this,HT)}))}}const pse=new He("mat-ripple-global-options");let od=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new dse(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Pt),N(_r),N(pse,8),N(Er,8))},n.\u0275dir=tt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&pn("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),zv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In,In]}),n})(),GT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In]}),n})(),F3=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[zv,Ya,In,GT]}),n})();function k3(...n){const e=S0(n),{args:t,keys:i}=W2(n),r=new wn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let h=!1;kr(t[u]).subscribe(Jn(s,d=>{h||(h=!0,c--),a[u]=d},()=>l--,void 0,()=>{(!l||!h)&&(c||s.next(i?X2(i,a):a),s.complete())}))}});return e?r.pipe(kw(e)):r}class O3{}class N3{}class La{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof La?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new La;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof La?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class gse{encodeKey(e){return B3(e)}encodeValue(e){return B3(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const vse=/%(\d[a-f0-9])/gi,yse={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function B3(n){return encodeURIComponent(n).replace(vse,(e,t)=>yse[t]??e)}function Hv(n){return`${n}`}class Fa{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new gse,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _se(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Hv):[Hv(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Fa({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Hv(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Hv(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class bse{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function j3(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function U3(n){return typeof Blob<"u"&&n instanceof Blob}function V3(n){return typeof FormData<"u"&&n instanceof FormData}class Np{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function xse(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new La),this.context||(this.context=new bse),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Fa,this.urlWithParams=t}serializeBody(){return null===this.body?null:j3(this.body)||U3(this.body)||V3(this.body)||function wse(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fa?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||V3(this.body)?null:U3(this.body)?this.body.type||null:j3(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fa?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,d)=>h.set(d,e.setHeaders[d]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((h,d)=>h.set(d,e.setParams[d]),c)),new Np(t,i,s,{params:c,headers:l,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var Li=(()=>((Li=Li||{})[Li.Sent=0]="Sent",Li[Li.UploadProgress=1]="UploadProgress",Li[Li.ResponseHeader=2]="ResponseHeader",Li[Li.DownloadProgress=3]="DownloadProgress",Li[Li.Response=4]="Response",Li[Li.User=5]="User",Li))();class WT{constructor(e,t=200,i="OK"){this.headers=e.headers||new La,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class XT extends WT{constructor(e={}){super(e),this.type=Li.ResponseHeader}clone(e={}){return new XT({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Gv extends WT{constructor(e={}){super(e),this.type=Li.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Gv({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class z3 extends WT{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function qT(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Wv=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Np)s=t;else{let l,c;l=r.headers instanceof La?r.headers:new La(r.headers),r.params&&(c=r.params instanceof Fa?r.params:new Fa({fromObject:r.params})),s=new Np(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Mt(s).pipe(Ju(l=>this.handler.handle(l)));if(t instanceof Np||"events"===r.observe)return o;const a=o.pipe(Ui(l=>l instanceof Gv));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(xt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(xt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(xt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(xt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Fa).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,qT(r,i))}post(t,i,r={}){return this.request("POST",t,qT(r,i))}put(t,i,r={}){return this.request("PUT",t,qT(r,i))}}return n.\u0275fac=function(t){return new(t||n)(re(O3))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class H3{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const G3=new He("HTTP_INTERCEPTORS");let Mse=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Sse=/^\)\]\}',?\n/;let W3=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new wn(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((f,p)=>r.setRequestHeader(f,p.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const f=t.detectContentTypeHeader();null!==f&&r.setRequestHeader("Content-Type",f)}if(t.responseType){const f=t.responseType.toLowerCase();r.responseType="json"!==f?f:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=r.statusText||"OK",p=new La(r.getAllResponseHeaders()),m=function Tse(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new XT({headers:p,status:r.status,statusText:f,url:m}),o},l=()=>{let{headers:f,status:p,statusText:m,url:g}=a(),_=null;204!==p&&(_=typeof r.response>"u"?r.responseText:r.response),0===p&&(p=_?200:0);let v=p>=200&&p<300;if("json"===t.responseType&&"string"==typeof _){const y=_;_=_.replace(Sse,"");try{_=""!==_?JSON.parse(_):null}catch(b){_=y,v&&(v=!1,_={error:b,text:_})}}v?(i.next(new Gv({body:_,headers:f,status:p,statusText:m,url:g||void 0})),i.complete()):i.error(new z3({error:_,headers:f,status:p,statusText:m,url:g||void 0}))},c=f=>{const{url:p}=a(),m=new z3({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});i.error(m)};let u=!1;const h=f=>{u||(i.next(a()),u=!0);let p={type:Li.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),"text"===t.responseType&&!!r.responseText&&(p.partialText=r.responseText),i.next(p)},d=f=>{let p={type:Li.UploadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),i.next(p)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",h),null!==s&&r.upload&&r.upload.addEventListener("progress",d)),r.send(s),i.next({type:Li.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",h),null!==s&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(re(S2))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const ZT=new He("XSRF_COOKIE_NAME"),YT=new He("XSRF_HEADER_NAME");class X3{}let Cse=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=h2(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(re(Ut),re(_f),re(ZT))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),KT=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(re(X3),re(YT))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Ese=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(G3,[]);this.chain=i.reduceRight((r,s)=>new H3(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(re(N3),re(Xi))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Dse=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:KT,useClass:Mse}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:ZT,useValue:t.cookieName}:[],t.headerName?{provide:YT,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:[KT,{provide:G3,useExisting:KT,multi:!0},{provide:X3,useClass:Cse},{provide:ZT,useValue:"XSRF-TOKEN"},{provide:YT,useValue:"X-XSRF-TOKEN"}]}),n})(),Ase=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:[Wv,{provide:O3,useClass:Ese},W3,{provide:N3,useExisting:W3}],imports:[Dse.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();const Rse=["*"];let Xv;function Bp(n){return function Pse(){if(void 0===Xv&&(Xv=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(Xv=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Xv}()?.createHTML(n)||n}function q3(n){return Error(`Unable to find icon with the name "${n}"`)}function Z3(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function Y3(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class Yc{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let qv=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new Yc(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(fn.HTML,r);if(!o)throw Y3(r);const a=Bp(o);return this._addSvgIconConfig(t,i,new Yc("",a,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new Yc(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(fn.HTML,i);if(!s)throw Y3(i);const o=Bp(s);return this._addSvgIconSetConfig(t,new Yc("",o,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(fn.RESOURCE_URL,t);if(!i)throw Z3(t);const r=this._cachedIconsByUrl.get(i);return r?Mt(Zv(r)):this._loadSvgIconFromConfig(new Yc(t,null)).pipe(Wn(s=>this._cachedIconsByUrl.set(i,s)),xt(s=>Zv(s)))}getNamedSvgIcon(t,i=""){const r=K3(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):Js(q3(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Mt(Zv(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(xt(i=>Zv(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Mt(r):k3(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(eo(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(fn.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),Mt(null)})))).pipe(xt(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw q3(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Wn(i=>t.svgText=i),xt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Mt(null):this._fetchIcon(t).pipe(Wn(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(Bp("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(Bp("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function Ise(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize(fn.RESOURCE_URL,i);if(!o)throw Z3(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(xt(c=>Bp(c)),Kg(()=>this._inProgressUrlFetches.delete(o)),T0());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(K3(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return Fse(s)?new Yc(s.url,null,s.options):new Yc(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(re(Wv,8),re(qg),re(Ut,8),re(oa))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zv(n){return n.cloneNode(!0)}function K3(n,e){return n+":"+e}function Fse(n){return!(!n.url||!n.options)}const kse=kp(class{constructor(n){this._elementRef=n}}),Ose=new He("MAT_ICON_DEFAULT_OPTIONS"),Nse=new He("mat-icon-location",{providedIn:"root",factory:function Bse(){const n=Zl(Ut),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),Q3=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],jse=Q3.map(n=>`[${n}]`).join(", "),Use=/^url\(['"]?#(.*?)['"]?\)$/;let $3=(()=>{class n extends kse{constructor(t,i,r,s,o,a){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=$n.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=ai(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?[this._iconRegistry.classNameForFontAlias(this.fontSet)]:this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(jse),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)Q3.forEach(o=>{const a=i[s],l=a.getAttribute(o),c=l?l.match(Use):null;if(c){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Or(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(qv),ql("aria-hidden"),N(Nse),N(oa),N(Ose,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,i){2&t&&(yi("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet),pn("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Se],ngContentSelectors:Rse,decls:1,vars:0,template:function(t,i){1&t&&(Ji(),Hn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),QT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In,In]}),n})();const Vse=["*",[["mat-card-footer"]]],zse=["*","mat-card-footer"];let Hse=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["mat-card-content"],["","mat-card-content",""],["","matCardContent",""]],hostAttrs:[1,"mat-card-content"]}),n})(),Gse=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["mat-card-footer"]],hostAttrs:[1,"mat-card-footer"]}),n})(),Wse=(()=>{class n{constructor(t){this._animationMode=t}}return n.\u0275fac=function(t){return new(t||n)(N(Er,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,i){2&t&&pn("_mat-animation-noopable","NoopAnimations"===i._animationMode)},exportAs:["matCard"],ngContentSelectors:zse,decls:2,vars:0,template:function(t,i){1&t&&(Ji(Vse),Hn(0),Hn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),n})(),J3=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In,In]}),n})();class $T{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class Xse extends $T{constructor(e,t,i,r){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r}}class eB extends $T{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class qse extends $T{constructor(e){super(),this.element=e instanceof qt?e.nativeElement:e}}class tB{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof Xse?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof eB?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof qse?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Zse extends tB{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||Xi.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let JT=(()=>{class n extends tB{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new yt,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)(N(Xa),N(Ur),N(Ut))},n.\u0275dir=tt({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Se]}),n})(),nB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();const Yse=["addListener","removeListener"],Kse=["addEventListener","removeEventListener"],Qse=["on","off"];function Ml(n,e,t,i){if(un(t)&&(i=t,t=void 0),i)return Ml(n,e,t).pipe(kw(i));const[r,s]=function eoe(n){return un(n.addEventListener)&&un(n.removeEventListener)}(n)?Kse.map(o=>a=>n[o](e,a,t)):function $se(n){return un(n.addListener)&&un(n.removeListener)}(n)?Yse.map(iB(n,e)):function Jse(n){return un(n.on)&&un(n.off)}(n)?Qse.map(iB(n,e)):[];if(!r&&w0(n))return Gi(o=>Ml(o,e,t))(kr(n));if(!r)throw new TypeError("Invalid event target");return new wn(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function iB(n,e){return t=>i=>n[t](e,i)}function rB(n=0,e,t=Sre){let i=-1;return null!=e&&(lE(e)?t=e:i=e),new wn(r=>{let s=function toe(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}class sB{}const ka="*";function jp(n,e){return{type:7,name:n,definitions:e,options:{}}}function Sl(n,e=null){return{type:4,styles:e,timings:n}}function oB(n,e=null){return{type:2,steps:n,options:e}}function Lr(n){return{type:6,styles:n,offset:null}}function Oa(n,e,t){return{type:0,name:n,styles:e,options:t}}function Na(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function aB(n){Promise.resolve(null).then(n)}class Up{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){aB(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class lB{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?aB(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const Vp={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=Vp;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new $n(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=Vp;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=Vp;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},Yv=new class ooe extends NT{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class soe extends OT{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Vp.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,t,i);e.actions.some(r=>r.id===t)||(Vp.cancelAnimationFrame(t),e._scheduled=void 0)}});let tC,aoe=1;const Kv={};function cB(n){return n in Kv&&(delete Kv[n],!0)}const loe={setImmediate(n){const e=aoe++;return Kv[e]=!0,tC||(tC=Promise.resolve()),tC.then(()=>cB(e)&&n()),e},clearImmediate(n){cB(n)}},{setImmediate:coe,clearImmediate:uoe}=loe,Qv={setImmediate(...n){const{delegate:e}=Qv;return(e?.setImmediate||coe)(...n)},clearImmediate(n){const{delegate:e}=Qv;return(e?.clearImmediate||uoe)(n)},delegate:void 0};new class doe extends NT{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class hoe extends OT{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Qv.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,t,i);e.actions.some(r=>r.id===t)||(Qv.clearImmediate(t),e._scheduled=void 0)}});function uB(n,e=BT){return function poe(n){return ui((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(Jn(t,c=>{i=!0,r=c,s||kr(n(c)).subscribe(s=Jn(t,a,l))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>rB(n,e))}let $v=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new Ft,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new wn(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(uB(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Mt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Ui(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Zc(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Ml(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(re(Pt),re(_r),re(Ut,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),zp=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new Ft,this._elementScrolled=new wn(o=>this.ngZone.runOutsideAngular(()=>Ml(this.elementRef.nativeElement,"scroll").pipe(jn(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=Rp()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==Rp()?t.left=t.right:1==Rp()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;t3()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:i:"end"==t&&(t=o?i:r),o&&2==Rp()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==Rp()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N($v),N(Pt),N(Ia,8))},n.\u0275dir=tt({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),n})(),ad=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new Ft,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(uB(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(re(_r),re(Pt),re(Ut,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Hp=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})(),hB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Lp,Hp,Lp,Hp]}),n})();function _oe(n,e){1&n&&Hn(0)}const dB=["*"];function voe(n,e){}const yoe=function(n){return{animationDuration:n}},boe=function(n,e){return{value:n,params:e}},xoe=["tabListContainer"],woe=["tabList"],Moe=["tabListInner"],Soe=["nextPaginator"],Toe=["previousPaginator"],Coe=["tabBodyWrapper"],Eoe=["tabHeader"];function Doe(n,e){}function Aoe(n,e){1&n&&Sn(0,Doe,0,0,"ng-template",10),2&n&&Q("cdkPortalOutlet",ii().$implicit.templateLabel)}function Roe(n,e){1&n&&Cn(0),2&n&&rf(ii().$implicit.textLabel)}function Poe(n,e){if(1&n){const t=Io();pe(0,"div",6),gt("click",function(){const r=Br(t),s=r.$implicit,o=r.index,a=ii(),l=yn(1);return jr(a._handleClick(s,l,o))})("cdkFocusChange",function(r){const o=Br(t).index;return jr(ii()._tabFocusChanged(r,o))}),pe(1,"div",7),Sn(2,Aoe,1,1,"ng-template",8),Sn(3,Roe,1,1,"ng-template",null,9,rI),Te()()}if(2&n){const t=e.$implicit,i=e.index,r=yn(4),s=ii();pn("mat-tab-label-active",s.selectedIndex===i),Q("id",s._getTabLabelId(i))("ngClass",t.labelClass)("disabled",t.disabled)("matRippleDisabled",t.disabled||s.disableRipple),yi("tabIndex",s._getTabIndex(t,i))("aria-posinset",i+1)("aria-setsize",s._tabs.length)("aria-controls",s._getTabContentId(i))("aria-selected",s.selectedIndex===i)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),se(2),Q("ngIf",t.templateLabel)("ngIfElse",r)}}function Ioe(n,e){if(1&n){const t=Io();pe(0,"mat-tab-body",11),gt("_onCentered",function(){return Br(t),jr(ii()._removeTabBodyWrapperHeight())})("_onCentering",function(r){return Br(t),jr(ii()._setTabBodyWrapperHeight(r))}),Te()}if(2&n){const t=e.$implicit,i=e.index,r=ii();pn("mat-tab-body-active",r.selectedIndex===i),Q("id",r._getTabContentId(i))("ngClass",t.bodyClass)("content",t.content)("position",t.position)("origin",t.origin)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),yi("tabindex",null!=r.contentTabIndex&&r.selectedIndex===i?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(i))}}const Loe=new He("MatInkBarPositioner",{providedIn:"root",factory:function Foe(){return e=>({left:e?(e.offsetLeft||0)+"px":"0",width:e?(e.offsetWidth||0)+"px":"0"})}});let fB=(()=>{class n{constructor(t,i,r,s){this._elementRef=t,this._ngZone=i,this._inkBarPositioner=r,this._animationMode=s}alignToElement(t){this.show(),this._ngZone.onStable.pipe(Or(1)).subscribe(()=>{const i=this._inkBarPositioner(t),r=this._elementRef.nativeElement;r.style.left=i.left,r.style.width=i.width})}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Pt),N(Loe),N(Er,8))},n.\u0275dir=tt({type:n,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(t,i){2&t&&pn("_mat-animation-noopable","NoopAnimations"===i._animationMode)}}),n})();const koe=new He("MatTabContent"),Ooe=new He("MatTabLabel"),Noe=new He("MAT_TAB"),Boe=Fp(class{}),pB=new He("MAT_TAB_GROUP");let mB=(()=>{class n extends Boe{constructor(t,i){super(),this._viewContainerRef=t,this._closestTabGroup=i,this.textLabel="",this._contentPortal=null,this._stateChanges=new Ft,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(t){this._setTemplateLabelInput(t)}get content(){return this._contentPortal}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new eB(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(t){t&&t._closestTab===this&&(this._templateLabel=t)}}return n.\u0275fac=function(t){return new(t||n)(N(Ur),N(pB,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-tab"]],contentQueries:function(t,i,r){if(1&t&&(pi(r,Ooe,5),pi(r,koe,7,Ks)),2&t){let s;Et(s=Dt())&&(i.templateLabel=s.first),Et(s=Dt())&&(i._explicitContent=s.first)}},viewQuery:function(t,i){if(1&t&&Pn(Ks,7),2&t){let r;Et(r=Dt())&&(i._implicitContent=r.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},exportAs:["matTab"],features:[Xe([{provide:Noe,useExisting:n}]),Se,$i],ngContentSelectors:dB,decls:1,vars:0,template:function(t,i){1&t&&(Ji(),Sn(0,_oe,1,0,"ng-template"))},encapsulation:2}),n})();const joe={translateTab:jp("translateTab",[Oa("center, void, left-origin-center, right-origin-center",Lr({transform:"none"})),Oa("left",Lr({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Oa("right",Lr({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Na("* => left, * => right, left => center, right => center",Sl("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Na("void => left-origin-center",[Lr({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),Sl("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Na("void => right-origin-center",[Lr({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),Sl("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let Uoe=(()=>{class n extends JT{constructor(t,i,r,s){super(t,i,s),this._host=r,this._centeringSub=$n.EMPTY,this._leavingSub=$n.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(pa(this._host._isCenterPosition(this._host._position))).subscribe(t=>{t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(N(Xa),N(Ur),N(Ze(()=>gB)),N(Ut))},n.\u0275dir=tt({type:n,selectors:[["","matTabBodyHost",""]],features:[Se]}),n})(),Voe=(()=>{class n{constructor(t,i,r){this._elementRef=t,this._dir=i,this._dirChangeSubscription=$n.EMPTY,this._translateTabComplete=new Ft,this._onCentering=new yt,this._beforeCentering=new yt,this._afterLeavingCenter=new yt,this._onCentered=new yt(!0),this.animationDuration="500ms",this.preserveContent=!1,i&&(this._dirChangeSubscription=i.change.subscribe(s=>{this._computePositionAnimationState(s),r.markForCheck()})),this._translateTabComplete.pipe(UT((s,o)=>s.fromState===o.fromState&&s.toState===o.toState)).subscribe(s=>{this._isCenterPosition(s.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(s.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(t){this._positionIndex=t,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(t){const i=this._isCenterPosition(t.toState);this._beforeCentering.emit(i),i&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(t){return"center"==t||"left-origin-center"==t||"right-origin-center"==t}_computePositionAnimationState(t=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==t?"left":"right":this._positionIndex>0?"ltr"==t?"right":"left":"center"}_computePositionFromOrigin(t){const i=this._getLayoutDirection();return"ltr"==i&&t<=0||"rtl"==i&&t>0?"left-origin-center":"right-origin-center"}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ia,8),N(Ei))},n.\u0275dir=tt({type:n,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),n})(),gB=(()=>{class n extends Voe{constructor(t,i,r){super(t,i,r)}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ia,8),N(Ei))},n.\u0275cmp=Re({type:n,selectors:[["mat-tab-body"]],viewQuery:function(t,i){if(1&t&&Pn(JT,5),2&t){let r;Et(r=Dt())&&(i._portalHost=r.first)}},hostAttrs:[1,"mat-tab-body"],features:[Se],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(t,i){1&t&&(pe(0,"div",0,1),gt("@translateTab.start",function(s){return i._onTranslateTabStarted(s)})("@translateTab.done",function(s){return i._translateTabComplete.next(s)}),Sn(2,voe,0,0,"ng-template",2),Te()),2&t&&Q("@translateTab",ic(3,boe,i._position,Tn(1,yoe,i.animationDuration)))},dependencies:[Uoe],styles:['.mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}.mat-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[joe.translateTab]}}),n})();const _B=new He("MAT_TABS_CONFIG"),zoe=Fp(class{});let vB=(()=>{class n extends zoe{constructor(t){super(),this.elementRef=t}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return n.\u0275fac=function(t){return new(t||n)(N(qt))},n.\u0275dir=tt({type:n,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(t,i){2&t&&(yi("aria-disabled",!!i.disabled),pn("mat-tab-disabled",i.disabled))},inputs:{disabled:"disabled"},features:[Se]}),n})();const yB=Ap({passive:!0});let Woe=(()=>{class n{constructor(t,i,r,s,o,a,l){this._elementRef=t,this._changeDetectorRef=i,this._viewportRuler=r,this._dir=s,this._ngZone=o,this._platform=a,this._animationMode=l,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new Ft,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new Ft,this._disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new yt,this.indexFocused=new yt,o.runOutsideAngular(()=>{Ml(t.nativeElement,"mouseleave").pipe(jn(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=ai(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){t=As(t),this._selectedIndex!=t&&(this._selectedIndexChanged=!0,this._selectedIndex=t,this._keyManager&&this._keyManager.updateActiveItem(t))}ngAfterViewInit(){Ml(this._previousPaginator.nativeElement,"touchstart",yB).pipe(jn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Ml(this._nextPaginator.nativeElement,"touchstart",yB).pipe(jn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const t=this._dir?this._dir.change:Mt("ltr"),i=this._viewportRuler.change(150),r=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new g3(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(Or(1)).subscribe(r),lu(t,i,this._items.changes,this._itemsResized()).pipe(jn(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),r()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(jn(this._destroyed)).subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}_itemsResized(){return"function"!=typeof ResizeObserver?yr:this._items.changes.pipe(pa(this._items),Bo(t=>new wn(i=>this._ngZone.runOutsideAngular(()=>{const r=new ResizeObserver(()=>{i.next()});return t.forEach(s=>{r.observe(s.elementRef.nativeElement)}),()=>{r.disconnect()}}))),jT(1))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!nd(t))switch(t.keyCode){case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t));break;default:this._keyManager.onKeydown(t)}}_onContentChanges(){const t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){!this._isValidIndex(t)||this.focusIndex===t||!this._keyManager||this._keyManager.setActiveItem(t)}_isValidIndex(t){if(!this._items)return!0;const i=this._items?this._items.toArray()[t]:null;return!!i&&!i.disabled}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();const i=this._tabListContainer.nativeElement;i.scrollLeft="ltr"==this._getLayoutDirection()?0:i.scrollWidth-i.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const t=this.scrollDistance,i="ltr"===this._getLayoutDirection()?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(i)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){return this._scrollTo(this._scrollDistance+("before"==t?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;const i=this._items?this._items.toArray()[t]:null;if(!i)return;const r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:s,offsetWidth:o}=i.elementRef.nativeElement;let a,l;"ltr"==this._getLayoutDirection()?(a=s,l=a+o):(l=this._tabListInner.nativeElement.offsetWidth-s,a=l-o);const c=this.scrollDistance,u=this.scrollDistance+r;a<c?this.scrollDistance-=c-a+60:l>u&&(this.scrollDistance+=l-u+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const t=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;t||(this.scrollDistance=0),t!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=t}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,i=t?t.elementRef.nativeElement:null;i?this._inkBar.alignToElement(i):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,i){i&&null!=i.button&&0!==i.button||(this._stopInterval(),rB(650,100).pipe(jn(lu(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:r,distance:s}=this._scrollHeader(t);(0===s||s>=r)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const i=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(i,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:i,distance:this._scrollDistance}}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ei),N(ad),N(Ia,8),N(Pt),N(_r),N(Er,8))},n.\u0275dir=tt({type:n,inputs:{disablePagination:"disablePagination"}}),n})(),Xoe=(()=>{class n extends Woe{constructor(t,i,r,s,o,a,l){super(t,i,r,s,o,a,l),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=ai(t)}_itemSelected(t){t.preventDefault()}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ei),N(ad),N(Ia,8),N(Pt),N(_r),N(Er,8))},n.\u0275dir=tt({type:n,inputs:{disableRipple:"disableRipple"},features:[Se]}),n})(),qoe=(()=>{class n extends Xoe{constructor(t,i,r,s,o,a,l){super(t,i,r,s,o,a,l)}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ei),N(ad),N(Ia,8),N(Pt),N(_r),N(Er,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-tab-header"]],contentQueries:function(t,i,r){if(1&t&&pi(r,vB,4),2&t){let s;Et(s=Dt())&&(i._items=s)}},viewQuery:function(t,i){if(1&t&&(Pn(fB,7),Pn(xoe,7),Pn(woe,7),Pn(Moe,7),Pn(Soe,5),Pn(Toe,5)),2&t){let r;Et(r=Dt())&&(i._inkBar=r.first),Et(r=Dt())&&(i._tabListContainer=r.first),Et(r=Dt())&&(i._tabList=r.first),Et(r=Dt())&&(i._tabListInner=r.first),Et(r=Dt())&&(i._nextPaginator=r.first),Et(r=Dt())&&(i._previousPaginator=r.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(t,i){2&t&&pn("mat-tab-header-pagination-controls-enabled",i._showPaginationControls)("mat-tab-header-rtl","rtl"==i._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[Se],ngContentSelectors:dB,decls:14,vars:10,consts:[["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","disabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["tabListInner",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","disabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(t,i){1&t&&(Ji(),pe(0,"button",0,1),gt("click",function(){return i._handlePaginatorClick("before")})("mousedown",function(s){return i._handlePaginatorPress("before",s)})("touchend",function(){return i._stopInterval()}),Ye(2,"div",2),Te(),pe(3,"div",3,4),gt("keydown",function(s){return i._handleKeydown(s)}),pe(5,"div",5,6),gt("cdkObserveContent",function(){return i._onContentChanges()}),pe(7,"div",7,8),Hn(9),Te(),Ye(10,"mat-ink-bar"),Te()(),pe(11,"button",9,10),gt("mousedown",function(s){return i._handlePaginatorPress("after",s)})("click",function(){return i._handlePaginatorClick("after")})("touchend",function(){return i._stopInterval()}),Ye(13,"div",2),Te()),2&t&&(pn("mat-tab-header-pagination-disabled",i._disableScrollBefore),Q("matRippleDisabled",i._disableScrollBefore||i.disableRipple)("disabled",i._disableScrollBefore||null),se(5),pn("_mat-animation-noopable","NoopAnimations"===i._animationMode),se(6),pn("mat-tab-header-pagination-disabled",i._disableScrollAfter),Q("matRippleDisabled",i._disableScrollAfter||i.disableRipple)("disabled",i._disableScrollAfter||null))},dependencies:[od,Dre,fB],styles:[".mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-tab-header-pagination::-moz-focus-inner{border:0}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}.mat-tab-list._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}"],encapsulation:2}),n})(),Zoe=0;class Yoe{}const Koe=kp(sd(class{constructor(n){this._elementRef=n}}),"primary");let Qoe=(()=>{class n extends Koe{constructor(t,i,r,s){super(t),this._changeDetectorRef=i,this._animationMode=s,this._tabs=new rc,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=$n.EMPTY,this._tabLabelSubscription=$n.EMPTY,this._dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this._disablePagination=!1,this._preserveContent=!1,this.selectedIndexChange=new yt,this.focusChange=new yt,this.animationDone=new yt,this.selectedTabChange=new yt(!0),this._groupId=Zoe++,this.animationDuration=r&&r.animationDuration?r.animationDuration:"500ms",this.disablePagination=!(!r||null==r.disablePagination)&&r.disablePagination,this.dynamicHeight=!(!r||null==r.dynamicHeight)&&r.dynamicHeight,this.contentTabIndex=r?.contentTabIndex??null,this.preserveContent=!!r?.preserveContent}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(t){this._dynamicHeight=ai(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=As(t,null)}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t+"")?t+"ms":t}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(t){this._contentTabIndex=As(t,null)}get disablePagination(){return this._disablePagination}set disablePagination(t){this._disablePagination=ai(t)}get preserveContent(){return this._preserveContent}set preserveContent(t){this._preserveContent=ai(t)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){const i=this._elementRef.nativeElement;i.classList.remove(`mat-background-${this.backgroundColor}`),t&&i.classList.add(`mat-background-${t}`),this._backgroundColor=t}ngAfterContentChecked(){const t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){const i=null==this._selectedIndex;if(!i){this.selectedTabChange.emit(this._createChangeEvent(t));const r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,s)=>r.isActive=s===t),i||(this.selectedIndexChange.emit(t),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((i,r)=>{i.position=r-t,null!=this._selectedIndex&&0==i.position&&!i.origin&&(i.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const t=this._clampTabIndex(this._indexToSelect);if(t===this._selectedIndex){const i=this._tabs.toArray();let r;for(let s=0;s<i.length;s++)if(i[s].isActive){this._indexToSelect=this._selectedIndex=s,this._lastFocusedTabIndex=null,r=i[s];break}!r&&i[t]&&Promise.resolve().then(()=>{i[t].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(t))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(pa(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(i=>i._closestTabGroup===this||!i._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(t){const i=this._tabHeader;i&&(i.focusIndex=t)}_focusChanged(t){this._lastFocusedTabIndex=t,this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){const i=new Yoe;return i.index=t,this._tabs&&this._tabs.length&&(i.tab=this._tabs.toArray()[t]),i}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=lu(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t){return`mat-tab-label-${this._groupId}-${t}`}_getTabContentId(t){return`mat-tab-content-${this._groupId}-${t}`}_setTabBodyWrapperHeight(t){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const i=this._tabBodyWrapper.nativeElement;i.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(i.style.height=t+"px")}_removeTabBodyWrapperHeight(){const t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this.animationDone.emit()}_handleClick(t,i,r){t.disabled||(this.selectedIndex=i.focusIndex=r)}_getTabIndex(t,i){return t.disabled?null:i===(this._lastFocusedTabIndex??this.selectedIndex)?0:-1}_tabFocusChanged(t,i){t&&"mouse"!==t&&"touch"!==t&&(this._tabHeader.focusIndex=i)}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ei),N(_B,8),N(Er,8))},n.\u0275dir=tt({type:n,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",preserveContent:"preserveContent",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[Se]}),n})(),$oe=(()=>{class n extends Qoe{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ei),N(_B,8),N(Er,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-tab-group"]],contentQueries:function(t,i,r){if(1&t&&pi(r,mB,5),2&t){let s;Et(s=Dt())&&(i._allTabs=s)}},viewQuery:function(t,i){if(1&t&&(Pn(Coe,5),Pn(Eoe,5)),2&t){let r;Et(r=Dt())&&(i._tabBodyWrapper=r.first),Et(r=Dt())&&(i._tabHeader=r.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(t,i){2&t&&pn("mat-tab-group-dynamic-height",i.dynamicHeight)("mat-tab-group-inverted-header","below"===i.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[Xe([{provide:pB,useExisting:n}]),Se],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","ngClass","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","ngClass","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf","ngIfElse"],["tabTextLabel",""],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","ngClass","content","position","origin","animationDuration","preserveContent","_onCentered","_onCentering"]],template:function(t,i){1&t&&(pe(0,"mat-tab-header",0,1),gt("indexFocused",function(s){return i._focusChanged(s)})("selectFocusedIndex",function(s){return i.selectedIndex=s}),Sn(2,Poe,5,15,"div",2),Te(),pe(3,"div",3,4),Sn(5,Ioe,1,11,"mat-tab-body",5),Te()),2&t&&(Q("selectedIndex",i.selectedIndex||0)("disableRipple",i.disableRipple)("disablePagination",i.disablePagination),se(2),Q("ngForOf",i._tabs),se(1),pn("_mat-animation-noopable","NoopAnimations"===i._animationMode),se(2),Q("ngForOf",i._tabs))},dependencies:[d2,oc,$u,JT,od,ese,vB,gB,qoe],styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}"],encapsulation:2}),n})(),xB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Ya,In,nB,zv,VT,tse,In]}),n})();const{isArray:Joe}=Array;const Jv=new He("HIGHLIGHT_OPTIONS");let nae=(()=>{class n{constructor(t,i,r){this.doc=t,this._options=r,this._ready=new es(null),this.ready=this._ready.asObservable().pipe(Ui(s=>!!s),xt(s=>s),Or(1)),w2(i)&&(t.defaultView.hljs?this._ready.next(t.defaultView.hljs):this._loadLibrary().pipe(Bo(s=>this._options&&this._options.lineNumbersLoader?(t.defaultView.hljs=s,this.loadLineNumbers().pipe(Wn(()=>this._ready.next(s)))):(this._ready.next(s),yr)),eo(s=>(console.error("[HLJS] ",s),yr))).subscribe(),this._options?.themePath&&this.loadTheme(this._options.themePath))}_loadLibrary(){if(this._options){if(this._options.fullLibraryLoader&&this._options.coreLibraryLoader)return Js(()=>"The full library and the core library were imported, only one of them should be imported!");if(this._options.fullLibraryLoader&&this._options.languages)return Js(()=>"The highlighting languages were imported they are not needed!");if(this._options.coreLibraryLoader&&!this._options.languages)return Js(()=>"The highlighting languages were not imported!");if(!this._options.coreLibraryLoader&&this._options.languages)return Js(()=>"The core library was not imported!");if(this._options.fullLibraryLoader)return this.loadFullLibrary();if(this._options.coreLibraryLoader&&this._options.languages&&Object.keys(this._options.languages).length)return this.loadCoreLibrary().pipe(Bo(t=>this._loadLanguages(t)))}return Js(()=>"Highlight.js library was not imported!")}_loadLanguages(t){return function tae(...n){const e=S0(n),t=function eae(n){return 1===n.length&&Joe(n[0])?n[0]:n}(n);return t.length?new wn(i=>{let r=t.map(()=>[]),s=t.map(()=>!1);i.add(()=>{r=s=null});for(let o=0;!i.closed&&o<t.length;o++)kr(t[o]).subscribe(Jn(i,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());i.next(e?e(...l):l),r.some((c,u)=>!c.length&&s[u])&&i.complete()}},()=>{s[o]=!0,!r[o].length&&i.complete()}));return()=>{r=s=null}}):yr}(...Object.entries(this._options.languages).map(([r,s])=>ey(s()).pipe(Wn(o=>t.registerLanguage(r,o))))).pipe(xt(()=>t))}loadCoreLibrary(){return ey(this._options.coreLibraryLoader())}loadFullLibrary(){return ey(this._options.fullLibraryLoader())}loadLineNumbers(){return ey(this._options.lineNumbersLoader())}setTheme(t){this._themeLinkElement.href=t}loadTheme(t){this._themeLinkElement=this.doc.createElement("link"),this._themeLinkElement.href=t,this._themeLinkElement.type="text/css",this._themeLinkElement.rel="stylesheet",this._themeLinkElement.media="screen,print",this.doc.head.appendChild(this._themeLinkElement)}}return n.\u0275fac=function(t){return new(t||n)(re(Ut),re(_f),re(Jv,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ey=n=>vi(n).pipe(Ui(e=>!!e&&!!e.default),xt(e=>e.default));let iae=(()=>{class n{constructor(t,i){this._loader=t,this._hljs=null,t.ready.subscribe(r=>{this._hljs=r,i&&i.config&&(r.configure(i.config),r.listLanguages().length<1&&console.error("[HighlightJS]: No languages were registered!"))})}get hljs(){return this._hljs}highlight(t,{language:i,ignoreIllegals:r}){return this._loader.ready.pipe(xt(s=>s.highlight(t,{language:i,ignoreIllegals:r})))}highlightAuto(t,i){return this._loader.ready.pipe(xt(r=>r.highlightAuto(t,i)))}highlightElement(t){return this._loader.ready.pipe(xt(i=>i.highlightElement(t)))}highlightAll(){return this._loader.ready.pipe(xt(t=>t.highlightAll()))}configure(t){return this._loader.ready.pipe(xt(i=>i.configure(t)))}registerLanguage(t,i){return this._loader.ready.pipe(Wn(r=>r.registerLanguage(t,i)))}unregisterLanguage(t){return this._loader.ready.pipe(Wn(i=>i.unregisterLanguage(t)))}registerAliases(t,{languageName:i}){return this._loader.ready.pipe(Wn(r=>r.registerAliases(t,{languageName:i})))}listLanguages(){return this._loader.ready.pipe(xt(t=>t.listLanguages()))}getLanguage(t){return this._loader.ready.pipe(xt(i=>i.getLanguage(t)))}safeMode(){return this._loader.ready.pipe(xt(t=>t.safeMode()))}debugMode(){return this._loader.ready.pipe(xt(t=>t.debugMode()))}lineNumbersBlock(t){return this._loader.ready.pipe(Ui(i=>!!i.lineNumbersBlock),Wn(i=>i.lineNumbersBlock(t)))}}return n.\u0275fac=function(t){return new(t||n)(re(nae),re(Jv,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rae=(()=>{class n{constructor(t,i,r,s){this._hljs=i,this._sanitizer=r,this._options=s,this.highlighted=new yt,this._nativeElement=t.nativeElement}ngOnChanges(t){null!==t?.code?.currentValue&&t.code.currentValue!==t.code.previousValue&&(this.code?this.highlightElement(this.code,this.languages):this.setTextContent(""))}highlightElement(t,i){this.setTextContent(t),this._hljs.highlightAuto(t,i).subscribe(r=>{this.setInnerHTML(r?.value),this.lineNumbers&&this._options&&this._options.lineNumbersLoader&&this.addLineNumbers(),this.highlighted.emit(r)})}addLineNumbers(){this.destroyLineNumbersObserver(),Yv.schedule(()=>{this._hljs.lineNumbersBlock(this._nativeElement).subscribe(),this._lineNumbersObs=new MutationObserver(()=>{this._nativeElement.firstElementChild&&"TABLE"===this._nativeElement.firstElementChild.tagName.toUpperCase()&&this._nativeElement.classList.add("hljs-line-numbers"),this.destroyLineNumbersObserver()}),this._lineNumbersObs.observe(this._nativeElement,{childList:!0})})}destroyLineNumbersObserver(){this._lineNumbersObs&&(this._lineNumbersObs.disconnect(),this._lineNumbersObs=null)}setTextContent(t){Yv.schedule(()=>this._nativeElement.textContent=t)}setInnerHTML(t){Yv.schedule(()=>this._nativeElement.innerHTML=this._sanitizer.sanitize(fn.HTML,t)||"")}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(iae),N(qg),N(Jv,8))},n.\u0275dir=tt({type:n,selectors:[["","highlight",""]],hostVars:2,hostBindings:function(t,i){2&t&&pn("hljs",!0)},inputs:{code:["highlight","code"],languages:"languages",lineNumbers:"lineNumbers"},outputs:{highlighted:"highlighted"},features:[$i]}),n})(),wB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();const oae={connector:()=>new Ft};function cae(n,e,t,i){t&&!un(t)&&(i=t);const r=un(t)?t:void 0;return s=>function lae(n,e){const t=un(n)?n:()=>n;return un(e)?function aae(n,e=oae){const{connector:t}=e;return ui((i,r)=>{const s=t();vi(n(function sae(n){return new wn(e=>n.subscribe(e))}(s))).subscribe(r),r.add(i.subscribe(s))})}(e,{connector:t}):i=>new Nw(i,t)}(new mT(n,e,i),r)(s)}const uae=new He("GIST_OPTIONS");let hae=(()=>{class n{constructor(t,i){this._http=t,this._options=i}getCodeFromGist(t){let i;return this.isOAuthProvided()&&(i=(new Fa).set("client_id",this._options.clientId).set("client_secret",this._options.clientSecret)),this.fetchFile(`https://api.github.com/gists/${t}`,{params:i,responseType:"json"})}getCodeFromUrl(t){return this.fetchFile(t,{responseType:"text"})}isOAuthProvided(){return!!this._options&&!!this._options.clientId&&!!this._options.clientSecret}fetchFile(t,i){return function dae(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(n)}(t)?this._http.get(t,i).pipe(cae(1),Yg(),eo(r=>(console.error("[NgxHighlight]: Unable to fetch the URL!",r.message),yr))):yr}}return n.\u0275fac=function(t){return new(t||n)(re(Wv),re(uae,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),fae=(()=>{class n{constructor(t){this._loader=t}transform(t){return this._loader.getCodeFromUrl(t)}}return n.\u0275fac=function(t){return new(t||n)(N(hae,16))},n.\u0275pipe=Qi({name:"codeFromUrl",type:n,pure:!0}),n})(),pae=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[wB,Ase,wB]}),n})();function mae(n,e){if(1&n&&(pe(0,"mat-tab",5)(1,"pre"),Cn(2,"            "),Ye(3,"code",6),_s(4,"async"),_s(5,"codeFromUrl"),Cn(6,"\n        "),Te()()),2&n){const t=e.$implicit,i=e.index,r=ii();Q("label",r.fileNames[i]),se(3),Q("highlight",vs(4,3,vs(5,5,t)))("lineNumbers",r.lineNumbers)}}let gae=(()=>{class n{constructor(t){this.editorService=t,this.fileNames=[],this.lineNumbers=!1}set codeUrls(t){this.editorService.setUrls(t),this.fileNames=this.editorService.fileNames}get codeUrls(){return this.editorService.urls}}return n.\u0275fac=function(t){return new(t||n)(N(Ov))},n.\u0275cmp=Re({type:n,selectors:[["app-code"]],inputs:{codeUrls:"codeUrls",lineNumbers:"lineNumbers"},decls:14,vars:1,consts:[["color","accent"],[1,"code-wrapper","hljs"],["dynamicHeight","","color","primary","backgroundColor","primary"],[3,"label",4,"ngFor","ngForOf"],["href","#",1,"gist-url",3,"click"],[3,"label"],[3,"highlight","lineNumbers"]],template:function(t,i){1&t&&(pe(0,"mat-card",0)(1,"mat-card-content")(2,"div",1)(3,"mat-tab-group",2),Sn(4,mae,7,7,"mat-tab",3),Te()()(),pe(5,"mat-card-footer")(6,"a",4),gt("click",function(s){return i.editorService.toCodeSandbox(s)}),pe(7,"mat-icon"),Cn(8,"crop_din"),Te(),Cn(9," CodeSandbox "),Te(),pe(10,"a",4),gt("click",function(s){return i.editorService.toStackblitz(s)}),pe(11,"mat-icon"),Cn(12,"bolt"),Te(),Cn(13," Stackblitz "),Te()()()),2&t&&(se(4),Q("ngForOf",i.codeUrls))},dependencies:[oc,$3,Wse,Hse,Gse,$oe,mB,rae,Cw,fae],styles:["pre[_ngcontent-%COMP%]{display:flex;margin-top:0;margin-bottom:0;word-wrap:break-word}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;line-height:1.8em;font-size:14px;min-height:100%;padding:1em 1.2em}pre[_ngcontent-%COMP%]   code.hljs-line-numbers[_ngcontent-%COMP%]{padding:0}.mat-card[_ngcontent-%COMP%]{padding:0;margin-bottom:3em}.mat-card-header[_ngcontent-%COMP%]{margin:0!important;padding:0!important;display:flex;align-items:center;height:40px}.mat-card-content[_ngcontent-%COMP%]{position:relative;overflow:hidden;padding:1px;margin-bottom:0}.mat-card-footer[_ngcontent-%COMP%]{padding:10px!important;margin:0!important;display:flex;flex-direction:row-reverse}.mat-card-footer[_ngcontent-%COMP%]   .gist-url[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:300;font-size:13px;text-decoration:unset}.mat-card-footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mat-icon[_ngcontent-%COMP%]{margin:0 3px}.code-wrapper[_ngcontent-%COMP%]{border-radius:3px 3px 0 0}  .hljs{padding:0;border:none;transition:border ease 1s}  .hljs-ln{padding:10px 0}  .hljs-ln tr:first-child td{padding-top:10px!important}  .hljs-ln tr:last-child td{padding-bottom:10px!important}  td.hljs-ln-numbers{-webkit-user-select:none;user-select:none;text-align:center;color:#cccccc6b;border-right:1px solid rgba(204,204,204,.1098039216);vertical-align:top;padding-right:10px!important;padding-left:10px!important}  td.hljs-ln-code{padding-left:10px!important}"],changeDetection:0}),n})();function _ae(n,e){1&n&&Tx(0)}let vae=(()=>{class n{constructor(t,i){this.editorService=t,this.route=i,this.exampleComponent=null,this.codeUrls=this.route.snapshot.data.codeUrls??[],this.editorService.declarations=this.route.snapshot.data.declarations,this.exampleComponent=this.route.snapshot.data.exampleComponent}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(N(Ov),N(uc))},n.\u0275cmp=Re({type:n,selectors:[["app-example-page"]],decls:3,vars:3,consts:[[1,"example-container"],[4,"ngComponentOutlet"],[3,"lineNumbers","codeUrls"]],template:function(t,i){1&t&&(pe(0,"div",0),Sn(1,_ae,1,0,"ng-container",1),Te(),Ye(2,"app-code",2)),2&t&&(se(1),Q("ngComponentOutlet",i.exampleComponent),se(1),Q("lineNumbers",!0)("codeUrls",i.codeUrls))},dependencies:[f2,gae]}),n})();const yae=.5*(Math.sqrt(3)-1),Gp=(3-Math.sqrt(3))/6,Zo=1/6,xae=(Math.sqrt(5)-1)/4,rr=(5-Math.sqrt(5))/20,Zi=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),Fi=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);let Eae=(()=>{class n extends Ds{getType(){return PS}set count(t){this._objRef&&(this._objRef.count=t)}set instanceColor(t){this._objRef&&(this._objRef.instanceColor=Lt(this._objRef.instanceColor,t))}set instanceMatrix(t){this._objRef&&(this._objRef.instanceMatrix=Lt(this._objRef.instanceMatrix,t))}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-instancedMesh"]],inputs:{count:"count",instanceColor:"instanceColor",instanceMatrix:"instanceMatrix"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Dae=["canvas"],Aae=["light"],Rae=["instancedMesh"],Pae=function(){return[0,0,30]},Iae=function(){return[0,0,0]},Lae=function(){return["#808080"]},Fae=function(n){return[void 0,void 0,n]},kae=function(n,e,t){return[n,e,t]},MB=function(){return["#9C1E15"]},Oae=function(n){return[0,0,n]},Nae=function(n,e){return[n,e]};let Bae=(()=>{class n{constructor(){this.SIZE=1.5,this.NX=20,this.NY=20,this.PADDING=1,this.SIZEP=this.SIZE+this.PADDING,this.W=this.NX*this.SIZEP-this.PADDING,this.H=this.NY*this.SIZEP-this.PADDING,this.NUM_INSTANCES=this.NX*this.NY,this.dummy=new nn,this.simplex=new class wae{constructor(e=Math.random){const t="function"==typeof e?e:function Tae(n){let e=0,t=0,i=0,r=1;const s=function Cae(){let n=4022871197;return function(e){e=e.toString();for(let t=0;t<e.length;t++){n+=e.charCodeAt(t);let i=.02519603282416938*n;n=i>>>0,i-=n,i*=n,n=i>>>0,i-=n,n+=4294967296*i}return 2.3283064365386963e-10*(n>>>0)}}();return e=s(" "),t=s(" "),i=s(" "),e-=s(n),e<0&&(e+=1),t-=s(n),t<0&&(t+=1),i-=s(n),i<0&&(i+=1),function(){const o=2091639*e+2.3283064365386963e-10*r;return e=t,t=i,i=o-(r=0|o)}}(e);this.p=function Sae(n){const e=new Uint8Array(256);for(let t=0;t<256;t++)e[t]=t;for(let t=0;t<255;t++){const i=t+~~(n()*(256-t)),r=e[t];e[t]=e[i],e[i]=r}return e}(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let i=0;i<512;i++)this.perm[i]=this.p[255&i],this.permMod12[i]=this.perm[i]%12}noise2D(e,t){const i=this.permMod12,r=this.perm;let s=0,o=0,a=0;const l=(e+t)*yae,c=Math.floor(e+l),u=Math.floor(t+l),h=(c+u)*Gp,p=e-(c-h),m=t-(u-h);let g,_;p>m?(g=1,_=0):(g=0,_=1);const v=p-g+Gp,y=m-_+Gp,b=p-1+2*Gp,w=m-1+2*Gp,M=255&c,T=255&u;let x=.5-p*p-m*m;if(x>=0){const F=3*i[M+r[T]];x*=x,s=x*x*(Zi[F]*p+Zi[F+1]*m)}let E=.5-v*v-y*y;if(E>=0){const F=3*i[M+g+r[T+_]];E*=E,o=E*E*(Zi[F]*v+Zi[F+1]*y)}let R=.5-b*b-w*w;if(R>=0){const F=3*i[M+1+r[T+1]];R*=R,a=R*R*(Zi[F]*b+Zi[F+1]*w)}return 70*(s+o+a)}noise3D(e,t,i){const r=this.permMod12,s=this.perm;let o,a,l,c;const u=.3333333333333333*(e+t+i),h=Math.floor(e+u),d=Math.floor(t+u),f=Math.floor(i+u),p=(h+d+f)*Zo,v=e-(h-p),y=t-(d-p),b=i-(f-p);let w,M,T,x,E,R;v>=y?y>=b?(w=1,M=0,T=0,x=1,E=1,R=0):v>=b?(w=1,M=0,T=0,x=1,E=0,R=1):(w=0,M=0,T=1,x=1,E=0,R=1):y<b?(w=0,M=0,T=1,x=0,E=1,R=1):v<b?(w=0,M=1,T=0,x=0,E=1,R=1):(w=0,M=1,T=0,x=1,E=1,R=0);const F=v-w+Zo,V=y-M+Zo,H=b-T+Zo,j=v-x+2*Zo,q=y-E+2*Zo,I=b-R+2*Zo,U=v-1+.5,W=y-1+.5,z=b-1+.5,Y=255&h,oe=255&d,$=255&f;let me=.6-v*v-y*y-b*b;if(me<0)o=0;else{const X=3*r[Y+s[oe+s[$]]];me*=me,o=me*me*(Zi[X]*v+Zi[X+1]*y+Zi[X+2]*b)}let he=.6-F*F-V*V-H*H;if(he<0)a=0;else{const X=3*r[Y+w+s[oe+M+s[$+T]]];he*=he,a=he*he*(Zi[X]*F+Zi[X+1]*V+Zi[X+2]*H)}let Ae=.6-j*j-q*q-I*I;if(Ae<0)l=0;else{const X=3*r[Y+x+s[oe+E+s[$+R]]];Ae*=Ae,l=Ae*Ae*(Zi[X]*j+Zi[X+1]*q+Zi[X+2]*I)}let J=.6-U*U-W*W-z*z;if(J<0)c=0;else{const X=3*r[Y+1+s[oe+1+s[$+1]]];J*=J,c=J*J*(Zi[X]*U+Zi[X+1]*W+Zi[X+2]*z)}return 32*(o+a+l+c)}noise4D(e,t,i,r){const s=this.perm;let o,a,l,c,u;const h=(e+t+i+r)*xae,d=Math.floor(e+h),f=Math.floor(t+h),p=Math.floor(i+h),m=Math.floor(r+h),g=(d+f+p+m)*rr,w=e-(d-g),M=t-(f-g),T=i-(p-g),x=r-(m-g);let E=0,R=0,F=0,V=0;w>M?E++:R++,w>T?E++:F++,w>x?E++:V++,M>T?R++:F++,M>x?R++:V++,T>x?F++:V++;const H=E>=3?1:0,j=R>=3?1:0,q=F>=3?1:0,I=V>=3?1:0,U=E>=2?1:0,W=R>=2?1:0,z=F>=2?1:0,Y=V>=2?1:0,oe=E>=1?1:0,$=R>=1?1:0,me=F>=1?1:0,he=V>=1?1:0,Ae=w-H+rr,J=M-j+rr,X=T-q+rr,de=x-I+rr,Le=w-U+2*rr,_e=M-W+2*rr,st=T-z+2*rr,ue=x-Y+2*rr,fe=w-oe+3*rr,Me=M-$+3*rr,Je=T-me+3*rr,Ge=x-he+3*rr,bt=w-1+4*rr,mt=M-1+4*rr,dt=T-1+4*rr,Jt=x-1+4*rr,Wt=255&d,B=255&f,P=255&p,ae=255&m;let xe=.6-w*w-M*M-T*T-x*x;if(xe<0)o=0;else{const le=s[Wt+s[B+s[P+s[ae]]]]%32*4;xe*=xe,o=xe*xe*(Fi[le]*w+Fi[le+1]*M+Fi[le+2]*T+Fi[le+3]*x)}let Pe=.6-Ae*Ae-J*J-X*X-de*de;if(Pe<0)a=0;else{const le=s[Wt+H+s[B+j+s[P+q+s[ae+I]]]]%32*4;Pe*=Pe,a=Pe*Pe*(Fi[le]*Ae+Fi[le+1]*J+Fi[le+2]*X+Fi[le+3]*de)}let Ue=.6-Le*Le-_e*_e-st*st-ue*ue;if(Ue<0)l=0;else{const le=s[Wt+U+s[B+W+s[P+z+s[ae+Y]]]]%32*4;Ue*=Ue,l=Ue*Ue*(Fi[le]*Le+Fi[le+1]*_e+Fi[le+2]*st+Fi[le+3]*ue)}let ht=.6-fe*fe-Me*Me-Je*Je-Ge*Ge;if(ht<0)c=0;else{const le=s[Wt+oe+s[B+$+s[P+me+s[ae+he]]]]%32*4;ht*=ht,c=ht*ht*(Fi[le]*fe+Fi[le+1]*Me+Fi[le+2]*Je+Fi[le+3]*Ge)}let L=.6-bt*bt-mt*mt-dt*dt-Jt*Jt;if(L<0)u=0;else{const le=s[Wt+1+s[B+1+s[P+1+s[ae+1]]]]%32*4;L*=L,u=L*L*(Fi[le]*bt+Fi[le+1]*mt+Fi[le+2]*dt+Fi[le+3]*Jt)}return 27*(o+a+l+c+u)}},this.pointerPN={x:0,y:0}}ngOnInit(){}onRender(){this.updateLightPosition(),this.updateInstanceMatrix()}updateLightPosition(){this.light&&this.light.objRef&&(this.light.objRef.position.x=this.pointerPN.x*this.W,this.light.objRef.position.y=this.pointerPN.y*this.H)}updateInstanceMatrix(){if(!this.instancedMesh||!this.instancedMesh.objRef)return;const t=-this.W/2+this.PADDING,i=-this.H/2+this.PADDING,r=1e-4*Date.now(),s=.1*this.pointerPN.x,o=.1*this.pointerPN.y;let l,c,u,h,d,f;for(let p=0;p<this.NX;p++)for(let m=0;m<this.NY;m++)l=t+p*this.SIZEP,c=i+m*this.SIZEP,u=.005*l+s,h=.005*c+o,d=this.simplex.noise3D(u,h,r)*Math.PI,f=this.simplex.noise3D(h,u,r)*Math.PI,this.dummy.position.set(l,c,-10),this.dummy.rotation.set(d,f,0),this.dummy.updateMatrix(),this.instancedMesh?.objRef?.setMatrixAt(p*this.NY+m,this.dummy.matrix);this.instancedMesh.objRef.instanceMatrix.needsUpdate=!0}onMouseMove(t){if(!this.canvas||!this.canvas.rendererCanvas)return;const i=this.canvas.rendererCanvas.nativeElement;this.pointerPN.x=(t.clientX-i.offsetLeft+window.scrollX)/i.width*2-1,this.pointerPN.y=-(t.clientY-i.offsetTop+window.scrollY)/i.height*2+1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-instanced-mesh-example"]],viewQuery:function(t,i){if(1&t&&(Pn(Dae,5),Pn(Aae,5),Pn(Rae,5)),2&t){let r;Et(r=Dt())&&(i.canvas=r.first),Et(r=Dt())&&(i.light=r.first),Et(r=Dt())&&(i.instancedMesh=r.first)}},hostBindings:function(t,i){1&t&&gt("mousemove",function(s){return i.onMouseMove(s)},!1,Qm)},decls:15,vars:33,consts:[[3,"shadow","onRender"],["canvas",""],[3,"position","lookAt"],[3,"color"],[3,"castShadow","shadowMapHeight","shadowMapWidth"],["light",""],[3,"args","count","castShadow","receiveShadow"],["instancedMesh",""],[3,"args"],[3,"position","receiveShadow"]],template:function(t,i){1&t&&(pe(0,"th-canvas",0,1),gt("onRender",function(){return i.onRender()}),pe(2,"th-scene")(3,"th-perspectiveCamera",2),Ye(4,"th-orbitControls"),Te(),Ye(5,"th-ambientLight",3)(6,"th-pointLight",4,5),pe(8,"th-instancedMesh",6,7),Ye(10,"th-boxGeometry",8)(11,"th-meshPhongMaterial",3),Te(),pe(12,"th-mesh",9),Ye(13,"th-planeGeometry",8)(14,"th-meshPhongMaterial",3),Te()()()),2&t&&(Q("shadow",!0),se(3),Q("position",Ee(17,Pae))("lookAt",Ee(18,Iae)),se(2),Q("color",Ee(19,Lae)),se(1),Q("castShadow",!0)("shadowMapHeight",1024)("shadowMapWidth",1024),se(2),Q("args",Tn(20,Fae,i.NUM_INSTANCES))("count",i.NUM_INSTANCES)("castShadow",!0)("receiveShadow",!0),se(2),Q("args",bg(22,kae,i.SIZE,i.SIZE,i.SIZE)),se(1),Q("color",Ee(26,MB)),se(1),Q("position",Tn(27,Oae,-10-i.SIZE))("receiveShadow",!0),se(1),Q("args",ic(29,Nae,2*i.W,2*i.H)),se(1),Q("color",Ee(32,MB)))},dependencies:[Cp,Ir,Gc,qo,Eae,Ds,mr,Yh,ST,vT,ir],encapsulation:2,changeDetection:0}),n})();const jae=function(){return[2,2,2]},Uae=function(){return[1,1,1]},Vae=function(){return{color:"purple"}},zae=function(n){return[n,0,0]},Hae=function(){return[2,0,0]},Gae=function(){return[75,2,.1,1e3]},Wae=function(){return[1,1,5]};let Xae=(()=>{class n{constructor(){this.selected=!1,this.rotation=[0,0,0],this.position=[0,0,0]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-box"]],inputs:{rotation:"rotation",position:"position"},decls:3,vars:7,consts:[[3,"rotation","position","scale","onClick"],[3,"args"]],template:function(t,i){1&t&&(pe(0,"th-mesh",0),gt("onClick",function(){return i.selected=!i.selected}),Ye(1,"th-boxGeometry")(2,"th-meshBasicMaterial",1),Te()),2&t&&(Q("rotation",i.rotation)("position",i.position)("scale",i.selected?Ee(4,jae):Ee(5,Uae)),se(2),Q("args",Ee(6,Vae)))},dependencies:[Ds,BN,ST,Iv],encapsulation:2,changeDetection:0}),n})(),qae=(()=>{class n{constructor(){this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-introductory-example"]],decls:6,vars:11,consts:[[3,"onRender"],[3,"position","rotation"],[3,"args","position"]],template:function(t,i){1&t&&(pe(0,"th-canvas",0),gt("onRender",function(){return i.onBeforeRender()}),pe(1,"th-scene"),Ye(2,"app-box",1)(3,"app-box",1)(4,"th-ambientLight")(5,"th-perspectiveCamera",2),Te()()),2&t&&(se(2),Q("position",Tn(6,zae,-2))("rotation",i.rotation),se(1),Q("position",Ee(8,Hae))("rotation",i.rotation),se(2),Q("args",Ee(9,Gae))("position",Ee(10,Wae)))},dependencies:[Ir,qo,mr,ir,Xae],encapsulation:2,changeDetection:0}),n})();const Zae=function(){return[0,1,0]},Yae=function(){return[100,100,100]},Kae=function(n){return[0,0,n]},Qae=function(){return[10,10]},SB=function(){return[10,10,10]},$ae=function(){return[45,2,.1,100]},Jae=function(){return[0,0,0]};let ele=(()=>{class n{constructor(){this.assetPath1=`${Ra}DamagedHelmet.glb`,this.assetPath2=`${Ra}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-loader-example"]],decls:8,vars:22,consts:[[3,"onRender"],[3,"thStats"],["loadGLTF","",3,"url","rotation","position"],["loadGLTF","",3,"url","scale","rotation","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,i){1&t&&(pe(0,"th-canvas",0),gt("onRender",function(){return i.onBeforeRender()}),pe(1,"th-scene",1),Ye(2,"th-ambientLight"),pe(3,"th-object3D",2),Ye(4,"th-object3D",3),Te(),Ye(5,"th-gridHelper",4)(6,"th-pointLight",5)(7,"th-perspectiveCamera",6),Te()()),2&t&&(se(1),Q("thStats",!0),se(2),Q("url",i.assetPath1)("rotation",i.rotation)("position",Ee(13,Zae)),se(1),Q("url",i.assetPath2)("scale",Ee(14,Yae))("rotation",i.rotation)("position",Tn(15,Kae,-3)),se(1),Q("args",Ee(17,Qae)),se(1),Q("position",Ee(18,SB)),se(1),Q("args",Ee(19,$ae))("position",Ee(20,SB))("lookAt",Ee(21,Jae)))},dependencies:[Ir,an,Vc,Gc,qo,mr,ir,Qh,wp],encapsulation:2,changeDetection:0}),n})(),TB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})(),tle=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[TB,TB]}),n})();new C,new C,new C,new C,new C,new Ce;var iC=function(n){return URL.createObjectURL(new Blob([n],{type:"text/javascript"}))};try{URL.revokeObjectURL(iC(""))}catch{iC=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var Ln=Uint8Array,Yi=Uint16Array,Tl=Uint32Array,ld=new Ln([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),cd=new Ln([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),PB=(new Ln([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),function(n,e){for(var t=new Yi(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];var r=new Tl(t[30]);for(i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return[t,r]}),IB=PB(ld,2),ny=IB[1];IB[0][28]=258,ny[258]=28,PB(cd,0);for(var Xp=new Yi(32768),Qn=0;Qn<32768;++Qn){var Cl=(43690&Qn)>>>1|(21845&Qn)<<1;Xp[Qn]=((65280&(Cl=(61680&(Cl=(52428&Cl)>>>2|(13107&Cl)<<2))>>>4|(3855&Cl)<<4))>>>8|(255&Cl)<<8)>>>1}var Kc=new Ln(288);for(Qn=0;Qn<144;++Qn)Kc[Qn]=8;for(Qn=144;Qn<256;++Qn)Kc[Qn]=9;for(Qn=256;Qn<280;++Qn)Kc[Qn]=7;for(Qn=280;Qn<288;++Qn)Kc[Qn]=8;var iy=new Ln(32);for(Qn=0;Qn<32;++Qn)iy[Qn]=5;var cy=new Ln(0),mC=typeof TextDecoder<"u"&&new TextDecoder;try{mC.decode(cy,{stream:!0})}catch{}new fh,new C;const pd={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class Ko{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const Ple=new Cc(-1,1,1,-1,0,1),vC=new wt;vC.setAttribute("position",new $e([-1,3,0,-1,-1,0,3,-1,0],3)),vC.setAttribute("uv",new $e([0,2,0,0,2,0],2));class md{constructor(e){this._mesh=new qe(vC,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Ple)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class yC extends Ko{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Yn?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Ho.clone(e.uniforms),this.material=new Yn({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new md(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class hj extends Ko{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;let o,a;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class Ile extends Ko{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Lle{constructor(e,t){if(this.renderer=e,void 0===t){const i=e.getSize(new te);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,(t=new Nn(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===pd&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===yC&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new yC(pd),this.clock=new Sv}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==hj&&(o instanceof hj?i=!0:o instanceof Ile&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new te);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new Cc(-1,1,1,-1,0,1);const bC=new wt;bC.setAttribute("position",new $e([-1,3,0,-1,-1,0,3,-1,0],3)),bC.setAttribute("uv",new $e([0,2,0,0,2,0],2));let kle=(()=>{class n extends qh{getType(){return Lle}set renderer(t){this._objRef&&(this._objRef.renderer=t)}set renderTarget1(t){this._objRef&&(this._objRef.renderTarget1=t)}set renderTarget2(t){this._objRef&&(this._objRef.renderTarget2=t)}set writeBuffer(t){this._objRef&&(this._objRef.writeBuffer=t)}set readBuffer(t){this._objRef&&(this._objRef.readBuffer=t)}set passes(t){this._objRef&&(this._objRef.passes=t)}set copyPass(t){this._objRef&&(this._objRef.copyPass=t)}set clock(t){this._objRef&&(this._objRef.clock=t)}set renderToScreen(t){this._objRef&&(this._objRef.renderToScreen=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-effectComposerGen"]],inputs:{renderer:"renderer",renderTarget1:"renderTarget1",renderTarget2:"renderTarget2",writeBuffer:"writeBuffer",readBuffer:"readBuffer",passes:"passes",copyPass:"copyPass",clock:"clock",renderToScreen:"renderToScreen"},features:[Xe([]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),vy=(()=>{class n extends kle{constructor(t,i){super(),this.view=t,this.engineService=i}createThreeInstance(t){return t||(t=new Array(5)),t[0]=t[0]??this.engineService.renderer,t[1]=t[1]??this.initRenderTarget(),super.createThreeInstance(t)}initRenderTarget(){if(this.view.viewPort){let t,i;return this.view.viewPort instanceof gn?(t=this.view.viewPort.z,i=this.view.viewPort?.width):(t=this.view.viewPort.width,i=this.view.viewPort.height),new Nn(t,i)}}addToParent(){this._objRef&&(this.view.effectComposer=this._objRef)}removeFromParent(){this.view.effectComposer=void 0}}return n.\u0275fac=function(t){return new(t||n)(N(xl),N(zc))},n.\u0275cmp=Re({type:n,selectors:[["th-effectComposer"]],features:[Xe([]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Rl=(()=>{class n extends qh{constructor(t){super(),this.effectComposer=t}addToParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.addPass(this._objRef)}removeFromParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.removePass(this._objRef)}}return n.\u0275fac=function(t){return new(t||n)(N(vy,8))},n.\u0275cmp=Re({type:n,selectors:[["th-abs-control"]],features:[Se],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})();class Ole extends Ko{constructor(e,t,i,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ce}render(e,t,i){const r=e.autoClear;let s,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}let Qp=(()=>{class n extends Rl{getType(){return Ko}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set needsSwap(t){this._objRef&&(this._objRef.needsSwap=t)}set clear(t){this._objRef&&(this._objRef.clear=t)}set renderToScreen(t){this._objRef&&(this._objRef.renderToScreen=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-pass"]],inputs:{enabled:"enabled",needsSwap:"needsSwap",clear:"clear",renderToScreen:"renderToScreen"},features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Nle=(()=>{class n extends Qp{getType(){return Ole}set scene(t){this._objRef&&(this._objRef.scene=t)}set camera(t){this._objRef&&(this._objRef.camera=t)}set overrideMaterial(t){this._objRef&&(this._objRef.overrideMaterial=t)}set clearColor(t){this._objRef&&(this._objRef.clearColor=Lt(this._objRef.clearColor,t))}set clearAlpha(t){this._objRef&&(this._objRef.clearAlpha=t)}set clearDepth(t){this._objRef&&(this._objRef.clearDepth=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-renderPassGen"]],inputs:{scene:"scene",camera:"camera",overrideMaterial:"overrideMaterial",clearColor:"clearColor",clearAlpha:"clearAlpha",clearDepth:"clearDepth"},features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),dj=(()=>{class n extends Nle{constructor(t,i){super(t),this.effectComposer=t,this.view=i}createThreeInstance(t){return t||(t=new Array(5)),t[0]=t[0]??this.view.scene,t[1]=t[1]??this.view.camera,t[2]=t[2]??this.overrideMaterial,t[3]=t[3]??this.clearColor,t[4]=t[4]??this.clearAlpha,super.createThreeInstance(t)}ngAfterContentChecked(){!this._objRef||(this.view.scene&&this.view.scene.objRef&&(this._objRef.scene=this.view.scene.objRef),this.view.camera&&this.view.camera.objRef&&(this._objRef.camera=this.view.camera.objRef))}}return n.\u0275fac=function(t){return new(t||n)(N(vy),N(xl))},n.\u0275cmp=Re({type:n,selectors:[["th-renderPass"]],features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Qc=new mp,Hr=new C,Pl=new C,ti=new bn,fj={X:new C(1,0,0),Y:new C(0,1,0),Z:new C(0,0,1)},xC={type:"change"},pj={type:"mouseDown"},mj={type:"mouseUp",mode:null},gj={type:"objectChange"};class _j extends nn{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new Hle;this._gizmo=i,this.add(i);const r=new Gle;this._plane=r,this.add(r);const s=this;function o(v,y){let b=y;Object.defineProperty(s,v,{get:function(){return void 0!==b?b:y},set:function(w){b!==w&&(b=w,r[v]=w,i[v]=w,s.dispatchEvent({type:v+"-changed",value:w}),s.dispatchEvent(xC))}}),s[v]=y,r[v]=y,i[v]=y}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new C,l=new C,c=new bn,u=new bn,h=new C,d=new bn,f=new C,p=new C,m=new C,_=new C;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",u),o("cameraPosition",h),o("cameraQuaternion",d),o("pointStart",f),o("pointEnd",p),o("rotationAxis",m),o("rotationAngle",0),o("eye",_),this._offset=new C,this._startNorm=new C,this._endNorm=new C,this._cameraScale=new C,this._parentPosition=new C,this._parentQuaternion=new bn,this._parentQuaternionInv=new bn,this._parentScale=new C,this._worldScaleStart=new C,this._worldQuaternionInv=new bn,this._worldScale=new C,this._positionStart=new C,this._quaternionStart=new bn,this._scaleStart=new C,this._getPointer=Ble.bind(this),this._onPointerDown=Ule.bind(this),this._onPointerHover=jle.bind(this),this._onPointerMove=Vle.bind(this),this._onPointerUp=zle.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Qc.setFromCamera(e,this.camera);const t=wC(this._gizmo.picker[this.mode],Qc);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Qc.setFromCamera(e,this.camera);const t=wC(this._plane,Qc,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,pj.mode=this.mode,this.dispatchEvent(pj)}}pointerMove(e){const t=this.axis,i=this.mode,r=this.object;let s=this.space;if("scale"===i?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;Qc.setFromCamera(e,this.camera);const o=wC(this._plane,Qc,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(ti.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(Hr.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(Hr.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Pl.set(a,a,a)}else Hr.copy(this.pointStart),Pl.copy(this.pointEnd),Hr.applyQuaternion(this._worldQuaternionInv),Pl.applyQuaternion(this._worldQuaternionInv),Pl.divide(Hr),-1===t.search("X")&&(Pl.x=1),-1===t.search("Y")&&(Pl.y=1),-1===t.search("Z")&&(Pl.z=1);r.scale.copy(this._scaleStart).multiply(Pl),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(Hr.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Hr.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(fj[t]),Hr.copy(fj[t]),"local"===s&&Hr.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Hr.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(ti.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(ti.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(xC),this.dispatchEvent(gj)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(mj.mode=this.mode,this.dispatchEvent(mj)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(xC),this.dispatchEvent(gj),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Qc}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function Ble(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function jle(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n))}}function Ule(n){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function Vle(n){!this.enabled||this.pointerMove(this._getPointer(n))}function zle(n){!this.enabled||(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function wC(n,e,t){const i=e.intersectObject(n,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||t)return i[r];return!1}const yy=new fh,Un=new C(0,1,0),vj=new C(0,0,0),yj=new ot,by=new bn,xy=new bn,Qo=new C,bj=new ot,$p=new C(1,0,0),$c=new C(0,1,0),Jp=new C(0,0,1),wy=new C,em=new C,tm=new C;class Hle extends nn{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new nr({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Pi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const u=e.clone();u.color.setHex(255),u.opacity=.5;const h=e.clone();h.opacity=.25;const d=e.clone();d.color.setHex(16776960),d.opacity=.25,e.clone().color.setHex(16776960);const p=e.clone();p.color.setHex(7895160);const m=new gi(0,.04,.1,12);m.translate(0,.05,0);const g=new Xn(.08,.08,.08);g.translate(0,.04,0);const _=new wt;_.setAttribute("position",new $e([0,0,0,1,0,0],3));const v=new gi(.0075,.0075,.5,3);function y(q,I){const U=new po(q,.0075,3,64,I*Math.PI*2);return U.rotateY(Math.PI/2),U.rotateX(Math.PI/2),U}v.translate(0,.25,0);const w={X:[[new qe(m,s),[.5,0,0],[0,0,-Math.PI/2]],[new qe(m,s),[-.5,0,0],[0,0,Math.PI/2]],[new qe(v,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new qe(m,o),[0,.5,0]],[new qe(m,o),[0,-.5,0],[Math.PI,0,0]],[new qe(v,o)]],Z:[[new qe(m,a),[0,0,.5],[Math.PI/2,0,0]],[new qe(m,a),[0,0,-.5],[-Math.PI/2,0,0]],[new qe(v,a),null,[Math.PI/2,0,0]]],XYZ:[[new qe(new fo(.1,0),h.clone()),[0,0,0]]],XY:[[new qe(new Xn(.15,.15,.01),u.clone()),[.15,.15,0]]],YZ:[[new qe(new Xn(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new qe(new Xn(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},M={X:[[new qe(new gi(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new qe(new gi(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new qe(new gi(.2,0,.6,4),i),[0,.3,0]],[new qe(new gi(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new qe(new gi(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new qe(new gi(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new qe(new fo(.2,0),i)]],XY:[[new qe(new Xn(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new qe(new Xn(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new qe(new Xn(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},T={START:[[new qe(new fo(.01,2),r),null,null,null,"helper"]],END:[[new qe(new fo(.01,2),r),null,null,null,"helper"]],DELTA:[[new Mi(function b(){const q=new wt;return q.setAttribute("position",new $e([0,0,0,1,1,1],3)),q}(),r),null,null,null,"helper"]],X:[[new Mi(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Mi(_,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Mi(_,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},x={XYZE:[[new qe(y(.5,1),p),null,[0,Math.PI/2,0]]],X:[[new qe(y(.5,.5),s)]],Y:[[new qe(y(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new qe(y(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new qe(y(.75,1),d),null,[0,Math.PI/2,0]]]},E={AXIS:[[new Mi(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},R={XYZE:[[new qe(new Ca(.25,10,8),i)]],X:[[new qe(new po(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new qe(new po(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new qe(new po(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new qe(new po(.75,.1,2,24),i)]]},F={X:[[new qe(g,s),[.5,0,0],[0,0,-Math.PI/2]],[new qe(v,s),[0,0,0],[0,0,-Math.PI/2]],[new qe(g,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new qe(g,o),[0,.5,0]],[new qe(v,o)],[new qe(g,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new qe(g,a),[0,0,.5],[Math.PI/2,0,0]],[new qe(v,a),[0,0,0],[Math.PI/2,0,0]],[new qe(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new qe(new Xn(.15,.15,.01),u),[.15,.15,0]]],YZ:[[new qe(new Xn(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new qe(new Xn(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new qe(new Xn(.1,.1,.1),h.clone())]]},V={X:[[new qe(new gi(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new qe(new gi(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new qe(new gi(.2,0,.6,4),i),[0,.3,0]],[new qe(new gi(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new qe(new gi(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new qe(new gi(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new qe(new Xn(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new qe(new Xn(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new qe(new Xn(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new qe(new Xn(.2,.2,.2),i),[0,0,0]]]},H={X:[[new Mi(_,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Mi(_,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Mi(_,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function j(q){const I=new nn;for(const U in q)for(let W=q[U].length;W--;){const z=q[U][W][0].clone(),Y=q[U][W][1],oe=q[U][W][2],$=q[U][W][3],me=q[U][W][4];z.name=U,z.tag=me,Y&&z.position.set(Y[0],Y[1],Y[2]),oe&&z.rotation.set(oe[0],oe[1],oe[2]),$&&z.scale.set($[0],$[1],$[2]),z.updateMatrix();const he=z.geometry.clone();he.applyMatrix4(z.matrix),z.geometry=he,z.renderOrder=1/0,z.position.set(0,0,0),z.rotation.set(0,0,0),z.scale.set(1,1,1),I.add(z)}return I}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=j(w)),this.add(this.gizmo.rotate=j(x)),this.add(this.gizmo.scale=j(F)),this.add(this.picker.translate=j(M)),this.add(this.picker.rotate=j(R)),this.add(this.picker.scale=j(V)),this.add(this.helper.translate=j(T)),this.add(this.helper.rotate=j(E)),this.add(this.helper.scale=j(H)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:xy;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(Un.copy($p).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(Un.copy($c).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(Un.copy(Jp).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(Un.copy(Jp).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(Un.copy($p).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(Un.copy($c).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(by.copy(i),Un.copy(this.eye).applyQuaternion(ti.copy(i).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(yj.lookAt(this.eye,vj,$c)),"X"===o.name&&(ti.setFromAxisAngle($p,Math.atan2(-Un.y,Un.z)),ti.multiplyQuaternions(by,ti),o.quaternion.copy(ti)),"Y"===o.name&&(ti.setFromAxisAngle($c,Math.atan2(Un.x,Un.z)),ti.multiplyQuaternions(by,ti),o.quaternion.copy(ti)),"Z"===o.name&&(ti.setFromAxisAngle(Jp,Math.atan2(Un.y,Un.x)),ti.multiplyQuaternions(by,ti),o.quaternion.copy(ti))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.position.copy(this.worldPositionStart),o.visible=!!this.axis,"X"===this.axis&&(ti.setFromEuler(yy.set(0,0,0)),o.quaternion.copy(i).multiply(ti),Math.abs(Un.copy($p).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(ti.setFromEuler(yy.set(0,0,Math.PI/2)),o.quaternion.copy(i).multiply(ti),Math.abs(Un.copy($c).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(ti.setFromEuler(yy.set(0,Math.PI/2,0)),o.quaternion.copy(i).multiply(ti),Math.abs(Un.copy(Jp).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(ti.setFromEuler(yy.set(0,Math.PI/2,0)),Un.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(yj.lookAt(vj,Un,$c)),o.quaternion.multiply(ti),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),Hr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Hr.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(Hr),o.visible=this.dragging):(o.quaternion.copy(i),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}class Gle extends qe{constructor(){super(new Ta(1e5,1e5,2,2),new nr({visible:!1,wireframe:!0,side:io,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),wy.copy($p).applyQuaternion("local"===t?this.worldQuaternion:xy),em.copy($c).applyQuaternion("local"===t?this.worldQuaternion:xy),tm.copy(Jp).applyQuaternion("local"===t?this.worldQuaternion:xy),Un.copy(em),this.mode){case"translate":case"scale":switch(this.axis){case"X":Un.copy(this.eye).cross(wy),Qo.copy(wy).cross(Un);break;case"Y":Un.copy(this.eye).cross(em),Qo.copy(em).cross(Un);break;case"Z":Un.copy(this.eye).cross(tm),Qo.copy(tm).cross(Un);break;case"XY":Qo.copy(tm);break;case"YZ":Qo.copy(wy);break;case"XZ":Un.copy(tm),Qo.copy(em);break;case"XYZ":case"E":Qo.set(0,0,0)}break;default:Qo.set(0,0,0)}0===Qo.length()?this.quaternion.copy(this.cameraQuaternion):(bj.lookAt(Hr.set(0,0,0),Qo,Un),this.quaternion.setFromRotationMatrix(bj)),super.updateMatrixWorld(e)}}let Wle=(()=>{class n extends gr{getType(){return _j}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set camera(t){this._objRef&&(this._objRef.camera=t)}set object(t){this._objRef&&(this._objRef.object=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set axis(t){this._objRef&&(this._objRef.axis=t)}set mode(t){this._objRef&&(this._objRef.mode=t)}set translationSnap(t){this._objRef&&(this._objRef.translationSnap=t)}set rotationSnap(t){this._objRef&&(this._objRef.rotationSnap=t)}set space(t){this._objRef&&(this._objRef.space=t)}set size(t){this._objRef&&(this._objRef.size=t)}set dragging(t){this._objRef&&(this._objRef.dragging=t)}set showX(t){this._objRef&&(this._objRef.showX=t)}set showY(t){this._objRef&&(this._objRef.showY=t)}set showZ(t){this._objRef&&(this._objRef.showZ=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-transformControlsGen"]],inputs:{domElement:"domElement",camera:"camera",object:"object",enabled:"enabled",axis:"axis",mode:"mode",translationSnap:"translationSnap",rotationSnap:"rotationSnap",space:"space",size:"size",dragging:"dragging",showX:"showX",showY:"showY",showZ:"showZ",mouseButtons:"mouseButtons"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Xle=(()=>{class n extends Wle{getType(){return _j}set object(t){this._objRef&&(this._objRef.object=t,t?this._objRef.attach(t):this._objRef.detach())}addToParent(){this._objRef&&this.canvas?.scene?.objRef?.add(this._objRef)}removeFromParent(){this._objRef&&this.canvas?.scene?.objRef?.remove(this._objRef)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-transformControls"]],inputs:{object:"object"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();function ut(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const vt={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},Dn={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},Ht={x:0,y:0},cs={camera:new ot,gizmos:new ot},qn={type:"change"},wo={type:"start"},Is={type:"end"},qle=new mp,ki=new C,xj=new ot,wj=new ot,Mo=new C;class Zle extends rs{constructor(e,t,i=null){super(),ut(this,"onWindowResize",()=>{const r=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;this._tbRadius=this.calculateTbRadius(this.camera);const s=this._tbRadius/r,a=new _l(0,0,s,s).getPoints(this._curvePts),l=(new wt).setFromPoints(a);for(const c in this._gizmos.children)this._gizmos.children[c].geometry=l;this.dispatchEvent(qn)}),ut(this,"onContextMenu",r=>{if(this.enabled)for(let s=0;s<this.mouseActions.length;s++)if(2==this.mouseActions[s].mouse){r.preventDefault();break}}),ut(this,"onPointerCancel",()=>{this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=Dn.NONE}),ut(this,"onPointerDown",r=>{if(0==r.button&&r.isPrimary?(this._downValid=!0,this._downEvents.push(r),this._downStart=performance.now()):this._downValid=!1,"touch"==r.pointerType&&this._input!=Dn.CURSOR)switch(this._touchStart.push(r),this._touchCurrent.push(r),this._input){case Dn.NONE:this._input=Dn.ONE_FINGER,this.onSinglePanStart(r,"ROTATE"),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp);break;case Dn.ONE_FINGER:case Dn.ONE_FINGER_SWITCHED:this._input=Dn.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case Dn.TWO_FINGER:this._input=Dn.MULT_FINGER,this.onTriplePanStart(r)}else if("touch"!=r.pointerType&&this._input==Dn.NONE){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT"),this._mouseOp=this.getOpFromAction(r.button,s),null!=this._mouseOp&&(window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),this._input=Dn.CURSOR,this._button=r.button,this.onSinglePanStart(r,this._mouseOp))}}),ut(this,"onPointerMove",r=>{if("touch"==r.pointerType&&this._input!=Dn.CURSOR)switch(this._input){case Dn.ONE_FINGER:this.updateTouchEvent(r),this.onSinglePanMove(r,vt.ROTATE);break;case Dn.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],r)*this._devPxRatio>=this._switchSensibility){this._input=Dn.ONE_FINGER,this.updateTouchEvent(r),this.onSinglePanStart(r,"ROTATE");break}break;case Dn.TWO_FINGER:this.updateTouchEvent(r),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case Dn.MULT_FINGER:this.updateTouchEvent(r),this.onTriplePanMove(r)}else if("touch"!=r.pointerType&&this._input==Dn.CURSOR){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT");const o=this.getOpStateFromAction(this._button,s);null!=o&&this.onSinglePanMove(r,o)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],r)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}),ut(this,"onPointerUp",r=>{if("touch"==r.pointerType&&this._input!=Dn.CURSOR){const s=this._touchCurrent.length;for(let o=0;o<s;o++)if(this._touchCurrent[o].pointerId==r.pointerId){this._touchCurrent.splice(o,1),this._touchStart.splice(o,1);break}switch(this._input){case Dn.ONE_FINGER:case Dn.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Dn.NONE,this.onSinglePanEnd();break;case Dn.TWO_FINGER:this.onDoublePanEnd(r),this.onPinchEnd(r),this.onRotateEnd(r),this._input=Dn.ONE_FINGER_SWITCHED;break;case Dn.MULT_FINGER:0==this._touchCurrent.length&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Dn.NONE,this.onTriplePanEnd())}}else"touch"!=r.pointerType&&this._input==Dn.CURSOR&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=Dn.NONE,this.onSinglePanEnd(),this._button=-1);if(r.isPrimary)if(this._downValid)if(r.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(0==this._nclicks)this._nclicks=1,this._clickStart=performance.now();else{const o=r.timeStamp-this._clickStart,a=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;o<=this._maxInterval&&a<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(r)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}),ut(this,"onWheel",r=>{if(this.enabled&&this.enableZoom){let s=null;r.ctrlKey||r.metaKey?s="CTRL":r.shiftKey&&(s="SHIFT");const o=this.getOpFromAction("WHEEL",s);if(null!=o){r.preventDefault(),this.dispatchEvent(wo);const a=125;let l=r.deltaY/a,c=1;switch(l>0?c=1/this.scaleFactor:l<0&&(c=this.scaleFactor),o){case"ZOOM":if(this.updateTbState(vt.SCALE,!0),l>0?c=1/Math.pow(this.scaleFactor,l):l<0&&(c=Math.pow(this.scaleFactor,-l)),this.cursorZoom&&this.enablePan){let u;this.camera.isOrthographicCamera?u=this.unprojectOnTbPlane(this.camera,r.clientX,r.clientY,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(u=this.unprojectOnTbPlane(this.camera,r.clientX,r.clientY,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),this.applyTransformMatrix(this.scale(c,u))}else this.applyTransformMatrix(this.scale(c,this._gizmos.position));null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(qn),this.dispatchEvent(Is);break;case"FOV":if(this.camera.isPerspectiveCamera){this.updateTbState(vt.FOV,!0),0!=r.deltaX&&(l=r.deltaX/a,c=1,l>0?c=1/Math.pow(this.scaleFactor,l):l<0&&(c=Math.pow(this.scaleFactor,-l))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const u=this._v3_1.distanceTo(this._gizmos.position);let h=u/c;h=Ot.clamp(h,this.minDistance,this.maxDistance);const d=u*Math.tan(Ot.DEG2RAD*this.camera.fov*.5);let f=Ot.RAD2DEG*(2*Math.atan(d/h));f>this.maxFov?f=this.maxFov:f<this.minFov&&(f=this.minFov),c=u/(d/Math.tan(Ot.DEG2RAD*(f/2))),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._gizmos.position,!1))}null!=this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(qn),this.dispatchEvent(Is)}}}}),ut(this,"onSinglePanStart",(r,s)=>{if(this.enabled)switch(this.dispatchEvent(wo),this.setCenter(r.clientX,r.clientY),s){case"PAN":if(!this.enablePan)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(qn)),this.updateTbState(vt.PAN,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement)),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(qn));break;case"ROTATE":if(!this.enableRotate)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.updateTbState(vt.ROTATE,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Ht.x,Ht.y,this.domElement,this._tbRadius)),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr),this.dispatchEvent(qn);break;case"FOV":if(!this.camera.isPerspectiveCamera||!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(qn)),this.updateTbState(vt.FOV,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition);break;case"ZOOM":if(!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(qn)),this.updateTbState(vt.SCALE,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),ut(this,"onSinglePanMove",(r,s)=>{if(this.enabled){const o=s!=this._state;switch(this.setCenter(r.clientX,r.clientY),s){case vt.PAN:this.enablePan&&(o?(this.dispatchEvent(Is),this.dispatchEvent(wo),this.updateTbState(s,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement)),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)):(this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))));break;case vt.ROTATE:if(this.enableRotate)if(o)this.dispatchEvent(Is),this.dispatchEvent(wo),this.updateTbState(s,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Ht.x,Ht.y,this.domElement,this._tbRadius)),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0);else{this._currentCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Ht.x,Ht.y,this.domElement,this._tbRadius));const a=this._startCursorPosition.distanceTo(this._currentCursorPosition),l=this._startCursorPosition.angleTo(this._currentCursorPosition),c=Math.max(a/this._tbRadius,l);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),c)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=c,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case vt.SCALE:if(this.enableZoom)if(o)this.dispatchEvent(Is),this.dispatchEvent(wo),this.updateTbState(s,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,8*-l):l>0&&(c=Math.pow(this.scaleFactor,8*l)),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.scale(c,this._v3_1))}break;case vt.FOV:if(this.enableZoom&&this.camera.isPerspectiveCamera)if(o)this.dispatchEvent(Is),this.dispatchEvent(wo),this.updateTbState(s,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,8*-l):l>0&&(c=Math.pow(this.scaleFactor,8*l)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const u=this._v3_1.distanceTo(this._gizmos.position);let h=u/c;h=Ot.clamp(h,this.minDistance,this.maxDistance);const d=u*Math.tan(Ot.DEG2RAD*this._fovState*.5);let f=Ot.RAD2DEG*(2*Math.atan(d/h));f=Ot.clamp(f,this.minFov,this.maxFov);const p=d/Math.tan(Ot.DEG2RAD*(f/2));c=u/p,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._v3_2,!1)),ki.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(p/u),this._m4_1.makeTranslation(ki.x,ki.y,ki.z)}}this.dispatchEvent(qn)}}),ut(this,"onSinglePanEnd",()=>{if(this._state==vt.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){const s=Math.abs((this._wPrev+this._wCurr)/2),o=this;this._animationId=window.requestAnimationFrame(function(a){o.updateTbState(vt.ANIMATION_ROTATE,!0);const l=o.calculateRotationAxis(o._cursorPosPrev,o._cursorPosCurr);o.onRotationAnim(a,l,Math.min(s,o.wMax))})}else this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(qn);else this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(qn)}else(this._state==vt.PAN||this._state==vt.IDLE)&&(this.updateTbState(vt.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(qn));this.dispatchEvent(Is)}),ut(this,"onDoubleTap",r=>{if(this.enabled&&this.enablePan&&null!=this.scene){this.dispatchEvent(wo),this.setCenter(r.clientX,r.clientY);const s=this.unprojectOnObj(this.getCursorNDC(Ht.x,Ht.y,this.domElement),this.camera);if(null!=s&&this.enableAnimations){const o=this;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(a){o.updateTbState(vt.ANIMATION_FOCUS,!0),o.onFocusAnim(a,s,o._cameraMatrixState,o._gizmoMatrixState)})}else null!=s&&!this.enableAnimations&&(this.updateTbState(vt.FOCUS,!0),this.focus(s,this.scaleFactor),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(qn))}this.dispatchEvent(Is)}),ut(this,"onDoublePanStart",()=>{this.enabled&&this.enablePan&&(this.dispatchEvent(wo),this.updateTbState(vt.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement,!0)),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1))}),ut(this,"onDoublePanMove",()=>{this.enabled&&this.enablePan&&(this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=vt.PAN&&(this.updateTbState(vt.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition)),this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement,!0)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(qn))}),ut(this,"onDoublePanEnd",()=>{this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Is)}),ut(this,"onRotateStart",()=>{this.enabled&&this.enableRotate&&(this.dispatchEvent(wo),this.updateTbState(vt.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,this.camera.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}),ut(this,"onRotateMove",()=>{if(this.enabled&&this.enableRotate){let r;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=vt.ZROTATE&&(this.updateTbState(vt.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),r=this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):r=(new C).setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.zRotate(r,Ot.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation))),this.dispatchEvent(qn)}}),ut(this,"onRotateEnd",()=>{this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Is)}),ut(this,"onPinchStart",()=>{this.enabled&&this.enableZoom&&(this.dispatchEvent(wo),this.updateTbState(vt.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}),ut(this,"onPinchMove",()=>{if(this.enabled&&this.enableZoom){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);const r=12;this._state!=vt.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(vt.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),r*this._devPxRatio);const s=this._currentFingerDistance/this._startFingerDistance;let o;this.enablePan?this.camera.isOrthographicCamera?o=this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(o=this.unprojectOnTbPlane(this.camera,Ht.x,Ht.y,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):o=this._gizmos.position,this.applyTransformMatrix(this.scale(s,o)),this.dispatchEvent(qn)}}),ut(this,"onPinchEnd",()=>{this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Is)}),ut(this,"onTriplePanStart",()=>{if(this.enabled&&this.enableZoom){this.dispatchEvent(wo),this.updateTbState(vt.SCALE,!0);let r=0,s=0;const o=this._touchCurrent.length;for(let a=0;a<o;a++)r+=this._touchCurrent[a].clientX,s+=this._touchCurrent[a].clientY;this.setCenter(r/o,s/o),this._startCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),ut(this,"onTriplePanMove",()=>{if(this.enabled&&this.enableZoom){let r=0,s=0;const o=this._touchCurrent.length;for(let m=0;m<o;m++)r+=this._touchCurrent[m].clientX,s+=this._touchCurrent[m].clientY;this.setCenter(r/o,s/o);const a=8;this._currentCursorPosition.setY(.5*this.getCursorNDC(Ht.x,Ht.y,this.domElement).y);const l=this._currentCursorPosition.y-this._startCursorPosition.y;let c=1;l<0?c=1/Math.pow(this.scaleFactor,-l*a):l>0&&(c=Math.pow(this.scaleFactor,l*a)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const u=this._v3_1.distanceTo(this._gizmos.position);let h=u/c;h=Ot.clamp(h,this.minDistance,this.maxDistance);const d=u*Math.tan(Ot.DEG2RAD*this._fovState*.5);let f=Ot.RAD2DEG*(2*Math.atan(d/h));f=Ot.clamp(f,this.minFov,this.maxFov);const p=d/Math.tan(Ot.DEG2RAD*(f/2));c=u/p,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(f),this.applyTransformMatrix(this.scale(c,this._v3_2,!1)),ki.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(p/u),this._m4_1.makeTranslation(ki.x,ki.y,ki.z),this.dispatchEvent(qn)}}),ut(this,"onTriplePanEnd",()=>{this.updateTbState(vt.IDLE,!1),this.dispatchEvent(Is)}),ut(this,"setCenter",(r,s)=>{Ht.x=r,Ht.y=s}),ut(this,"initializeMouseActions",()=>{this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}),ut(this,"compareMouseAction",(r,s)=>r.operation==s.operation&&r.mouse==s.mouse&&r.key==s.key),ut(this,"setMouseAction",(r,s,o=null)=>{let u;if(!["PAN","ROTATE","ZOOM","FOV"].includes(r)||![0,1,2,"WHEEL"].includes(s)||!["CTRL","SHIFT",null].includes(o)||"WHEEL"==s&&"ZOOM"!=r&&"FOV"!=r)return!1;switch(r){case"PAN":u=vt.PAN;break;case"ROTATE":u=vt.ROTATE;break;case"ZOOM":u=vt.SCALE;break;case"FOV":u=vt.FOV}const h={operation:r,mouse:s,key:o,state:u};for(let d=0;d<this.mouseActions.length;d++)if(this.mouseActions[d].mouse==h.mouse&&this.mouseActions[d].key==h.key)return this.mouseActions.splice(d,1,h),!0;return this.mouseActions.push(h),!0}),ut(this,"unsetMouseAction",(r,s=null)=>{for(let o=0;o<this.mouseActions.length;o++)if(this.mouseActions[o].mouse==r&&this.mouseActions[o].key==s)return this.mouseActions.splice(o,1),!0;return!1}),ut(this,"getOpFromAction",(r,s)=>{let o;for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&o.key==s)return o.operation;if(null!=s)for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&null==o.key)return o.operation;return null}),ut(this,"getOpStateFromAction",(r,s)=>{let o;for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&o.key==s)return o.state;if(null!=s)for(let a=0;a<this.mouseActions.length;a++)if(o=this.mouseActions[a],o.mouse==r&&null==o.key)return o.state;return null}),ut(this,"getAngle",(r,s)=>180*Math.atan2(s.clientY-r.clientY,s.clientX-r.clientX)/Math.PI),ut(this,"updateTouchEvent",r=>{for(let s=0;s<this._touchCurrent.length;s++)if(this._touchCurrent[s].pointerId==r.pointerId){this._touchCurrent.splice(s,1,r);break}}),ut(this,"calculateAngularSpeed",(r,s,o,a)=>{const c=(a-o)/1e3;return 0==c?0:(s-r)/c}),ut(this,"calculatePointersDistance",(r,s)=>Math.sqrt(Math.pow(s.clientX-r.clientX,2)+Math.pow(s.clientY-r.clientY,2))),ut(this,"calculateRotationAxis",(r,s)=>(this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(r,s).applyQuaternion(this._quat),this._rotationAxis.normalize().clone())),ut(this,"calculateTbRadius",r=>{const s=r.position.distanceTo(this._gizmos.position);if("PerspectiveCamera"==r.type){const o=Ot.DEG2RAD*r.fov*.5,a=Math.atan(r.aspect*Math.tan(o));return Math.tan(Math.min(o,a))*s*this.radiusFactor}if("OrthographicCamera"==r.type)return Math.min(r.top,r.right)*this.radiusFactor}),ut(this,"focus",(r,s,o=1)=>{ki.copy(r).sub(this._gizmos.position).multiplyScalar(o),this._translationMatrix.makeTranslation(ki.x,ki.y,ki.z),xj.copy(this._gizmoMatrixState),this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),wj.copy(this._cameraMatrixState),this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.scale(s,this._gizmos.position)),this._gizmoMatrixState.copy(xj),this._cameraMatrixState.copy(wj)}),ut(this,"drawGrid",()=>{if(null!=this.scene){let o,a,l,c;if(this.camera.isOrthographicCamera)l=Math.max(this.camera.right-this.camera.left,this.camera.bottom-this.camera.top),c=l/20,o=l/this.camera.zoom*3,a=o/c*this.camera.zoom;else if(this.camera.isPerspectiveCamera){const u=this.camera.position.distanceTo(this._gizmos.position),h=Ot.DEG2RAD*this.camera.fov*.5,d=Math.atan(this.camera.aspect*Math.tan(h));l=Math.tan(Math.max(h,d))*u*2,c=l/20,o=3*l,a=o/c}null==this._grid&&(this._grid=new uT(o,a,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(.5*Math.PI),this.scene.add(this._grid))}}),ut(this,"dispose",()=>{-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onWheel),this.domElement.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("resize",this.onWindowResize),null!==this.scene&&this.scene.remove(this._gizmos),this.disposeGrid()}),ut(this,"disposeGrid",()=>{null!=this._grid&&null!=this.scene&&(this.scene.remove(this._grid),this._grid=null)}),ut(this,"easeOutCubic",r=>1-Math.pow(1-r,3)),ut(this,"activateGizmos",r=>{const s=this._gizmos.children[0],o=this._gizmos.children[1],a=this._gizmos.children[2];r?(s.material.setValues({opacity:1}),o.material.setValues({opacity:1}),a.material.setValues({opacity:1})):(s.material.setValues({opacity:.6}),o.material.setValues({opacity:.6}),a.material.setValues({opacity:.6}))}),ut(this,"getCursorNDC",(r,s,o)=>{const a=o.getBoundingClientRect();return this._v2_1.setX((r-a.left)/a.width*2-1),this._v2_1.setY((a.bottom-s)/a.height*2-1),this._v2_1.clone()}),ut(this,"getCursorPosition",(r,s,o)=>(this._v2_1.copy(this.getCursorNDC(r,s,o)),this._v2_1.x*=.5*(this.camera.right-this.camera.left),this._v2_1.y*=.5*(this.camera.top-this.camera.bottom),this._v2_1.clone())),ut(this,"setCamera",r=>{r.lookAt(this.target),r.updateMatrix(),"PerspectiveCamera"==r.type&&(this._fov0=r.fov,this._fovState=r.fov),this._cameraMatrixState0.copy(r.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(r.projectionMatrix),this._zoom0=r.zoom,this._zoomState=this._zoom0,this._initialNear=r.near,this._nearPos0=r.position.distanceTo(this.target)-r.near,this._nearPos=this._initialNear,this._initialFar=r.far,this._farPos0=r.position.distanceTo(this.target)-r.far,this._farPos=this._initialFar,this._up0.copy(r.up),this._upState.copy(r.up),this.camera=r,this.camera.updateProjectionMatrix(),this._tbRadius=this.calculateTbRadius(r),this.makeGizmos(this.target,this._tbRadius)}),ut(this,"makeGizmos",(r,s)=>{const a=new _l(0,0,s,s).getPoints(this._curvePts),l=(new wt).setFromPoints(a),c=new Pi({color:16744576,fog:!1,transparent:!0,opacity:.6}),u=new Pi({color:8454016,fog:!1,transparent:!0,opacity:.6}),h=new Pi({color:8421631,fog:!1,transparent:!0,opacity:.6}),d=new Mi(l,c),f=new Mi(l,u),p=new Mi(l,h),m=.5*Math.PI;if(d.rotation.x=m,f.rotation.y=m,this._gizmoMatrixState0.identity().setPosition(r),this._gizmoMatrixState.copy(this._gizmoMatrixState0),1!=this.camera.zoom){const g=1/this.camera.zoom;this._scaleMatrix.makeScale(g,g,g),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(r.x,r.y,r.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.clear(),this._gizmos.add(d),this._gizmos.add(f),this._gizmos.add(p)}),ut(this,"onFocusAnim",(r,s,o,a)=>{if(-1==this._timeStart&&(this._timeStart=r),this._state==vt.ANIMATION_FOCUS){const c=(r-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(a),c>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(s,this.scaleFactor),this._timeStart=-1,this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(qn);else{const u=this.easeOutCubic(c),h=1-u+this.scaleFactor*u;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(s,h,u),this.dispatchEvent(qn);const d=this;this._animationId=window.requestAnimationFrame(function(f){d.onFocusAnim(f,s,o,a.clone())})}}else this._animationId=-1,this._timeStart=-1}),ut(this,"onRotationAnim",(r,s,o)=>{if(-1==this._timeStart&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=r),this._state==vt.ANIMATION_ROTATE){const a=(r-this._timeStart)/1e3;if(o+-this.dampingFactor*a>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(a,2)+o*a+0,this.applyTransformMatrix(this.rotate(s,this._angleCurrent)),this.dispatchEvent(qn);const c=this;this._animationId=window.requestAnimationFrame(function(u){c.onRotationAnim(u,s,o)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(vt.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(qn)}else this._animationId=-1,this._timeStart=-1,this._state!=vt.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(qn))}),ut(this,"pan",(r,s,o=!1)=>{const a=r.clone().sub(s);if(this.camera.isOrthographicCamera)a.multiplyScalar(1/this.camera.zoom);else if(this.camera.isPerspectiveCamera&&o){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);const l=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);a.multiplyScalar(1/l)}return this._v3_1.set(a.x,a.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1),cs}),ut(this,"reset",()=>{this.camera.zoom=this._zoom0,this.camera.isPerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(qn)}),ut(this,"rotate",(r,s)=>{const o=this._gizmos.position;return this._translationMatrix.makeTranslation(-o.x,-o.y,-o.z),this._rotationMatrix.makeRotationAxis(r,-s),this._m4_1.makeTranslation(o.x,o.y,o.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),cs}),ut(this,"copyState",()=>{let r;this.camera.isOrthographicCamera?r=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}):this.camera.isPerspectiveCamera&&(r=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}})),navigator.clipboard.writeText(r)}),ut(this,"pasteState",()=>{const r=this;navigator.clipboard.readText().then(function(o){r.setStateFromJSON(o)})}),ut(this,"saveState",()=>{this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera.isPerspectiveCamera&&(this._fov0=this.camera.fov)}),ut(this,"scale",(r,s,o=!0)=>{Mo.copy(s);let a=1/r;if(this.camera.isOrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=r,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,a=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,a=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(a,a,a),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),Mo.sub(this._v3_1);const l=Mo.clone().multiplyScalar(a);return Mo.sub(l),this._m4_1.makeTranslation(Mo.x,Mo.y,Mo.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),cs}if(this.camera.isPerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let l=this._v3_1.distanceTo(Mo),c=l-l*a;const u=l-c;if(u<this.minDistance?(a=this.minDistance/l,c=l-l*a):u>this.maxDistance&&(a=this.maxDistance/l,c=l-l*a),ki.copy(Mo).sub(this._v3_1).normalize().multiplyScalar(c),this._m4_1.makeTranslation(ki.x,ki.y,ki.z),o){const h=this._v3_2;l=h.distanceTo(Mo),c=l-l*a,ki.copy(Mo).sub(this._v3_2).normalize().multiplyScalar(c),this._translationMatrix.makeTranslation(h.x,h.y,h.z),this._scaleMatrix.makeScale(a,a,a),this._m4_2.makeTranslation(ki.x,ki.y,ki.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-h.x,-h.y,-h.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return cs}}),ut(this,"setFov",r=>{this.camera.isPerspectiveCamera&&(this.camera.fov=Ot.clamp(r,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}),ut(this,"zRotate",(r,s)=>(this._rotationMatrix.makeRotationAxis(this._rotationAxis,s),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._m4_1.makeTranslation(r.x,r.y,r.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(r),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,s),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),cs)),ut(this,"unprojectOnObj",(r,s)=>{const o=this.getRaycaster();o.near=s.near,o.far=s.far,o.setFromCamera(r,s);const a=o.intersectObjects(this.scene.children,!0);for(let l=0;l<a.length;l++)if(a[l].object.uuid!=this._gizmos.uuid&&null!=a[l].face)return a[l].point.clone();return null}),ut(this,"unprojectOnTbSurface",(r,s,o,a,l)=>{if("OrthographicCamera"==r.type){this._v2_1.copy(this.getCursorPosition(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);const c=Math.pow(this._v2_1.x,2),u=Math.pow(this._v2_1.y,2),h=Math.pow(this._tbRadius,2);return this._v3_1.setZ(c+u<=.5*h?Math.sqrt(h-(c+u)):.5*h/Math.sqrt(c+u)),this._v3_1}if("PerspectiveCamera"==r.type){this._v2_1.copy(this.getCursorNDC(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(r.projectionMatrixInverse);const c=this._v3_1.clone().normalize(),u=r.position.distanceTo(this._gizmos.position),h=Math.pow(l,2),d=this._v3_1.z,f=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(0==f)return c.set(this._v3_1.x,this._v3_1.y,l),c;const p=d/f,m=u;let g=Math.pow(p,2)+1,_=2*p*m,v=Math.pow(m,2)-h,y=Math.pow(_,2)-4*g*v;if(y>=0&&(this._v2_1.setX((-_-Math.sqrt(y))/(2*g)),this._v2_1.setY(p*this._v2_1.x+m),Ot.RAD2DEG*this._v2_1.angle()>=45)){const M=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(u-this._v2_1.y,2));return c.multiplyScalar(M),c.z+=u,c}g=p,_=m,v=.5*-h,y=Math.pow(_,2)-4*g*v,this._v2_1.setX((-_-Math.sqrt(y))/(2*g)),this._v2_1.setY(p*this._v2_1.x+m);const b=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(u-this._v2_1.y,2));return c.multiplyScalar(b),c.z+=u,c}}),ut(this,"unprojectOnTbPlane",(r,s,o,a,l=!1)=>{if("OrthographicCamera"==r.type)return this._v2_1.copy(this.getCursorPosition(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if("PerspectiveCamera"==r.type){this._v2_1.copy(this.getCursorNDC(s,o,a)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(r.projectionMatrixInverse);const c=this._v3_1.clone().normalize(),u=this._v3_1.z,h=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));let d;if(d=l?this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):r.position.distanceTo(this._gizmos.position),0==h)return c.set(0,0,0),c;const m=-d/(u/h),g=Math.sqrt(Math.pow(d,2)+Math.pow(m,2));return c.multiplyScalar(g),c.z=0,c}}),ut(this,"updateMatrixState",()=>{this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera.isOrthographicCamera?(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom):this.camera.isPerspectiveCamera&&(this._fovState=this.camera.fov)}),ut(this,"updateTbState",(r,s)=>{this._state=r,s&&this.updateMatrixState()}),ut(this,"update",()=>{if(!1===this.target.equals(this._currentTarget)&&(this._gizmos.position.copy(this.target),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)),this.camera.isOrthographicCamera){if(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom){const s=Ot.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.scale(s/this.camera.zoom,this._gizmos.position,!0))}}else if(this.camera.isPerspectiveCamera){const s=this.camera.position.distanceTo(this._gizmos.position);if(s>this.maxDistance+1e-6||s<this.minDistance-1e-6){const a=Ot.clamp(s,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.scale(a/s,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=Ot.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());const o=this._tbRadius;if(this._tbRadius=this.calculateTbRadius(this.camera),o<this._tbRadius-1e-6||o>this._tbRadius+1e-6){const l=this._tbRadius/((this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3),u=new _l(0,0,l,l).getPoints(this._curvePts),h=(new wt).setFromPoints(u);for(const d in this._gizmos.children)this._gizmos.children[d].geometry=h}}this.camera.lookAt(this._gizmos.position)}),ut(this,"setStateFromJSON",r=>{const s=JSON.parse(r);if(null!=s.arcballState){this._cameraMatrixState.fromArray(s.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(s.arcballState.cameraUp),this.camera.near=s.arcballState.cameraNear,this.camera.far=s.arcballState.cameraFar,this.camera.zoom=s.arcballState.cameraZoom,this.camera.isPerspectiveCamera&&(this.camera.fov=s.arcballState.cameraFov),this._gizmoMatrixState.fromArray(s.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera);const o=(new ot).copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(o),this.camera.lookAt(this._gizmos.position),this.updateTbState(vt.IDLE,!1),this.dispatchEvent(qn)}}),this.camera=null,this.domElement=t,this.scene=i,this.target=new C,this._currentTarget=new C,this.radiusFactor=.67,this.mouseActions=[],this._mouseOp=null,this._v2_1=new te,this._v3_1=new C,this._v3_2=new C,this._m4_1=new ot,this._m4_2=new ot,this._quat=new bn,this._translationMatrix=new ot,this._rotationMatrix=new ot,this._scaleMatrix=new ot,this._rotationAxis=new C,this._cameraMatrixState=new ot,this._cameraProjectionState=new ot,this._fovState=1,this._upState=new C,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new ot,this._up0=new C,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new ot,this._gizmoMatrixState0=new ot,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=Dn.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._downStart=0,this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new C,this._startCursorPosition=new C,this._grid=null,this._gridPosition=new C,this._gizmos=new Wo,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new C,this._cursorPosCurr=new C,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.enableGizmos=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this._tbRadius=1,this._state=vt.IDLE,this.setCamera(e),null!=this.scene&&this.scene.add(this._gizmos),this.domElement.style.touchAction="none",this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("wheel",this.onWheel),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),window.addEventListener("resize",this.onWindowResize)}applyTransformMatrix(e){if(null!=e.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==vt.ROTATE||this._state==vt.ZROTATE||this._state==vt.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),null!=e.gizmos&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),this._state==vt.SCALE||this._state==vt.FOCUS||this._state==vt.ANIMATION_FOCUS)if(this._tbRadius=this.calculateTbRadius(this.camera),this.adjustNearFar){const t=this.camera.position.distanceTo(this._gizmos.position),i=new zo;i.setFromObject(this._gizmos);const r=new ba;i.getBoundingSphere(r);const s=Math.max(this._nearPos0,r.radius+r.center.length()),a=Math.min(s,t-this._initialNear);this.camera.near=t-a;const l=Math.min(this._farPos0,-r.radius+r.center.length()),u=Math.min(l,t-this._initialFar);this.camera.far=t-u,this.camera.updateProjectionMatrix()}else{let t=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,t=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,t=!0),t&&this.camera.updateProjectionMatrix()}}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(qn)}setTbRadius(e){this.radiusFactor=e,this._tbRadius=this.calculateTbRadius(this.camera);const i=new _l(0,0,this._tbRadius,this._tbRadius).getPoints(this._curvePts),r=(new wt).setFromPoints(i);for(const s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(qn)}setTransformationMatrices(e=null,t=null){null!=e?null!=cs.camera?cs.camera.copy(e):cs.camera=e.clone():cs.camera=null,null!=t?null!=cs.gizmos?cs.gizmos.copy(t):cs.gizmos=t.clone():cs.gizmos=null}getRaycaster(){return qle}}let Yle=(()=>{class n extends gr{getType(){return Zle}set camera(t){this._objRef&&(this._objRef.camera=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set scene(t){this._objRef&&(this._objRef.scene=t)}set focusAnimationTime(t){this._objRef&&(this._objRef.focusAnimationTime=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set enablePan(t){this._objRef&&(this._objRef.enablePan=t)}set enableRotate(t){this._objRef&&(this._objRef.enableRotate=t)}set enableZoom(t){this._objRef&&(this._objRef.enableZoom=t)}set enableGizmos(t){this._objRef&&(this._objRef.enableGizmos=t)}set adjustNearFar(t){this._objRef&&(this._objRef.adjustNearFar=t)}set scaleFactor(t){this._objRef&&(this._objRef.scaleFactor=t)}set dampingFactor(t){this._objRef&&(this._objRef.dampingFactor=t)}set wMax(t){this._objRef&&(this._objRef.wMax=t)}set enableAnimations(t){this._objRef&&(this._objRef.enableAnimations=t)}set enableGrid(t){this._objRef&&(this._objRef.enableGrid=t)}set cursorZoom(t){this._objRef&&(this._objRef.cursorZoom=t)}set minFov(t){this._objRef&&(this._objRef.minFov=t)}set maxFov(t){this._objRef&&(this._objRef.maxFov=t)}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set minZoom(t){this._objRef&&(this._objRef.minZoom=t)}set maxZoom(t){this._objRef&&(this._objRef.maxZoom=t)}set target(t){this._objRef&&(this._objRef.target=Lt(this._objRef.target,t))}set radiusFactor(t){this._objRef&&(this._objRef.radiusFactor=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-arcballControls"]],inputs:{camera:"camera",domElement:"domElement",scene:"scene",focusAnimationTime:"focusAnimationTime",enabled:"enabled",enablePan:"enablePan",enableRotate:"enableRotate",enableZoom:"enableZoom",enableGizmos:"enableGizmos",adjustNearFar:"adjustNearFar",scaleFactor:"scaleFactor",dampingFactor:"dampingFactor",wMax:"wMax",enableAnimations:"enableAnimations",enableGrid:"enableGrid",cursorZoom:"cursorZoom",minFov:"minFov",maxFov:"maxFov",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",target:"target",radiusFactor:"radiusFactor"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const MC={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new te(.001953125,0)},cKernel:{value:[]}},vertexShader:"\n\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float cKernel[ KERNEL_SIZE_INT ];\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec2 uImageIncrement;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 imageCoord = vUv;\n\t\t\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {\n\n\t\t\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];\n\t\t\t\timageCoord += uImageIncrement;\n\n\t\t\t}\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}",buildKernel:function(n){let t=2*Math.ceil(3*n)+1;t>25&&(t=25);const i=.5*(t-1),r=new Array(t);let s=0;for(let o=0;o<t;++o)r[o]=Kle(o-i,n),s+=r[o];for(let o=0;o<t;++o)r[o]/=s;return r}};function Kle(n,e){return Math.exp(-n*n/(2*e*e))}class gd extends Ko{constructor(e=1,t=25,i=4,r=256){super(),this.renderTargetX=new Nn(r,r),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Nn(r,r),this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=Ho.clone(SC.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Yn({uniforms:this.combineUniforms,vertexShader:SC.vertexShader,fragmentShader:SC.fragmentShader,blending:ih,transparent:!0}),void 0===MC&&console.error("THREE.BloomPass relies on ConvolutionShader");const s=MC;this.convolutionUniforms=Ho.clone(s.uniforms),this.convolutionUniforms.uImageIncrement.value=gd.blurX,this.convolutionUniforms.cKernel.value=MC.buildKernel(i),this.materialConvolution=new Yn({uniforms:this.convolutionUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new md(null)}render(e,t,i,r,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=i.texture,this.convolutionUniforms.uImageIncrement.value=gd.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=gd.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.clear&&e.clear(),this.fsQuad.render(e)}}const SC={uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float strength;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = strength * texel;\n\n\t\t}"};gd.blurX=new te(.001953125,0),gd.blurY=new te(0,.001953125),new C,new aN,new Go,new C,new as;const Cj={uniforms:{tDiffuse:{value:null},tSize:{value:new te(256,256)},center:{value:new te(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform vec2 center;\n\t\tuniform float angle;\n\t\tuniform float scale;\n\t\tuniform vec2 tSize;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tfloat pattern() {\n\n\t\t\tfloat s = sin( angle ), c = cos( angle );\n\n\t\t\tvec2 tex = vUv * tSize - center;\n\t\t\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;\n\n\t\t\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec4 color = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat average = ( color.r + color.g + color.b ) / 3.0;\n\n\t\t\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );\n\n\t\t}"},_d=new Go,Il=new mp,nm=new te,Ej=new C,Ty=new C,EC=new C,Dj=new ot;class ece extends rs{constructor(e,t,i){super(),i.style.touchAction="none";let r=null,s=null;const o=[],a=this;function l(){i.addEventListener("pointermove",f),i.addEventListener("pointerdown",p),i.addEventListener("pointerup",m),i.addEventListener("pointerleave",m)}function c(){i.removeEventListener("pointermove",f),i.removeEventListener("pointerdown",p),i.removeEventListener("pointerup",m),i.removeEventListener("pointerleave",m),i.style.cursor=""}function f(_){if(!1!==a.enabled){if(g(_),Il.setFromCamera(nm,t),r)return Il.ray.intersectPlane(_d,Ty)&&r.position.copy(Ty.sub(Ej).applyMatrix4(Dj)),void a.dispatchEvent({type:"drag",object:r});if("mouse"===_.pointerType||"pen"===_.pointerType)if(o.length=0,Il.setFromCamera(nm,t),Il.intersectObjects(e,!0,o),o.length>0){const v=o[0].object;_d.setFromNormalAndCoplanarPoint(t.getWorldDirection(_d.normal),EC.setFromMatrixPosition(v.matrixWorld)),s!==v&&null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),i.style.cursor="auto",s=null),s!==v&&(a.dispatchEvent({type:"hoveron",object:v}),i.style.cursor="pointer",s=v)}else null!==s&&(a.dispatchEvent({type:"hoveroff",object:s}),i.style.cursor="auto",s=null)}}function p(_){!1!==a.enabled&&(g(_),o.length=0,Il.setFromCamera(nm,t),Il.intersectObjects(e,!0,o),o.length>0&&(r=!0===a.transformGroup?e[0]:o[0].object,_d.setFromNormalAndCoplanarPoint(t.getWorldDirection(_d.normal),EC.setFromMatrixPosition(r.matrixWorld)),Il.ray.intersectPlane(_d,Ty)&&(Dj.copy(r.parent.matrixWorld).invert(),Ej.copy(Ty).sub(EC.setFromMatrixPosition(r.matrixWorld))),i.style.cursor="move",a.dispatchEvent({type:"dragstart",object:r})))}function m(){!1!==a.enabled&&(r&&(a.dispatchEvent({type:"dragend",object:r}),r=null),i.style.cursor=s?"pointer":"auto")}function g(_){const v=i.getBoundingClientRect();nm.x=(_.clientX-v.left)/v.width*2-1,nm.y=-(_.clientY-v.top)/v.height*2+1}l(),this.enabled=!0,this.transformGroup=!1,this.activate=l,this.deactivate=c,this.dispose=function u(){c()},this.getObjects=function h(){return e},this.getRaycaster=function d(){return Il}}}let tce=(()=>{class n extends gr{getType(){return ece}set object(t){this._objRef&&(this._objRef.object=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set transformGroup(t){this._objRef&&(this._objRef.transformGroup=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-dragControls"]],inputs:{object:"object",enabled:"enabled",transformGroup:"transformGroup"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Aj={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\t// control parameter\n\t\tuniform float time;\n\n\t\tuniform bool grayscale;\n\n\t\t// noise effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float nIntensity;\n\n\t\t// scanlines effect intensity value (0 = no effect, 1 = full effect)\n\t\tuniform float sIntensity;\n\n\t\t// scanlines effect count value (0 = no effect, 4096 = full effect)\n\t\tuniform float sCount;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t// sample the source\n\t\t\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );\n\n\t\t// make some noise\n\t\t\tfloat dx = rand( vUv + time );\n\n\t\t// add noise\n\t\t\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );\n\n\t\t// get us a sine and cosine\n\t\t\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\n\n\t\t// add scanlines\n\t\t\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\n\n\t\t// interpolate between source and result by intensity\n\t\t\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\n\n\t\t// convert to grayscale if desired\n\t\t\tif( grayscale ) {\n\n\t\t\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n\n\t\t\t}\n\n\t\t\tgl_FragColor =  vec4( cResult, cTextureScreen.a );\n\n\t\t}"};class nce extends Ko{constructor(e,t,i,r){super(),void 0===Aj&&console.error("THREE.FilmPass relies on FilmShader");const s=Aj;this.uniforms=Ho.clone(s.uniforms),this.material=new Yn({uniforms:this.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==t&&(this.uniforms.sIntensity.value=t),void 0!==i&&(this.uniforms.sCount.value=i),this.fsQuad=new md(this.material)}render(e,t,i,r){this.uniforms.tDiffuse.value=i.texture,this.uniforms.time.value+=r,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}}let ice=(()=>{class n extends Qp{getType(){return nce}set uniforms(t){this._objRef&&Object.assign(this._objRef.uniforms,t)}set material(t){this._objRef&&(this._objRef.material=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-filmPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Rj=new C,DC=new Tv,AC=new C;class rce{constructor(e,t){void 0===t&&(console.warn('THREE.FirstPersonControls: The second parameter "domElement" is now mandatory.'),t=document),this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let i=0,r=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(h){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(h.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(h){if(this.activeLook)switch(h.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(h){this.domElement===document?(this.mouseX=h.pageX-this.viewHalfX,this.mouseY=h.pageY-this.viewHalfY):(this.mouseX=h.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=h.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(h){switch(h.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}},this.onKeyUp=function(h){switch(h.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}},this.lookAt=function(h,d,f){return h.isVector3?AC.copy(h):AC.set(h,d,f),this.object.lookAt(AC),u(this),this},this.update=function(){const h=new C;return function(f){if(!1===this.enabled)return;if(this.heightSpeed){const w=Ot.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=f*(w*this.heightCoef)}else this.autoSpeedFactor=0;const p=f*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(p+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(p),this.moveLeft&&this.object.translateX(-p),this.moveRight&&this.object.translateX(p),this.moveUp&&this.object.translateY(p),this.moveDown&&this.object.translateY(-p);let m=f*this.lookSpeed;this.activeLook||(m=0);let g=1;this.constrainVertical&&(g=Math.PI/(this.verticalMax-this.verticalMin)),r-=this.mouseX*m,this.lookVertical&&(i-=this.mouseY*m*g),i=Math.max(-85,Math.min(85,i));let _=Ot.degToRad(90-i);const v=Ot.degToRad(r);this.constrainVertical&&(_=Ot.mapLinear(_,0,Math.PI,this.verticalMin,this.verticalMax));const y=this.object.position;h.setFromSphericalCoords(1,_,v).add(y),this.object.lookAt(h)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",Pj),this.domElement.removeEventListener("mousedown",o),this.domElement.removeEventListener("mousemove",s),this.domElement.removeEventListener("mouseup",a),window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)};const s=this.onMouseMove.bind(this),o=this.onMouseDown.bind(this),a=this.onMouseUp.bind(this),l=this.onKeyDown.bind(this),c=this.onKeyUp.bind(this);function u(h){const d=h.object.quaternion;Rj.set(0,0,-1).applyQuaternion(d),DC.setFromVector3(Rj),i=90-Ot.radToDeg(DC.phi),r=Ot.radToDeg(DC.theta)}this.domElement.addEventListener("contextmenu",Pj),this.domElement.addEventListener("mousemove",s),this.domElement.addEventListener("mousedown",o),this.domElement.addEventListener("mouseup",a),window.addEventListener("keydown",l),window.addEventListener("keyup",c),this.handleResize(),u(this)}}function Pj(n){n.preventDefault()}let sce=(()=>{class n extends gr{getType(){return rce}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set movementSpeed(t){this._objRef&&(this._objRef.movementSpeed=t)}set lookSpeed(t){this._objRef&&(this._objRef.lookSpeed=t)}set lookVertical(t){this._objRef&&(this._objRef.lookVertical=t)}set autoForward(t){this._objRef&&(this._objRef.autoForward=t)}set activeLook(t){this._objRef&&(this._objRef.activeLook=t)}set heightSpeed(t){this._objRef&&(this._objRef.heightSpeed=t)}set heightCoef(t){this._objRef&&(this._objRef.heightCoef=t)}set heightMin(t){this._objRef&&(this._objRef.heightMin=t)}set heightMax(t){this._objRef&&(this._objRef.heightMax=t)}set constrainVertical(t){this._objRef&&(this._objRef.constrainVertical=t)}set verticalMin(t){this._objRef&&(this._objRef.verticalMin=t)}set verticalMax(t){this._objRef&&(this._objRef.verticalMax=t)}set mouseDragOn(t){this._objRef&&(this._objRef.mouseDragOn=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-firstPersonControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",movementSpeed:"movementSpeed",lookSpeed:"lookSpeed",lookVertical:"lookVertical",autoForward:"autoForward",activeLook:"activeLook",heightSpeed:"heightSpeed",heightCoef:"heightCoef",heightMin:"heightMin",heightMax:"heightMax",constrainVertical:"constrainVertical",verticalMin:"verticalMin",verticalMax:"verticalMax",mouseDragOn:"mouseDragOn"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const oce={type:"change"};class ace extends rs{constructor(e,t){super(),void 0===t&&(console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.'),t=document),this.object=e,this.domElement=t,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const i=this,r=1e-6,s=new bn,o=new C;this.tmpQuaternion=new bn,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new C(0,0,0),this.rotationVector=new C(0,0,0),this.keydown=function(d){if(!d.altKey){switch(d.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(d){switch(d.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(d){if(this.dragToLook)this.mouseStatus++;else{switch(d.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(d){if(!this.dragToLook||this.mouseStatus>0){const f=this.getContainerDimensions(),p=f.size[0]/2,m=f.size[1]/2;this.moveState.yawLeft=-(d.pageX-f.offset[0]-p)/p,this.moveState.pitchDown=(d.pageY-f.offset[1]-m)/m,this.updateRotationVector()}},this.mouseup=function(d){if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(d.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(d){const f=d*i.movementSpeed,p=d*i.rollSpeed;i.object.translateX(i.moveVector.x*f),i.object.translateY(i.moveVector.y*f),i.object.translateZ(i.moveVector.z*f),i.tmpQuaternion.set(i.rotationVector.x*p,i.rotationVector.y*p,i.rotationVector.z*p,1).normalize(),i.object.quaternion.multiply(i.tmpQuaternion),(o.distanceToSquared(i.object.position)>r||8*(1-s.dot(i.object.quaternion))>r)&&(i.dispatchEvent(oce),s.copy(i.object.quaternion),o.copy(i.object.position))},this.updateMovementVector=function(){const d=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-d+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",Ij),this.domElement.removeEventListener("mousedown",l),this.domElement.removeEventListener("mousemove",a),this.domElement.removeEventListener("mouseup",c),window.removeEventListener("keydown",u),window.removeEventListener("keyup",h)};const a=this.mousemove.bind(this),l=this.mousedown.bind(this),c=this.mouseup.bind(this),u=this.keydown.bind(this),h=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",Ij),this.domElement.addEventListener("mousemove",a),this.domElement.addEventListener("mousedown",l),this.domElement.addEventListener("mouseup",c),window.addEventListener("keydown",u),window.addEventListener("keyup",h),this.updateMovementVector(),this.updateRotationVector()}}function Ij(n){n.preventDefault()}let lce=(()=>{class n extends gr{getType(){return ace}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set movementSpeed(t){this._objRef&&(this._objRef.movementSpeed=t)}set rollSpeed(t){this._objRef&&(this._objRef.rollSpeed=t)}set dragToLook(t){this._objRef&&(this._objRef.dragToLook=t)}set autoForward(t){this._objRef&&(this._objRef.autoForward=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-flyControls"]],inputs:{object:"object",domElement:"domElement",movementSpeed:"movementSpeed",rollSpeed:"rollSpeed",dragToLook:"dragToLook",autoForward:"autoForward"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Lj={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tfloat disp = texture2D(tDisp, p*seed*seed).r;\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=disp*seed_x*(seed/5.);\n\t\t\t\tp.y+=disp*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"};class cce extends Ko{constructor(e=64){super(),void 0===Lj&&console.error("THREE.GlitchPass relies on DigitalGlitch");const t=Lj;this.uniforms=Ho.clone(t.uniforms),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new Yn({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new md(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,i){!1===e.capabilities.isWebGL2&&(this.uniforms.tDisp.value.format=vM),this.uniforms.tDiffuse.value=i.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=Ot.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=Ot.randFloat(-1,1),this.uniforms.seed_y.value=Ot.randFloat(-1,1),this.uniforms.distortion_x.value=Ot.randFloat(0,1),this.uniforms.distortion_y.value=Ot.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=Ot.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=Ot.randFloat(0,1),this.uniforms.distortion_y.value=Ot.randFloat(0,1),this.uniforms.seed_x.value=Ot.randFloat(-.3,.3),this.uniforms.seed_y.value=Ot.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=Ot.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),i=e*e;for(let s=0;s<i;s++){const o=Ot.randFloat(0,1);t[s]=o}const r=new Ac(t,e,e,yM,so);return r.needsUpdate=!0,r}}let uce=(()=>{class n extends Qp{getType(){return cce}set uniforms(t){this._objRef&&Object.assign(this._objRef.uniforms,t)}set material(t){this._objRef&&(this._objRef.material=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}set goWild(t){this._objRef&&(this._objRef.goWild=t)}set curF(t){this._objRef&&(this._objRef.curF=t)}set randX(t){this._objRef&&(this._objRef.randX=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-glitchPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad",goWild:"goWild",curF:"curF",randX:"randX"},features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();Math,Math,Math;class RC{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,i){return e[0]*t+e[1]*i}dot3(e,t,i,r){return e[0]*t+e[1]*i+e[2]*r}dot4(e,t,i,r,s){return e[0]*t+e[1]*i+e[2]*r+e[3]*s}noise(e,t){let i,r,s;const a=(e+t)*(.5*(Math.sqrt(3)-1)),l=Math.floor(e+a),c=Math.floor(t+a),u=(3-Math.sqrt(3))/6,h=(l+c)*u,p=e-(l-h),m=t-(c-h);let g,_;p>m?(g=1,_=0):(g=0,_=1);const v=p-g+u,y=m-_+u,b=p-1+2*u,w=m-1+2*u,M=255&l,T=255&c,E=this.perm[M+g+this.perm[T+_]]%12,R=this.perm[M+1+this.perm[T+1]]%12;let F=.5-p*p-m*m;F<0?i=0:(F*=F,i=F*F*this.dot(this.grad3[this.perm[M+this.perm[T]]%12],p,m));let V=.5-v*v-y*y;V<0?r=0:(V*=V,r=V*V*this.dot(this.grad3[E],v,y));let H=.5-b*b-w*w;return H<0?s=0:(H*=H,s=H*H*this.dot(this.grad3[R],b,w)),70*(i+r+s)}noise3d(e,t,i){let r,s,o,a;const c=.3333333333333333*(e+t+i),u=Math.floor(e+c),h=Math.floor(t+c),d=Math.floor(i+c),f=1/6,p=(u+h+d)*f,v=e-(u-p),y=t-(h-p),b=i-(d-p);let w,M,T,x,E,R;v>=y?y>=b?(w=1,M=0,T=0,x=1,E=1,R=0):v>=b?(w=1,M=0,T=0,x=1,E=0,R=1):(w=0,M=0,T=1,x=1,E=0,R=1):y<b?(w=0,M=0,T=1,x=0,E=1,R=1):v<b?(w=0,M=1,T=0,x=0,E=1,R=1):(w=0,M=1,T=0,x=1,E=1,R=0);const F=v-w+f,V=y-M+f,H=b-T+f,j=v-x+2*f,q=y-E+2*f,I=b-R+2*f,U=v-1+.5,W=y-1+.5,z=b-1+.5,Y=255&u,oe=255&h,$=255&d,he=this.perm[Y+w+this.perm[oe+M+this.perm[$+T]]]%12,Ae=this.perm[Y+x+this.perm[oe+E+this.perm[$+R]]]%12,J=this.perm[Y+1+this.perm[oe+1+this.perm[$+1]]]%12;let X=.6-v*v-y*y-b*b;X<0?r=0:(X*=X,r=X*X*this.dot3(this.grad3[this.perm[Y+this.perm[oe+this.perm[$]]]%12],v,y,b));let de=.6-F*F-V*V-H*H;de<0?s=0:(de*=de,s=de*de*this.dot3(this.grad3[he],F,V,H));let Le=.6-j*j-q*q-I*I;Le<0?o=0:(Le*=Le,o=Le*Le*this.dot3(this.grad3[Ae],j,q,I));let _e=.6-U*U-W*W-z*z;return _e<0?a=0:(_e*=_e,a=_e*_e*this.dot3(this.grad3[J],U,W,z)),32*(r+s+o+a)}noise4d(e,t,i,r){const s=this.grad4,o=this.simplex,a=this.perm,l=(Math.sqrt(5)-1)/4,c=(5-Math.sqrt(5))/20;let u,h,d,f,p;const m=(e+t+i+r)*l,g=Math.floor(e+m),_=Math.floor(t+m),v=Math.floor(i+m),y=Math.floor(r+m),b=(g+_+v+y)*c,E=e-(g-b),R=t-(_-b),F=i-(v-b),V=r-(y-b),z=(E>R?32:0)+(E>F?16:0)+(R>F?8:0)+(E>V?4:0)+(R>V?2:0)+(F>V?1:0),Y=o[z][0]>=3?1:0,oe=o[z][1]>=3?1:0,$=o[z][2]>=3?1:0,me=o[z][3]>=3?1:0,he=o[z][0]>=2?1:0,Ae=o[z][1]>=2?1:0,J=o[z][2]>=2?1:0,X=o[z][3]>=2?1:0,de=o[z][0]>=1?1:0,Le=o[z][1]>=1?1:0,_e=o[z][2]>=1?1:0,st=o[z][3]>=1?1:0,ue=E-Y+c,fe=R-oe+c,Me=F-$+c,Je=V-me+c,Ge=E-he+2*c,bt=R-Ae+2*c,mt=F-J+2*c,dt=V-X+2*c,Jt=E-de+3*c,Wt=R-Le+3*c,B=F-_e+3*c,P=V-st+3*c,ae=E-1+4*c,xe=R-1+4*c,Pe=F-1+4*c,Ue=V-1+4*c,ht=255&g,L=255&_,le=255&v,Ne=255&y,G=a[ht+Y+a[L+oe+a[le+$+a[Ne+me]]]]%32,De=a[ht+he+a[L+Ae+a[le+J+a[Ne+X]]]]%32,je=a[ht+de+a[L+Le+a[le+_e+a[Ne+st]]]]%32,_t=a[ht+1+a[L+1+a[le+1+a[Ne+1]]]]%32;let Fe=.6-E*E-R*R-F*F-V*V;Fe<0?u=0:(Fe*=Fe,u=Fe*Fe*this.dot4(s[a[ht+a[L+a[le+a[Ne]]]]%32],E,R,F,V));let Ke=.6-ue*ue-fe*fe-Me*Me-Je*Je;Ke<0?h=0:(Ke*=Ke,h=Ke*Ke*this.dot4(s[G],ue,fe,Me,Je));let Be=.6-Ge*Ge-bt*bt-mt*mt-dt*dt;Be<0?d=0:(Be*=Be,d=Be*Be*this.dot4(s[De],Ge,bt,mt,dt));let ge=.6-Jt*Jt-Wt*Wt-B*B-P*P;ge<0?f=0:(ge*=ge,f=ge*ge*this.dot4(s[je],Jt,Wt,B,P));let Yt=.6-ae*ae-xe*xe-Pe*Pe-Ue*Ue;return Yt<0?p=0:(Yt*=Yt,p=Yt*Yt*this.dot4(s[_t],ae,xe,Pe,Ue)),27*(u+h+d+f+p)}}class ci extends wt{constructor(e={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(ci.copyParameters(e,e)),this.createMesh()}static createRandomGenerator(){const t=[];for(let r=0;r<2053;r++)t.push(Math.random());const i={currentSeed:0,random:function(){const r=t[i.currentSeed];return i.currentSeed=(i.currentSeed+1)%2053,r},getSeed:function(){return i.currentSeed/2053},setSeed:function(r){i.currentSeed=Math.floor(2053*r)%2053}};return i}static copyParameters(e={},t={}){const i=function(r){return t===e?r:r.clone()};return e.sourceOffset=void 0!==t.sourceOffset?i(t.sourceOffset):new C(0,100,0),e.destOffset=void 0!==t.destOffset?i(t.destOffset):new C(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?i(t.up0):new C(0,0,1),e.up1=void 0!==t.up1?i(t.up1):new C(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e}update(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),this.state=e<this.subrays[0].endPropagationTime?ci.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?ci.RAY_VANISHING:ci.RAY_STEADY,this.visible=!0):(this.visible=!1,this.state=e<this.rayParameters.birthTime?ci.RAY_UNBORN:ci.RAY_EXTINGUISHED))}init(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=ci.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=ci.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(let t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new RC(this.seedGenerator),this.simplexY=new RC(this.seedGenerator),this.simplexZ=new RC(this.seedGenerator),this.forwards=new C,this.forwardsFill=new C,this.side=new C,this.down=new C,this.middlePos=new C,this.middleLinPos=new C,this.newPos=new C,this.vPos=new C,this.cross1=new C}createMesh(){const e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,i=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(i),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new U_(this.indices,1)),this.positionAttribute=new $e(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new $e(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=S_,this.positionAttribute.usage=S_,this.generateUVs&&(this.uvsAttribute.usage=S_)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(e){const t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(r){const s=t.currentSubray;e<s.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.endPropagationTime?t.timeFraction>=r.fraction0*s.propagationTimeFactor&&(t.createPrism(r),t.onDecideSubrayCreation(r,t)):e<s.beginVanishingTime?(t.createPrism(r),t.onDecideSubrayCreation(r,t)):(t.timeFraction<=s.vanishingTimeFactor+r.fraction1*(1-s.vanishingTimeFactor)&&t.createPrism(r),t.onDecideSubrayCreation(r,t)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0}fractalRay(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let i=0;i<this.numSubrays;i++){const r=this.subrays[i];this.currentSubray=r,this.randomGenerator.setSeed(r.seed),r.endPropagationTime=Ot.lerp(r.birthTime,r.deathTime,r.propagationTimeFactor),r.beginVanishingTime=Ot.lerp(r.deathTime,r.birthTime,1-r.vanishingTimeFactor);const s=this.randomGenerator.random;r.linPos0.set(s(),s(),s()).multiplyScalar(1e3),r.linPos1.set(s(),s(),s()).multiplyScalar(1e3),this.timeFraction=(e-r.birthTime)/(r.deathTime-r.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const o=this.getNewSegment();o.iteration=0,o.pos0.copy(r.pos0),o.pos1.copy(r.pos1),o.linPos0.copy(r.linPos0),o.linPos1.copy(r.linPos1),o.up0.copy(r.up0),o.up1.copy(r.up1),o.radius0=r.radius0,o.radius1=r.radius1,o.fraction0=0,o.fraction1=1,o.positionVariationFactor=1-r.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,r.recursion)/(1<<r.maxIterations),this.fractalRayRecursive(o)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(e){if(e.iteration>=this.currentSubray.maxIterations)return void this.currentSegmentCallback(e);this.forwards.subVectors(e.pos1,e.pos0);let t=this.forwards.length();t<1e-6&&(this.forwards.set(0,0,.01),t=this.forwards.length());const i=.5*(e.radius0+e.radius1),r=.5*(e.fraction0+e.fraction1),s=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);const o=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(o.x,o.y,o.z,s),this.simplexY.noise4d(o.x,o.y,o.z,s),this.simplexZ.noise4d(o.x,o.y,o.z,s)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);const a=this.getNewSegment();a.pos0.copy(e.pos0),a.pos1.copy(this.newPos),a.linPos0.copy(e.linPos0),a.linPos1.copy(this.middleLinPos),a.up0.copy(e.up0),a.up1.copy(e.up1),a.radius0=e.radius0,a.radius1=i,a.fraction0=e.fraction0,a.fraction1=r,a.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,a.iteration=e.iteration+1;const l=this.getNewSegment();l.pos0.copy(this.newPos),l.pos1.copy(e.pos1),l.linPos0.copy(this.middleLinPos),l.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),l.up0.crossVectors(this.forwards,this.cross1).normalize(),l.up1.copy(e.up1),l.radius0=i,l.radius1=e.radius1,l.fraction0=r,l.fraction1=e.fraction1,l.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,l.iteration=e.iteration+1,this.fractalRayRecursive(a),this.fractalRayRecursive(l)}createPrism(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(e,t,i,r){this.side.crossVectors(t,i).multiplyScalar(r*ci.COS30DEG),this.down.copy(t).multiplyScalar(-r*ci.SIN30DEG);const s=this.vPos,o=this.vertices;s.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,s.copy(t).multiplyScalar(r).add(e),o[this.currentCoordinate++]=s.x,o[this.currentCoordinate++]=s.y,o[this.currentCoordinate++]=s.z,this.currentVertex+=3}createTriangleVerticesWithUVs(e,t,i,r,s){this.side.crossVectors(t,i).multiplyScalar(r*ci.COS30DEG),this.down.copy(t).multiplyScalar(-r*ci.SIN30DEG);const o=this.vPos,a=this.vertices,l=this.uvs;o.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=0,o.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=.5,o.copy(t).multiplyScalar(r).add(e),a[this.currentCoordinate++]=o.x,a[this.currentCoordinate++]=o.y,a[this.currentCoordinate++]=o.z,l[this.currentUVCoordinate++]=s,l[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(e){const t=this.indices;e=this.currentVertex-6,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+5,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+1,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+4,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+0,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+2,t[this.currentIndex++]=e+3,t[this.currentIndex++]=e+5}createDefaultSubrayCreationCallbacks(){const e=this.randomGenerator.random;this.onDecideSubrayCreation=function(o,a){const l=a.currentSubray,c=a.rayParameters.subrayPeriod,u=a.rayParameters.subrayDutyCycle,h=a.rayParameters.isEternal&&0==l.recursion?-e()*c:Ot.lerp(l.birthTime,l.endPropagationTime,o.fraction0)-e()*c,d=a.time-h,f=Math.floor(d/c),p=e()*(f+1);let g=0;if(d%c<=u*c&&(g=a.subrayProbability),l.recursion<a.maxSubrayRecursion&&a.numSubrays<a.maxSubrays&&e()<g){const _=a.addNewSubray(),v=a.randomGenerator.getSeed();_.seed=p,a.randomGenerator.setSeed(p),_.recursion=l.recursion+1,_.maxIterations=Math.max(1,l.maxIterations-1),_.linPos0.set(e(),e(),e()).multiplyScalar(1e3),_.linPos1.set(e(),e(),e()).multiplyScalar(1e3),_.up0.copy(l.up0),_.up1.copy(l.up1),_.radius0=o.radius0*a.rayParameters.radius0Factor,_.radius1=Math.min(a.rayParameters.minRadius,o.radius1*a.rayParameters.radius1Factor),_.birthTime=h+f*c,_.deathTime=_.birthTime+c*u,!a.rayParameters.isEternal&&0==l.recursion&&(_.birthTime=Math.max(_.birthTime,l.birthTime),_.deathTime=Math.min(_.deathTime,l.deathTime)),_.timeScale=2*l.timeScale,_.roughness=l.roughness,_.straightness=l.straightness,_.propagationTimeFactor=l.propagationTimeFactor,_.vanishingTimeFactor=l.vanishingTimeFactor,a.onSubrayCreation(o,l,_,a),a.randomGenerator.setSeed(v)}};const t=new C,i=new C,r=new C,s=new C;this.onSubrayCreation=function(o,a,l,c){c.subrayCylinderPosition(o,a,l,.5,.6,.2)},this.subrayConePosition=function(o,a,l,c,u,h){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),i.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*(e()*c));const d=t.length();r.crossVectors(a.up0,i);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(d*u*(h+e()*(1-h))).add(t).add(a.pos0)},this.subrayCylinderPosition=function(o,a,l,c,u,h){l.pos0.copy(o.pos0),t.subVectors(a.pos1,a.pos0),i.copy(t).normalize(),t.multiplyScalar(o.fraction0+(1-o.fraction0)*((2*e()-1)*c));const d=t.length();r.crossVectors(a.up0,i);const f=2*Math.PI*e();r.multiplyScalar(Math.cos(f)),s.copy(a.up0).multiplyScalar(Math.sin(f)),l.pos1.copy(r).add(s).multiplyScalar(d*u*(h+e()*(1-h))).add(t).add(a.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new C,pos1:new C,linPos0:new C,linPos1:new C,up0:new C,up1:new C,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new C,pos1:new C,linPos0:new C,linPos1:new C,up0:new C,up1:new C,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(e){return super.copy(e),this.init(ci.copyParameters({},e.rayParameters)),this}clone(){return new this.constructor(ci.copyParameters({},this.rayParameters))}}ci.RAY_INITIALIZED=0,ci.RAY_UNBORN=1,ci.RAY_PROPAGATING=2,ci.RAY_STEADY=3,ci.RAY_VANISHING=4,ci.RAY_EXTINGUISHED=5,ci.COS30DEG=Math.cos(30*Math.PI/180),ci.SIN30DEG=Math.sin(30*Math.PI/180);let Fj=(()=>{class n extends Qp{getType(){return yC}set textureID(t){this._objRef&&(this._objRef.textureID=t)}set uniforms(t){this._objRef&&Object.assign(this._objRef.uniforms,t)}set material(t){this._objRef&&(this._objRef.material=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-shaderPass"]],inputs:{textureID:"textureID",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),dce=(()=>{class n extends Cp{getType(){return Aie}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-mapControls"]],features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();class Jc extends Ko{constructor(e,t,i,r){super(),this.renderScene=t,this.renderCamera=i,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new Ce(1,1,1),this.hiddenEdgeColor=new Ce(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new te(e.x,e.y):new te(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Nn(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new ev,this.depthMaterial.side=io,this.depthMaterial.depthPacking=GM,this.depthMaterial.blending=ro,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=io,this.prepareMaskMaterial.fragmentShader=function u(h,d){return h.replace(/DEPTH_TO_VIEW_Z/g,(d.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Nn(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Nn(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Nn(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Nn(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Nn(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Nn(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===pd&&console.error("THREE.OutlinePass relies on CopyShader");const c=pd;this.copyUniforms=Ho.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Yn({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:ro,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ce,this.oldClearAlpha=1,this.fsQuad=new md(null),this.tempPulseColor1=new Ce,this.tempPulseColor2=new Ce,this.textureMatrix=new ot}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value.set(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value.set(i,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function i(r){r.isMesh&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}for(let r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(i)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,i=[];function r(o){o.isMesh&&i.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(r);this.renderScene.traverse(function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let l=0;l<i.length;l++)if(i[l].id===o.id){a=!0;break}if(!1===a){const l=o.visible;(!1===e||!0===t.get(o))&&(o.visible=e),t.set(o,l)}}else(o.isPoints||o.isLine)&&(!0===e?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,i,r,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const l=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Jc.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Jc.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Jc.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Jc.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Yn({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new te(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\t\t\t\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new Yn({uniforms:{maskTexture:{value:null},texSize:{value:new te(.5,.5)},visibleEdgeColor:{value:new C(1,1,1)},hiddenEdgeColor:{value:new C(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new Yn({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new te(.5,.5)},direction:{value:new te(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new Yn({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:ih,depthTest:!1,depthWrite:!1,transparent:!0})}}Jc.BlurDirectionX=new te(1,0),Jc.BlurDirectionY=new te(0,1),new fh(0,0,0,"YXZ"),new C,Math,new C,new te(512,512),new ot,new ot,new te(512,512),new te(0,0),new te(1/1024,1/512),new te(1/1024,1/512),new te(1/1024,1/512),new te,new ot,new ot,new te,new te,new ot,new ot,new te;const PC={type:"change"},IC={type:"start"},LC={type:"end"};class yce extends rs{constructor(e,t){super(),void 0===t&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const i=this;this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:ws.ROTATE,MIDDLE:ws.DOLLY,RIGHT:ws.PAN},this.target=new C;const s=1e-6,o=new C;let a=1,l=-1,c=-1,u=0,h=0,d=0;const f=new C,p=new te,m=new te,g=new C,_=new te,v=new te,y=new te,b=new te,w=[],M={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const X=i.domElement.getBoundingClientRect(),de=i.domElement.ownerDocument.documentElement;i.screen.left=X.left+window.pageXOffset-de.clientLeft,i.screen.top=X.top+window.pageYOffset-de.clientTop,i.screen.width=X.width,i.screen.height=X.height};const T=function(){const X=new te;return function(Le,_e){return X.set((Le-i.screen.left)/i.screen.width,(_e-i.screen.top)/i.screen.height),X}}(),x=function(){const X=new te;return function(Le,_e){return X.set((Le-.5*i.screen.width-i.screen.left)/(.5*i.screen.width),(i.screen.height+2*(i.screen.top-_e))/i.screen.width),X}}();function E(X){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(X.pointerId),i.domElement.addEventListener("pointermove",R),i.domElement.addEventListener("pointerup",F)),function me(X){w.push(X)}(X),"touch"===X.pointerType?function z(X){if(1===(Ae(X),w.length))l=3,m.copy(x(w[0].pageX,w[0].pageY)),p.copy(m);else{l=4;const de=w[0].pageX-w[1].pageX,Le=w[0].pageY-w[1].pageY;h=u=Math.sqrt(de*de+Le*Le),y.copy(T((w[0].pageX+w[1].pageX)/2,(w[0].pageY+w[1].pageY)/2)),b.copy(y)}i.dispatchEvent(IC)}(X):function q(X){if(-1===l)switch(X.button){case i.mouseButtons.LEFT:l=0;break;case i.mouseButtons.MIDDLE:l=1;break;case i.mouseButtons.RIGHT:l=2}const de=-1!==c?c:l;0!==de||i.noRotate?1!==de||i.noZoom?2===de&&!i.noPan&&(y.copy(T(X.pageX,X.pageY)),b.copy(y)):(_.copy(T(X.pageX,X.pageY)),v.copy(_)):(m.copy(x(X.pageX,X.pageY)),p.copy(m)),i.dispatchEvent(IC)}(X))}function R(X){!1!==i.enabled&&("touch"===X.pointerType?function Y(X){if(1===(Ae(X),w.length))p.copy(m),m.copy(x(X.pageX,X.pageY));else{const de=function J(X){return M[(X.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}(X),Le=X.pageX-de.x,_e=X.pageY-de.y;h=Math.sqrt(Le*Le+_e*_e),b.copy(T((X.pageX+de.x)/2,(X.pageY+de.y)/2))}}(X):function I(X){const de=-1!==c?c:l;0!==de||i.noRotate?1!==de||i.noZoom?2===de&&!i.noPan&&b.copy(T(X.pageX,X.pageY)):v.copy(T(X.pageX,X.pageY)):(p.copy(m),m.copy(x(X.pageX,X.pageY)))}(X))}function F(X){!1!==i.enabled&&("touch"===X.pointerType?function oe(X){switch(w.length){case 0:l=-1;break;case 1:l=3,m.copy(x(X.pageX,X.pageY)),p.copy(m);break;case 2:l=4,m.copy(x(X.pageX-p.x,X.pageY-p.y)),p.copy(m)}i.dispatchEvent(LC)}(X):function U(){l=-1,i.dispatchEvent(LC)}(),he(X),0===w.length&&(i.domElement.releasePointerCapture(X.pointerId),i.domElement.removeEventListener("pointermove",R),i.domElement.removeEventListener("pointerup",F)))}function V(X){he(X)}function H(X){!1!==i.enabled&&(window.removeEventListener("keydown",H),-1===c&&(X.code!==i.keys[0]||i.noRotate?X.code!==i.keys[1]||i.noZoom?X.code===i.keys[2]&&!i.noPan&&(c=2):c=1:c=0))}function j(){!1!==i.enabled&&(c=-1,window.addEventListener("keydown",H))}function W(X){if(!1!==i.enabled&&!0!==i.noZoom){switch(X.preventDefault(),X.deltaMode){case 2:_.y-=.025*X.deltaY;break;case 1:_.y-=.01*X.deltaY;break;default:_.y-=25e-5*X.deltaY}i.dispatchEvent(IC),i.dispatchEvent(LC)}}function $(X){!1!==i.enabled&&X.preventDefault()}function he(X){delete M[X.pointerId];for(let de=0;de<w.length;de++)if(w[de].pointerId==X.pointerId)return void w.splice(de,1)}function Ae(X){let de=M[X.pointerId];void 0===de&&(de=new te,M[X.pointerId]=de),de.set(X.pageX,X.pageY)}this.rotateCamera=function(){const X=new C,de=new bn,Le=new C,_e=new C,st=new C,ue=new C;return function(){ue.set(m.x-p.x,m.y-p.y,0);let Me=ue.length();Me?(f.copy(i.object.position).sub(i.target),Le.copy(f).normalize(),_e.copy(i.object.up).normalize(),st.crossVectors(_e,Le).normalize(),_e.setLength(m.y-p.y),st.setLength(m.x-p.x),ue.copy(_e.add(st)),X.crossVectors(ue,f).normalize(),Me*=i.rotateSpeed,de.setFromAxisAngle(X,Me),f.applyQuaternion(de),i.object.up.applyQuaternion(de),g.copy(X),d=Me):!i.staticMoving&&d&&(d*=Math.sqrt(1-i.dynamicDampingFactor),f.copy(i.object.position).sub(i.target),de.setFromAxisAngle(g,d),f.applyQuaternion(de),i.object.up.applyQuaternion(de)),p.copy(m)}}(),this.zoomCamera=function(){let X;4===l?(X=u/h,u=h,i.object.isPerspectiveCamera?f.multiplyScalar(X):i.object.isOrthographicCamera?(i.object.zoom/=X,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(X=1+(v.y-_.y)*i.zoomSpeed,1!==X&&X>0&&(i.object.isPerspectiveCamera?f.multiplyScalar(X):i.object.isOrthographicCamera?(i.object.zoom/=X,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),i.staticMoving?_.copy(v):_.y+=(v.y-_.y)*this.dynamicDampingFactor)},this.panCamera=function(){const X=new te,de=new C,Le=new C;return function(){if(X.copy(b).sub(y),X.lengthSq()){if(i.object.isOrthographicCamera){const ue=(i.object.top-i.object.bottom)/i.object.zoom/i.domElement.clientWidth;X.x*=(i.object.right-i.object.left)/i.object.zoom/i.domElement.clientWidth,X.y*=ue}X.multiplyScalar(f.length()*i.panSpeed),Le.copy(f).cross(i.object.up).setLength(X.x),Le.add(de.copy(i.object.up).setLength(X.y)),i.object.position.add(Le),i.target.add(Le),i.staticMoving?y.copy(b):y.add(X.subVectors(b,y).multiplyScalar(i.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!i.noZoom||!i.noPan)&&(f.lengthSq()>i.maxDistance*i.maxDistance&&(i.object.position.addVectors(i.target,f.setLength(i.maxDistance)),_.copy(v)),f.lengthSq()<i.minDistance*i.minDistance&&(i.object.position.addVectors(i.target,f.setLength(i.minDistance)),_.copy(v)))},this.update=function(){f.subVectors(i.object.position,i.target),i.noRotate||i.rotateCamera(),i.noZoom||i.zoomCamera(),i.noPan||i.panCamera(),i.object.position.addVectors(i.target,f),i.object.isPerspectiveCamera?(i.checkDistances(),i.object.lookAt(i.target),o.distanceToSquared(i.object.position)>s&&(i.dispatchEvent(PC),o.copy(i.object.position))):i.object.isOrthographicCamera?(i.object.lookAt(i.target),(o.distanceToSquared(i.object.position)>s||a!==i.object.zoom)&&(i.dispatchEvent(PC),o.copy(i.object.position),a=i.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){l=-1,c=-1,i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.up.copy(i.up0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),f.subVectors(i.object.position,i.target),i.object.lookAt(i.target),i.dispatchEvent(PC),o.copy(i.object.position),a=i.object.zoom},this.dispose=function(){i.domElement.removeEventListener("contextmenu",$),i.domElement.removeEventListener("pointerdown",E),i.domElement.removeEventListener("pointercancel",V),i.domElement.removeEventListener("wheel",W),i.domElement.removeEventListener("pointermove",R),i.domElement.removeEventListener("pointerup",F),window.removeEventListener("keydown",H),window.removeEventListener("keyup",j)},this.domElement.addEventListener("contextmenu",$),this.domElement.addEventListener("pointerdown",E),this.domElement.addEventListener("pointercancel",V),this.domElement.addEventListener("wheel",W,{passive:!1}),window.addEventListener("keydown",H),window.addEventListener("keyup",j),this.handleResize(),this.update()}}let bce=(()=>{class n extends gr{getType(){return yce}set object(t){this._objRef&&(this._objRef.object=t)}set domElement(t){this._objRef&&(this._objRef.domElement=t)}set enabled(t){this._objRef&&(this._objRef.enabled=t)}set screen(t){this._objRef&&(this._objRef.screen=t)}set rotateSpeed(t){this._objRef&&(this._objRef.rotateSpeed=t)}set zoomSpeed(t){this._objRef&&(this._objRef.zoomSpeed=t)}set panSpeed(t){this._objRef&&(this._objRef.panSpeed=t)}set noRotate(t){this._objRef&&(this._objRef.noRotate=t)}set noZoom(t){this._objRef&&(this._objRef.noZoom=t)}set noPan(t){this._objRef&&(this._objRef.noPan=t)}set noRoll(t){this._objRef&&(this._objRef.noRoll=t)}set staticMoving(t){this._objRef&&(this._objRef.staticMoving=t)}set dynamicDampingFactor(t){this._objRef&&(this._objRef.dynamicDampingFactor=t)}set minDistance(t){this._objRef&&(this._objRef.minDistance=t)}set maxDistance(t){this._objRef&&(this._objRef.maxDistance=t)}set keys(t){this._objRef&&(this._objRef.keys=t)}set mouseButtons(t){this._objRef&&(this._objRef.mouseButtons=t)}set target(t){this._objRef&&(this._objRef.target=Lt(this._objRef.target,t))}set position0(t){this._objRef&&(this._objRef.position0=Lt(this._objRef.position0,t))}set target0(t){this._objRef&&(this._objRef.target0=Lt(this._objRef.target0,t))}set up0(t){this._objRef&&(this._objRef.up0=Lt(this._objRef.up0,t))}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-trackballControls"]],inputs:{object:"object",domElement:"domElement",enabled:"enabled",screen:"screen",rotateSpeed:"rotateSpeed",zoomSpeed:"zoomSpeed",panSpeed:"panSpeed",noRotate:"noRotate",noZoom:"noZoom",noPan:"noPan",noRoll:"noRoll",staticMoving:"staticMoving",dynamicDampingFactor:"dynamicDampingFactor",minDistance:"minDistance",maxDistance:"maxDistance",keys:"keys",mouseButtons:"mouseButtons",target:"target",position0:"position0",target0:"target0",up0:"up0"},features:[Xe([{provide:gr,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Nj={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ce(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class bd extends Ko{constructor(e,t,i,r){super(),this.strength=void 0!==t?t:1,this.radius=i,this.threshold=r,this.resolution=void 0!==e?new te(e.x,e.y):new te(256,256),this.clearColor=new Ce(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Nn(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let h=0;h<this.nMips;h++){const d=new Nn(s,o);d.texture.name="UnrealBloomPass.h"+h,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d);const f=new Nn(s,o);f.texture.name="UnrealBloomPass.v"+h,f.texture.generateMipmaps=!1,this.renderTargetsVertical.push(f),s=Math.round(s/2),o=Math.round(o/2)}void 0===Nj&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=Nj;this.highPassUniforms=Ho.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Yn({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let h=0;h<this.nMips;h++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[h])),this.separableBlurMaterials[h].uniforms.texSize.value=new te(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===pd&&console.error("THREE.UnrealBloomPass relies on CopyShader");const u=pd;this.copyUniforms=Ho.clone(u.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Yn({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:ih,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ce,this.oldClearAlpha=1,this.basic=new nr,this.fsQuad=new md(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let i=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(i,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(i,r),this.renderTargetsVertical[s].setSize(i,r),this.separableBlurMaterials[s].uniforms.texSize.value=new te(i,r),i=Math.round(i/2),r=Math.round(r/2)}render(e,t,i,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=bd.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=bd.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new Yn({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new te(.5,.5)},direction:{value:new te(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new Yn({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}bd.BlurDirectionX=new te(1,0),bd.BlurDirectionY=new te(0,1);let Bj=(()=>{class n extends Qp{getType(){return bd}set resolution(t){this._objRef&&(this._objRef.resolution=Lt(this._objRef.resolution,t))}set strength(t){this._objRef&&(this._objRef.strength=t)}set radius(t){this._objRef&&(this._objRef.radius=t)}set threshold(t){this._objRef&&(this._objRef.threshold=t)}set clearColor(t){this._objRef&&(this._objRef.clearColor=Lt(this._objRef.clearColor,t))}set renderTargetsHorizontal(t){this._objRef&&(this._objRef.renderTargetsHorizontal=t)}set renderTargetsVertical(t){this._objRef&&(this._objRef.renderTargetsVertical=t)}set nMips(t){this._objRef&&(this._objRef.nMips=t)}set renderTargetBright(t){this._objRef&&(this._objRef.renderTargetBright=t)}set highPassUniforms(t){this._objRef&&(this._objRef.highPassUniforms=t)}set materialHighPassFilter(t){this._objRef&&(this._objRef.materialHighPassFilter=t)}set separableBlurMaterials(t){this._objRef&&(this._objRef.separableBlurMaterials=t)}set compositeMaterial(t){this._objRef&&(this._objRef.compositeMaterial=t)}set bloomTintColors(t){this._objRef&&(this._objRef.bloomTintColors=t)}set copyUniforms(t){this._objRef&&(this._objRef.copyUniforms=t)}set materialCopy(t){this._objRef&&(this._objRef.materialCopy=t)}set oldClearColor(t){this._objRef&&(this._objRef.oldClearColor=Lt(this._objRef.oldClearColor,t))}set oldClearAlpha(t){this._objRef&&(this._objRef.oldClearAlpha=t)}set basic(t){this._objRef&&(this._objRef.basic=t)}set fsQuad(t){this._objRef&&(this._objRef.fsQuad=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-unrealBloomPass"]],inputs:{resolution:"resolution",strength:"strength",radius:"radius",threshold:"threshold",clearColor:"clearColor",renderTargetsHorizontal:"renderTargetsHorizontal",renderTargetsVertical:"renderTargetsVertical",nMips:"nMips",renderTargetBright:"renderTargetBright",highPassUniforms:"highPassUniforms",materialHighPassFilter:"materialHighPassFilter",separableBlurMaterials:"separableBlurMaterials",compositeMaterial:"compositeMaterial",bloomTintColors:"bloomTintColors",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",basic:"basic",fsQuad:"fsQuad"},features:[Xe([{provide:Rl,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();function xce(n){return[{provide:an,useExisting:Ze(()=>n)}]}var e,t,n,Gt={toRGBA8:function(n){var e=n.width,t=n.height;if(null==n.tabs.acTL)return[Gt.toRGBA8.decodeImage(n.data,e,t,n).buffer];var i=[];null==n.frames[0].data&&(n.frames[0].data=n.data);for(var r=e*t*4,s=new Uint8Array(r),o=new Uint8Array(r),a=new Uint8Array(r),l=0;l<n.frames.length;l++){var c=n.frames[l],u=c.rect.x,h=c.rect.y,d=c.rect.width,f=c.rect.height,p=Gt.toRGBA8.decodeImage(c.data,d,f,n);if(0!=l)for(var m=0;m<r;m++)a[m]=s[m];if(0==c.blend?Gt._copyTile(p,d,f,s,e,t,u,h,0):1==c.blend&&Gt._copyTile(p,d,f,s,e,t,u,h,1),i.push(s.buffer.slice(0)),1==c.dispose)Gt._copyTile(o,d,f,s,e,t,u,h,0);else if(2==c.dispose)for(m=0;m<r;m++)s[m]=a[m]}return i}};Gt.toRGBA8.decodeImage=function(n,e,t,i){var r=e*t,s=Gt.decode._getBPP(i),o=Math.ceil(e*s/8),a=new Uint8Array(4*r),l=new Uint32Array(a.buffer),c=i.ctype,u=i.depth,h=Gt._bin.readUshort;if(6==c){var d=r<<2;if(8==u)for(var f=0;f<d;f+=4)a[f]=n[f],a[f+1]=n[f+1],a[f+2]=n[f+2],a[f+3]=n[f+3];if(16==u)for(f=0;f<d;f++)a[f]=n[f<<1]}else if(2==c){var p=i.tabs.tRNS;if(null==p){if(8==u)for(f=0;f<r;f++)l[f]=255<<24|n[2+(m=3*f)]<<16|n[m+1]<<8|n[m];if(16==u)for(f=0;f<r;f++)l[f]=255<<24|n[4+(m=6*f)]<<16|n[m+2]<<8|n[m]}else{var g=p[0],_=p[1],v=p[2];if(8==u)for(f=0;f<r;f++){var y=f<<2;l[f]=255<<24|n[2+(m=3*f)]<<16|n[m+1]<<8|n[m],n[m]==g&&n[m+1]==_&&n[m+2]==v&&(a[y+3]=0)}if(16==u)for(f=0;f<r;f++){var m;y=f<<2,l[f]=255<<24|n[4+(m=6*f)]<<16|n[m+2]<<8|n[m],h(n,m)==g&&h(n,m+2)==_&&h(n,m+4)==v&&(a[y+3]=0)}}}else if(3==c){var b=i.tabs.PLTE,w=i.tabs.tRNS,M=w?w.length:0;if(1==u)for(var T=0;T<t;T++){var x=T*o,E=T*e;for(f=0;f<e;f++)a[y=E+f<<2]=b[F=3*(R=n[x+(f>>3)]>>7-((7&f)<<0)&1)],a[y+1]=b[F+1],a[y+2]=b[F+2],a[y+3]=R<M?w[R]:255}if(2==u)for(T=0;T<t;T++)for(x=T*o,E=T*e,f=0;f<e;f++)a[y=E+f<<2]=b[F=3*(R=n[x+(f>>2)]>>6-((3&f)<<1)&3)],a[y+1]=b[F+1],a[y+2]=b[F+2],a[y+3]=R<M?w[R]:255;if(4==u)for(T=0;T<t;T++)for(x=T*o,E=T*e,f=0;f<e;f++)a[y=E+f<<2]=b[F=3*(R=n[x+(f>>1)]>>4-((1&f)<<2)&15)],a[y+1]=b[F+1],a[y+2]=b[F+2],a[y+3]=R<M?w[R]:255;if(8==u)for(f=0;f<r;f++){var R,F;a[y=f<<2]=b[F=3*(R=n[f])],a[y+1]=b[F+1],a[y+2]=b[F+2],a[y+3]=R<M?w[R]:255}}else if(4==c){if(8==u)for(f=0;f<r;f++)a[y=f<<2]=H=n[V=f<<1],a[y+1]=H,a[y+2]=H,a[y+3]=n[V+1];if(16==u)for(f=0;f<r;f++){var V;a[y=f<<2]=H=n[V=f<<2],a[y+1]=H,a[y+2]=H,a[y+3]=n[V+2]}}else if(0==c)for(g=i.tabs.tRNS?i.tabs.tRNS:-1,T=0;T<t;T++){var j=T*o,q=T*e;if(1==u)for(var I=0;I<e;I++)l[q+I]=(U=(H=255*(n[j+(I>>>3)]>>>7-(7&I)&1))==255*g?0:255)<<24|H<<16|H<<8|H;else if(2==u)for(I=0;I<e;I++)l[q+I]=(U=(H=85*(n[j+(I>>>2)]>>>6-((3&I)<<1)&3))==85*g?0:255)<<24|H<<16|H<<8|H;else if(4==u)for(I=0;I<e;I++)l[q+I]=(U=(H=17*(n[j+(I>>>1)]>>>4-((1&I)<<2)&15))==17*g?0:255)<<24|H<<16|H<<8|H;else if(8==u)for(I=0;I<e;I++)l[q+I]=(U=(H=n[j+I])==g?0:255)<<24|H<<16|H<<8|H;else if(16==u)for(I=0;I<e;I++){var H=n[j+(I<<1)],U=h(n,j+(I<<1))==g?0:255;l[q+I]=U<<24|H<<16|H<<8|H}}return a},Gt.decode=function(n){for(var c,h,d,f,e=new Uint8Array(n),t=8,i=Gt._bin,r=i.readUshort,s=i.readUint,o={tabs:{},frames:[]},a=new Uint8Array(e.length),l=0,u=0,p=[137,80,78,71,13,10,26,10],m=0;m<8;m++)if(e[m]!=p[m])throw new Error("The input is not a PNG file!");for(;t<e.length;){var g=i.readUint(e,t),_=i.readASCII(e,t+=4,4);if(t+=4,"IHDR"==_)Gt.decode._IHDR(e,t,o);else if("CgBI"==_)o.tabs[_]=e.slice(t,t+4);else if("IDAT"==_){for(m=0;m<g;m++)a[l+m]=e[t+m];l+=g}else if("acTL"==_)o.tabs[_]={num_frames:s(e,t),num_plays:s(e,t+4)},c=new Uint8Array(e.length);else if("fcTL"==_){0!=u&&((v=o.frames[o.frames.length-1]).data=Gt.decode._decompress(o,c.slice(0,u),v.rect.width,v.rect.height),u=0);var y={x:s(e,t+12),y:s(e,t+16),width:s(e,t+4),height:s(e,t+8)},b=r(e,t+22);b=r(e,t+20)/(0==b?100:b);var w={rect:y,delay:Math.round(1e3*b),dispose:e[t+24],blend:e[t+25]};o.frames.push(w)}else if("fdAT"==_){for(m=0;m<g-4;m++)c[u+m]=e[t+m+4];u+=g-4}else if("pHYs"==_)o.tabs[_]=[i.readUint(e,t),i.readUint(e,t+4),e[t+8]];else if("cHRM"==_)for(o.tabs[_]=[],m=0;m<8;m++)o.tabs[_].push(i.readUint(e,t+4*m));else if("tEXt"==_||"zTXt"==_){null==o.tabs[_]&&(o.tabs[_]={});var M=i.nextZero(e,t);d=i.readASCII(e,t,M-t);var T=t+g-M-1;"tEXt"==_?h=i.readASCII(e,M+1,T):(f=Gt.decode._inflate(e.slice(M+2,M+2+T)),h=i.readUTF8(f,0,f.length)),o.tabs[_][d]=h}else if("iTXt"==_){null==o.tabs[_]&&(o.tabs[_]={}),M=0;var x=t;M=i.nextZero(e,x),d=i.readASCII(e,x,M-x);var E=e[x=M+1];M=i.nextZero(e,x+=2),i.readASCII(e,x,M-x),M=i.nextZero(e,x=M+1),i.readUTF8(e,x,M-x),T=g-((x=M+1)-t),0==E?h=i.readUTF8(e,x,T):(f=Gt.decode._inflate(e.slice(x,x+T)),h=i.readUTF8(f,0,f.length)),o.tabs[_][d]=h}else if("PLTE"==_)o.tabs[_]=i.readBytes(e,t,g);else if("hIST"==_){var R=o.tabs.PLTE.length/3;for(o.tabs[_]=[],m=0;m<R;m++)o.tabs[_].push(r(e,t+2*m))}else if("tRNS"==_)3==o.ctype?o.tabs[_]=i.readBytes(e,t,g):0==o.ctype?o.tabs[_]=r(e,t):2==o.ctype&&(o.tabs[_]=[r(e,t),r(e,t+2),r(e,t+4)]);else if("gAMA"==_)o.tabs[_]=i.readUint(e,t)/1e5;else if("sRGB"==_)o.tabs[_]=e[t];else if("bKGD"==_)0==o.ctype||4==o.ctype?o.tabs[_]=[r(e,t)]:2==o.ctype||6==o.ctype?o.tabs[_]=[r(e,t),r(e,t+2),r(e,t+4)]:3==o.ctype&&(o.tabs[_]=e[t]);else if("IEND"==_)break;i.readUint(e,t+=g),t+=4}var v;return 0!=u&&((v=o.frames[o.frames.length-1]).data=Gt.decode._decompress(o,c.slice(0,u),v.rect.width,v.rect.height)),o.data=Gt.decode._decompress(o,a,o.width,o.height),delete o.compress,delete o.interlace,delete o.filter,o},Gt.decode._decompress=function(n,e,t,i){var r=Gt.decode._getBPP(n),s=Math.ceil(t*r/8),o=new Uint8Array((s+1+n.interlace)*i);return e=n.tabs.CgBI?Gt.inflateRaw(e,o):Gt.decode._inflate(e,o),0==n.interlace?e=Gt.decode._filterZero(e,n,0,t,i):1==n.interlace&&(e=Gt.decode._readInterlace(e,n)),e},Gt.decode._inflate=function(n,e){return Gt.inflateRaw(new Uint8Array(n.buffer,2,n.length-6),e)},Gt.inflateRaw=((n={H:{}}).H.N=function(e,t){var f,p,i=Uint8Array,r=0,s=0,o=0,a=0,l=0,c=0,u=0,h=0,d=0;if(3==e[0]&&0==e[1])return t||new i(0);var m=n.H,g=m.b,_=m.e,v=m.R,y=m.n,b=m.A,w=m.Z,M=m.m,T=null==t;for(T&&(t=new i(e.length>>>2<<5));0==r;)if(r=g(e,d,1),s=g(e,d+1,2),d+=3,0!=s){if(T&&(t=n.H.W(t,h+(1<<17))),1==s&&(f=M.J,p=M.h,c=511,u=31),2==s){o=_(e,d,5)+257,a=_(e,d+5,5)+1,l=_(e,d+10,4)+4,d+=14;for(var R=1,F=0;F<38;F+=2)M.Q[F]=0,M.Q[F+1]=0;for(F=0;F<l;F++){var V=_(e,d+3*F,3);M.Q[1+(M.X[F]<<1)]=V,V>R&&(R=V)}d+=3*l,y(M.Q,R),b(M.Q,R,M.u),f=M.w,p=M.d,d=v(M.u,(1<<R)-1,o+a,e,d,M.v);var H=m.V(M.v,0,o,M.C);c=(1<<H)-1;var j=m.V(M.v,o,a,M.D);u=(1<<j)-1,y(M.C,H),b(M.C,H,f),y(M.D,j),b(M.D,j,p)}for(;;){var q=f[w(e,d)&c];d+=15&q;var I=q>>>4;if(I>>>8==0)t[h++]=I;else{if(256==I)break;var U=h+I-254;if(I>264){var W=M.q[I-257];U=h+(W>>>3)+_(e,d,7&W),d+=7&W}var z=p[w(e,d)&u],oe=M.c[z>>>4],$=(oe>>>4)+g(e,d+=15&z,15&oe);for(d+=15&oe;h<U;)t[h]=t[h++-$],t[h]=t[h++-$],t[h]=t[h++-$],t[h]=t[h++-$];h=U}}}else{0!=(7&d)&&(d+=8-(7&d));var x=4+(d>>>3),E=e[x-4]|e[x-3]<<8;T&&(t=n.H.W(t,h+E)),t.set(new i(e.buffer,e.byteOffset+x,E),h),d=x+E<<3,h+=E}return t.length==h?t:t.slice(0,h)},n.H.W=function(e,t){var i=e.length;if(t<=i)return e;var r=new Uint8Array(i<<1);return r.set(e,0),r},n.H.R=function(e,t,i,r,s,o){for(var a=n.H.e,l=n.H.Z,c=0;c<i;){var u=e[l(r,s)&t];s+=15&u;var h=u>>>4;if(h<=15)o[c]=h,c++;else{var d=0,f=0;16==h?(f=3+a(r,s,2),s+=2,d=o[c-1]):17==h?(f=3+a(r,s,3),s+=3):18==h&&(f=11+a(r,s,7),s+=7);for(var p=c+f;c<p;)o[c]=d,c++}}return s},n.H.V=function(e,t,i,r){for(var s=0,o=0,a=r.length>>>1;o<i;){var l=e[o+t];r[o<<1]=0,r[1+(o<<1)]=l,l>s&&(s=l),o++}for(;o<a;)r[o<<1]=0,r[1+(o<<1)]=0,o++;return s},n.H.n=function(e,t){for(var s,o,a,c,i=n.H.m,r=e.length,u=i.j,l=0;l<=t;l++)u[l]=0;for(l=1;l<r;l+=2)u[e[l]]++;var h=i.K;for(s=0,u[0]=0,o=1;o<=t;o++)h[o]=s=s+u[o-1]<<1;for(a=0;a<r;a+=2)0!=(c=e[a+1])&&(e[a]=h[c],h[c]++)},n.H.A=function(e,t,i){for(var r=e.length,o=n.H.m.r,a=0;a<r;a+=2)if(0!=e[a+1])for(var c=e[a+1],u=a>>1<<4|c,h=t-c,d=e[a]<<h,f=d+(1<<h);d!=f;)i[o[d]>>>15-t]=u,d++},n.H.l=function(e,t){for(var i=n.H.m.r,r=15-t,s=0;s<e.length;s+=2)e[s]=i[e[s]<<t-e[s+1]]>>>r},n.H.M=function(e,t,i){var r=t>>>3;e[r]|=i<<=7&t,e[r+1]|=i>>>8},n.H.I=function(e,t,i){var r=t>>>3;e[r]|=i<<=7&t,e[r+1]|=i>>>8,e[r+2]|=i>>>16},n.H.e=function(e,t,i){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<i)-1},n.H.b=function(e,t,i){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<i)-1},n.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},n.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},n.H.m=(e=Uint16Array,t=Uint32Array,{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new t(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new t(286),Y:new t(30),a:new t(19),t:new t(15e3),k:new e(65536),g:new e(32768)}),function(){for(var e=n.H.m,i=0;i<32768;i++){var r=i;e.r[i]=((r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16)>>>17}function s(o,a,l){for(;0!=a--;)o.push(0,l)}for(i=0;i<32;i++)e.q[i]=e.S[i]<<3|e.T[i],e.c[i]=e.p[i]<<4|e.z[i];s(e._,144,8),s(e._,112,9),s(e._,24,7),s(e._,8,8),n.H.n(e._,9),n.H.A(e._,9,e.J),n.H.l(e._,9),s(e.$,32,5),n.H.n(e.$,5),n.H.A(e.$,5,e.h),n.H.l(e.$,5),s(e.Q,19,0),s(e.C,286,0),s(e.D,30,0),s(e.v,320,0)}(),n.H.N),Gt.decode._readInterlace=function(n,e){for(var t=e.width,i=e.height,r=Gt.decode._getBPP(e),s=r>>3,o=Math.ceil(t*r/8),a=new Uint8Array(i*o),l=0,c=[0,0,4,0,2,0,1],u=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],d=[8,8,4,4,2,2,1],f=0;f<7;){for(var p=h[f],m=d[f],g=0,_=0,v=c[f];v<i;)v+=p,_++;for(var y=u[f];y<t;)y+=m,g++;var b=Math.ceil(g*r/8);Gt.decode._filterZero(n,e,l,g,_);for(var w=0,M=c[f];M<i;){for(var x=u[f],E=l+w*b<<3;x<t;){if(1==r&&(a[M*o+(x>>3)]|=(n[E>>3]>>7-(7&E)&1)<<7-((7&x)<<0)),2==r&&(a[M*o+(x>>2)]|=(n[E>>3]>>6-(7&E)&3)<<6-((3&x)<<1)),4==r&&(a[M*o+(x>>1)]|=(n[E>>3]>>4-(7&E)&15)<<4-((1&x)<<2)),r>=8)for(var R=M*o+x*s,F=0;F<s;F++)a[R+F]=n[(E>>3)+F];E+=r,x+=m}w++,M+=p}g*_!=0&&(l+=_*(1+b)),f+=1}return a},Gt.decode._getBPP=function(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth},Gt.decode._filterZero=function(n,e,t,i,r){var s=Gt.decode._getBPP(e),o=Math.ceil(i*s/8),a=Gt.decode._paeth;s=Math.ceil(s/8);var l,c,u=n[t],h=0;if(u>1&&(n[t]=[0,0,1][u-2]),3==u)for(h=s;h<o;h++)n[h+1]=n[h+1]+(n[h+1-s]>>>1)&255;for(var d=0;d<r;d++)if(h=0,0==(u=n[(c=(l=t+d*o)+d+1)-1]))for(;h<o;h++)n[l+h]=n[c+h];else if(1==u){for(;h<s;h++)n[l+h]=n[c+h];for(;h<o;h++)n[l+h]=n[c+h]+n[l+h-s]}else if(2==u)for(;h<o;h++)n[l+h]=n[c+h]+n[l+h-o];else if(3==u){for(;h<s;h++)n[l+h]=n[c+h]+(n[l+h-o]>>>1);for(;h<o;h++)n[l+h]=n[c+h]+(n[l+h-o]+n[l+h-s]>>>1)}else{for(;h<s;h++)n[l+h]=n[c+h]+a(0,n[l+h-o],0);for(;h<o;h++)n[l+h]=n[c+h]+a(n[l+h-s],n[l+h-o],n[l+h-s-o])}return n},Gt.decode._paeth=function(n,e,t){var i=n+e-t,r=i-n,s=i-e,o=i-t;return r*r<=s*s&&r*r<=o*o?n:s*s<=o*o?e:t},Gt.decode._IHDR=function(n,e,t){var i=Gt._bin;t.width=i.readUint(n,e),t.height=i.readUint(n,e+=4),t.depth=n[e+=4],e++,t.ctype=n[e],e++,t.compress=n[e],e++,t.filter=n[e],e++,t.interlace=n[e],e++},Gt._bin={nextZero:function(n,e){for(;0!=n[e];)e++;return e},readUshort:function(n,e){return n[e]<<8|n[e+1]},writeUshort:function(n,e,t){n[e]=t>>8&255,n[e+1]=255&t},readUint:function(n,e){return 16777216*n[e]+(n[e+1]<<16|n[e+2]<<8|n[e+3])},writeUint:function(n,e,t){n[e]=t>>24&255,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=255&t},readASCII:function(n,e,t){for(var i="",r=0;r<t;r++)i+=String.fromCharCode(n[e+r]);return i},writeASCII:function(n,e,t){for(var i=0;i<t.length;i++)n[e+i]=t.charCodeAt(i)},readBytes:function(n,e,t){for(var i=[],r=0;r<t;r++)i.push(n[e+r]);return i},pad:function(n){return n.length<2?"0"+n:n},readUTF8:function(n,e,t){for(var r,i="",s=0;s<t;s++)i+="%"+Gt._bin.pad(n[e+s].toString(16));try{r=decodeURIComponent(i)}catch{return Gt._bin.readASCII(n,e,t)}return r}},Gt._copyTile=function(n,e,t,i,r,s,o,a,l){for(var c=Math.min(e,r),u=Math.min(t,s),h=0,d=0,f=0;f<u;f++)for(var p=0;p<c;p++)if(o>=0&&a>=0?(h=f*e+p<<2,d=(a+f)*r+o+p<<2):(h=(-a+f)*e-o+p<<2,d=f*r+p<<2),0==l)i[d]=n[h],i[d+1]=n[h+1],i[d+2]=n[h+2],i[d+3]=n[h+3];else if(1==l){var g=n[h]*(m=.00392156862745098*n[h+3]),_=n[h+1]*m,v=n[h+2]*m,b=i[d]*(y=i[d+3]*(1/255)),w=i[d+1]*y,M=i[d+2]*y,T=1-m,x=m+y*T,E=0==x?0:1/x;i[d+3]=255*x,i[d+0]=(g+b*T)*E,i[d+1]=(_+w*T)*E,i[d+2]=(v+M*T)*E}else if(2==l)g=n[h],_=n[h+1],v=n[h+2],b=i[d],w=i[d+1],M=i[d+2],(m=n[h+3])==(y=i[d+3])&&g==b&&_==w&&v==M?(i[d]=0,i[d+1]=0,i[d+2]=0,i[d+3]=0):(i[d]=g,i[d+1]=_,i[d+2]=v,i[d+3]=m);else if(3==l){var m,y;if(g=n[h],_=n[h+1],v=n[h+2],b=i[d],w=i[d+1],M=i[d+2],(m=n[h+3])==(y=i[d+3])&&g==b&&_==w&&v==M)continue;if(m<220&&y>20)return!1}return!0};const at={decode:function(n,e){null==e&&(e={parseMN:!0,debug:!1});var t=new Uint8Array(n),i=0,s="II"==at._binBE.readASCII(t,i,2)?at._binLE:at._binBE;s.readUshort(t,i+=2);for(var o=s.readUint(t,i+=2),a=[];;){var l=s.readUshort(t,o),c=s.readUshort(t,o+4);if(0!=l&&(c<1||13<c)){console.log("error in TIFF");break}if(at._readIFD(s,t,o,a,0,e),0==(o=s.readUint(t,o+2+12*l)))break}return a},decodeImage:function(n,e,t){if(!e.data){var i=new Uint8Array(n),r=at._binBE.readASCII(i,0,2);if(null!=e.t256){e.isLE="II"==r,e.width=e.t256[0],e.height=e.t257[0];var a,s=e.t259?e.t259[0]:1,o=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&console.log("PlanarConfiguration 2 should not be used!"),7==s&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3)),a=e.t258?Math.min(32,e.t258[0])*e.t258.length:e.t277?e.t277[0]:1,1==s&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(a=Math.round(8*e.t279[0]/(e.width*e.t278[0])));var l=8*Math.ceil(e.width*a/8),c=e.t273;null==c&&(c=e.t324);var u=e.t279;1==s&&1==c.length&&(u=[e.height*(l>>>3)]),null==u&&(u=e.t325);var h=new Uint8Array(e.height*(l>>>3)),d=0;if(null!=e.t322){for(var f=e.t322[0],p=e.t323[0],m=Math.floor((e.width+f-1)/f),g=Math.floor((e.height+p-1)/p),_=new Uint8Array(0|Math.ceil(f*p*a/8)),v=0;v<g;v++)for(var y=0;y<m;y++){for(var b=v*m+y,w=0;w<_.length;w++)_[w]=0;at.decode._decompress(e,t,i,c[b],u[b],s,_,0,o),6==s?h=_:at._copyTile(_,0|Math.ceil(f*a/8),p,h,0|Math.ceil(e.width*a/8),e.height,0|Math.ceil(y*f*a/8),v*p)}d=8*h.length}else{var M=e.t278?e.t278[0]:e.height;for(M=Math.min(M,e.height),b=0;b<c.length;b++)at.decode._decompress(e,t,i,c[b],u[b],s,h,0|Math.ceil(d/8),o),d+=l*M;d=Math.min(d,8*h.length)}e.data=new Uint8Array(h.buffer,0,0|Math.ceil(d/8))}}}};at.decode._decompress=function(n,e,t,i,r,s,o,a){34676==s?at.decode._decodeLogLuv32(n,t,i,r,o,a):console.log("Unsupported compression",s);var l=n.t258?Math.min(32,n.t258[0]):1,c=n.t277?n.t277[0]:1,u=l*c>>>3,h=n.t278?n.t278[0]:n.height,d=Math.ceil(l*c*n.width/8);if(16==l&&!n.isLE&&null==n.t33422)for(var f=0;f<h;f++)for(var p=a+f*d,m=1;m<d;m+=2){var g=o[p+m];o[p+m]=o[p+m-1],o[p+m-1]=g}if(n.t317&&2==n.t317[0])for(f=0;f<h;f++){var _=a+f*d;if(16==l)for(var v=u;v<d;v+=2){var y=(o[_+v+1]<<8|o[_+v])+(o[_+v-u+1]<<8|o[_+v-u]);o[_+v]=255&y,o[_+v+1]=y>>>8&255}else if(3==c)for(v=3;v<d;v+=3)o[_+v]=o[_+v]+o[_+v-3]&255,o[_+v+1]=o[_+v+1]+o[_+v-2]&255,o[_+v+2]=o[_+v+2]+o[_+v-1]&255;else for(v=u;v<d;v++)o[_+v]=o[_+v]+o[_+v-u]&255}},at.decode._decodeLogLuv32=function(n,e,t,i,r,s){for(var o=n.width,a=4*o,l=0,c=new Uint8Array(a);l<i;){for(var u=0;u<a;){var h=e[t+l];if(l++,h<128){for(var d=0;d<h;d++)c[u+d]=e[t+l+d];u+=h,l+=h}else{for(h-=126,d=0;d<h;d++)c[u+d]=e[t+l];u+=h,l++}}for(var f=0;f<o;f++)r[s+0]=c[f],r[s+1]=c[f+o],r[s+2]=c[f+2*o],r[s+4]=c[f+3*o],s+=6}},at.tags={},at._types=function(){var n=new Array(250);return n.fill(0),{basic:{main:n=n.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),at._readIFD=function(n,e,t,i,r,s){var o=n.readUshort(e,t);t+=2;var a={};s.debug&&console.log("   ".repeat(r),i.length-1,">>>----------------");for(var l=0;l<o;l++){var c=n.readUshort(e,t),u=n.readUshort(e,t+=2),h=n.readUint(e,t+=2),d=n.readUint(e,t+=4);t+=4;var f=[];if((1==u||7==u)&&(f=new Uint8Array(e.buffer,h<5?t-4:d,h)),2==u){var p=h<5?t-4:d,m=e[p],g=Math.max(0,Math.min(h-1,e.length-p));m<128||0==g?f.push(n.readASCII(e,p,g)):f=new Uint8Array(e.buffer,p,g)}if(3==u)for(var _=0;_<h;_++)f.push(n.readUshort(e,(h<3?t-4:d)+2*_));if(4==u||13==u)for(_=0;_<h;_++)f.push(n.readUint(e,(h<2?t-4:d)+4*_));if(5==u||10==u){var v=5==u?n.readUint:n.readInt;for(_=0;_<h;_++)f.push([v(e,d+8*_),v(e,d+8*_+4)])}if(8==u)for(_=0;_<h;_++)f.push(n.readShort(e,(h<3?t-4:d)+2*_));if(9==u)for(_=0;_<h;_++)f.push(n.readInt(e,(h<2?t-4:d)+4*_));if(11==u)for(_=0;_<h;_++)f.push(n.readFloat(e,d+4*_));if(12==u)for(_=0;_<h;_++)f.push(n.readDouble(e,d+8*_));if(0==h||0!=f.length){if(s.debug&&console.log("   ".repeat(r),c,u,at.tags[c],f),a["t"+c]=f,330==c||34665==c||34853==c||50740==c&&n.readUshort(e,n.readUint(f,0))<300||61440==c){var y=50740==c?[n.readUint(f,0)]:f,b=[];for(_=0;_<y.length;_++)at._readIFD(n,e,y[_],b,r+1,s);330==c&&(a.subIFD=b),34665==c&&(a.exifIFD=b[0]),34853==c&&(a.gpsiIFD=b[0]),50740==c&&(a.dngPrvt=b[0]),61440==c&&(a.fujiIFD=b[0])}if(37500==c&&s.parseMN){var w=f;if("Nikon"==n.readASCII(w,0,5))a.makerNote=at.decode(w.slice(10).buffer)[0];else if(n.readUshort(e,d)<300&&n.readUshort(e,d+4)<=12){var M=[];at._readIFD(n,e,d,M,r+1,s),a.makerNote=M[0]}}}else if(console.log(c,"unknown TIFF tag type: ",u,"num:",h),0==l)return}return i.push(a),s.debug&&console.log("   ".repeat(r),"<<<---------------"),t},at.toRGBA=function(n,e){const t=n.width,i=n.height,r=t*i,s=n.data;let o;switch(e){case rl:o=new Uint16Array(4*r);break;case so:o=new Float32Array(4*r);break;default:console.error("THREE.LogLuvLoader: Unsupported texture data type:",e)}let a=n.t262?n.t262[0]:2;const l=n.t258?Math.min(32,n.t258[0]):1;if(null==n.t262&&1==l&&(a=0),32845==a)for(let c=0;c<i;c++)for(let u=0;u<t;u++){const h=6*(c*t+u),d=4*(c*t+u);let f=s[h+1]<<8|s[h];f=Math.pow(2,(f+.5)/256-64);const p=(s[h+3]+.5)/410,m=(s[h+5]+.5)/410,g=9*p/(6*p-16*m+12),_=4*m/(6*p-16*m+12),y=g*f/_,w=(1-g-_)*f/_,M=2.69*y-1.276*f-.414*w,T=-1.022*y+1.978*f+.044*w,x=.061*y-.224*f+1.163*w;e===rl?(o[d]=gp.toHalfFloat(Math.min(M,65504)),o[d+1]=gp.toHalfFloat(Math.min(T,65504)),o[d+2]=gp.toHalfFloat(Math.min(x,65504)),o[d+3]=gp.toHalfFloat(1)):(o[d]=M,o[d+1]=T,o[d+2]=x,o[d+3]=1)}else console.log("Unsupported Photometric interpretation: "+a);return o},at._binBE={nextZero:function(n,e){for(;0!=n[e];)e++;return e},readUshort:function(n,e){return n[e]<<8|n[e+1]},readShort:function(n,e){var t=at._binBE.ui8;return t[0]=n[e+1],t[1]=n[e+0],at._binBE.i16[0]},readInt:function(n,e){var t=at._binBE.ui8;return t[0]=n[e+3],t[1]=n[e+2],t[2]=n[e+1],t[3]=n[e+0],at._binBE.i32[0]},readUint:function(n,e){var t=at._binBE.ui8;return t[0]=n[e+3],t[1]=n[e+2],t[2]=n[e+1],t[3]=n[e+0],at._binBE.ui32[0]},readASCII:function(n,e,t){for(var i="",r=0;r<t;r++)i+=String.fromCharCode(n[e+r]);return i},readFloat:function(n,e){for(var t=at._binBE.ui8,i=0;i<4;i++)t[i]=n[e+3-i];return at._binBE.fl32[0]},readDouble:function(n,e){for(var t=at._binBE.ui8,i=0;i<8;i++)t[i]=n[e+7-i];return at._binBE.fl64[0]},writeUshort:function(n,e,t){n[e]=t>>8&255,n[e+1]=255&t},writeInt:function(n,e,t){var i=at._binBE.ui8;at._binBE.i32[0]=t,n[e+3]=i[0],n[e+2]=i[1],n[e+1]=i[2],n[e+0]=i[3]},writeUint:function(n,e,t){n[e]=t>>24&255,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t>>0&255},writeASCII:function(n,e,t){for(var i=0;i<t.length;i++)n[e+i]=t.charCodeAt(i)},writeDouble:function(n,e,t){at._binBE.fl64[0]=t;for(var i=0;i<8;i++)n[e+i]=at._binBE.ui8[7-i]}},at._binBE.ui8=new Uint8Array(8),at._binBE.i16=new Int16Array(at._binBE.ui8.buffer),at._binBE.i32=new Int32Array(at._binBE.ui8.buffer),at._binBE.ui32=new Uint32Array(at._binBE.ui8.buffer),at._binBE.fl32=new Float32Array(at._binBE.ui8.buffer),at._binBE.fl64=new Float64Array(at._binBE.ui8.buffer),at._binLE={nextZero:at._binBE.nextZero,readUshort:function(n,e){return n[e+1]<<8|n[e]},readShort:function(n,e){var t=at._binBE.ui8;return t[0]=n[e+0],t[1]=n[e+1],at._binBE.i16[0]},readInt:function(n,e){var t=at._binBE.ui8;return t[0]=n[e+0],t[1]=n[e+1],t[2]=n[e+2],t[3]=n[e+3],at._binBE.i32[0]},readUint:function(n,e){var t=at._binBE.ui8;return t[0]=n[e+0],t[1]=n[e+1],t[2]=n[e+2],t[3]=n[e+3],at._binBE.ui32[0]},readASCII:at._binBE.readASCII,readFloat:function(n,e){for(var t=at._binBE.ui8,i=0;i<4;i++)t[i]=n[e+i];return at._binBE.fl32[0]},readDouble:function(n,e){for(var t=at._binBE.ui8,i=0;i<8;i++)t[i]=n[e+i];return at._binBE.fl64[0]},writeUshort:function(n,e,t){n[e]=255&t,n[e+1]=t>>8&255},writeInt:function(n,e,t){var i=at._binBE.ui8;at._binBE.i32[0]=t,n[e+0]=i[0],n[e+1]=i[1],n[e+2]=i[2],n[e+3]=i[3]},writeUint:function(n,e,t){n[e]=t>>>0&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},writeASCII:at._binBE.writeASCII},at._copyTile=function(n,e,t,i,r,s,o,a){for(var l=Math.min(e,r-o),c=Math.min(t,s-a),u=0;u<c;u++)for(var h=(a+u)*r+o,d=u*e,f=0;f<l;f++)i[h+f]=n[d+f]};const Cy=new Ce;class wce extends Pr{constructor(e){super(e),this.propertyNameMapping={}}load(e,t,i,r){const s=this,o=new Es(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}setPropertyNameMapping(e){this.propertyNameMapping=e}parse(e){function t(f){let m="",g=0;const _=/^ply([\s\S]*)end_header\r?\n/.exec(f);null!==_&&(m=_[1],g=new Blob([_[0]]).size);const v={comments:[],elements:[],headerLength:g,objInfo:""},y=m.split("\n");let b;function w(M,T){const x={type:M[0]};return"list"===x.type?(x.name=M[3],x.countType=M[1],x.itemType=M[2]):x.name=M[1],x.name in T&&(x.name=T[x.name]),x}for(let M=0;M<y.length;M++){let T=y[M];if(T=T.trim(),""===T)continue;const x=T.split(/\s+/),E=x.shift();switch(T=x.join(" "),E){case"format":v.format=x[0],v.version=x[1];break;case"comment":v.comments.push(T);break;case"element":void 0!==b&&v.elements.push(b),b={},b.name=x[0],b.count=parseInt(x[1]),b.properties=[];break;case"property":b.properties.push(w(x,d.propertyNameMapping));break;case"obj_info":v.objInfo=T;break;default:console.log("unhandled",E,x)}}return void 0!==b&&v.elements.push(b),v}function i(f,p){switch(p){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(f);case"float":case"double":case"float32":case"float64":return parseFloat(f)}}function r(f,p){const m=p.split(/\s+/),g={};for(let _=0;_<f.length;_++)if("list"===f[_].type){const v=[],y=i(m.shift(),f[_].countType);for(let b=0;b<y;b++)v.push(i(m.shift(),f[_].itemType));g[f[_].name]=v}else g[f[_].name]=i(m.shift(),f[_].type);return g}function s(f,p){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};let g,v="";null!==(g=/end_header\s([\s\S]*)$/.exec(f))&&(v=g[1]);const y=v.split("\n");let b=0,w=0;for(let M=0;M<y.length;M++){let T=y[M];if(T=T.trim(),""===T)continue;w>=p.elements[b].count&&(b++,w=0);const x=r(p.elements[b].properties,T);a(m,p.elements[b].name,x),w++}return o(m)}function o(f){let p=new wt;return f.indices.length>0&&p.setIndex(f.indices),p.setAttribute("position",new $e(f.vertices,3)),f.normals.length>0&&p.setAttribute("normal",new $e(f.normals,3)),f.uvs.length>0&&p.setAttribute("uv",new $e(f.uvs,2)),f.colors.length>0&&p.setAttribute("color",new $e(f.colors,3)),f.faceVertexUvs.length>0&&(p=p.toNonIndexed(),p.setAttribute("uv",new $e(f.faceVertexUvs,2))),p.computeBoundingSphere(),p}function a(f,p,m){function g(V){for(let H=0,j=V.length;H<j;H++){const q=V[H];if(q in m)return q}return null}const _=g(["x","px","posx"])||"x",v=g(["y","py","posy"])||"y",y=g(["z","pz","posz"])||"z",b=g(["nx","normalx"]),w=g(["ny","normaly"]),M=g(["nz","normalz"]),T=g(["s","u","texture_u","tx"]),x=g(["t","v","texture_v","ty"]),E=g(["red","diffuse_red","r","diffuse_r"]),R=g(["green","diffuse_green","g","diffuse_g"]),F=g(["blue","diffuse_blue","b","diffuse_b"]);if("vertex"===p)f.vertices.push(m[_],m[v],m[y]),null!==b&&null!==w&&null!==M&&f.normals.push(m[b],m[w],m[M]),null!==T&&null!==x&&f.uvs.push(m[T],m[x]),null!==E&&null!==R&&null!==F&&(Cy.setRGB(m[E]/255,m[R]/255,m[F]/255).convertSRGBToLinear(),f.colors.push(Cy.r,Cy.g,Cy.b));else if("face"===p){const V=m.vertex_indices||m.vertex_index,H=m.texcoord;3===V.length?(f.indices.push(V[0],V[1],V[2]),H&&6===H.length&&(f.faceVertexUvs.push(H[0],H[1]),f.faceVertexUvs.push(H[2],H[3]),f.faceVertexUvs.push(H[4],H[5]))):4===V.length&&(f.indices.push(V[0],V[1],V[3]),f.indices.push(V[1],V[2],V[3]))}}function l(f,p,m,g){switch(m){case"int8":case"char":return[f.getInt8(p),1];case"uint8":case"uchar":return[f.getUint8(p),1];case"int16":case"short":return[f.getInt16(p,g),2];case"uint16":case"ushort":return[f.getUint16(p,g),2];case"int32":case"int":return[f.getInt32(p,g),4];case"uint32":case"uint":return[f.getUint32(p,g),4];case"float32":case"float":return[f.getFloat32(p,g),4];case"float64":case"double":return[f.getFloat64(p,g),8]}}function c(f,p,m,g){const _={};let v,y=0;for(let b=0;b<m.length;b++)if("list"===m[b].type){const w=[];v=l(f,p+y,m[b].countType,g);const M=v[0];y+=v[1];for(let T=0;T<M;T++)v=l(f,p+y,m[b].itemType,g),w.push(v[0]),y+=v[1];_[m[b].name]=w}else v=l(f,p+y,m[b].type,g),_[m[b].name]=v[0],y+=v[1];return[_,y]}let h;const d=this;if(e instanceof ArrayBuffer){const f=_o.decodeText(new Uint8Array(e)),p=t(f);h="ascii"===p.format?s(f,p):function u(f,p){const m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},g="binary_little_endian"===p.format,_=new DataView(f,p.headerLength);let v,y=0;for(let b=0;b<p.elements.length;b++)for(let w=0;w<p.elements[b].count;w++)v=c(_,y,p.elements[b].properties,g),y+=v[1],a(m,p.elements[b].name,v[0]);return o(m)}(e,p)}else h=s(e,t(e));return h}}let Mce=(()=>{class n extends FN{constructor(){super(...arguments),this.clazz=wce}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Sce=(()=>{class n extends kN{constructor(t,i,r){super(t,i),this.host=t,this.zone=i,this.service=r}getRefFromResponse(t){return t.computeVertexNormals(),t}load(){var t=this;return no(function*(){if(!t.initialized)return;if(void 0===t._url)throw new Error("missing url");const i=t._url,r=fT(t.onProgress$)?o=>{t.onProgress$?.next(o)}:void 0,s=yield t.zone.runOutsideAngular(()=>t.service.load(i,r));t.host.objRef=t.getRefFromResponse(s),t.onLoaded$&&void 0!==s&&t.onLoaded$?.next(s)})()}}return n.\u0275fac=function(t){return new(t||n)(N(bo,1),N(Pt),N(Mce))},n.\u0275dir=tt({type:n,selectors:[["","loadPLY",""]],features:[Se]}),n})(),jj=(()=>{class n extends Zh{getType(){return mo}set type(t){this._objRef&&(this._objRef.type=t)}set defines(t){this._objRef&&(this._objRef.defines=t)}set color(t){this._objRef&&(this._objRef.color=Lt(this._objRef.color,t))}set roughness(t){this._objRef&&(this._objRef.roughness=t)}set metalness(t){this._objRef&&(this._objRef.metalness=t)}set map(t){this._objRef&&(this._objRef.map=t)}set lightMap(t){this._objRef&&(this._objRef.lightMap=t)}set lightMapIntensity(t){this._objRef&&(this._objRef.lightMapIntensity=t)}set aoMap(t){this._objRef&&(this._objRef.aoMap=t)}set aoMapIntensity(t){this._objRef&&(this._objRef.aoMapIntensity=t)}set emissive(t){this._objRef&&(this._objRef.emissive=Lt(this._objRef.emissive,t))}set emissiveIntensity(t){this._objRef&&(this._objRef.emissiveIntensity=t)}set emissiveMap(t){this._objRef&&(this._objRef.emissiveMap=t)}set bumpMap(t){this._objRef&&(this._objRef.bumpMap=t)}set bumpScale(t){this._objRef&&(this._objRef.bumpScale=t)}set normalMap(t){this._objRef&&(this._objRef.normalMap=t)}set normalMapType(t){this._objRef&&(this._objRef.normalMapType=t)}set normalScale(t){this._objRef&&(this._objRef.normalScale=Lt(this._objRef.normalScale,t))}set displacementMap(t){this._objRef&&(this._objRef.displacementMap=t)}set displacementScale(t){this._objRef&&(this._objRef.displacementScale=t)}set displacementBias(t){this._objRef&&(this._objRef.displacementBias=t)}set roughnessMap(t){this._objRef&&(this._objRef.roughnessMap=t)}set metalnessMap(t){this._objRef&&(this._objRef.metalnessMap=t)}set alphaMap(t){this._objRef&&(this._objRef.alphaMap=t)}set envMap(t){this._objRef&&(this._objRef.envMap=t)}set envMapIntensity(t){this._objRef&&(this._objRef.envMapIntensity=t)}set wireframe(t){this._objRef&&(this._objRef.wireframe=t)}set wireframeLinewidth(t){this._objRef&&(this._objRef.wireframeLinewidth=t)}set wireframeLinecap(t){this._objRef&&(this._objRef.wireframeLinecap=t)}set wireframeLinejoin(t){this._objRef&&(this._objRef.wireframeLinejoin=t)}set flatShading(t){this._objRef&&(this._objRef.flatShading=t)}set fog(t){this._objRef&&(this._objRef.fog=t)}set isMeshStandardMaterial(t){this._objRef&&(this._objRef.isMeshStandardMaterial=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-meshStandardMaterial"]],inputs:{type:"type",defines:"defines",color:"color",roughness:"roughness",metalness:"metalness",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",roughnessMap:"roughnessMap",metalnessMap:"metalnessMap",alphaMap:"alphaMap",envMap:"envMap",envMapIntensity:"envMapIntensity",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",fog:"fog",isMeshStandardMaterial:"isMeshStandardMaterial"},features:[Xe([{provide:Zh,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Tce=(()=>{class n extends bo{getType(){return ho}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-polyhedronGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:bo,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Cce=(()=>{class n extends Tce{getType(){return Ic}set type(t){this._objRef&&(this._objRef.type=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-icosahedronGeometry"]],inputs:{type:"type"},features:[Xe([{provide:bo,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Ece=["slider"],Dce=function(){return[35,2,.1,100]},Ace=function(){return[0,0,6]},Rce=function(n,e){return{x:0,y:0,width:n,height:e}},Pce=function(){return["#ffffff","#444444",1]},Ice=function(n){return[n,2,2]},Lce=function(){return[1,3]},Fce=function(n,e,t){return{x:n,y:0,width:e,height:t}};let kce=(()=>{class n{constructor(){this.sliderPos=0,this.controlsEnabled=!0,this.colorLeft=new Ce(12375183),this.colorRight=new Ce(9419988)}ngOnInit(){!this.slider||!this.canvas||(this.slider.nativeElement.style.touchAction="none",this.sliderPos=(this.canvas.rendererCanvas?.nativeElement.clientWidth||0)/2)}onPointerMove(t){if(this.controlsEnabled||!this.canvas||!this.canvas.rendererCanvas||!this.slider||!1===t.isPrimary)return;const r=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.sliderPos=Math.max(r.left,Math.min(r.right,t.pageX))-r.left,this.slider.nativeElement.style.left=this.sliderPos-this.slider.nativeElement.offsetWidth/2+"px"}onPointerUp(){this.controlsEnabled=!0}onSliderPointerDown(t){!1!==t.isPrimary&&(this.controlsEnabled=!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-multi-scene-example"]],viewQuery:function(t,i){if(1&t&&(Pn(Ece,7),Pn(ir,7)),2&t){let r;Et(r=Dt())&&(i.slider=r.first),Et(r=Dt())&&(i.canvas=r.first)}},hostBindings:function(t,i){1&t&&gt("pointermove",function(s){return i.onPointerMove(s)},!1,Sb)("pointerup",function(){return i.onPointerUp()},!1,Sb)},decls:20,vars:32,consts:[[1,"slider",3,"pointerdown"],["slider",""],[3,"disableDefaultView"],["thecanvas",""],[3,"args","position"],["cam",""],[3,"scissor","scissorTest","clearColor","camera"],[3,"background"],["light",""],[3,"args"],["geo",""],[3,"objRef"],[3,"geometry"],[3,"wireframe"]],template:function(t,i){if(1&t&&(pe(0,"div",0,1),gt("pointerdown",function(s){return i.onSliderPointerDown(s)}),Te(),pe(2,"th-canvas",2,3)(4,"th-perspectiveCamera",4,5),Ye(6,"th-orbitControls"),Te(),pe(7,"th-view",6)(8,"th-scene",7),Ye(9,"th-hemisphereLight",4,8),pe(11,"th-mesh"),Ye(12,"th-meshStandardMaterial")(13,"th-icosahedronGeometry",9,10),Te()()(),pe(15,"th-view",6)(16,"th-scene",7),Ye(17,"th-light",11),pe(18,"th-mesh",12),Ye(19,"th-meshStandardMaterial",13),Te()()()()),2&t){const r=yn(3),s=yn(5),o=yn(10),a=yn(14);se(2),Q("disableDefaultView",!0),se(2),Q("args",Ee(19,Dce))("position",Ee(20,Ace)),se(3),Q("scissor",ic(21,Rce,i.sliderPos,(null==r.rendererCanvas||null==r.rendererCanvas.nativeElement?null:r.rendererCanvas.nativeElement.height)||0))("scissorTest",!0)("clearColor",i.colorLeft)("camera",s),se(1),Q("background",i.colorLeft),se(1),Q("args",Ee(24,Pce))("position",Tn(25,Ice,-2)),se(4),Q("args",Ee(27,Lce)),se(2),Q("scissor",bg(28,Fce,i.sliderPos,(null==r.rendererCanvas||null==r.rendererCanvas.nativeElement?null:r.rendererCanvas.nativeElement.width)||0,(null==r.rendererCanvas||null==r.rendererCanvas.nativeElement?null:r.rendererCanvas.nativeElement.height)||0))("scissorTest",!0)("clearColor",i.colorRight)("camera",s),se(1),Q("background",i.colorRight),se(1),Q("objRef",null==o.objRef?null:o.objRef.clone()),se(1),Q("geometry",a.objRef),se(1),Q("wireframe",!0)}},dependencies:[Cp,Ir,_T,_p,Ds,mr,jj,Cce,ir,xl],styles:[".container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.slider[_ngcontent-%COMP%]{position:absolute;cursor:ew-resize;width:40px;height:40px;background-color:#f32196;opacity:.7;border-radius:50%;top:calc(50% - 20px);left:calc(50% - 20px)}"],changeDetection:0}),n})();const Uj={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float amount;\n\t\tuniform float angle;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\tvec4 cr = texture2D(tDiffuse, vUv + offset);\n\t\t\tvec4 cga = texture2D(tDiffuse, vUv);\n\t\t\tvec4 cb = texture2D(tDiffuse, vUv - offset);\n\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\n\t\t}"};let FC=(()=>{class n extends bo{getType(){return Ca}set type(t){this._objRef&&(this._objRef.type=t)}set parameters(t){this._objRef&&(this._objRef.parameters=t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-sphereGeometry"]],inputs:{type:"type",parameters:"parameters"},features:[Xe([{provide:bo,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const Oce=["thecanvas"],Nce=function(n,e){return{x:0,y:0,width:n,height:e}},Bce=function(){return[0,0,1]},jce=function(){return["#ffffff"]},Uce=function(){return[0,0,0]},Ey=function(n){return[n,0,0]},Vce=function(){return[200,32,16]},zce=function(){return["#fac400"]},Hce=function(){return["#f83f0d"]},Gce=function(){return[400,0,0]},kC=function(n,e,t,i){return{x:n,y:e,width:t,height:i}},Wce=function(n){return[n]},Xce=function(){return{value:.055}},qce=function(n){return{amount:n}},Zce=function(){return[.35,.5,2048,!0]};let Yce=(()=>{class n{constructor(){this.Math=Math,this.RGBShiftShader=Uj,this.DotScreenShader=Cj,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.view1={left:0,bottom:0,width:.5,height:1,background:new Ce(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(t,i)=>{this.updateSize(),t.position.x+=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(i.position),t.updateProjectionMatrix()}},this.view2={left:.5,bottom:0,width:.5,height:.5,background:new Ce(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(t,i)=>{this.updateSize(),t.position.x-=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(t.position.clone().setY(0)),t.updateProjectionMatrix()}},this.view3={left:.5,bottom:.5,width:.5,height:.5,background:new Ce(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(t,i)=>{this.updateSize(),t.position.y-=.05*this.mouseX,t.position.y=Math.max(Math.min(t.position.y,1600),-1600),t.lookAt(i.position),t.updateProjectionMatrix()}}}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new OS(this.canvas.rendererCanvas.nativeElement))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.nativeElement.width,this.canvasHeight=this.canvas.rendererCanvas.nativeElement.height)}onMouseMove(t){if(!this.canvas||!this.canvas.rendererCanvas)return;const i=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.mouseX=t.clientX-i.left-i.width/2,this.mouseY=t.clientY-i.right-i.height/2}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-multi-view-postprocessing-example"]],viewQuery:function(t,i){if(1&t&&Pn(Oce,7),2&t){let r;Et(r=Dt())&&(i.canvas=r.first)}},hostBindings:function(t,i){1&t&&gt("mousemove",function(s){return i.onMouseMove(s)},!1,Qm)},decls:32,vars:95,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","onRender"],["thview1",""],[3,"position","up","fov","aspect","near","far"],["camera1",""],[3,"clearColor"],[3,"strength"],[3,"args","uniforms"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview2",""],["camera2",""],["thview3",""],["camera3",""]],template:function(t,i){if(1&t){const r=Io();pe(0,"th-canvas",0,1)(2,"th-scene",null,2),Ye(4,"th-directionalLight",3),pe(5,"th-mesh",4),Ye(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Te(),Ye(10,"th-mesh",9)(11,"th-mesh",9),Te(),pe(12,"th-view",10,11),gt("onRender",function(){Br(r);const o=yn(15),a=yn(3);return jr(i.view1.updateCamera(o.objRef,a.objRef))}),Ye(14,"th-perspectiveCamera",12,13),pe(16,"th-effectComposer"),Ye(17,"th-renderPass",14)(18,"th-unrealBloomPass",15)(19,"th-shaderPass",16)(20,"th-glitchPass"),Te()(),pe(21,"th-view",17,18),gt("onRender",function(){Br(r);const o=yn(24),a=yn(3);return jr(i.view2.updateCamera(o.objRef,a.objRef))}),Ye(23,"th-perspectiveCamera",12,19),pe(25,"th-effectComposer"),Ye(26,"th-renderPass")(27,"th-filmPass",5),Te()(),pe(28,"th-view",17,20),gt("onRender",function(){Br(r);const o=yn(31),a=yn(3);return jr(i.view3.updateCamera(o.objRef,a.objRef))}),Ye(30,"th-perspectiveCamera",12,21),Te()()}if(2&t){const r=yn(3),s=yn(7),o=yn(9),a=yn(13),l=yn(22),c=yn(29);Q("disableDefaultView",!0)("viewPort",ic(56,Nce,.5*i.canvasWidth,i.canvasHeight)),se(4),Q("position",Ee(59,Bce))("args",Ee(60,jce)),se(1),Q("position",Ee(61,Uce))("rotation",Tn(62,Ey,-i.Math.PI/2)),se(1),Q("args",Ee(64,Vce)),se(2),Q("flatShading",!1)("shininess",30)("specular",Ee(65,zce))("color",Ee(66,Hce)),se(2),Q("position",Tn(67,Ey,-400))("rotation",Tn(69,Ey,-i.Math.PI/2))("geometry",s.objRef)("material",o.objRef),se(1),Q("position",Ee(71,Gce))("rotation",Tn(72,Ey,-i.Math.PI/2))("geometry",s.objRef)("material",o.objRef),se(1),Q("scene",r)("viewPort",df(74,kC,i.view1.left*i.canvasWidth,i.view1.bottom*i.canvasHeight,i.view1.width*i.canvasWidth,i.view1.height*i.canvasHeight))("scissor",a.viewPort)("scissorTest",!0),se(2),Q("position",i.view1.eye)("up",i.view1.up)("fov",i.view1.fov)("aspect",i.view1.width*i.canvasWidth/(i.view1.height*i.canvasHeight))("near",1)("far",1e4),se(3),Q("clearColor",i.view1.background),se(1),Q("strength",.2),se(1),Q("args",Tn(79,Wce,i.RGBShiftShader))("uniforms",Tn(82,qce,Ee(81,Xce))),se(2),Q("scene",r)("viewPort",df(84,kC,i.view2.left*i.canvasWidth,i.view2.bottom*i.canvasHeight,i.view2.width*i.canvasWidth,i.view2.height*i.canvasHeight))("scissor",l.viewPort)("scissorTest",!0)("clearColor",i.view2.background),se(2),Q("position",i.view2.eye)("up",i.view2.up)("fov",i.view2.fov)("aspect",i.view2.width*i.canvasWidth/(i.view2.height*i.canvasHeight))("near",1)("far",1e4),se(4),Q("args",Ee(89,Zce)),se(1),Q("scene",r)("viewPort",df(90,kC,i.view3.left*i.canvasWidth,i.view3.bottom*i.canvasHeight,i.view3.width*i.canvasWidth,i.view3.height*i.canvasHeight))("scissor",c.viewPort)("scissorTest",!0)("clearColor",i.view3.background),se(2),Q("position",i.view3.eye)("up",i.view3.up)("fov",i.view3.fov)("aspect",i.view3.width*i.canvasWidth/(i.view3.height*i.canvasHeight))("near",1)("far",1e4)}},dependencies:[Ir,vp,Ds,mr,Yh,FC,vy,ice,uce,dj,Fj,Bj,ir,xl],encapsulation:2,changeDetection:0}),n})(),Vj=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(N(ua),N(qt))},n.\u0275dir=tt({type:n}),n})(),eu=(()=>{class n extends Vj{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275dir=tt({type:n,features:[Se]}),n})();const Fs=new He("NgValueAccessor"),Kce={provide:Fs,useExisting:Ze(()=>OC),multi:!0};let OC=(()=>{class n extends eu{writeValue(t){this.setProperty("checked",t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275dir=tt({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,i){1&t&&gt("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[Xe([Kce]),Se]}),n})();const Qce={provide:Fs,useExisting:Ze(()=>Dy),multi:!0},Jce=new He("CompositionEventMode");let Dy=(()=>{class n extends Vj{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function $ce(){const n=No()?No().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(N(ua),N(qt),N(Jce,8))},n.\u0275dir=tt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&gt("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[Xe([Qce]),Se]}),n})();const vr=new He("NgValidators"),Fl=new He("NgAsyncValidators");function Qj(n){return null!=n}function $j(n){const e=ef(n)?vi(n):n;return Cx(e),e}function Jj(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function eU(n,e){return e.map(t=>t(n))}function tU(n){return n.map(e=>function tue(n){return!n.validate}(e)?e:t=>e.validate(t))}function NC(n){return null!=n?function nU(n){if(!n)return null;const e=n.filter(Qj);return 0==e.length?null:function(t){return Jj(eU(t,e))}}(tU(n)):null}function BC(n){return null!=n?function iU(n){if(!n)return null;const e=n.filter(Qj);return 0==e.length?null:function(t){return k3(eU(t,e).map($j)).pipe(xt(Jj))}}(tU(n)):null}function rU(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function jC(n){return n?Array.isArray(n)?n:[n]:[]}function Ry(n,e){return Array.isArray(n)?n.includes(e):n===e}function aU(n,e){const t=jC(e);return jC(n).forEach(r=>{Ry(t,r)||t.push(r)}),t}function lU(n,e){return jC(e).filter(t=>!Ry(n,t))}class cU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=NC(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=BC(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Fr extends cU{get formDirective(){return null}get path(){return null}}class kl extends cU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let UC=(()=>{class n extends class uU{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(N(kl,2))},n.\u0275dir=tt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&pn("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Se]}),n})();const rm="VALID",Iy="INVALID",xd="PENDING",sm="DISABLED";function dU(n){return Array.isArray(n)?NC(n):n||null}function fU(n){return Array.isArray(n)?BC(n):n||null}function Ly(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function om(n,e){(function qC(n,e){const t=function sU(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(rU(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function oU(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(rU(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Oy(e._rawValidators,r),Oy(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),n.disabled&&e.valueAccessor.setDisabledState?.(!0),function hue(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&_U(n,e)})}(n,e),function fue(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function due(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&_U(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function uue(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Oy(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function _U(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function xU(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function wU(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const xue={provide:kl,useExisting:Ze(()=>By)},CU=(()=>Promise.resolve(null))();let By=(()=>{class n extends kl{constructor(t,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new class extends class gU{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=dU(this._rawValidators),this._composedAsyncValidatorFn=fU(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===rm}get invalid(){return this.status===Iy}get pending(){return this.status==xd}get disabled(){return this.status===sm}get enabled(){return this.status!==sm}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=dU(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=fU(e)}addValidators(e){this.setValidators(aU(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(aU(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(lU(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(lU(e,this._rawAsyncValidators))}hasValidator(e){return Ry(this._rawValidators,e)}hasAsyncValidator(e){return Ry(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=xd,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=sm,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=rm,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===rm||this.status===xd)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sm:rm}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=xd,this._hasOwnPendingAsyncValidator=!0;const t=$j(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new yt,this.statusChanges=new yt}_calculateStatus(){return this._allControlsDisabled()?sm:this.errors?Iy:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xd)?xd:this._anyControlsHaveStatus(Iy)?Iy:rm}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ly(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}{constructor(e=null,t,i){super(function GC(n){return(Ly(n)?n.validators:n)||null}(t),function WC(n,e){return(Ly(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ly(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=wU(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){xU(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){xU(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){wU(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},this._registered=!1,this.update=new yt,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function YC(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===Dy?t=s:function gue(n){return Object.getPrototypeOf(n.constructor)===eu}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function ZC(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){om(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){CU.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&ha(i);CU.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function Fy(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(N(Fr,9),N(vr,10),N(Fl,10),N(Fs,10),N(Ei,8))},n.\u0275dir=tt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Xe([xue]),Se,$i]}),n})(),DU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({}),n})();const Cue={provide:Fs,useExisting:Ze(()=>QC),multi:!0};let QC=(()=>{class n extends eu{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275dir=tt({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,i){1&t&&gt("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[Xe([Cue]),Se]}),n})();const Iue={provide:Fs,useExisting:Ze(()=>jy),multi:!0};function FU(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let jy=(()=>{class n extends eu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=FU(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function Lue(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275dir=tt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,i){1&t&&gt("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Xe([Iue]),Se]}),n})(),kU=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(FU(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(ua),N(jy,9))},n.\u0275dir=tt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const Fue={provide:Fs,useExisting:Ze(()=>t1),multi:!0};function OU(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let t1=(()=>{class n extends eu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const c=this._getOptionValue(o[a].value);r.push(c)}}else{const o=i.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function kue(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275dir=tt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,i){1&t&&gt("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Xe([Fue]),Se]}),n})(),NU=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(OU(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(OU(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(ua),N(t1,9))},n.\u0275dir=tt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),Gue=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[DU]}),n})(),Wue=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Gue]}),n})();function Zue(n,e){1&n&&Ye(0,"th-orbitControls")}function Yue(n,e){1&n&&Ye(0,"th-mapControls")}function Kue(n,e){1&n&&Ye(0,"th-arcballControls")}function Que(n,e){1&n&&Ye(0,"th-transformControls",17),2&n&&(ii(),Q("object",yn(26).objRef))}const $ue=function(n){return[n]},Jue=function(n,e,t){return[n,e,t]};function ehe(n,e){if(1&n&&Ye(0,"th-dragControls",10),2&n){ii();const t=yn(26),i=yn(30),r=yn(22);Q("args",bg(3,Jue,Tn(1,$ue,t.objRef),i.objRef,null==r.rendererCanvas?null:r.rendererCanvas.nativeElement))}}function the(n,e){1&n&&Ye(0,"th-flyControls")}function nhe(n,e){1&n&&Ye(0,"th-trackballControls")}function ihe(n,e){1&n&&Ye(0,"th-firstPersonControls")}const rhe=function(){return[2,2,2]},she=function(){return[1,1,1]},ohe=function(){return[10,10]},qU=function(){return[10,10,10]},ahe=function(){return[45,2,.1,100]},lhe=function(){return[0,0,0]};let che=(()=>{class n{constructor(){this.controlType="orbit",this.renderOnDemand=!0,this.selected=!1,this.glbPath=`${Ra}DamagedHelmet.glb`}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-on-demand-example"]],decls:39,vars:27,consts:[[1,"control-panel"],["id","ondemand","type","checkbox",3,"ngModel","ngModelChange"],["for","ondemand"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"works-on-demand"],[1,"needs-loop"],[3,"thStats","renderOnDemand"],["canvas",""],["loadGLTF","",3,"url","scale","onClick"],["model",""],[3,"args"],[3,"position"],[3,"ngSwitch","args","position","lookAt"],["camera",""],[4,"ngSwitchCase"],[3,"object",4,"ngSwitchCase"],[3,"args",4,"ngSwitchCase"],[3,"object"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"input",1),gt("ngModelChange",function(s){return i.renderOnDemand=s}),Te(),pe(2,"label",2),Cn(3,"Render On-Demand"),Te(),pe(4,"select",3),gt("ngModelChange",function(s){return i.controlType=s}),pe(5,"option",4),Cn(6,"orbit"),Te(),pe(7,"option",4),Cn(8,"map"),Te(),pe(9,"option",4),Cn(10,"arcball"),Te(),pe(11,"option",4),Cn(12,"transform"),Te(),pe(13,"option",4),Cn(14,"drag"),Te(),pe(15,"option",5),Cn(16,"fly"),Te(),pe(17,"option",5),Cn(18,"trackball"),Te(),pe(19,"option",5),Cn(20,"firstpersion"),Te()()(),pe(21,"th-canvas",6,7)(23,"th-scene"),Ye(24,"th-ambientLight"),pe(25,"th-object3D",8,9),gt("onClick",function(){return i.selected=!i.selected}),Te(),Ye(27,"th-gridHelper",10)(28,"th-pointLight",11),pe(29,"th-perspectiveCamera",12,13),Sn(31,Zue,1,0,"th-orbitControls",14),Sn(32,Yue,1,0,"th-mapControls",14),Sn(33,Kue,1,0,"th-arcballControls",14),Sn(34,Que,1,1,"th-transformControls",15),Sn(35,ehe,1,7,"th-dragControls",16),Sn(36,the,1,0,"th-flyControls",14),Sn(37,nhe,1,0,"th-trackballControls",14),Sn(38,ihe,1,0,"th-firstPersonControls",14),Te()()()),2&t&&(se(1),Q("ngModel",i.renderOnDemand),se(3),Q("ngModel",i.controlType),se(17),Q("thStats",!0)("renderOnDemand",i.renderOnDemand),se(4),Q("url",i.glbPath)("scale",i.selected?Ee(20,rhe):Ee(21,she)),se(2),Q("args",Ee(22,ohe)),se(1),Q("position",Ee(23,qU)),se(1),Q("ngSwitch",i.controlType)("args",Ee(24,ahe))("position",Ee(25,qU))("lookAt",Ee(26,lhe)),se(2),Q("ngSwitchCase","orbit"),se(1),Q("ngSwitchCase","map"),se(1),Q("ngSwitchCase","arcball"),se(1),Q("ngSwitchCase","transform"),se(1),Q("ngSwitchCase","drag"),se(1),Q("ngSwitchCase","fly"),se(1),Q("ngSwitchCase","trackball"),se(1),Q("ngSwitchCase","firstpersion"))},dependencies:[Vg,_2,Xle,Yle,tce,sce,lce,Cp,dce,bce,Ir,an,Vc,Gc,qo,mr,ir,Qh,Iv,ON,wp,kU,NU,OC,jy,UC,By],styles:[".needs-loop[_ngcontent-%COMP%]{color:red}.works-on-demand[_ngcontent-%COMP%]{color:green}.control-panel[_ngcontent-%COMP%]{display:flex;gap:1em;margin:1em}"],changeDetection:0}),n})(),uhe=(()=>{class n{transform(t){return Array.isArray(t)?new Ce(...t):new Ce(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=Qi({name:"color",type:n,pure:!0}),n})();const hhe=["camera"],dhe=function(){return["#72645b",2,15]},fhe=function(n){return[0,n,0]},ZU=function(n){return[n,0,0]},phe=function(){return[40,40]},mhe=function(){return{color:"#999999",specular:"#101010"}},ghe=function(n){return[0,n,.3]},_he=function(){return[.001,.001,.001]},vhe=function(){return{color:"#0055ff",flatShading:!0}},yhe=function(){return["#443333","#111122"]},bhe=function(){return[1,1,1]},xhe=function(n){return[.5,1,n]},whe=function(){return[35,2,1,15]};let Mhe=(()=>{class n{constructor(){this.Math=Math,this.cameraPosition=new C(3,.15,3),this.assetPath=`${Ra}dolphins.ply`}onBeforeRender(){const t=5e-4*Date.now();this.camera&&(this.camera.position=new C(2.5*Math.sin(t),.15,2.5*Math.cos(t)),this.camera.lookAt=[0,.1,0])}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-plyloader-example"]],viewQuery:function(t,i){if(1&t&&Pn(hhe,5),2&t){let r;Et(r=Dt())&&(i.camera=r.first)}},decls:17,vars:55,consts:[[3,"shadow","onRender"],[3,"background","fog"],[3,"position","rotation","receiveShadow"],[3,"args"],[3,"rotation","position","scale","castShadow","receiveShadow"],["loadPLY","",3,"url"],[3,"castShadow","position","color","intensity","shadowMapHeight","shadowMapWidth"],["camera",""]],template:function(t,i){1&t&&(pe(0,"th-canvas",0),gt("onRender",function(){return i.onBeforeRender()}),pe(1,"th-scene",1),_s(2,"color"),_s(3,"fog"),pe(4,"th-mesh",2),Ye(5,"th-planeGeometry",3)(6,"th-meshPhongMaterial",3),Te(),pe(7,"th-mesh",4),Ye(8,"th-bufferGeometry",5)(9,"th-meshStandardMaterial",3),Te(),Ye(10,"th-hemisphereLight",3)(11,"th-directionalLight",6),_s(12,"color"),Ye(13,"th-directionalLight",6),_s(14,"color"),Ye(15,"th-perspectiveCamera",3,7),Te()()),2&t&&(Q("shadow",!0),se(1),Q("background",vs(2,29,"#72645b"))("fog",vs(3,31,Ee(37,dhe))),se(3),Q("position",Tn(38,fhe,-.5))("rotation",Tn(40,ZU,-i.Math.PI/2))("receiveShadow",!0),se(1),Q("args",Ee(42,phe)),se(1),Q("args",Ee(43,mhe)),se(1),Q("rotation",Tn(44,ZU,-i.Math.PI/2))("position",Tn(46,ghe,-.2))("scale",Ee(48,_he))("castShadow",!0)("receiveShadow",!0),se(1),Q("url",i.assetPath),se(1),Q("args",Ee(49,vhe)),se(1),Q("args",Ee(50,yhe)),se(1),Q("castShadow",!0)("position",Ee(51,bhe))("color",vs(12,33,"#ffffff"))("intensity",1.35)("shadowMapHeight",1024)("shadowMapWidth",1024),se(2),Q("castShadow",!0)("position",Tn(52,xhe,-1))("color",vs(14,35,"#ffaa00"))("intensity",1)("shadowMapHeight",1024)("shadowMapWidth",1024),se(2),Q("args",Ee(54,whe)))},dependencies:[Ir,_T,vp,Ds,mr,jj,Yh,bo,vT,ir,Sce,uhe,NN],encapsulation:2,changeDetection:0}),n})();const She=["object"],The=["light"];function Che(n,e){if(1&n&&(pe(0,"th-mesh",14),Ye(1,"th-meshPhongMaterial",15),Te()),2&n){const t=e.$implicit;ii(),Q("geometry",yn(15).objRef)("position",t.pos)("rotation",t.rotation)("scale",t.scale),se(1),Q("flatShading",!0)("color",t.color)}}const Ehe=function(n){return[n]},Dhe=function(n){return{value:n}},Ahe=function(n){return{amount:n}},Rhe=function(){return["#ffffff"]},Phe=function(n){return[0,0,n]},Ihe=function(){return["0x222222"]},Lhe=function(){return["0xffffff"]},Fhe=function(){return[1,4,4]};let khe=(()=>{class n{constructor(){this.DotScreenShader=Cj,this.RGBShiftShader=Uj,this.shiftAmount=.0015,this.zDist=400,this.meshData=[],this.initMeshData()}ngOnInit(){this.light?.position?.set(1,1,1)}initMeshData(){for(let t=0;t<100;t++){const i=50*Math.random();this.meshData.push({pos:new C(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize().multiplyScalar(Math.random()*this.zDist),rotation:new fh(2*Math.random(),2*Math.random(),2*Math.random()),scale:new C(i,i,i),color:new Ce(16777215*Math.random())})}}animate(){this.object?.objRef?.rotation&&(this.object.objRef.rotation.x+=.005,this.object.objRef.rotation.y+=.01)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-post-processing-example"]],viewQuery:function(t,i){if(1&t&&(Pn(She,7),Pn(The,7)),2&t){let r;Et(r=Dt())&&(i.object=r.first),Et(r=Dt())&&(i.light=r.first)}},decls:19,vars:30,consts:[["for","shift"],["id","shift","type","range",3,"ngModel","min","max","step","ngModelChange"],[3,"shadow","thStats","onRender"],["thecanvas",""],[3,"strength"],[3,"args","uniforms"],[3,"background"],[3,"position","fov","near","far"],[3,"color"],["light",""],[3,"args"],["geometry",""],["object",""],[3,"geometry","position","rotation","scale",4,"ngFor","ngForOf"],[3,"geometry","position","rotation","scale"],[3,"flatShading","color"]],template:function(t,i){1&t&&(pe(0,"label",0),Cn(1,"Shift Amount"),Te(),pe(2,"input",1),gt("ngModelChange",function(s){return i.shiftAmount=s}),Te(),pe(3,"th-canvas",2,3),gt("onRender",function(){return i.animate()}),pe(5,"th-effectComposer"),Ye(6,"th-renderPass")(7,"th-unrealBloomPass",4)(8,"th-shaderPass",5),Te(),pe(9,"th-scene",6),Ye(10,"th-perspectiveCamera",7)(11,"th-ambientLight",8)(12,"th-directionalLight",8,9)(14,"th-sphereGeometry",10,11),pe(16,"th-object3D",null,12),Sn(18,Che,2,6,"th-mesh",13),Te()()()),2&t&&(se(2),Q("ngModel",i.shiftAmount)("min",.0015)("max",.2)("step",.005),se(1),Q("shadow",!0)("thStats",!0),se(4),Q("strength",1),se(1),Q("args",Tn(18,Ehe,i.RGBShiftShader))("uniforms",Tn(22,Ahe,Tn(20,Dhe,i.shiftAmount))),se(1),Q("background",Ee(24,Rhe)),se(1),Q("position",Tn(25,Phe,i.zDist))("fov",70)("near",1)("far",1e3),se(1),Q("color",Ee(27,Ihe)),se(1),Q("color",Ee(28,Lhe)),se(2),Q("args",Ee(29,Fhe)),se(4),Q("ngForOf",i.meshData))},dependencies:[oc,Ir,an,vp,qo,Ds,mr,Yh,FC,vy,dj,Fj,Bj,ir,wp,Dy,QC,UC,By],styles:["label[_ngcontent-%COMP%]{margin-right:.5em}"],changeDetection:0}),n})(),Ohe=(()=>{class n extends wN{getType(){return pN}set type(t){this._objRef&&(this._objRef.type=t)}set box(t){this._objRef&&(this._objRef.box=Lt(this._objRef.box,t))}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["th-box3Helper"]],inputs:{type:"type",box:"box"},features:[Xe([{provide:an,useExisting:Ze(()=>n)}]),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();const r1=function(){return[0,0,0]},Nhe=function(){return[2,2,2]},Bhe=function(){return[1,1,1]},jhe=function(n,e){return[n,e]},Uhe=function(){return[10,10]},YU=function(){return[10,10,10]},Vhe=function(){return[45,2,.1,100]};let zhe=(()=>{class n extends Ds{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.objRef&&(this.objRef.material=new mo({color:"green"}),this.objRef.geometry=new Xn(1,1,1))}}return n.\u0275fac=function(t){return new(t||n)(N(an,4))},n.\u0275cmp=Re({type:n,selectors:[["th-box"]],features:[Xe(xce(n)),Se],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})(),Hhe=(()=>{class n{constructor(){this.THREE=Td,this.box=new zo(new C(0,0,0),new C(1.5,1.5,1.5)),this.color=new Ce(1,0,0),this.rotation=[0,0,0],this.material=new mo,this.selected=!1,this.material.color.set("green"),setInterval(()=>{0!==this.material.color.r?(this.material=new mo,this.material.color.set("green")):(this.material=new mo,this.material.color.set("red"))},200)}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-simple-example"]],decls:8,vars:24,consts:[[3,"onRender"],[3,"position","material","rotation","scale","onClick"],[3,"args","material","position"],[3,"args"],[3,"position"],[3,"args","position","lookAt"]],template:function(t,i){1&t&&(pe(0,"th-canvas",0),gt("onRender",function(){return i.onBeforeRender()}),pe(1,"th-scene"),Ye(2,"th-ambientLight"),pe(3,"th-box",1),gt("onClick",function(){return i.selected=!i.selected}),Te(),Ye(4,"th-box3Helper",2)(5,"th-gridHelper",3)(6,"th-pointLight",4)(7,"th-perspectiveCamera",5),Te()()),2&t&&(se(3),Q("position",Ee(12,r1))("material",i.material)("rotation",i.rotation)("scale",i.selected?Ee(13,Nhe):Ee(14,Bhe)),se(1),Q("args",ic(15,jhe,i.box,i.color))("material",i.material)("position",Ee(18,r1)),se(1),Q("args",Ee(19,Uhe)),se(1),Q("position",Ee(20,YU)),se(1),Q("args",Ee(21,Vhe))("position",Ee(22,YU))("lookAt",Ee(23,r1)))},dependencies:[Ir,Vc,Ohe,Gc,qo,mr,ir,Iv,zhe],encapsulation:2,changeDetection:0}),n})();const Ghe=["thecanvas"],Whe=function(n,e,t,i){return{x:n,y:e,width:t,height:i}};function Xhe(n,e){if(1&n){const t=Io();pe(0,"th-view",11,12),gt("onRender",function(){const s=Br(t).$implicit,o=yn(3);ii();const a=yn(3);return jr(s.updateCamera(o.objRef,a.objRef))}),Ye(2,"th-perspectiveCamera",13,14),Te()}if(2&n){const t=e.$implicit,i=yn(1),r=ii();Q("scene",yn(3))("viewPort",df(11,Whe,t.left*r.canvasWidth,t.bottom*r.canvasHeight,t.width*r.canvasWidth,t.height*r.canvasHeight))("scissor",i.viewPort)("scissorTest",!0)("clearColor",t.background),se(2),Q("position",t.eye)("up",t.up)("fov",t.fov)("aspect",t.width*r.canvasWidth/(t.height*r.canvasHeight))("near",1)("far",1e4)}}const qhe=function(n,e){return{x:0,y:0,width:n,height:e}},Zhe=function(){return[0,0,1]},Yhe=function(){return["#ffffff"]},Khe=function(){return[0,0,0]},Uy=function(n){return[n,0,0]},Qhe=function(){return[200,32,16]},$he=function(){return["#fac400"]},Jhe=function(){return["#f83f0d"]},ede=function(){return[400,0,0]},Vy=[{path:"basic-example",data:{title:"Basic Example",exampleComponent:Die,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/basic-example/basic-example.component.ts"]}},{path:"simple-example",data:{title:"Simple Example",exampleComponent:Hhe,declarations:["SimpleExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.ts"]}},{path:"introductory-example",data:{title:"Introductory Example",exampleComponent:qae,declarations:["IntroductoryExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/introductory-example/introductory-example.component.ts"]}},{path:"controls-example",data:{title:"Controls Example",exampleComponent:kie,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.ts"]}},{path:"loader-example",data:{title:"Loader Example",exampleComponent:ele,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.ts"]}},{path:"dynamic loader-example",data:{title:"Dynamic Loader Example",exampleComponent:Uie,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.ts"]}},{path:"events-example",data:{title:"Events Example",exampleComponent:Wie,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.scss"]}},{path:"instanced-mesh-example",data:{title:"Instanced Mesh Example",exampleComponent:Bae,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.ts"]}},{path:"post-processing-example",data:{title:"Post Processing Example",exampleComponent:khe,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.scss"]}},{path:"views-example",data:{title:"Multiple Views Example",exampleComponent:(()=>{class n{constructor(){this.Math=Math,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.views=[{left:0,bottom:0,width:.5,height:1,background:new Ce(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(t,i)=>{this.updateSize(),t.position.x+=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(i.position),t.updateProjectionMatrix()}},{left:.5,bottom:0,width:.5,height:.5,background:new Ce(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(t,i)=>{this.updateSize(),t.position.x-=.05*this.mouseX,t.position.x=Math.max(Math.min(t.position.x,2e3),-2e3),t.lookAt(t.position.clone().setY(0)),t.updateProjectionMatrix()}},{left:.5,bottom:.5,width:.5,height:.5,background:new Ce(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(t,i)=>{this.updateSize(),t.position.y-=.05*this.mouseX,t.position.y=Math.max(Math.min(t.position.y,1600),-1600),t.lookAt(i.position),t.updateProjectionMatrix()}}]}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new OS(this.canvas.rendererCanvas.nativeElement))}animate(t){}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.nativeElement.width,this.canvasHeight=this.canvas.rendererCanvas.nativeElement.height)}onMouseMove(t){if(!this.canvas||!this.canvas.rendererCanvas)return;const i=this.canvas.rendererCanvas.nativeElement.getBoundingClientRect();this.mouseX=t.clientX-i.left-i.width/2,this.mouseY=t.clientY-i.right-i.height/2}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-views-example"]],viewQuery:function(t,i){if(1&t&&Pn(Ghe,7),2&t){let r;Et(r=Dt())&&(i.canvas=r.first)}},hostBindings:function(t,i){1&t&&gt("mousemove",function(s){return i.onMouseMove(s)},!1,Qm)},decls:13,vars:38,consts:[[3,"disableDefaultView","viewPort"],["thecanvas",""],["scene",""],[3,"position","args"],[3,"position","rotation"],[3,"args"],["geo",""],[3,"flatShading","shininess","specular","color"],["mat",""],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender",4,"ngFor","ngForOf"],[3,"scene","viewPort","scissor","scissorTest","clearColor","onRender"],["thview",""],[3,"position","up","fov","aspect","near","far"],["camera",""]],template:function(t,i){if(1&t&&(pe(0,"th-canvas",0,1)(2,"th-scene",null,2),Ye(4,"th-directionalLight",3),pe(5,"th-mesh",4),Ye(6,"th-sphereGeometry",5,6)(8,"th-meshPhongMaterial",7,8),Te(),Ye(10,"th-mesh",9)(11,"th-mesh",9),Te(),Sn(12,Xhe,4,16,"th-view",10),Te()),2&t){const r=yn(7),s=yn(9);Q("disableDefaultView",!0)("viewPort",ic(20,qhe,.5*i.canvasWidth,i.canvasHeight)),se(4),Q("position",Ee(23,Zhe))("args",Ee(24,Yhe)),se(1),Q("position",Ee(25,Khe))("rotation",Tn(26,Uy,-i.Math.PI/2)),se(1),Q("args",Ee(28,Qhe)),se(2),Q("flatShading",!1)("shininess",30)("specular",Ee(29,$he))("color",Ee(30,Jhe)),se(2),Q("position",Tn(31,Uy,-400))("rotation",Tn(33,Uy,-i.Math.PI/2))("geometry",r.objRef)("material",s.objRef),se(1),Q("position",Ee(35,ede))("rotation",Tn(36,Uy,-i.Math.PI/2))("geometry",r.objRef)("material",s.objRef),se(1),Q("ngForOf",i.views)}},dependencies:[oc,Ir,vp,Ds,mr,Yh,FC,ir,xl],changeDetection:0}),n})(),codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.scss"]}},{path:"multi-scene-example",data:{title:"Multiple Scenes Example",codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.scss"],exampleComponent:kce}},{path:"multi-view-postprocessing-example",data:{title:"Multiple View Post Processing Example",exampleComponent:Yce,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.ts"]}},{path:"animation-example",data:{title:"Animation Example",exampleComponent:Sie,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.ts"]}},{path:"plyloader-example",data:{title:"PLY Loader Example",exampleComponent:Mhe,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.ts"]}},{path:"on-demand-example",data:{title:"On-Demand Rendering Example",exampleComponent:che,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.scss"]}}];Vy.forEach(n=>n.component=vae);const tde=[];Vy.forEach(n=>{tde.push(n.component)});let nde=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[KL.forRoot(Vy),KL]}),n})();const rde=["mat-button",""],sde=["*"],ade=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],lde=kp(Fp(sd(class{constructor(n){this._elementRef=n}})));let cde=(()=>{class n extends lde{constructor(t,i,r){super(t),this._focusMonitor=i,this._animationMode=r,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of ade)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,i){t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(i=>this._getHostElement().hasAttribute(i))}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ip),N(Er,8))},n.\u0275cmp=Re({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,i){if(1&t&&Pn(od,5),2&t){let r;Et(r=Dt())&&(i.ripple=r.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,i){2&t&&(yi("disabled",i.disabled||null),pn("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-button-disabled",i.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Se],attrs:rde,ngContentSelectors:sde,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,i){1&t&&(Ji(),pe(0,"span",0),Hn(1),Te(),Ye(2,"span",1)(3,"span",2)),2&t&&(se(2),pn("mat-button-ripple-round",i.isRoundButton||i.isIconButton),Q("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",i.isIconButton)("matRippleTrigger",i._getHostElement()))},dependencies:[od],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}"],encapsulation:2,changeDetection:0}),n})(),s1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[zv,In,In]}),n})(),ude=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In,In]}),n})();const QU=["*"],dde=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],fde=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],vde=Fp(sd(class{})),yde=sd(class{}),bde=new He("MatList"),$U=new He("MatNavList");let xde=(()=>{class n extends vde{constructor(){super(...arguments),this._stateChanges=new Ft}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[Xe([{provide:$U,useExisting:n}]),Se,$i],ngContentSelectors:QU,decls:1,vars:0,template:function(t,i){1&t&&(Ji(),Hn(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}'],encapsulation:2,changeDetection:0}),n})(),JU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),n})(),eV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),n})(),wde=(()=>{class n extends yde{constructor(t,i,r,s){super(),this._element=t,this._isInteractiveList=!1,this._destroyed=new Ft,this._disabled=!1,this._isInteractiveList=!!(r||s&&"action-list"===s._getListType()),this._list=r||s;const o=this._getHostElement();"button"===o.nodeName.toLowerCase()&&!o.hasAttribute("type")&&o.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(jn(this._destroyed)).subscribe(()=>{i.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(t){this._disabled=ai(t)}ngAfterContentInit(){!function A3(n,e,t="mat"){n.changes.pipe(pa(n)).subscribe(({length:i})=>{Op(e,`${t}-2-line`,!1),Op(e,`${t}-3-line`,!1),Op(e,`${t}-multi-line`,!1),2===i||3===i?Op(e,`${t}-${i}-line`,!0):i>3&&Op(e,`${t}-multi-line`,!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Ei),N($U,8),N(bde,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,i,r){if(1&t&&(pi(r,JU,5),pi(r,eV,5),pi(r,D3,5)),2&t){let s;Et(s=Dt())&&(i._avatar=s.first),Et(s=Dt())&&(i._icon=s.first),Et(s=Dt())&&(i._lines=s)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:4,hostBindings:function(t,i){2&t&&pn("mat-list-item-disabled",i.disabled)("mat-list-item-with-avatar",i._avatar||i._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[Se],ngContentSelectors:fde,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(t,i){1&t&&(Ji(dde),pe(0,"span",0),Ye(1,"span",1),Hn(2),pe(3,"span",2),Hn(4,1),Te(),Hn(5,2),Te()),2&t&&(se(1),Q("matRippleTrigger",i._getHostElement())("matRippleDisabled",i._isRippleDisabled()))},dependencies:[od],encapsulation:2,changeDetection:0}),n})(),o1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[R3,zv,In,GT,Ya,R3,In,GT,ude]}),n})();const Dde=["*",[["mat-toolbar-row"]]],Ade=["*","mat-toolbar-row"],Rde=kp(class{constructor(n){this._elementRef=n}});let Pde=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=tt({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),Ide=(()=>{class n extends Rde{constructor(t,i,r){super(t),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(_r),N(Ut))},n.\u0275cmp=Re({type:n,selectors:[["mat-toolbar"]],contentQueries:function(t,i,r){if(1&t&&pi(r,Pde,5),2&t){let s;Et(s=Dt())&&(i._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,i){2&t&&pn("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",0===i._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Se],ngContentSelectors:Ade,decls:2,vars:0,template:function(t,i){1&t&&(Ji(Dde),Hn(0),Hn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),a1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[In,In]}),n})();const zy=["*"],Lde=["content"];function Fde(n,e){if(1&n){const t=Io();pe(0,"div",2),gt("click",function(){return Br(t),jr(ii()._onBackdropClicked())}),Te()}2&n&&pn("mat-drawer-shown",ii()._isShowingBackdrop())}function kde(n,e){1&n&&(pe(0,"mat-drawer-content"),Hn(1,2),Te())}const Ode=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Nde=["mat-drawer","mat-drawer-content","*"];function Bde(n,e){if(1&n){const t=Io();pe(0,"div",2),gt("click",function(){return Br(t),jr(ii()._onBackdropClicked())}),Te()}2&n&&pn("mat-drawer-shown",ii()._isShowingBackdrop())}function jde(n,e){1&n&&(pe(0,"mat-sidenav-content"),Hn(1,2),Te())}const Ude=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Vde=["mat-sidenav","mat-sidenav-content","*"],nV={transformDrawer:jp("transform",[Oa("open, open-instant",Lr({transform:"none",visibility:"visible"})),Oa("void",Lr({"box-shadow":"none",visibility:"hidden"})),Na("void => open-instant",Sl("0ms")),Na("void <=> open, open-instant => void",Sl("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Hde=new He("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Gde(){return!1}}),l1=new He("MAT_DRAWER_CONTAINER");let Hy=(()=>{class n extends zp{constructor(t,i,r,s,o){super(r,s,o),this._changeDetectorRef=t,this._container=i}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(N(Ei),N(Ze(()=>rV)),N(qt),N($v),N(Pt))},n.\u0275cmp=Re({type:n,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,i){2&t&&tf("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[Xe([{provide:zp,useExisting:n}]),Se],ngContentSelectors:zy,decls:1,vars:0,template:function(t,i){1&t&&(Ji(),Hn(0))},encapsulation:2,changeDetection:0}),n})(),iV=(()=>{class n{constructor(t,i,r,s,o,a,l,c){this._elementRef=t,this._focusTrapFactory=i,this._focusMonitor=r,this._platform=s,this._ngZone=o,this._interactivityChecker=a,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Ft,this._animationEnd=new Ft,this._animationState="void",this.openedChange=new yt(!0),this._openedStream=this.openedChange.pipe(Ui(u=>u),xt(()=>{})),this.openedStart=this._animationStarted.pipe(Ui(u=>u.fromState!==u.toState&&0===u.toState.indexOf("open")),Uw(void 0)),this._closedStream=this.openedChange.pipe(Ui(u=>!u),xt(()=>{})),this.closedStart=this._animationStarted.pipe(Ui(u=>u.fromState!==u.toState&&"void"===u.toState),Uw(void 0)),this._destroyed=new Ft,this.onPositionChanged=new yt,this._modeChanged=new Ft,this.openedChange.subscribe(u=>{u?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{Ml(this._elementRef.nativeElement,"keydown").pipe(Ui(u=>27===u.keyCode&&!this.disableClose&&!nd(u)),jn(this._destroyed)).subscribe(u=>this._ngZone.run(()=>{this.close(),u.stopPropagation(),u.preventDefault()}))}),this._animationEnd.pipe(UT((u,h)=>u.fromState===h.fromState&&u.toState===h.toState)).subscribe(u=>{const{fromState:h,toState:d}=u;(0===d.indexOf("open")&&"void"===h||"void"===d&&0===h.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=ai(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=ai(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(ai(t))}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{!i&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,i){t&&i&&(this._openedVia=i);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,i,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",i&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Or(1)).subscribe(o=>s(o?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const i=this._elementRef.nativeElement,r=i.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,i)),r.appendChild(i)):this._anchor&&this._anchor.parentNode.insertBefore(i,this._anchor)}}return n.\u0275fac=function(t){return new(t||n)(N(qt),N(Zre),N(Ip),N(_r),N(Pt),N(_3),N(Ut,8),N(l1,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-drawer"]],viewQuery:function(t,i){if(1&t&&Pn(Lde,5),2&t){let r;Et(r=Dt())&&(i._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,i){1&t&&Ex("@transform.start",function(s){return i._animationStarted.next(s)})("@transform.done",function(s){return i._animationEnd.next(s)}),2&t&&(yi("align",null),Ix("@transform",i._animationState),pn("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:zy,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(Ji(),pe(0,"div",0,1),Hn(2),Te())},dependencies:[zp],encapsulation:2,data:{animation:[nV.transformDrawer]},changeDetection:0}),n})(),rV=(()=>{class n{constructor(t,i,r,s,o,a=!1,l){this._dir=t,this._element=i,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=l,this._drawers=new rc,this.backdropClick=new yt,this._destroyed=new Ft,this._doCheckSubject=new Ft,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Ft,t&&t.change.pipe(jn(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),o.change().pipe(jn(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=a}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=ai(t)}get hasBackdrop(){return this._backdropOverride??(!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode)}set hasBackdrop(t){this._backdropOverride=null==t?null:ai(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(pa(this._allDrawers),jn(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(i=>!i._container||i._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(pa(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(jv(10),jn(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,i=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,i-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)i+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();i+=r,t-=r}t=t||null,i=i||null,(t!==this._contentMargins.left||i!==this._contentMargins.right)&&(this._contentMargins={left:t,right:i},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Ui(i=>i.fromState!==i.toState),jn(this._drawers.changes)).subscribe(i=>{"open-instant"!==i.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(jn(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){!t||t.onPositionChanged.pipe(jn(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Or(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(jn(lu(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const i=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?i.add(r):i.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return n.\u0275fac=function(t){return new(t||n)(N(Ia,8),N(qt),N(Pt),N(Ei),N(ad),N(Hde),N(Er,8))},n.\u0275cmp=Re({type:n,selectors:[["mat-drawer-container"]],contentQueries:function(t,i,r){if(1&t&&(pi(r,Hy,5),pi(r,iV,5)),2&t){let s;Et(s=Dt())&&(i._content=s.first),Et(s=Dt())&&(i._allDrawers=s)}},viewQuery:function(t,i){if(1&t&&Pn(Hy,5),2&t){let r;Et(r=Dt())&&(i._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,i){2&t&&pn("mat-drawer-container-explicit-backdrop",i._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Xe([{provide:l1,useExisting:n}])],ngContentSelectors:Nde,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(Ji(Ode),Sn(0,Fde,1,2,"div",0),Hn(1),Hn(2,1),Sn(3,kde,2,0,"mat-drawer-content",1)),2&t&&(Q("ngIf",i.hasBackdrop),se(3),Q("ngIf",!i._content))},dependencies:[$u,Hy],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),c1=(()=>{class n extends Hy{constructor(t,i,r,s,o){super(t,i,r,s,o)}}return n.\u0275fac=function(t){return new(t||n)(N(Ei),N(Ze(()=>oV)),N(qt),N($v),N(Pt))},n.\u0275cmp=Re({type:n,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,i){2&t&&tf("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[Xe([{provide:zp,useExisting:n}]),Se],ngContentSelectors:zy,decls:1,vars:0,template:function(t,i){1&t&&(Ji(),Hn(0))},encapsulation:2,changeDetection:0}),n})(),sV=(()=>{class n extends iV{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=ai(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=As(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=As(t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,i){2&t&&(yi("align",null),tf("top",i.fixedInViewport?i.fixedTopGap:null,"px")("bottom",i.fixedInViewport?i.fixedBottomGap:null,"px"),pn("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened)("mat-sidenav-fixed",i.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Se],ngContentSelectors:zy,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(Ji(),pe(0,"div",0,1),Hn(2),Te())},dependencies:[zp],encapsulation:2,data:{animation:[nV.transformDrawer]},changeDetection:0}),n})(),oV=(()=>{class n extends rV{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pt(n)))(i||n)}}(),n.\u0275cmp=Re({type:n,selectors:[["mat-sidenav-container"]],contentQueries:function(t,i,r){if(1&t&&(pi(r,c1,5),pi(r,sV,5)),2&t){let s;Et(s=Dt())&&(i._content=s.first),Et(s=Dt())&&(i._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,i){2&t&&pn("mat-drawer-container-explicit-backdrop",i._backdropOverride)},exportAs:["matSidenavContainer"],features:[Xe([{provide:l1,useExisting:n}]),Se],ngContentSelectors:Vde,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(Ji(Ude),Sn(0,Bde,1,2,"div",0),Hn(1),Hn(2,1),Sn(3,jde,2,0,"mat-sidenav-content",1)),2&t&&(Q("ngIf",i.hasBackdrop),se(3),Q("ngIf",!i._content))},dependencies:[$u,c1],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),Wde=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Ya,In,Hp,Hp,In]}),n})();function Xde(n,e){if(1&n&&(pe(0,"a",10),Cn(1),Te()),2&n){const t=e.$implicit;Q("routerLink",t.path),se(1),rf(null==t.data?null:t.data.title)}}function qde(n,e){if(1&n){const t=Io();pe(0,"button",11),gt("click",function(){return Br(t),ii(),jr(yn(2).toggle())}),pe(1,"mat-icon",12),Cn(2,"menu"),Te()()}}function Zde(n,e){if(1&n){const t=Io();pe(0,"button",13),gt("click",function(r){return Br(t),jr(ii().editorService.toCodeSandbox(r))}),pe(1,"mat-icon"),Cn(2,"crop_din"),Te(),Cn(3," CodeSandbox "),Te()}}function Yde(n,e){if(1&n){const t=Io();pe(0,"button",13),gt("click",function(r){return Br(t),jr(ii().editorService.toStackblitz(r))}),pe(1,"mat-icon"),Cn(2,"bolt"),Te(),Cn(3," Stackblitz "),Te()}}let Kde=(()=>{class n{constructor(t,i){this.breakpointObserver=t,this.editorService=i,this.routes=Vy,this.isHandset$=this.breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)").pipe(xt(r=>r.matches),function ide(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,T0({connector:()=>new mT(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}())}}return n.\u0275fac=function(t){return new(t||n)(N(d3),N(Ov))},n.\u0275cmp=Re({type:n,selectors:[["app-navigation-shell"]],decls:21,vars:15,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["mat-list-item","",3,"routerLink",4,"ngFor","ngForOf"],[1,"content"],["color","primary"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],[1,"toolbar-spacer"],["mat-button","","href","#",3,"click",4,"ngIf"],[1,"main-route-content"],["mat-list-item","",3,"routerLink"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-button","","href","#",3,"click"]],template:function(t,i){1&t&&(pe(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),_s(3,"async"),_s(4,"async"),_s(5,"async"),pe(6,"mat-toolbar"),Cn(7,"ngx-three"),Te(),pe(8,"mat-nav-list"),Sn(9,Xde,2,2,"a",3),Te()(),pe(10,"mat-sidenav-content",4)(11,"mat-toolbar",5),Sn(12,qde,3,0,"button",6),_s(13,"async"),pe(14,"span"),Cn(15,"ngx-three-demo"),Te(),Ye(16,"span",7),Sn(17,Zde,4,0,"button",8),Sn(18,Yde,4,0,"button",8),Te(),pe(19,"div",9),Ye(20,"router-outlet"),Te()()()),2&t&&(se(1),Q("mode",vs(4,9,i.isHandset$)?"over":"side")("opened",!1===vs(5,11,i.isHandset$)),yi("role",vs(3,7,i.isHandset$)?"dialog":"navigation"),se(8),Q("ngForOf",i.routes),se(3),Q("ngIf",vs(13,13,i.isHandset$)),se(5),Q("ngIf",i.editorService.urls.length),se(1),Q("ngIf",i.editorService.urls.length))},dependencies:[oc,$u,$w,h_,cde,xde,wde,$3,Ide,sV,oV,c1,Cw],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{height:100vh}.main-route-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{display:block;height:100%}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),n})(),Qde=(()=>{class n{constructor(){this.title="ngx-three-demo"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Re({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&Ye(0,"app-navigation-shell")},dependencies:[Kde]}),n})();const aV=t3();class $de{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Ii(-this._previousScrollPosition.left),e.style.top=Ii(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),aV&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),aV&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class Jde{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class lV{enable(){}disable(){}attach(){}}function u1(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function cV(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class efe{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();u1(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let tfe=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new lV,this.close=o=>new Jde(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new $de(this._viewportRuler,this._document),this.reposition=o=>new efe(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(re($v),re(ad),re(Pt),re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class nfe{constructor(e){if(this.scrollStrategy=new lV,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class ife{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let uV=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rfe=(()=>{class n extends uV{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(re(Ut),re(Pt,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),sfe=(()=>{class n extends uV{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=qc(s)},this._clickListener=s=>{const o=qc(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const u=l[c];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(a))break;const h=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(s)):h.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(re(Ut),re(_r),re(Pt,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),hV=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||LT()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),LT()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(re(Ut),re(_r))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ofe{constructor(e,t,i,r,s,o,a,l,c,u=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=u,this._backdropElement=null,this._backdropClick=new Ft,this._attachments=new Ft,this._detachments=new Ft,this._locationChanges=$n.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new Ft,this._outsidePointerEvents=new Ft,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Or(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Ii(this._config.width),e.height=Ii(this._config.height),e.minWidth=Ii(this._config.minWidth),e.minHeight=Ii(this._config.minHeight),e.maxWidth=Ii(this._config.maxWidth),e.maxHeight=Ii(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=Uv(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(jn(lu(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const dV="cdk-overlay-connected-position-bounding-box",afe=/([A-Za-z%]+)$/;class lfe{constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Ft,this._resizeSubscription=$n.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(dV),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),u=this._getOverlayFit(c,t,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(u,c,i)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const u=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);u>l&&(l=u,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&nu(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(dV),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=pV(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let d=0-a,f=a+s.height-i.height,p=this._subtractOverflows(s.width,0-o,o+s.width-i.width),m=this._subtractOverflows(s.height,d,f),g=p*m;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:m===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=fV(this._overlayRef.getConfig().minHeight),a=fV(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportHorizontally||null!=a&&a<=s;return(e.fitsInViewportVertically||null!=o&&o<=r)&&c}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=pV(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-i.top-e.y,0),c=Math.max(s.left-i.left-e.x,0);let u=0,h=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,h=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new ife(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,h,d;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const f=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)d=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)h=e.x,u=i.right-e.x;else{const f=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,h=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-p/2)}return{top:o,left:h,bottom:a,right:d,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=Ii(i.height),r.top=Ii(i.top),r.bottom=Ii(i.bottom),r.width=Ii(i.width),r.left=Ii(i.left),r.right=Ii(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Ii(s)),o&&(r.maxWidth=Ii(o))}this._lastBoundingBoxSize=i,nu(this._boundingBox.style,r)}_resetBoundingBoxStyles(){nu(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){nu(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();nu(i,this._getExactOverlayY(t,e,u)),nu(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=Ii(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=Ii(o.maxWidth):s&&(i.maxWidth="")),nu(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Ii(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Ii(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:cV(e,i),isOriginOutsideView:u1(e,i),isOverlayClipped:cV(t,i),isOverlayOutsideView:u1(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?e.offsetX??this._offsetX:e.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Uv(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof qt)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function nu(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function fV(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(afe);return t&&"px"!==t?null:parseFloat(e)}return n||null}function pV(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const mV="cdk-global-overlay-wrapper";class cfe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(mV),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,h=this._xOffset,d="rtl"===this._overlayRef.getConfig().direction;let f="",p="",m="";l?m="flex-start":"center"===u?(m="center",d?p=h:f=h):d?"left"===u||"end"===u?(m="flex-end",f=h):("right"===u||"start"===u)&&(m="flex-start",p=h):"left"===u||"start"===u?(m="flex-start",f=h):("right"===u||"end"===u)&&(m="flex-end",p=h),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":p,t.justifyContent=m,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(mV),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let ufe=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new cfe}flexibleConnectedTo(t){return new lfe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(re(ad),re(Ut),re(_r),re(hV))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),hfe=0,h1=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,h,d,f){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=h,this._outsideClickDispatcher=d,this._animationsModuleType=f}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new nfe(t);return o.direction=o.direction||this._directionality.value,new ofe(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+hfe++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(vf)),new Zse(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(re(tfe),re(hV),re(Xa),re(ufe),re(rfe),re(Xi),re(Pt),re(Ut),re(Ia),re(Pg),re(sfe),re(Er,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const pfe={provide:new He("cdk-connected-overlay-scroll-strategy"),deps:[h1],useFactory:function ffe(n){return()=>n.scrollStrategies.reposition()}};let mfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:[h1,pfe],imports:[Lp,nB,hB,hB]}),n})(),bfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Ya,In,VT,In]}),n})();const Tfe={provide:new He("mat-select-scroll-strategy"),deps:[h1],useFactory:function Sfe(n){return()=>n.scrollStrategies.reposition()}};let _V=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:[Tfe],imports:[Ya,mfe,F3,In,Hp,bfe,F3,In]}),n})(),bV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Ya,In,In]}),n})();const Ofe=[s1,o1,QT,J3,a1,_V,xB,bV];let Nfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({imports:[Ofe,s1,o1,QT,J3,a1,_V,xB,bV]}),n})();const ln=!1;function xV(n){return new et(3e3,ln)}function vpe(){return typeof window<"u"&&typeof window.document<"u"}function f1(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Ol(n){switch(n.length){case 0:return new Up;case 1:return n[0];default:return new lB(n)}}function wV(n,e,t,i,r=new Map,s=new Map){const o=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const h=u.get("offset"),d=h==l,f=d&&c||new Map;u.forEach((p,m)=>{let g=m,_=p;if("offset"!==m)switch(g=e.normalizePropertyName(g,o),_){case"!":_=r.get(m);break;case ka:_=s.get(m);break;default:_=e.normalizeStyleValue(m,g,_,o)}f.set(g,_)}),d||a.push(f),c=f,l=h}),o.length)throw function ope(n){return new et(3502,ln)}();return a}function p1(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&m1(t,"start",n)));break;case"done":n.onDone(()=>i(t&&m1(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&m1(t,"destroy",n)))}}function m1(n,e,t){const s=g1(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function g1(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function us(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function MV(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let _1=(n,e)=>!1,SV=(n,e,t)=>[],TV=null;function v1(n){const e=n.parentNode||n.host;return e===TV?null:e}(f1()||typeof Element<"u")&&(vpe()?(TV=(()=>document.documentElement)(),_1=(n,e)=>{for(;e;){if(e===n)return!0;e=v1(e)}return!1}):_1=(n,e)=>n.contains(e),SV=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let iu=null,CV=!1;const EV=_1,DV=SV;let AV=(()=>{class n{validateStyleProperty(t){return function bpe(n){iu||(iu=function xpe(){return typeof document<"u"?document.body:null}()||{},CV=!!iu.style&&"WebkitAppearance"in iu.style);let e=!0;return iu.style&&!function ype(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in iu.style,!e&&CV&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in iu.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return EV(t,i)}getParentElement(t){return v1(t)}query(t,i,r){return DV(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new Up(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),y1=(()=>{class n{}return n.NOOP=new AV,n})();const b1="ng-enter",Wy="ng-leave",Xy="ng-trigger",qy=".ng-trigger",PV="ng-animating",x1=".ng-animating";function Nl(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:w1(parseFloat(e[1]),e[2])}function w1(n,e){return"s"===e?1e3*n:n}function Zy(n,e,t){return n.hasOwnProperty("duration")?n:function Spe(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(xV()),{duration:0,delay:0,easing:""};r=w1(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=w1(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function Bfe(){return new et(3100,ln)}()),a=!0),s<0&&(e.push(function jfe(){return new et(3101,ln)}()),a=!0),a&&e.splice(l,0,xV())}return{duration:r,delay:s,easing:o}}(n,e,t)}function cm(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function IV(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Bl(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function FV(n,e,t){return t?e+":"+t+";":""}function kV(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=FV(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=FV(0,Dpe(t),n.style[t]));n.setAttribute("style",e)}function $o(n,e,t){n.style&&(e.forEach((i,r)=>{const s=S1(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),f1()&&kV(n))}function ru(n,e){n.style&&(e.forEach((t,i)=>{const r=S1(i);n.style[r]=""}),f1()&&kV(n))}function um(n){return Array.isArray(n)?1==n.length?n[0]:oB(n):n}const M1=new RegExp("{{\\s*(.+?)\\s*}}","g");function OV(n){let e=[];if("string"==typeof n){let t;for(;t=M1.exec(n);)e.push(t[1]);M1.lastIndex=0}return e}function Yy(n,e,t){const i=n.toString(),r=i.replace(M1,(s,o)=>{let a=e[o];return null==a&&(t.push(function Vfe(n){return new et(3003,ln)}()),a=""),a.toString()});return r==i?n:r}function Ky(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const Epe=/-+([a-z0-9])/g;function S1(n){return n.replace(Epe,(...e)=>e[1].toUpperCase())}function Dpe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function hs(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function zfe(n){return new et(3004,ln)}()}}function NV(n,e){return window.getComputedStyle(n)[e]}function Fpe(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function kpe(n,e,t){if(":"==n[0]){const l=function Ope(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function npe(n){return new et(3016,ln)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function tpe(n){return new et(3015,ln)}()),e;const r=i[1],s=i[2],o=i[3];e.push(BV(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(BV(o,r))}(i,t,e)):t.push(n),t}const e0=new Set(["true","1"]),t0=new Set(["false","0"]);function BV(n,e){const t=e0.has(n)||t0.has(n),i=e0.has(e)||t0.has(e);return(r,s)=>{let o="*"==n||n==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?e0.has(n):t0.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?e0.has(e):t0.has(e)),o&&a}}const Npe=new RegExp("s*:selfs*,?","g");function T1(n,e,t,i){return new Bpe(n).build(e,t,i)}class Bpe{constructor(e){this._driver=e}build(e,t,i){const r=new Vpe(t);return this._resetContextStyleTimingState(r),hs(this,um(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Gfe(){return new et(3006,ln)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function Wfe(){return new et(3007,ln)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{OV(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(Ky(s.values()),t.errors.push(function Xfe(n,e){return new et(3008,ln)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=hs(this,um(e.animation),t);return{type:1,matchers:Fpe(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:su(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>hs(this,i,t)),options:su(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=hs(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:su(e.options)}}visitAnimate(e,t){const i=function Hpe(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return C1(Zy(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=C1(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Zy(t,e);return C1(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:Lr({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=Lr(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===ka?i.push(a):t.errors.push(new et(3002,ln)):i.push(IV(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),u=c.get(l);let h=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function Zfe(n,e,t,i,r){return new et(3010,ln)}()),h=!1),s=u.startTime),h&&c.set(l,{startTime:s,endTime:r}),t.options&&function Cpe(n,e,t){const i=e.params||{},r=OV(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Ufe(n){return new et(3001,ln)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Yfe(){return new et(3011,ln)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(_=>{const v=this._makeStyleAst(_,t);let y=null!=v.offset?v.offset:function zpe(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(v.styles),b=0;return null!=y&&(s++,b=v.offset=y),l=l||b<0||b>1,a=a||b<c,c=b,o.push(b),v});l&&t.errors.push(function Kfe(){return new et(3012,ln)}()),a&&t.errors.push(function Qfe(){return new et(3200,ln)}());const h=e.steps.length;let d=0;s>0&&s<h?t.errors.push(function $fe(){return new et(3202,ln)}()):0==s&&(d=1/(h-1));const f=h-1,p=t.currentTime,m=t.currentAnimateTimings,g=m.duration;return u.forEach((_,v)=>{const y=d>0?v==f?1:d*v:o[v],b=y*g;t.currentTime=p+m.delay+b,m.duration=b,this._validateStyleAst(_,t),_.offset=y,i.styles.push(_)}),i}visitReference(e,t){return{type:8,animation:hs(this,um(e.animation),t),options:su(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:su(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:su(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function jpe(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Npe,"")),n=n.replace(/@\*/g,qy).replace(/@\w+/g,t=>qy+"-"+t.slice(1)).replace(/:animating/g,x1),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,us(t.collectedStyles,t.currentQuerySelector,new Map);const a=hs(this,um(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:su(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function Jfe(){return new et(3013,ln)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Zy(e.timings,t.errors,!0);return{type:12,animation:hs(this,um(e.animation),t),timings:i,options:null}}}class Vpe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set,this.nonAnimatableCSSPropertiesFound=new Set}}function su(n){return n?(n=cm(n)).params&&(n.params=function Upe(n){return n?cm(n):null}(n.params)):n={},n}function C1(n,e,t){return{duration:n,delay:e,easing:t}}function E1(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class n0{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Xpe=new RegExp(":enter","g"),Zpe=new RegExp(":leave","g");function D1(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new Ype).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class Ype{buildKeyframes(e,t,i,r,s,o,a,l,c,u=[]){c=c||new n0;const h=new A1(e,t,c,r,s,u,[]);h.options=l;const d=l.delay?Nl(l.delay):0;h.currentTimeline.delayNextStep(d),h.currentTimeline.setStyles([o],null,h.errors,l),hs(this,i,h);const f=h.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let m=f.length-1;m>=0;m--){const g=f[m];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,h.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[E1(t,[],[],[],0,d,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Nl(i.duration):null,a=null!=i.delay?Nl(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),hs(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=r0);const o=Nl(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>hs(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Nl(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),hs(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Zy(t.params?Yy(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Nl(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=r0);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const h=t.createSubContext(e.options,c);s&&h.delayNextStep(s),c===t.element&&(l=h.currentTimeline),hs(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const h=u.currentTime;hs(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const r0={};class A1{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=r0,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new s0(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Nl(i.duration)),null!=i.delay&&(r.delay=Nl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Yy(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new A1(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=r0,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new Kpe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(Xpe,"."+this._enterClassName)).replace(Zpe,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function epe(n){return new et(3014,ln)}()),a}}class s0{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new s0(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||ka),this._currentKeyframe.set(t,ka);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function Qpe(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,ka)}else Bl(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=Yy(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)||ka),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Bl(a,new Map,this._backFill);c.forEach((u,h)=>{"!"===u?e.add(h):u===ka&&t.add(h)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?Ky(e.values()):[],o=t.size?Ky(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return E1(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class Kpe extends s0{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=Bl(e[0]);l.set("offset",0),s.push(l);const c=Bl(e[0]);c.set("offset",VV(a)),s.push(c);const u=e.length-1;for(let h=1;h<=u;h++){let d=Bl(e[h]);const f=d.get("offset");d.set("offset",VV((t+f*i)/o)),s.push(d)}i=o,t=0,r="",e=s}return E1(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function VV(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class R1{}const $pe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Jpe extends R1{normalizePropertyName(e,t){return S1(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if($pe.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Hfe(n,e){return new et(3005,ln)}())}return o+s}}function zV(n,e,t,i,r,s,o,a,l,c,u,h,d){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const P1={};class HV{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function eme(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,u){const h=[],d=this.ast.options&&this.ast.options.params||P1,p=this.buildStyles(i,a&&a.params||P1,h),m=l&&l.params||P1,g=this.buildStyles(r,m,h),_=new Set,v=new Map,y=new Map,b="void"===r,w={params:tme(m,d),delay:this.ast.options?.delay},M=u?[]:D1(e,t,this.ast.animation,s,o,p,g,w,c,h);let T=0;if(M.forEach(E=>{T=Math.max(E.duration+E.delay,T)}),h.length)return zV(t,this._triggerName,i,r,b,p,g,[],[],v,y,T,h);M.forEach(E=>{const R=E.element,F=us(v,R,new Set);E.preStyleProps.forEach(H=>F.add(H));const V=us(y,R,new Set);E.postStyleProps.forEach(H=>V.add(H)),R!==t&&_.add(R)});const x=Ky(_.values());return zV(t,this._triggerName,i,r,b,p,g,M,x,v,y,T)}}function tme(n,e){const t=cm(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class nme{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=cm(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Yy(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(l,o)})}),i}}class rme{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new nme(r.style,r.options&&r.options.params||{},i))}),GV(this.states,"true","1"),GV(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new HV(e,r,this.states))}),this.fallbackTransition=function sme(n,e,t){return new HV(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function GV(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const ome=new n0;class ame{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=T1(this._driver,t,i,[]);if(i.length)throw function ape(n){return new et(3503,ln)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=wV(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=D1(this._driver,t,s,b1,Wy,new Map,new Map,i,ome,r),o.forEach(u=>{const h=us(a,u.element,new Map);u.postStyleProps.forEach(d=>h.set(d,null))})):(r.push(function lpe(){return new et(3300,ln)}()),o=[]),r.length)throw function cpe(n){return new et(3504,ln)}();a.forEach((u,h)=>{u.forEach((d,f)=>{u.set(f,this._driver.computeStyle(h,f,ka))})});const c=Ol(o.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,new Map,h)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function upe(n){return new et(3301,ln)}();return t}listen(e,t,i,r){const s=g1(t,"","","");return p1(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const WV="ng-animate-queued",I1="ng-animate-disabled",dme=[],XV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},fme={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Os="__ng_removed";class L1{constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function _me(n){return n??null}(i?e.value:e),i){const s=cm(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const hm="void",F1=new L1(hm);class pme{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ns(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function hpe(n,e){return new et(3302,ln)}();if(null==i||0==i.length)throw function dpe(n){return new et(3303,ln)}();if(!function vme(n){return"start"==n||"done"==n}(i))throw function fpe(n,e){return new et(3400,ln)}();const s=us(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=us(this._engine.statesByElement,e,new Map);return a.has(t)||(Ns(e,Xy),Ns(e,Xy+"-"+t),a.set(t,F1)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function ppe(n){return new et(3401,ln)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new k1(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Ns(e,Xy),Ns(e,Xy+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new L1(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=F1),c.value!==hm&&l.value===c.value){if(!function xme(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const m=[],g=s.matchStyles(l.value,l.params,m),_=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{ru(e,g),$o(e,_)})}return}const d=us(this._engine.playersByElement,e,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(Ns(e,WV),o.onStart(()=>{wd(e,WV)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const g=this._engine.playersByElement.get(e);if(g){let _=g.indexOf(o);_>=0&&g.splice(_,1)}}),this.players.push(o),d.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,qy,!0);i.forEach(r=>{if(r[Os])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const u=this.trigger(e,c,hm,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&Ol(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||F1,u=new L1(hm),h=new k1(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Os];(!s||s===XV)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Ns(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=g1(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,p1(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class mme{constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new pme(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(o0(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!o0(t))return;const s=t[Os];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ns(e,I1)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),wd(e,I1))}removeNode(e,t,i,r){if(o0(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[Os]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return o0(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,qy,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,x1,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Ol(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Os];if(t&&t.setForRemoval){if(e[Os]=XV,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(I1)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ns(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Ol(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function mpe(n){return new et(3402,ln)}()}_flushAnimations(e,t){const i=new n0,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(I=>{u.add(I);const U=this.driver.query(I,".ng-animate-queued",!0);for(let W=0;W<U.length;W++)u.add(U[W])});const h=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=YV(d,this.collectedEnterElements),p=new Map;let m=0;f.forEach((I,U)=>{const W=b1+m++;p.set(U,W),I.forEach(z=>Ns(z,W))});const g=[],_=new Set,v=new Set;for(let I=0;I<this.collectedLeaveElements.length;I++){const U=this.collectedLeaveElements[I],W=U[Os];W&&W.setForRemoval&&(g.push(U),_.add(U),W.hasAnimation?this.driver.query(U,".ng-star-inserted",!0).forEach(z=>_.add(z)):v.add(U))}const y=new Map,b=YV(d,Array.from(_));b.forEach((I,U)=>{const W=Wy+m++;y.set(U,W),I.forEach(z=>Ns(z,W))}),e.push(()=>{f.forEach((I,U)=>{const W=p.get(U);I.forEach(z=>wd(z,W))}),b.forEach((I,U)=>{const W=y.get(U);I.forEach(z=>wd(z,W))}),g.forEach(I=>{this.processLeaveNode(I)})});const w=[],M=[];for(let I=this._namespaceList.length-1;I>=0;I--)this._namespaceList[I].drainQueuedTransitions(t).forEach(W=>{const z=W.player,Y=W.element;if(w.push(z),this.collectedEnterElements.length){const X=Y[Os];if(X&&X.setForMove){if(X.previousTriggersValues&&X.previousTriggersValues.has(W.triggerName)){const de=X.previousTriggersValues.get(W.triggerName),Le=this.statesByElement.get(W.element);if(Le&&Le.has(W.triggerName)){const _e=Le.get(W.triggerName);_e.value=de,Le.set(W.triggerName,_e)}}return void z.destroy()}}const oe=!h||!this.driver.containsElement(h,Y),$=y.get(Y),me=p.get(Y),he=this._buildInstruction(W,i,me,$,oe);if(he.errors&&he.errors.length)return void M.push(he);if(oe)return z.onStart(()=>ru(Y,he.fromStyles)),z.onDestroy(()=>$o(Y,he.toStyles)),void r.push(z);if(W.isFallbackTransition)return z.onStart(()=>ru(Y,he.fromStyles)),z.onDestroy(()=>$o(Y,he.toStyles)),void r.push(z);const Ae=[];he.timelines.forEach(X=>{X.stretchStartingKeyframe=!0,this.disabledNodes.has(X.element)||Ae.push(X)}),he.timelines=Ae,i.append(Y,he.timelines),o.push({instruction:he,player:z,element:Y}),he.queriedElements.forEach(X=>us(a,X,[]).push(z)),he.preStyleProps.forEach((X,de)=>{if(X.size){let Le=l.get(de);Le||l.set(de,Le=new Set),X.forEach((_e,st)=>Le.add(st))}}),he.postStyleProps.forEach((X,de)=>{let Le=c.get(de);Le||c.set(de,Le=new Set),X.forEach((_e,st)=>Le.add(st))})});if(M.length){const I=[];M.forEach(U=>{I.push(function gpe(n,e){return new et(3505,ln)}())}),w.forEach(U=>U.destroy()),this.reportError(I)}const T=new Map,x=new Map;o.forEach(I=>{const U=I.element;i.has(U)&&(x.set(U,U),this._beforeAnimationBuild(I.player.namespaceId,I.instruction,T))}),r.forEach(I=>{const U=I.element;this._getPreviousPlayers(U,!1,I.namespaceId,I.triggerName,null).forEach(z=>{us(T,U,[]).push(z),z.destroy()})});const E=g.filter(I=>QV(I,l,c)),R=new Map;ZV(R,this.driver,v,c,ka).forEach(I=>{QV(I,l,c)&&E.push(I)});const V=new Map;f.forEach((I,U)=>{ZV(V,this.driver,new Set(I),l,"!")}),E.forEach(I=>{const U=R.get(I),W=V.get(I);R.set(I,new Map([...Array.from(U?.entries()??[]),...Array.from(W?.entries()??[])]))});const H=[],j=[],q={};o.forEach(I=>{const{element:U,player:W,instruction:z}=I;if(i.has(U)){if(u.has(U))return W.onDestroy(()=>$o(U,z.toStyles)),W.disabled=!0,W.overrideTotalTime(z.totalTime),void r.push(W);let Y=q;if(x.size>1){let $=U;const me=[];for(;$=$.parentNode;){const he=x.get($);if(he){Y=he;break}me.push($)}me.forEach(he=>x.set(he,Y))}const oe=this._buildAnimation(W.namespaceId,z,T,s,V,R);if(W.setRealPlayer(oe),Y===q)H.push(W);else{const $=this.playersByElement.get(Y);$&&$.length&&(W.parentPlayer=Ol($)),r.push(W)}}else ru(U,z.fromStyles),W.onDestroy(()=>$o(U,z.toStyles)),j.push(W),u.has(U)&&r.push(W)}),j.forEach(I=>{const U=s.get(I.element);if(U&&U.length){const W=Ol(U);I.setRealPlayer(W)}}),r.forEach(I=>{I.parentPlayer?I.syncPlayerEvents(I.parentPlayer):I.destroy()});for(let I=0;I<g.length;I++){const U=g[I],W=U[Os];if(wd(U,Wy),W&&W.hasAnimation)continue;let z=[];if(a.size){let oe=a.get(U);oe&&oe.length&&z.push(...oe);let $=this.driver.query(U,x1,!0);for(let me=0;me<$.length;me++){let he=a.get($[me]);he&&he.length&&z.push(...he)}}const Y=z.filter(oe=>!oe.destroyed);Y.length?yme(this,U,Y):this.processLeaveNode(U)}return g.length=0,H.forEach(I=>{this.players.push(I),I.onDone(()=>{I.destroy();const U=this.players.indexOf(I);this.players.splice(U,1)}),I.play()}),H}elementContainsData(e,t){let i=!1;const r=t[Os];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==hm;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,h=us(i,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),h.push(f)})}ru(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,h=new Set,d=t.timelines.map(p=>{const m=p.element;u.add(m);const g=m[Os];if(g&&g.removedBeforeQueried)return new Up(p.duration,p.delay);const _=m!==l,v=function bme(n){const e=[];return KV(n,e),e}((i.get(m)||dme).map(T=>T.getRealPlayer())).filter(T=>!!T.element&&T.element===m),y=s.get(m),b=o.get(m),w=wV(0,this._normalizer,0,p.keyframes,y,b),M=this._buildPlayer(p,w,v);if(p.subTimeline&&r&&h.add(m),_){const T=new k1(e,a,m);T.setRealPlayer(M),c.push(T)}return M});c.forEach(p=>{us(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function gme(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>Ns(p,PV));const f=Ol(d);return f.onDestroy(()=>{u.forEach(p=>wd(p,PV)),$o(l,t.toStyles)}),h.forEach(p=>{us(r,p,[]).push(f)}),f}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Up(e.duration,e.delay)}}class k1{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Up,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>p1(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){us(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function o0(n){return n&&1===n.nodeType}function qV(n,e){const t=n.style.display;return n.style.display=e??"none",t}function ZV(n,e,t,i,r){const s=[];t.forEach(l=>s.push(qV(l)));const o=[];i.forEach((l,c)=>{const u=new Map;l.forEach(h=>{const d=e.computeStyle(c,h,r);u.set(h,d),(!d||0==d.length)&&(c[Os]=fme,o.push(c))}),n.set(c,u)});let a=0;return t.forEach(l=>qV(l,s[a++])),o}function YV(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function Ns(n,e){n.classList?.add(e)}function wd(n,e){n.classList?.remove(e)}function yme(n,e,t){Ol(t).onDone(()=>n.processLeaveNode(e))}function KV(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof lB?KV(i.players,e):e.push(i)}}function QV(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class a0{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new mme(e,t,i),this._timelineEngine=new ame(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],u=T1(this._driver,s,l,[]);if(l.length)throw function spe(n,e){return new et(3404,ln)}();a=function ime(n,e,t){return new rme(n,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=MV(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=MV(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Mme=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&$o(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($o(this._element,this._initialStyles),this._endStyles&&($o(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(ru(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ru(this._element,this._endStyles),this._endStyles=null),$o(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function O1(n){let e=null;return n.forEach((t,i)=>{(function Sme(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class $V{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:NV(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Tme{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return EV(e,t)}getParentElement(e){return v1(e)}query(e,t,i){return DV(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,u=o.filter(f=>f instanceof $V);(function Ape(n,e){return 0===n||0===e})(i,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,m)=>c.set(m,p))});let h=function Tpe(n){return n.length?n[0]instanceof Map?n:n.map(e=>IV(e)):[]}(t).map(f=>Bl(f));h=function Rpe(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,NV(n,a)))}}return e}(e,h,c);const d=function wme(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=O1(e[0]),e.length>1&&(i=O1(e[e.length-1]))):e instanceof Map&&(t=O1(e)),t||i?new Mme(n,t,i):null}(e,h);return new $V(e,h,l,d)}}let Cme=(()=>{class n extends sB{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Vs.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?oB(t):t;return JV(this._renderer,null,i,"register",[r]),new Eme(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(re(uf),re(Ut))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Eme extends class noe{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Dme(this._id,e,t||{},this._renderer)}}class Dme{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return JV(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function JV(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const ez="@.disabled";let Ame=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new tz("",s,this.engine),this._rendererCache.set(s,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return i.data.animation.forEach(l),new Rme(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(re(uf),re(a0),re(Pt))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class tz{constructor(e,t,i){this.namespaceId=e,this.delegate=t,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==ez?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Rme extends tz{constructor(e,t,i,r){super(t,i,r),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==ez?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Pme(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Ime(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}let Lme=(()=>{class n extends a0{constructor(t,i,r){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(re(Ut),re(y1),re(R1))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const nz=[{provide:sB,useClass:Cme},{provide:R1,useFactory:function Fme(){return new Jpe}},{provide:a0,useClass:Lme},{provide:uf,useFactory:function kme(n,e,t){return new Ame(n,e,t)},deps:[Xg,a0,Pt]}],iz=[{provide:y1,useFactory:()=>new Tme},{provide:Er,useValue:"BrowserAnimations"},...nz],Ome=[{provide:y1,useClass:AV},{provide:Er,useValue:"NoopAnimations"},...nz];let Nme=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?Ome:iz}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=jt({providers:iz,imports:[U2]}),n})(),Bme=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Vt({type:n,bootstrap:[Qde]}),n.\u0275inj=jt({providers:[{provide:Jv,useValue:{fullLibraryLoader:()=>ou.e(225).then(ou.bind(ou,7225))}},Ov],imports:[U2,nde,tle,Nfe,Wue,pae,Nme,Are,a1,s1,Wde,QT,o1]}),n})();(function G7(){UI=!1})(),JX().bootstrapModule(Bme).catch(n=>console.error(n))}},d0=>{d0(d0.s=2677)}]);